/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/cin-aux/runtime/sessions/route";
exports.ids = ["app/api/cin-aux/runtime/sessions/route"];
exports.modules = {

/***/ "(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fcin-aux%2Fruntime%2Fsessions%2Froute&page=%2Fapi%2Fcin-aux%2Fruntime%2Fsessions%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcin-aux%2Fruntime%2Fsessions%2Froute.ts&appDir=H%3A%5CUsers%5CGus%5Csource%5Crepo%5Cdynamics%5Cdynamics-b%5Ccryptopi-dynamics%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=H%3A%5CUsers%5CGus%5Csource%5Crepo%5Cdynamics%5Cdynamics-b%5Ccryptopi-dynamics&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!":
/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fcin-aux%2Fruntime%2Fsessions%2Froute&page=%2Fapi%2Fcin-aux%2Fruntime%2Fsessions%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcin-aux%2Fruntime%2Fsessions%2Froute.ts&appDir=H%3A%5CUsers%5CGus%5Csource%5Crepo%5Cdynamics%5Cdynamics-b%5Ccryptopi-dynamics%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=H%3A%5CUsers%5CGus%5Csource%5Crepo%5Cdynamics%5Cdynamics-b%5Ccryptopi-dynamics&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=! ***!
  \*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   handler: () => (/* binding */ handler),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/dist/server/request-meta */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/request-meta.js\");\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! next/dist/server/lib/trace/tracer */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/lib/trace/tracer.js\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next/dist/shared/lib/router/utils/app-paths */ \"next/dist/shared/lib/router/utils/app-paths\");\n/* harmony import */ var next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! next/dist/server/base-http/node */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/base-http/node.js\");\n/* harmony import */ var next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! next/dist/server/web/spec-extension/adapters/next-request */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/web/spec-extension/adapters/next-request.js\");\n/* harmony import */ var next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! next/dist/server/lib/trace/constants */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/lib/trace/constants.js\");\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! next/dist/server/instrumentation/utils */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/instrumentation/utils.js\");\n/* harmony import */ var next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! next/dist/server/send-response */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/send-response.js\");\n/* harmony import */ var next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! next/dist/server/web/utils */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/web/utils.js\");\n/* harmony import */ var next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__);\n/* harmony import */ var next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! next/dist/server/lib/cache-control */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/lib/cache-control.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! next/dist/lib/constants */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/lib/constants.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13___default = /*#__PURE__*/__webpack_require__.n(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__);\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! next/dist/shared/lib/no-fallback-error.external */ \"next/dist/shared/lib/no-fallback-error.external\");\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__);\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! next/dist/server/response-cache */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/response-cache/index.js\");\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__);\n/* harmony import */ var H_Users_Gus_source_repo_dynamics_dynamics_b_cryptopi_dynamics_src_app_api_cin_aux_runtime_sessions_route_ts__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./src/app/api/cin-aux/runtime/sessions/route.ts */ \"(rsc)/./src/app/api/cin-aux/runtime/sessions/route.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([H_Users_Gus_source_repo_dynamics_dynamics_b_cryptopi_dynamics_src_app_api_cin_aux_runtime_sessions_route_ts__WEBPACK_IMPORTED_MODULE_16__]);\nH_Users_Gus_source_repo_dynamics_dynamics_b_cryptopi_dynamics_src_app_api_cin_aux_runtime_sessions_route_ts__WEBPACK_IMPORTED_MODULE_16__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/cin-aux/runtime/sessions/route\",\n        pathname: \"/api/cin-aux/runtime/sessions\",\n        filename: \"route\",\n        bundlePath: \"app/api/cin-aux/runtime/sessions/route\"\n    },\n    distDir: \".next\" || 0,\n    relativeProjectDir:  false || '',\n    resolvedPagePath: \"H:\\\\Users\\\\Gus\\\\source\\\\repo\\\\dynamics\\\\dynamics-b\\\\cryptopi-dynamics\\\\src\\\\app\\\\api\\\\cin-aux\\\\runtime\\\\sessions\\\\route.ts\",\n    nextConfigOutput,\n    userland: H_Users_Gus_source_repo_dynamics_dynamics_b_cryptopi_dynamics_src_app_api_cin_aux_runtime_sessions_route_ts__WEBPACK_IMPORTED_MODULE_16__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\nasync function handler(req, res, ctx) {\n    var _nextConfig_experimental;\n    let srcPage = \"/api/cin-aux/runtime/sessions/route\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (false) {} else if (srcPage === '/index') {\n        // we always normalize /index specifically\n        srcPage = '/';\n    }\n    const multiZoneDraftMode = false;\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage,\n        multiZoneDraftMode\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return null;\n    }\n    const { buildId, params, nextConfig, isDraftMode, prerenderManifest, routerServerContext, isOnDemandRevalidate, revalidateOnlyGenerated, resolvedPathname } = prepareResult;\n    const normalizedSrcPage = (0,next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__.normalizeAppPath)(srcPage);\n    let isIsr = Boolean(prerenderManifest.dynamicRoutes[normalizedSrcPage] || prerenderManifest.routes[resolvedPathname]);\n    if (isIsr && !isDraftMode) {\n        const isPrerendered = Boolean(prerenderManifest.routes[resolvedPathname]);\n        const prerenderInfo = prerenderManifest.dynamicRoutes[normalizedSrcPage];\n        if (prerenderInfo) {\n            if (prerenderInfo.fallback === false && !isPrerendered) {\n                throw new next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__.NoFallbackError();\n            }\n        }\n    }\n    let cacheKey = null;\n    if (isIsr && !routeModule.isDev && !isDraftMode) {\n        cacheKey = resolvedPathname;\n        // ensure /index and / is normalized to one key\n        cacheKey = cacheKey === '/index' ? '/' : cacheKey;\n    }\n    const supportsDynamicResponse = // If we're in development, we always support dynamic HTML\n    routeModule.isDev === true || // If this is not SSG or does not have static paths, then it supports\n    // dynamic HTML.\n    !isIsr;\n    // This is a revalidation request if the request is for a static\n    // page and it is not being resumed from a postponed render and\n    // it is not a dynamic RSC request then it is a revalidation\n    // request.\n    const isRevalidate = isIsr && !supportsDynamicResponse;\n    const method = req.method || 'GET';\n    const tracer = (0,next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__.getTracer)();\n    const activeSpan = tracer.getActiveScopeSpan();\n    const context = {\n        params,\n        prerenderManifest,\n        renderOpts: {\n            experimental: {\n                cacheComponents: Boolean(nextConfig.experimental.cacheComponents),\n                authInterrupts: Boolean(nextConfig.experimental.authInterrupts)\n            },\n            supportsDynamicResponse,\n            incrementalCache: (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'incrementalCache'),\n            cacheLifeProfiles: (_nextConfig_experimental = nextConfig.experimental) == null ? void 0 : _nextConfig_experimental.cacheLife,\n            isRevalidate,\n            waitUntil: ctx.waitUntil,\n            onClose: (cb)=>{\n                res.on('close', cb);\n            },\n            onAfterTaskError: undefined,\n            onInstrumentationRequestError: (error, _request, errorContext)=>routeModule.onRequestError(req, error, errorContext, routerServerContext)\n        },\n        sharedContext: {\n            buildId\n        }\n    };\n    const nodeNextReq = new next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__.NodeNextRequest(req);\n    const nodeNextRes = new next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__.NodeNextResponse(res);\n    const nextReq = next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__.NextRequestAdapter.fromNodeNextRequest(nodeNextReq, (0,next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__.signalFromNodeResponse)(res));\n    try {\n        const invokeRouteModule = async (span)=>{\n            return routeModule.handle(nextReq, context).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__.BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${req.url}`);\n                }\n            });\n        };\n        const handleResponse = async (currentSpan)=>{\n            var _cacheEntry_value;\n            const responseGenerator = async ({ previousCacheEntry })=>{\n                try {\n                    if (!(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode') && isOnDemandRevalidate && revalidateOnlyGenerated && !previousCacheEntry) {\n                        res.statusCode = 404;\n                        // on-demand revalidate always sets this header\n                        res.setHeader('x-nextjs-cache', 'REVALIDATED');\n                        res.end('This page could not be found');\n                        return null;\n                    }\n                    const response = await invokeRouteModule(currentSpan);\n                    req.fetchMetrics = context.renderOpts.fetchMetrics;\n                    let pendingWaitUntil = context.renderOpts.pendingWaitUntil;\n                    // Attempt using provided waitUntil if available\n                    // if it's not we fallback to sendResponse's handling\n                    if (pendingWaitUntil) {\n                        if (ctx.waitUntil) {\n                            ctx.waitUntil(pendingWaitUntil);\n                            pendingWaitUntil = undefined;\n                        }\n                    }\n                    const cacheTags = context.renderOpts.collectedTags;\n                    // If the request is for a static response, we can cache it so long\n                    // as it's not edge.\n                    if (isIsr) {\n                        const blob = await response.blob();\n                        // Copy the headers from the response.\n                        const headers = (0,next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__.toNodeOutgoingHttpHeaders)(response.headers);\n                        if (cacheTags) {\n                            headers[next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.NEXT_CACHE_TAGS_HEADER] = cacheTags;\n                        }\n                        if (!headers['content-type'] && blob.type) {\n                            headers['content-type'] = blob.type;\n                        }\n                        const revalidate = typeof context.renderOpts.collectedRevalidate === 'undefined' || context.renderOpts.collectedRevalidate >= next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.INFINITE_CACHE ? false : context.renderOpts.collectedRevalidate;\n                        const expire = typeof context.renderOpts.collectedExpire === 'undefined' || context.renderOpts.collectedExpire >= next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.INFINITE_CACHE ? undefined : context.renderOpts.collectedExpire;\n                        // Create the cache entry for the response.\n                        const cacheEntry = {\n                            value: {\n                                kind: next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__.CachedRouteKind.APP_ROUTE,\n                                status: response.status,\n                                body: Buffer.from(await blob.arrayBuffer()),\n                                headers\n                            },\n                            cacheControl: {\n                                revalidate,\n                                expire\n                            }\n                        };\n                        return cacheEntry;\n                    } else {\n                        // send response without caching if not ISR\n                        await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, response, context.renderOpts.pendingWaitUntil);\n                        return null;\n                    }\n                } catch (err) {\n                    // if this is a background revalidate we need to report\n                    // the request error here as it won't be bubbled\n                    if (previousCacheEntry == null ? void 0 : previousCacheEntry.isStale) {\n                        await routeModule.onRequestError(req, err, {\n                            routerKind: 'App Router',\n                            routePath: srcPage,\n                            routeType: 'route',\n                            revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__.getRevalidateReason)({\n                                isRevalidate,\n                                isOnDemandRevalidate\n                            })\n                        }, routerServerContext);\n                    }\n                    throw err;\n                }\n            };\n            const cacheEntry = await routeModule.handleResponse({\n                req,\n                nextConfig,\n                cacheKey,\n                routeKind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n                isFallback: false,\n                prerenderManifest,\n                isRoutePPREnabled: false,\n                isOnDemandRevalidate,\n                revalidateOnlyGenerated,\n                responseGenerator,\n                waitUntil: ctx.waitUntil\n            });\n            // we don't create a cacheEntry for ISR\n            if (!isIsr) {\n                return null;\n            }\n            if ((cacheEntry == null ? void 0 : (_cacheEntry_value = cacheEntry.value) == null ? void 0 : _cacheEntry_value.kind) !== next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__.CachedRouteKind.APP_ROUTE) {\n                var _cacheEntry_value1;\n                throw Object.defineProperty(new Error(`Invariant: app-route received invalid cache entry ${cacheEntry == null ? void 0 : (_cacheEntry_value1 = cacheEntry.value) == null ? void 0 : _cacheEntry_value1.kind}`), \"__NEXT_ERROR_CODE\", {\n                    value: \"E701\",\n                    enumerable: false,\n                    configurable: true\n                });\n            }\n            if (!(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode')) {\n                res.setHeader('x-nextjs-cache', isOnDemandRevalidate ? 'REVALIDATED' : cacheEntry.isMiss ? 'MISS' : cacheEntry.isStale ? 'STALE' : 'HIT');\n            }\n            // Draft mode should never be cached\n            if (isDraftMode) {\n                res.setHeader('Cache-Control', 'private, no-cache, no-store, max-age=0, must-revalidate');\n            }\n            const headers = (0,next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__.fromNodeOutgoingHttpHeaders)(cacheEntry.value.headers);\n            if (!((0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode') && isIsr)) {\n                headers.delete(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.NEXT_CACHE_TAGS_HEADER);\n            }\n            // If cache control is already set on the response we don't\n            // override it to allow users to customize it via next.config\n            if (cacheEntry.cacheControl && !res.getHeader('Cache-Control') && !headers.get('Cache-Control')) {\n                headers.set('Cache-Control', (0,next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_12__.getCacheControlHeader)(cacheEntry.cacheControl));\n            }\n            await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, new Response(cacheEntry.value.body, {\n                headers,\n                status: cacheEntry.value.status || 200\n            }));\n            return null;\n        };\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await handleResponse(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__.BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${req.url}`,\n                    kind: next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__.SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, handleResponse));\n        }\n    } catch (err) {\n        // if we aren't wrapped by base-server handle here\n        if (!activeSpan && !(err instanceof next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__.NoFallbackError)) {\n            await routeModule.onRequestError(req, err, {\n                routerKind: 'App Router',\n                routePath: normalizedSrcPage,\n                routeType: 'route',\n                revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__.getRevalidateReason)({\n                    isRevalidate,\n                    isOnDemandRevalidate\n                })\n            });\n        }\n        // rethrow so that we can handle serving error page\n        // If this is during static generation, throw the error again.\n        if (isIsr) throw err;\n        // Otherwise, send a 500 response.\n        await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, new Response(null, {\n            status: 500\n        }));\n        return null;\n    }\n}\n\n//# sourceMappingURL=app-route.js.map\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbmV4dEAxNS41LjJfQHBsYXl3cmlnaHQrdGVzX2I3ZTZjMjgwZTlhMWI0MzA5MzQ3YzBiZjBhYjQ3NmQ1L25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtYXBwLWxvYWRlci9pbmRleC5qcz9uYW1lPWFwcCUyRmFwaSUyRmNpbi1hdXglMkZydW50aW1lJTJGc2Vzc2lvbnMlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmNpbi1hdXglMkZydW50aW1lJTJGc2Vzc2lvbnMlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZjaW4tYXV4JTJGcnVudGltZSUyRnNlc3Npb25zJTJGcm91dGUudHMmYXBwRGlyPUglM0ElNUNVc2VycyU1Q0d1cyU1Q3NvdXJjZSU1Q3JlcG8lNUNkeW5hbWljcyU1Q2R5bmFtaWNzLWIlNUNjcnlwdG9waS1keW5hbWljcyU1Q3NyYyU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9SCUzQSU1Q1VzZXJzJTVDR3VzJTVDc291cmNlJTVDcmVwbyU1Q2R5bmFtaWNzJTVDZHluYW1pY3MtYiU1Q2NyeXB0b3BpLWR5bmFtaWNzJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEJmlzR2xvYmFsTm90Rm91bmRFbmFibGVkPSEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBK0Y7QUFDdkM7QUFDcUI7QUFDZDtBQUNTO0FBQ087QUFDSztBQUNtQztBQUNqRDtBQUNPO0FBQ2Y7QUFDc0M7QUFD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QTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsaUJBQWlCLDZFQUFjO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0Qix3RkFBMkI7QUFDdkQsa0JBQWtCLDZFQUFjO0FBQ2hDLCtCQUErQiw0RUFBc0I7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkMsMEZBQXFCO0FBQ2xFO0FBQ0Esa0JBQWtCLDZFQUFZO0FBQzlCO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWLDZFQUE2RSxnRkFBYztBQUMzRixpQ0FBaUMsUUFBUSxFQUFFLFFBQVE7QUFDbkQsMEJBQTBCLHVFQUFRO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsTUFBTTtBQUNOO0FBQ0EsNENBQTRDLDZGQUFlO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLDJGQUFtQjtBQUNyRDtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyw2RUFBWTtBQUMxQjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7O0FBRUEiLCJzb3VyY2VzIjpbIiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgeyBnZXRSZXF1ZXN0TWV0YSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JlcXVlc3QtbWV0YVwiO1xuaW1wb3J0IHsgZ2V0VHJhY2VyLCBTcGFuS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi90cmFjZS90cmFjZXJcIjtcbmltcG9ydCB7IG5vcm1hbGl6ZUFwcFBhdGggfSBmcm9tIFwibmV4dC9kaXN0L3NoYXJlZC9saWIvcm91dGVyL3V0aWxzL2FwcC1wYXRoc1wiO1xuaW1wb3J0IHsgTm9kZU5leHRSZXF1ZXN0LCBOb2RlTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvYmFzZS1odHRwL25vZGVcIjtcbmltcG9ydCB7IE5leHRSZXF1ZXN0QWRhcHRlciwgc2lnbmFsRnJvbU5vZGVSZXNwb25zZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3dlYi9zcGVjLWV4dGVuc2lvbi9hZGFwdGVycy9uZXh0LXJlcXVlc3RcIjtcbmltcG9ydCB7IEJhc2VTZXJ2ZXJTcGFuIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3RyYWNlL2NvbnN0YW50c1wiO1xuaW1wb3J0IHsgZ2V0UmV2YWxpZGF0ZVJlYXNvbiB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2luc3RydW1lbnRhdGlvbi91dGlsc1wiO1xuaW1wb3J0IHsgc2VuZFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvc2VuZC1yZXNwb25zZVwiO1xuaW1wb3J0IHsgZnJvbU5vZGVPdXRnb2luZ0h0dHBIZWFkZXJzLCB0b05vZGVPdXRnb2luZ0h0dHBIZWFkZXJzIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvd2ViL3V0aWxzXCI7XG5pbXBvcnQgeyBnZXRDYWNoZUNvbnRyb2xIZWFkZXIgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvY2FjaGUtY29udHJvbFwiO1xuaW1wb3J0IHsgSU5GSU5JVEVfQ0FDSEUsIE5FWFRfQ0FDSEVfVEFHU19IRUFERVIgfSBmcm9tIFwibmV4dC9kaXN0L2xpYi9jb25zdGFudHNcIjtcbmltcG9ydCB7IE5vRmFsbGJhY2tFcnJvciB9IGZyb20gXCJuZXh0L2Rpc3Qvc2hhcmVkL2xpYi9uby1mYWxsYmFjay1lcnJvci5leHRlcm5hbFwiO1xuaW1wb3J0IHsgQ2FjaGVkUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcmVzcG9uc2UtY2FjaGVcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJIOlxcXFxVc2Vyc1xcXFxHdXNcXFxcc291cmNlXFxcXHJlcG9cXFxcZHluYW1pY3NcXFxcZHluYW1pY3MtYlxcXFxjcnlwdG9waS1keW5hbWljc1xcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFxjaW4tYXV4XFxcXHJ1bnRpbWVcXFxcc2Vzc2lvbnNcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2Npbi1hdXgvcnVudGltZS9zZXNzaW9ucy9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2Npbi1hdXgvcnVudGltZS9zZXNzaW9uc1wiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvY2luLWF1eC9ydW50aW1lL3Nlc3Npb25zL3JvdXRlXCJcbiAgICB9LFxuICAgIGRpc3REaXI6IHByb2Nlc3MuZW52Ll9fTkVYVF9SRUxBVElWRV9ESVNUX0RJUiB8fCAnJyxcbiAgICByZWxhdGl2ZVByb2plY3REaXI6IHByb2Nlc3MuZW52Ll9fTkVYVF9SRUxBVElWRV9QUk9KRUNUX0RJUiB8fCAnJyxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkg6XFxcXFVzZXJzXFxcXEd1c1xcXFxzb3VyY2VcXFxccmVwb1xcXFxkeW5hbWljc1xcXFxkeW5hbWljcy1iXFxcXGNyeXB0b3BpLWR5bmFtaWNzXFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXGNpbi1hdXhcXFxccnVudGltZVxcXFxzZXNzaW9uc1xcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHdvcmtBc3luY1N0b3JhZ2UsIHdvcmtVbml0QXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHdvcmtBc3luY1N0b3JhZ2UsXG4gICAgICAgIHdvcmtVbml0QXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgd29ya0FzeW5jU3RvcmFnZSwgd29ya1VuaXRBc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBwYXRjaEZldGNoLCAgfTtcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcSwgcmVzLCBjdHgpIHtcbiAgICB2YXIgX25leHRDb25maWdfZXhwZXJpbWVudGFsO1xuICAgIGxldCBzcmNQYWdlID0gXCIvYXBpL2Npbi1hdXgvcnVudGltZS9zZXNzaW9ucy9yb3V0ZVwiO1xuICAgIC8vIHR1cmJvcGFjayBkb2Vzbid0IG5vcm1hbGl6ZSBgL2luZGV4YCBpbiB0aGUgcGFnZSBuYW1lXG4gICAgLy8gc28gd2UgbmVlZCB0byB0byBwcm9jZXNzIGR5bmFtaWMgcm91dGVzIHByb3Blcmx5XG4gICAgLy8gVE9ETzogZml4IHR1cmJvcGFjayBwcm92aWRpbmcgZGlmZmVyaW5nIHZhbHVlIGZyb20gd2VicGFja1xuICAgIGlmIChwcm9jZXNzLmVudi5UVVJCT1BBQ0spIHtcbiAgICAgICAgc3JjUGFnZSA9IHNyY1BhZ2UucmVwbGFjZSgvXFwvaW5kZXgkLywgJycpIHx8ICcvJztcbiAgICB9IGVsc2UgaWYgKHNyY1BhZ2UgPT09ICcvaW5kZXgnKSB7XG4gICAgICAgIC8vIHdlIGFsd2F5cyBub3JtYWxpemUgL2luZGV4IHNwZWNpZmljYWxseVxuICAgICAgICBzcmNQYWdlID0gJy8nO1xuICAgIH1cbiAgICBjb25zdCBtdWx0aVpvbmVEcmFmdE1vZGUgPSBwcm9jZXNzLmVudi5fX05FWFRfTVVMVElfWk9ORV9EUkFGVF9NT0RFO1xuICAgIGNvbnN0IHByZXBhcmVSZXN1bHQgPSBhd2FpdCByb3V0ZU1vZHVsZS5wcmVwYXJlKHJlcSwgcmVzLCB7XG4gICAgICAgIHNyY1BhZ2UsXG4gICAgICAgIG11bHRpWm9uZURyYWZ0TW9kZVxuICAgIH0pO1xuICAgIGlmICghcHJlcGFyZVJlc3VsdCkge1xuICAgICAgICByZXMuc3RhdHVzQ29kZSA9IDQwMDtcbiAgICAgICAgcmVzLmVuZCgnQmFkIFJlcXVlc3QnKTtcbiAgICAgICAgY3R4LndhaXRVbnRpbCA9PSBudWxsID8gdm9pZCAwIDogY3R4LndhaXRVbnRpbC5jYWxsKGN0eCwgUHJvbWlzZS5yZXNvbHZlKCkpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgY29uc3QgeyBidWlsZElkLCBwYXJhbXMsIG5leHRDb25maWcsIGlzRHJhZnRNb2RlLCBwcmVyZW5kZXJNYW5pZmVzdCwgcm91dGVyU2VydmVyQ29udGV4dCwgaXNPbkRlbWFuZFJldmFsaWRhdGUsIHJldmFsaWRhdGVPbmx5R2VuZXJhdGVkLCByZXNvbHZlZFBhdGhuYW1lIH0gPSBwcmVwYXJlUmVzdWx0O1xuICAgIGNvbnN0IG5vcm1hbGl6ZWRTcmNQYWdlID0gbm9ybWFsaXplQXBwUGF0aChzcmNQYWdlKTtcbiAgICBsZXQgaXNJc3IgPSBCb29sZWFuKHByZXJlbmRlck1hbmlmZXN0LmR5bmFtaWNSb3V0ZXNbbm9ybWFsaXplZFNyY1BhZ2VdIHx8IHByZXJlbmRlck1hbmlmZXN0LnJvdXRlc1tyZXNvbHZlZFBhdGhuYW1lXSk7XG4gICAgaWYgKGlzSXNyICYmICFpc0RyYWZ0TW9kZSkge1xuICAgICAgICBjb25zdCBpc1ByZXJlbmRlcmVkID0gQm9vbGVhbihwcmVyZW5kZXJNYW5pZmVzdC5yb3V0ZXNbcmVzb2x2ZWRQYXRobmFtZV0pO1xuICAgICAgICBjb25zdCBwcmVyZW5kZXJJbmZvID0gcHJlcmVuZGVyTWFuaWZlc3QuZHluYW1pY1JvdXRlc1tub3JtYWxpemVkU3JjUGFnZV07XG4gICAgICAgIGlmIChwcmVyZW5kZXJJbmZvKSB7XG4gICAgICAgICAgICBpZiAocHJlcmVuZGVySW5mby5mYWxsYmFjayA9PT0gZmFsc2UgJiYgIWlzUHJlcmVuZGVyZWQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm9GYWxsYmFja0Vycm9yKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgbGV0IGNhY2hlS2V5ID0gbnVsbDtcbiAgICBpZiAoaXNJc3IgJiYgIXJvdXRlTW9kdWxlLmlzRGV2ICYmICFpc0RyYWZ0TW9kZSkge1xuICAgICAgICBjYWNoZUtleSA9IHJlc29sdmVkUGF0aG5hbWU7XG4gICAgICAgIC8vIGVuc3VyZSAvaW5kZXggYW5kIC8gaXMgbm9ybWFsaXplZCB0byBvbmUga2V5XG4gICAgICAgIGNhY2hlS2V5ID0gY2FjaGVLZXkgPT09ICcvaW5kZXgnID8gJy8nIDogY2FjaGVLZXk7XG4gICAgfVxuICAgIGNvbnN0IHN1cHBvcnRzRHluYW1pY1Jlc3BvbnNlID0gLy8gSWYgd2UncmUgaW4gZGV2ZWxvcG1lbnQsIHdlIGFsd2F5cyBzdXBwb3J0IGR5bmFtaWMgSFRNTFxuICAgIHJvdXRlTW9kdWxlLmlzRGV2ID09PSB0cnVlIHx8IC8vIElmIHRoaXMgaXMgbm90IFNTRyBvciBkb2VzIG5vdCBoYXZlIHN0YXRpYyBwYXRocywgdGhlbiBpdCBzdXBwb3J0c1xuICAgIC8vIGR5bmFtaWMgSFRNTC5cbiAgICAhaXNJc3I7XG4gICAgLy8gVGhpcyBpcyBhIHJldmFsaWRhdGlvbiByZXF1ZXN0IGlmIHRoZSByZXF1ZXN0IGlzIGZvciBhIHN0YXRpY1xuICAgIC8vIHBhZ2UgYW5kIGl0IGlzIG5vdCBiZWluZyByZXN1bWVkIGZyb20gYSBwb3N0cG9uZWQgcmVuZGVyIGFuZFxuICAgIC8vIGl0IGlzIG5vdCBhIGR5bmFtaWMgUlNDIHJlcXVlc3QgdGhlbiBpdCBpcyBhIHJldmFsaWRhdGlvblxuICAgIC8vIHJlcXVlc3QuXG4gICAgY29uc3QgaXNSZXZhbGlkYXRlID0gaXNJc3IgJiYgIXN1cHBvcnRzRHluYW1pY1Jlc3BvbnNlO1xuICAgIGNvbnN0IG1ldGhvZCA9IHJlcS5tZXRob2QgfHwgJ0dFVCc7XG4gICAgY29uc3QgdHJhY2VyID0gZ2V0VHJhY2VyKCk7XG4gICAgY29uc3QgYWN0aXZlU3BhbiA9IHRyYWNlci5nZXRBY3RpdmVTY29wZVNwYW4oKTtcbiAgICBjb25zdCBjb250ZXh0ID0ge1xuICAgICAgICBwYXJhbXMsXG4gICAgICAgIHByZXJlbmRlck1hbmlmZXN0LFxuICAgICAgICByZW5kZXJPcHRzOiB7XG4gICAgICAgICAgICBleHBlcmltZW50YWw6IHtcbiAgICAgICAgICAgICAgICBjYWNoZUNvbXBvbmVudHM6IEJvb2xlYW4obmV4dENvbmZpZy5leHBlcmltZW50YWwuY2FjaGVDb21wb25lbnRzKSxcbiAgICAgICAgICAgICAgICBhdXRoSW50ZXJydXB0czogQm9vbGVhbihuZXh0Q29uZmlnLmV4cGVyaW1lbnRhbC5hdXRoSW50ZXJydXB0cylcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzdXBwb3J0c0R5bmFtaWNSZXNwb25zZSxcbiAgICAgICAgICAgIGluY3JlbWVudGFsQ2FjaGU6IGdldFJlcXVlc3RNZXRhKHJlcSwgJ2luY3JlbWVudGFsQ2FjaGUnKSxcbiAgICAgICAgICAgIGNhY2hlTGlmZVByb2ZpbGVzOiAoX25leHRDb25maWdfZXhwZXJpbWVudGFsID0gbmV4dENvbmZpZy5leHBlcmltZW50YWwpID09IG51bGwgPyB2b2lkIDAgOiBfbmV4dENvbmZpZ19leHBlcmltZW50YWwuY2FjaGVMaWZlLFxuICAgICAgICAgICAgaXNSZXZhbGlkYXRlLFxuICAgICAgICAgICAgd2FpdFVudGlsOiBjdHgud2FpdFVudGlsLFxuICAgICAgICAgICAgb25DbG9zZTogKGNiKT0+e1xuICAgICAgICAgICAgICAgIHJlcy5vbignY2xvc2UnLCBjYik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgb25BZnRlclRhc2tFcnJvcjogdW5kZWZpbmVkLFxuICAgICAgICAgICAgb25JbnN0cnVtZW50YXRpb25SZXF1ZXN0RXJyb3I6IChlcnJvciwgX3JlcXVlc3QsIGVycm9yQ29udGV4dCk9PnJvdXRlTW9kdWxlLm9uUmVxdWVzdEVycm9yKHJlcSwgZXJyb3IsIGVycm9yQ29udGV4dCwgcm91dGVyU2VydmVyQ29udGV4dClcbiAgICAgICAgfSxcbiAgICAgICAgc2hhcmVkQ29udGV4dDoge1xuICAgICAgICAgICAgYnVpbGRJZFxuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBub2RlTmV4dFJlcSA9IG5ldyBOb2RlTmV4dFJlcXVlc3QocmVxKTtcbiAgICBjb25zdCBub2RlTmV4dFJlcyA9IG5ldyBOb2RlTmV4dFJlc3BvbnNlKHJlcyk7XG4gICAgY29uc3QgbmV4dFJlcSA9IE5leHRSZXF1ZXN0QWRhcHRlci5mcm9tTm9kZU5leHRSZXF1ZXN0KG5vZGVOZXh0UmVxLCBzaWduYWxGcm9tTm9kZVJlc3BvbnNlKHJlcykpO1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGludm9rZVJvdXRlTW9kdWxlID0gYXN5bmMgKHNwYW4pPT57XG4gICAgICAgICAgICByZXR1cm4gcm91dGVNb2R1bGUuaGFuZGxlKG5leHRSZXEsIGNvbnRleHQpLmZpbmFsbHkoKCk9PntcbiAgICAgICAgICAgICAgICBpZiAoIXNwYW4pIHJldHVybjtcbiAgICAgICAgICAgICAgICBzcGFuLnNldEF0dHJpYnV0ZXMoe1xuICAgICAgICAgICAgICAgICAgICAnaHR0cC5zdGF0dXNfY29kZSc6IHJlcy5zdGF0dXNDb2RlLFxuICAgICAgICAgICAgICAgICAgICAnbmV4dC5yc2MnOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJvb3RTcGFuQXR0cmlidXRlcyA9IHRyYWNlci5nZXRSb290U3BhbkF0dHJpYnV0ZXMoKTtcbiAgICAgICAgICAgICAgICAvLyBXZSB3ZXJlIHVuYWJsZSB0byBnZXQgYXR0cmlidXRlcywgcHJvYmFibHkgT1RFTCBpcyBub3QgZW5hYmxlZFxuICAgICAgICAgICAgICAgIGlmICghcm9vdFNwYW5BdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQuc3Bhbl90eXBlJykgIT09IEJhc2VTZXJ2ZXJTcGFuLmhhbmRsZVJlcXVlc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBVbmV4cGVjdGVkIHJvb3Qgc3BhbiB0eXBlICcke3Jvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQuc3Bhbl90eXBlJyl9Jy4gUGxlYXNlIHJlcG9ydCB0aGlzIE5leHQuanMgaXNzdWUgaHR0cHM6Ly9naXRodWIuY29tL3ZlcmNlbC9uZXh0LmpzYCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3Qgcm91dGUgPSByb290U3BhbkF0dHJpYnV0ZXMuZ2V0KCduZXh0LnJvdXRlJyk7XG4gICAgICAgICAgICAgICAgaWYgKHJvdXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBgJHttZXRob2R9ICR7cm91dGV9YDtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi5zZXRBdHRyaWJ1dGVzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICduZXh0LnJvdXRlJzogcm91dGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAnaHR0cC5yb3V0ZSc6IHJvdXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ25leHQuc3Bhbl9uYW1lJzogbmFtZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi51cGRhdGVOYW1lKG5hbWUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNwYW4udXBkYXRlTmFtZShgJHttZXRob2R9ICR7cmVxLnVybH1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgaGFuZGxlUmVzcG9uc2UgPSBhc3luYyAoY3VycmVudFNwYW4pPT57XG4gICAgICAgICAgICB2YXIgX2NhY2hlRW50cnlfdmFsdWU7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZUdlbmVyYXRvciA9IGFzeW5jICh7IHByZXZpb3VzQ2FjaGVFbnRyeSB9KT0+e1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghZ2V0UmVxdWVzdE1ldGEocmVxLCAnbWluaW1hbE1vZGUnKSAmJiBpc09uRGVtYW5kUmV2YWxpZGF0ZSAmJiByZXZhbGlkYXRlT25seUdlbmVyYXRlZCAmJiAhcHJldmlvdXNDYWNoZUVudHJ5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMuc3RhdHVzQ29kZSA9IDQwNDtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9uLWRlbWFuZCByZXZhbGlkYXRlIGFsd2F5cyBzZXRzIHRoaXMgaGVhZGVyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXMuc2V0SGVhZGVyKCd4LW5leHRqcy1jYWNoZScsICdSRVZBTElEQVRFRCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzLmVuZCgnVGhpcyBwYWdlIGNvdWxkIG5vdCBiZSBmb3VuZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBpbnZva2VSb3V0ZU1vZHVsZShjdXJyZW50U3Bhbik7XG4gICAgICAgICAgICAgICAgICAgIHJlcS5mZXRjaE1ldHJpY3MgPSBjb250ZXh0LnJlbmRlck9wdHMuZmV0Y2hNZXRyaWNzO1xuICAgICAgICAgICAgICAgICAgICBsZXQgcGVuZGluZ1dhaXRVbnRpbCA9IGNvbnRleHQucmVuZGVyT3B0cy5wZW5kaW5nV2FpdFVudGlsO1xuICAgICAgICAgICAgICAgICAgICAvLyBBdHRlbXB0IHVzaW5nIHByb3ZpZGVkIHdhaXRVbnRpbCBpZiBhdmFpbGFibGVcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgaXQncyBub3Qgd2UgZmFsbGJhY2sgdG8gc2VuZFJlc3BvbnNlJ3MgaGFuZGxpbmdcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBlbmRpbmdXYWl0VW50aWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdHgud2FpdFVudGlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LndhaXRVbnRpbChwZW5kaW5nV2FpdFVudGlsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZW5kaW5nV2FpdFVudGlsID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhY2hlVGFncyA9IGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRUYWdzO1xuICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgcmVxdWVzdCBpcyBmb3IgYSBzdGF0aWMgcmVzcG9uc2UsIHdlIGNhbiBjYWNoZSBpdCBzbyBsb25nXG4gICAgICAgICAgICAgICAgICAgIC8vIGFzIGl0J3Mgbm90IGVkZ2UuXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc0lzcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYmxvYiA9IGF3YWl0IHJlc3BvbnNlLmJsb2IoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENvcHkgdGhlIGhlYWRlcnMgZnJvbSB0aGUgcmVzcG9uc2UuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBoZWFkZXJzID0gdG9Ob2RlT3V0Z29pbmdIdHRwSGVhZGVycyhyZXNwb25zZS5oZWFkZXJzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYWNoZVRhZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzW05FWFRfQ0FDSEVfVEFHU19IRUFERVJdID0gY2FjaGVUYWdzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFoZWFkZXJzWydjb250ZW50LXR5cGUnXSAmJiBibG9iLnR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzWydjb250ZW50LXR5cGUnXSA9IGJsb2IudHlwZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJldmFsaWRhdGUgPSB0eXBlb2YgY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZFJldmFsaWRhdGUgPT09ICd1bmRlZmluZWQnIHx8IGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRSZXZhbGlkYXRlID49IElORklOSVRFX0NBQ0hFID8gZmFsc2UgOiBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkUmV2YWxpZGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4cGlyZSA9IHR5cGVvZiBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkRXhwaXJlID09PSAndW5kZWZpbmVkJyB8fCBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkRXhwaXJlID49IElORklOSVRFX0NBQ0hFID8gdW5kZWZpbmVkIDogY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZEV4cGlyZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENyZWF0ZSB0aGUgY2FjaGUgZW50cnkgZm9yIHRoZSByZXNwb25zZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhY2hlRW50cnkgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2luZDogQ2FjaGVkUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiByZXNwb25zZS5zdGF0dXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvZHk6IEJ1ZmZlci5mcm9tKGF3YWl0IGJsb2IuYXJyYXlCdWZmZXIoKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlQ29udHJvbDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXZhbGlkYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBpcmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhY2hlRW50cnk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZW5kIHJlc3BvbnNlIHdpdGhvdXQgY2FjaGluZyBpZiBub3QgSVNSXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBzZW5kUmVzcG9uc2Uobm9kZU5leHRSZXEsIG5vZGVOZXh0UmVzLCByZXNwb25zZSwgY29udGV4dC5yZW5kZXJPcHRzLnBlbmRpbmdXYWl0VW50aWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhpcyBpcyBhIGJhY2tncm91bmQgcmV2YWxpZGF0ZSB3ZSBuZWVkIHRvIHJlcG9ydFxuICAgICAgICAgICAgICAgICAgICAvLyB0aGUgcmVxdWVzdCBlcnJvciBoZXJlIGFzIGl0IHdvbid0IGJlIGJ1YmJsZWRcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByZXZpb3VzQ2FjaGVFbnRyeSA9PSBudWxsID8gdm9pZCAwIDogcHJldmlvdXNDYWNoZUVudHJ5LmlzU3RhbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHJvdXRlTW9kdWxlLm9uUmVxdWVzdEVycm9yKHJlcSwgZXJyLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm91dGVyS2luZDogJ0FwcCBSb3V0ZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdXRlUGF0aDogc3JjUGFnZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3V0ZVR5cGU6ICdyb3V0ZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV2YWxpZGF0ZVJlYXNvbjogZ2V0UmV2YWxpZGF0ZVJlYXNvbih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzUmV2YWxpZGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNPbkRlbWFuZFJldmFsaWRhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgcm91dGVyU2VydmVyQ29udGV4dCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjb25zdCBjYWNoZUVudHJ5ID0gYXdhaXQgcm91dGVNb2R1bGUuaGFuZGxlUmVzcG9uc2Uoe1xuICAgICAgICAgICAgICAgIHJlcSxcbiAgICAgICAgICAgICAgICBuZXh0Q29uZmlnLFxuICAgICAgICAgICAgICAgIGNhY2hlS2V5LFxuICAgICAgICAgICAgICAgIHJvdXRlS2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgICAgICAgICBpc0ZhbGxiYWNrOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBwcmVyZW5kZXJNYW5pZmVzdCxcbiAgICAgICAgICAgICAgICBpc1JvdXRlUFBSRW5hYmxlZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgaXNPbkRlbWFuZFJldmFsaWRhdGUsXG4gICAgICAgICAgICAgICAgcmV2YWxpZGF0ZU9ubHlHZW5lcmF0ZWQsXG4gICAgICAgICAgICAgICAgcmVzcG9uc2VHZW5lcmF0b3IsXG4gICAgICAgICAgICAgICAgd2FpdFVudGlsOiBjdHgud2FpdFVudGlsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vIHdlIGRvbid0IGNyZWF0ZSBhIGNhY2hlRW50cnkgZm9yIElTUlxuICAgICAgICAgICAgaWYgKCFpc0lzcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKChjYWNoZUVudHJ5ID09IG51bGwgPyB2b2lkIDAgOiAoX2NhY2hlRW50cnlfdmFsdWUgPSBjYWNoZUVudHJ5LnZhbHVlKSA9PSBudWxsID8gdm9pZCAwIDogX2NhY2hlRW50cnlfdmFsdWUua2luZCkgIT09IENhY2hlZFJvdXRlS2luZC5BUFBfUk9VVEUpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2NhY2hlRW50cnlfdmFsdWUxO1xuICAgICAgICAgICAgICAgIHRocm93IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXcgRXJyb3IoYEludmFyaWFudDogYXBwLXJvdXRlIHJlY2VpdmVkIGludmFsaWQgY2FjaGUgZW50cnkgJHtjYWNoZUVudHJ5ID09IG51bGwgPyB2b2lkIDAgOiAoX2NhY2hlRW50cnlfdmFsdWUxID0gY2FjaGVFbnRyeS52YWx1ZSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9jYWNoZUVudHJ5X3ZhbHVlMS5raW5kfWApLCBcIl9fTkVYVF9FUlJPUl9DT0RFXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFwiRTcwMVwiLFxuICAgICAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWdldFJlcXVlc3RNZXRhKHJlcSwgJ21pbmltYWxNb2RlJykpIHtcbiAgICAgICAgICAgICAgICByZXMuc2V0SGVhZGVyKCd4LW5leHRqcy1jYWNoZScsIGlzT25EZW1hbmRSZXZhbGlkYXRlID8gJ1JFVkFMSURBVEVEJyA6IGNhY2hlRW50cnkuaXNNaXNzID8gJ01JU1MnIDogY2FjaGVFbnRyeS5pc1N0YWxlID8gJ1NUQUxFJyA6ICdISVQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIERyYWZ0IG1vZGUgc2hvdWxkIG5ldmVyIGJlIGNhY2hlZFxuICAgICAgICAgICAgaWYgKGlzRHJhZnRNb2RlKSB7XG4gICAgICAgICAgICAgICAgcmVzLnNldEhlYWRlcignQ2FjaGUtQ29udHJvbCcsICdwcml2YXRlLCBuby1jYWNoZSwgbm8tc3RvcmUsIG1heC1hZ2U9MCwgbXVzdC1yZXZhbGlkYXRlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBoZWFkZXJzID0gZnJvbU5vZGVPdXRnb2luZ0h0dHBIZWFkZXJzKGNhY2hlRW50cnkudmFsdWUuaGVhZGVycyk7XG4gICAgICAgICAgICBpZiAoIShnZXRSZXF1ZXN0TWV0YShyZXEsICdtaW5pbWFsTW9kZScpICYmIGlzSXNyKSkge1xuICAgICAgICAgICAgICAgIGhlYWRlcnMuZGVsZXRlKE5FWFRfQ0FDSEVfVEFHU19IRUFERVIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gSWYgY2FjaGUgY29udHJvbCBpcyBhbHJlYWR5IHNldCBvbiB0aGUgcmVzcG9uc2Ugd2UgZG9uJ3RcbiAgICAgICAgICAgIC8vIG92ZXJyaWRlIGl0IHRvIGFsbG93IHVzZXJzIHRvIGN1c3RvbWl6ZSBpdCB2aWEgbmV4dC5jb25maWdcbiAgICAgICAgICAgIGlmIChjYWNoZUVudHJ5LmNhY2hlQ29udHJvbCAmJiAhcmVzLmdldEhlYWRlcignQ2FjaGUtQ29udHJvbCcpICYmICFoZWFkZXJzLmdldCgnQ2FjaGUtQ29udHJvbCcpKSB7XG4gICAgICAgICAgICAgICAgaGVhZGVycy5zZXQoJ0NhY2hlLUNvbnRyb2wnLCBnZXRDYWNoZUNvbnRyb2xIZWFkZXIoY2FjaGVFbnRyeS5jYWNoZUNvbnRyb2wpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGF3YWl0IHNlbmRSZXNwb25zZShub2RlTmV4dFJlcSwgbm9kZU5leHRSZXMsIG5ldyBSZXNwb25zZShjYWNoZUVudHJ5LnZhbHVlLmJvZHksIHtcbiAgICAgICAgICAgICAgICBoZWFkZXJzLFxuICAgICAgICAgICAgICAgIHN0YXR1czogY2FjaGVFbnRyeS52YWx1ZS5zdGF0dXMgfHwgMjAwXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfTtcbiAgICAgICAgLy8gVE9ETzogYWN0aXZlU3BhbiBjb2RlIHBhdGggaXMgZm9yIHdoZW4gd3JhcHBlZCBieVxuICAgICAgICAvLyBuZXh0LXNlcnZlciBjYW4gYmUgcmVtb3ZlZCB3aGVuIHRoaXMgaXMgbm8gbG9uZ2VyIHVzZWRcbiAgICAgICAgaWYgKGFjdGl2ZVNwYW4pIHtcbiAgICAgICAgICAgIGF3YWl0IGhhbmRsZVJlc3BvbnNlKGFjdGl2ZVNwYW4pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYXdhaXQgdHJhY2VyLndpdGhQcm9wYWdhdGVkQ29udGV4dChyZXEuaGVhZGVycywgKCk9PnRyYWNlci50cmFjZShCYXNlU2VydmVyU3Bhbi5oYW5kbGVSZXF1ZXN0LCB7XG4gICAgICAgICAgICAgICAgICAgIHNwYW5OYW1lOiBgJHttZXRob2R9ICR7cmVxLnVybH1gLFxuICAgICAgICAgICAgICAgICAgICBraW5kOiBTcGFuS2luZC5TRVJWRVIsXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLm1ldGhvZCc6IG1ldGhvZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLnRhcmdldCc6IHJlcS51cmxcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIGhhbmRsZVJlc3BvbnNlKSk7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgLy8gaWYgd2UgYXJlbid0IHdyYXBwZWQgYnkgYmFzZS1zZXJ2ZXIgaGFuZGxlIGhlcmVcbiAgICAgICAgaWYgKCFhY3RpdmVTcGFuICYmICEoZXJyIGluc3RhbmNlb2YgTm9GYWxsYmFja0Vycm9yKSkge1xuICAgICAgICAgICAgYXdhaXQgcm91dGVNb2R1bGUub25SZXF1ZXN0RXJyb3IocmVxLCBlcnIsIHtcbiAgICAgICAgICAgICAgICByb3V0ZXJLaW5kOiAnQXBwIFJvdXRlcicsXG4gICAgICAgICAgICAgICAgcm91dGVQYXRoOiBub3JtYWxpemVkU3JjUGFnZSxcbiAgICAgICAgICAgICAgICByb3V0ZVR5cGU6ICdyb3V0ZScsXG4gICAgICAgICAgICAgICAgcmV2YWxpZGF0ZVJlYXNvbjogZ2V0UmV2YWxpZGF0ZVJlYXNvbih7XG4gICAgICAgICAgICAgICAgICAgIGlzUmV2YWxpZGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgaXNPbkRlbWFuZFJldmFsaWRhdGVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gcmV0aHJvdyBzbyB0aGF0IHdlIGNhbiBoYW5kbGUgc2VydmluZyBlcnJvciBwYWdlXG4gICAgICAgIC8vIElmIHRoaXMgaXMgZHVyaW5nIHN0YXRpYyBnZW5lcmF0aW9uLCB0aHJvdyB0aGUgZXJyb3IgYWdhaW4uXG4gICAgICAgIGlmIChpc0lzcikgdGhyb3cgZXJyO1xuICAgICAgICAvLyBPdGhlcndpc2UsIHNlbmQgYSA1MDAgcmVzcG9uc2UuXG4gICAgICAgIGF3YWl0IHNlbmRSZXNwb25zZShub2RlTmV4dFJlcSwgbm9kZU5leHRSZXMsIG5ldyBSZXNwb25zZShudWxsLCB7XG4gICAgICAgICAgICBzdGF0dXM6IDUwMFxuICAgICAgICB9KSk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fcin-aux%2Fruntime%2Fsessions%2Froute&page=%2Fapi%2Fcin-aux%2Fruntime%2Fsessions%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcin-aux%2Fruntime%2Fsessions%2Froute.ts&appDir=H%3A%5CUsers%5CGus%5Csource%5Crepo%5Cdynamics%5Cdynamics-b%5Ccryptopi-dynamics%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=H%3A%5CUsers%5CGus%5Csource%5Crepo%5Cdynamics%5Cdynamics-b%5Ccryptopi-dynamics&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!**************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \**************************************************************************************************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./src/app/api/cin-aux/runtime/sessions/route.ts":
/*!*******************************************************!*\
  !*** ./src/app/api/cin-aux/runtime/sessions/route.ts ***!
  \*******************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/api/server.js\");\n/* harmony import */ var _core_db_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/core/db/db */ \"(rsc)/./src/core/db/db.ts\");\n/* harmony import */ var _core_features_cin_aux_runtimeQueries__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/core/features/cin-aux/runtimeQueries */ \"(rsc)/./src/core/features/cin-aux/runtimeQueries.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_core_db_db__WEBPACK_IMPORTED_MODULE_1__, _core_features_cin_aux_runtimeQueries__WEBPACK_IMPORTED_MODULE_2__]);\n([_core_db_db__WEBPACK_IMPORTED_MODULE_1__, _core_features_cin_aux_runtimeQueries__WEBPACK_IMPORTED_MODULE_2__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n// GET: list sessions\nasync function GET() {\n    const sessions = await (0,_core_features_cin_aux_runtimeQueries__WEBPACK_IMPORTED_MODULE_2__.listRuntimeSessions)();\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(sessions);\n}\n// POST: create session\nasync function POST() {\n    try {\n        const { rows } = await _core_db_db__WEBPACK_IMPORTED_MODULE_1__.db.query(`\n      INSERT INTO cin_aux.rt_session (window_label)\n      VALUES ('manual-open')\n      RETURNING session_id, started_at;\n      `);\n        const session = rows[0];\n        const id = session.session_id;\n        await _core_db_db__WEBPACK_IMPORTED_MODULE_1__.db.query(`\n      INSERT INTO cin_aux.rt_imprint_luggage (\n        session_id,\n        imprint_principal_churn_usdt,\n        imprint_profit_churn_usdt,\n        imprint_generated_profit_usdt,\n        imprint_trace_sum_usdt,\n        imprint_devref_sum_usdt,\n        luggage_total_principal_usdt,\n        luggage_total_profit_usdt\n      )\n      VALUES ($1,0,0,0,0,0,0,0)\n      `, [\n            id\n        ]);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            ok: true,\n            sessionId: id,\n            startedAt: session.started_at\n        });\n    } catch (err) {\n        console.error(\"POST runtime/sessions error:\", err);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            ok: false,\n            error: err.message\n        }, {\n            status: 500\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9jaW4tYXV4L3J1bnRpbWUvc2Vzc2lvbnMvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBMkM7QUFDVDtBQUMyQztBQUU3RSxxQkFBcUI7QUFDZCxlQUFlRztJQUNwQixNQUFNQyxXQUFXLE1BQU1GLDBGQUFtQkE7SUFDMUMsT0FBT0YscURBQVlBLENBQUNLLElBQUksQ0FBQ0Q7QUFDM0I7QUFFQSx1QkFBdUI7QUFDaEIsZUFBZUU7SUFDcEIsSUFBSTtRQUNGLE1BQU0sRUFBRUMsSUFBSSxFQUFFLEdBQUcsTUFBTU4sMkNBQUVBLENBQUNPLEtBQUssQ0FDN0IsQ0FBQzs7OztNQUlELENBQUM7UUFHSCxNQUFNQyxVQUFVRixJQUFJLENBQUMsRUFBRTtRQUN2QixNQUFNRyxLQUFLRCxRQUFRRSxVQUFVO1FBRTdCLE1BQU1WLDJDQUFFQSxDQUFDTyxLQUFLLENBQ1osQ0FBQzs7Ozs7Ozs7Ozs7O01BWUQsQ0FBQyxFQUNEO1lBQUNFO1NBQUc7UUFHTixPQUFPVixxREFBWUEsQ0FBQ0ssSUFBSSxDQUFDO1lBQ3ZCTyxJQUFJO1lBQ0pDLFdBQVdIO1lBQ1hJLFdBQVdMLFFBQVFNLFVBQVU7UUFDL0I7SUFDRixFQUFFLE9BQU9DLEtBQVU7UUFDakJDLFFBQVFDLEtBQUssQ0FBQyxnQ0FBZ0NGO1FBQzlDLE9BQU9oQixxREFBWUEsQ0FBQ0ssSUFBSSxDQUN0QjtZQUFFTyxJQUFJO1lBQU9NLE9BQU9GLElBQUlHLE9BQU87UUFBQyxHQUNoQztZQUFFQyxRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsiSDpcXFVzZXJzXFxHdXNcXHNvdXJjZVxccmVwb1xcZHluYW1pY3NcXGR5bmFtaWNzLWJcXGNyeXB0b3BpLWR5bmFtaWNzXFxzcmNcXGFwcFxcYXBpXFxjaW4tYXV4XFxydW50aW1lXFxzZXNzaW9uc1xccm91dGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvc2VydmVyXCI7XG5pbXBvcnQgeyBkYiB9IGZyb20gXCJAL2NvcmUvZGIvZGJcIjtcbmltcG9ydCB7IGxpc3RSdW50aW1lU2Vzc2lvbnMgfSBmcm9tIFwiQC9jb3JlL2ZlYXR1cmVzL2Npbi1hdXgvcnVudGltZVF1ZXJpZXNcIjtcblxuLy8gR0VUOiBsaXN0IHNlc3Npb25zXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKCkge1xuICBjb25zdCBzZXNzaW9ucyA9IGF3YWl0IGxpc3RSdW50aW1lU2Vzc2lvbnMoKTtcbiAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHNlc3Npb25zKTtcbn1cblxuLy8gUE9TVDogY3JlYXRlIHNlc3Npb25cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKCkge1xuICB0cnkge1xuICAgIGNvbnN0IHsgcm93cyB9ID0gYXdhaXQgZGIucXVlcnkoXG4gICAgICBgXG4gICAgICBJTlNFUlQgSU5UTyBjaW5fYXV4LnJ0X3Nlc3Npb24gKHdpbmRvd19sYWJlbClcbiAgICAgIFZBTFVFUyAoJ21hbnVhbC1vcGVuJylcbiAgICAgIFJFVFVSTklORyBzZXNzaW9uX2lkLCBzdGFydGVkX2F0O1xuICAgICAgYFxuICAgICk7XHJcblxyXG4gICAgY29uc3Qgc2Vzc2lvbiA9IHJvd3NbMF07XHJcbiAgICBjb25zdCBpZCA9IHNlc3Npb24uc2Vzc2lvbl9pZDtcclxuXHJcbiAgICBhd2FpdCBkYi5xdWVyeShcbiAgICAgIGBcclxuICAgICAgSU5TRVJUIElOVE8gY2luX2F1eC5ydF9pbXByaW50X2x1Z2dhZ2UgKFxyXG4gICAgICAgIHNlc3Npb25faWQsXHJcbiAgICAgICAgaW1wcmludF9wcmluY2lwYWxfY2h1cm5fdXNkdCxcclxuICAgICAgICBpbXByaW50X3Byb2ZpdF9jaHVybl91c2R0LFxyXG4gICAgICAgIGltcHJpbnRfZ2VuZXJhdGVkX3Byb2ZpdF91c2R0LFxyXG4gICAgICAgIGltcHJpbnRfdHJhY2Vfc3VtX3VzZHQsXHJcbiAgICAgICAgaW1wcmludF9kZXZyZWZfc3VtX3VzZHQsXHJcbiAgICAgICAgbHVnZ2FnZV90b3RhbF9wcmluY2lwYWxfdXNkdCxcclxuICAgICAgICBsdWdnYWdlX3RvdGFsX3Byb2ZpdF91c2R0XHJcbiAgICAgIClcclxuICAgICAgVkFMVUVTICgkMSwwLDAsMCwwLDAsMCwwKVxyXG4gICAgICBgLFxyXG4gICAgICBbaWRdXHJcbiAgICApO1xyXG5cclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XHJcbiAgICAgIG9rOiB0cnVlLFxyXG4gICAgICBzZXNzaW9uSWQ6IGlkLFxyXG4gICAgICBzdGFydGVkQXQ6IHNlc3Npb24uc3RhcnRlZF9hdCxcclxuICAgIH0pO1xyXG4gIH0gY2F0Y2ggKGVycjogYW55KSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiUE9TVCBydW50aW1lL3Nlc3Npb25zIGVycm9yOlwiLCBlcnIpO1xyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICB7IG9rOiBmYWxzZSwgZXJyb3I6IGVyci5tZXNzYWdlIH0sXHJcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxyXG4gICAgKTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImRiIiwibGlzdFJ1bnRpbWVTZXNzaW9ucyIsIkdFVCIsInNlc3Npb25zIiwianNvbiIsIlBPU1QiLCJyb3dzIiwicXVlcnkiLCJzZXNzaW9uIiwiaWQiLCJzZXNzaW9uX2lkIiwib2siLCJzZXNzaW9uSWQiLCJzdGFydGVkQXQiLCJzdGFydGVkX2F0IiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwibWVzc2FnZSIsInN0YXR1cyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/cin-aux/runtime/sessions/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/core/db/db.ts":
/*!***************************!*\
  !*** ./src/core/db/db.ts ***!
  \***************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   clearOpeningCache: () => (/* binding */ clearOpeningCache),\n/* harmony export */   commitMatrixGrid: () => (/* binding */ commitMatrixGrid),\n/* harmony export */   countRowsAt: () => (/* binding */ countRowsAt),\n/* harmony export */   db: () => (/* reexport safe */ _pool_server__WEBPACK_IMPORTED_MODULE_0__.db),\n/* harmony export */   ensureOpening: () => (/* binding */ ensureOpening),\n/* harmony export */   getLatestByType: () => (/* binding */ getLatestByType),\n/* harmony export */   getLatestTsForType: () => (/* binding */ getLatestTsForType),\n/* harmony export */   getMatrixStageTableIdent: () => (/* binding */ getMatrixStageTableIdent),\n/* harmony export */   getNearestTsAtOrBefore: () => (/* binding */ getNearestTsAtOrBefore),\n/* harmony export */   getOpeningFromDb: () => (/* binding */ getOpeningFromDb),\n/* harmony export */   getPool: () => (/* reexport safe */ _pool_server__WEBPACK_IMPORTED_MODULE_0__.getPool),\n/* harmony export */   getPrevSnapshotByType: () => (/* binding */ getPrevSnapshotByType),\n/* harmony export */   getPrevValue: () => (/* binding */ getPrevValue),\n/* harmony export */   getSnapshotByType: () => (/* binding */ getSnapshotByType),\n/* harmony export */   persistLiveMatricesSlice: () => (/* binding */ persistLiveMatricesSlice),\n/* harmony export */   query: () => (/* reexport safe */ _pool_server__WEBPACK_IMPORTED_MODULE_0__.query),\n/* harmony export */   runDbTool: () => (/* binding */ runDbTool),\n/* harmony export */   sql: () => (/* reexport safe */ _session__WEBPACK_IMPORTED_MODULE_1__.sql),\n/* harmony export */   stageMatrixGrid: () => (/* binding */ stageMatrixGrid),\n/* harmony export */   upsertMatrixRows: () => (/* binding */ upsertMatrixRows),\n/* harmony export */   withClient: () => (/* reexport safe */ _pool_server__WEBPACK_IMPORTED_MODULE_0__.withClient)\n/* harmony export */ });\n/* harmony import */ var _pool_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./pool_server */ \"(rsc)/./src/core/db/pool_server.ts\");\n/* harmony import */ var _session__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./session */ \"(rsc)/./src/core/db/session.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pool_server__WEBPACK_IMPORTED_MODULE_0__, _session__WEBPACK_IMPORTED_MODULE_1__]);\n([_pool_server__WEBPACK_IMPORTED_MODULE_0__, _session__WEBPACK_IMPORTED_MODULE_1__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n// src/core/db/db.ts\n\n\n\n/** ------- Dynamics matrices (kept signatures) ------- */ // Optional env override; defaults to our canonical table\nconst RAW_TABLE = process.env.MATRIX_TABLE || \"matrices.dyn_values\";\n// Prevent SQL injection on identifier\nfunction asIdent(name) {\n    const parts = String(name).split(\".\").filter(Boolean);\n    if (!parts.length) throw new Error(`Invalid table identifier: ${name}`);\n    return parts.map((part)=>{\n        if (!/^[A-Za-z_][A-Za-z0-9_]*$/.test(part)) {\n            throw new Error(`Invalid table identifier: ${name}`);\n        }\n        return `\"${part}\"`;\n    }).join(\".\");\n}\nconst TABLE = asIdent(RAW_TABLE);\nconst RAW_STAGE_TABLE = process.env.MATRIX_STAGE_TABLE || \"matrices.dyn_values_stage\";\nconst RAW_COMMIT_TABLE = process.env.MATRIX_COMMIT_TABLE || process.env.MATRIX_TABLE || \"matrices.dyn_values\";\nconst STAGE_TABLE_CANDIDATES = Array.from(new Set([\n    process.env.MATRIX_STAGE_TABLE,\n    \"matrices.dyn_values_stage\",\n    \"public.dyn_matrix_values_stage\"\n].filter(Boolean)));\nconst MATRIX_TABLE_CANDIDATES = Array.from(new Set([\n    process.env.MATRIX_COMMIT_TABLE,\n    process.env.MATRIX_TABLE,\n    \"matrices.dyn_values\",\n    \"public.dyn_matrix_values\"\n].filter(Boolean)));\nfunction splitQualifiedName(name) {\n    const parts = String(name).split(\".\");\n    if (parts.length === 1) return {\n        schema: \"public\",\n        relation: parts[0]\n    };\n    const relation = parts.pop();\n    return {\n        schema: parts.join(\".\"),\n        relation\n    };\n}\nasync function ensureMatrixTables(client) {\n    await client.query(`CREATE SCHEMA IF NOT EXISTS matrices`);\n    await client.query(`\n    DO $$\n    BEGIN\n      IF EXISTS (\n        SELECT 1\n        FROM pg_class c\n        JOIN pg_namespace n ON n.oid = c.relnamespace\n        WHERE n.nspname = 'matrices'\n          AND c.relname = 'dyn_values'\n          AND c.relkind IN ('v','m')\n      ) THEN\n        EXECUTE 'DROP VIEW IF EXISTS matrices.dyn_values CASCADE';\n      END IF;\n      IF EXISTS (\n        SELECT 1\n        FROM pg_class c\n        JOIN pg_namespace n ON n.oid = c.relnamespace\n        WHERE n.nspname = 'matrices'\n          AND c.relname = 'dyn_values_stage'\n          AND c.relkind IN ('v','m')\n      ) THEN\n        EXECUTE 'DROP VIEW IF EXISTS matrices.dyn_values_stage CASCADE';\n      END IF;\n    END\n    $$;\n  `);\n    await client.query(`\n    CREATE TABLE IF NOT EXISTS matrices.dyn_values (\n      ts_ms        bigint           NOT NULL,\n      matrix_type  text             NOT NULL CHECK (matrix_type IN ('benchmark','delta','pct24h','id_pct','pct_drv','ref','pct_ref')),\n      base         text             NOT NULL,\n      quote        text             NOT NULL,\n      value        double precision NOT NULL,\n      meta         jsonb            NOT NULL DEFAULT '{}'::jsonb,\n      created_at   timestamptz      NOT NULL DEFAULT now(),\n      PRIMARY KEY (ts_ms, matrix_type, base, quote)\n    )\n  `);\n    await client.query(`\n    CREATE INDEX IF NOT EXISTS idx_matrices_dyn_values_pair\n      ON matrices.dyn_values (matrix_type, base, quote, ts_ms DESC)\n  `);\n    await client.query(`\n    CREATE TABLE IF NOT EXISTS matrices.dyn_values_stage (\n      ts_ms         bigint           NOT NULL,\n      matrix_type   text             NOT NULL,\n      base          text             NOT NULL,\n      quote         text             NOT NULL,\n      value         double precision NOT NULL,\n      meta          jsonb            NOT NULL DEFAULT '{}'::jsonb,\n      app_session_id text,\n      created_at    timestamptz      NOT NULL DEFAULT now(),\n      PRIMARY KEY (ts_ms, matrix_type, base, quote)\n    )\n  `);\n}\nasync function findExistingTable(client, candidates) {\n    for (const raw of candidates){\n        const { schema, relation } = splitQualifiedName(raw);\n        const { rows } = await client.query(`\n        SELECT c.relkind AS kind\n          FROM pg_class c\n          JOIN pg_namespace n ON n.oid = c.relnamespace\n         WHERE n.nspname = $1 AND c.relname = $2\n      `, [\n            schema,\n            relation\n        ]);\n        const kind = rows[0]?.kind;\n        if (kind && (kind === \"r\" || kind === \"p\")) {\n            return {\n                raw,\n                ident: asIdent(raw),\n                kind\n            };\n        }\n    }\n    return null;\n}\nlet cachedStageInfo = null;\nlet cachedMatrixInfo = null;\nasync function ensureStageInfo(client) {\n    if (cachedStageInfo) return cachedStageInfo;\n    let info = await findExistingTable(client, [\n        RAW_STAGE_TABLE,\n        ...STAGE_TABLE_CANDIDATES\n    ]) ?? await findExistingTable(client, STAGE_TABLE_CANDIDATES);\n    if (!info) {\n        await ensureMatrixTables(client);\n        info = await findExistingTable(client, [\n            RAW_STAGE_TABLE,\n            ...STAGE_TABLE_CANDIDATES\n        ]) ?? await findExistingTable(client, STAGE_TABLE_CANDIDATES);\n        if (!info) {\n            throw new Error(`Matrix stage table not found. Checked: ${[\n                RAW_STAGE_TABLE,\n                ...STAGE_TABLE_CANDIDATES\n            ].filter(Boolean).join(\", \")}`);\n        }\n    }\n    cachedStageInfo = info;\n    return info;\n}\nasync function ensureMatrixInfo(client) {\n    if (cachedMatrixInfo) return cachedMatrixInfo;\n    let info = await findExistingTable(client, [\n        RAW_COMMIT_TABLE,\n        ...MATRIX_TABLE_CANDIDATES\n    ]) ?? await findExistingTable(client, MATRIX_TABLE_CANDIDATES);\n    if (!info) {\n        await ensureMatrixTables(client);\n        info = await findExistingTable(client, [\n            RAW_COMMIT_TABLE,\n            ...MATRIX_TABLE_CANDIDATES\n        ]) ?? await findExistingTable(client, MATRIX_TABLE_CANDIDATES);\n        if (!info) {\n            throw new Error(`Matrix values table not found. Checked: ${[\n                RAW_COMMIT_TABLE,\n                ...MATRIX_TABLE_CANDIDATES\n            ].filter(Boolean).join(\", \")}`);\n        }\n    }\n    if (!info) {\n        throw new Error(`Matrix values table not found. Checked: ${[\n            RAW_COMMIT_TABLE,\n            ...MATRIX_TABLE_CANDIDATES\n        ].filter(Boolean).join(\", \")}`);\n    }\n    cachedMatrixInfo = info;\n    return info;\n}\nfunction dedupeUpper(xs) {\n    if (!xs?.length) return [];\n    const out = [];\n    const seen = new Set();\n    for (const x of xs){\n        const up = String(x ?? \"\").trim().toUpperCase();\n        if (!up || seen.has(up)) continue;\n        seen.add(up);\n        out.push(up);\n    }\n    return out;\n}\nasync function getMatrixStageTableIdent(client) {\n    if (cachedStageInfo) return cachedStageInfo.ident;\n    const useClient = client ?? await _pool_server__WEBPACK_IMPORTED_MODULE_0__.db.connect();\n    const release = !client;\n    try {\n        const info = await ensureStageInfo(useClient);\n        return info.ident;\n    } finally{\n        if (release) useClient.release();\n    }\n}\nasync function getMatrixValuesTableIdent(client) {\n    const info = await ensureMatrixInfo(client);\n    return info.ident;\n}\n/** Bulk upsert directly into main table (bypasses stage/commit) */ async function upsertMatrixRows(rows) {\n    if (!rows.length) return;\n    const client = await _pool_server__WEBPACK_IMPORTED_MODULE_0__.db.connect();\n    try {\n        const values = [];\n        const chunks = rows.map((r, i)=>{\n            const j = i * 6;\n            values.push(r.ts_ms, r.matrix_type, r.base, r.quote, r.value, JSON.stringify(r.meta ?? {}));\n            return `($${j + 1}, $${j + 2}, $${j + 3}, $${j + 4}, $${j + 5}, $${j + 6})`;\n        }).join(\",\");\n        const sql = `\n      INSERT INTO ${TABLE} (ts_ms, matrix_type, base, quote, value, meta)\n      VALUES ${chunks}\n      ON CONFLICT (ts_ms, matrix_type, base, quote)\n      DO UPDATE SET value = EXCLUDED.value, meta = EXCLUDED.meta;\n    `;\n        await client.query(sql, values);\n    } finally{\n        client.release();\n    }\n}\n/** Snapshots & lookups */ async function getLatestByType(matrix_type, coins) {\n    const client = await _pool_server__WEBPACK_IMPORTED_MODULE_0__.db.connect();\n    try {\n        const { rows } = await client.query(`SELECT ts_ms FROM ${TABLE} WHERE matrix_type=$1 ORDER BY ts_ms DESC LIMIT 1`, [\n            matrix_type\n        ]);\n        if (!rows.length) return {\n            ts_ms: null,\n            values: []\n        };\n        const ts_ms = Number(rows[0].ts_ms);\n        const { rows: vals } = await client.query(`SELECT base, quote, value FROM ${TABLE}\n       WHERE matrix_type=$1 AND ts_ms=$2 AND base = ANY($3) AND quote = ANY($3)`, [\n            matrix_type,\n            ts_ms,\n            coins\n        ]);\n        return {\n            ts_ms,\n            values: vals\n        };\n    } finally{\n        client.release();\n    }\n}\nasync function getPrevValue(matrix_type, base, quote, beforeTs) {\n    const { rows } = await _pool_server__WEBPACK_IMPORTED_MODULE_0__.db.query(`SELECT value FROM ${TABLE}\n     WHERE matrix_type=$1 AND base=$2 AND quote=$3 AND ts_ms < $4\n     ORDER BY ts_ms DESC LIMIT 1`, [\n        matrix_type,\n        base,\n        quote,\n        beforeTs\n    ]);\n    return rows.length ? Number(rows[0].value) : null;\n}\nasync function getLatestTsForType(matrix_type) {\n    const { rows } = await _pool_server__WEBPACK_IMPORTED_MODULE_0__.db.query(`SELECT MAX(ts_ms) AS ts_ms FROM ${TABLE} WHERE matrix_type=$1`, [\n        matrix_type\n    ]);\n    const v = rows[0]?.ts_ms;\n    return v == null ? null : Number(v);\n}\nasync function getNearestTsAtOrBefore(matrix_type, ts_ms) {\n    const { rows } = await _pool_server__WEBPACK_IMPORTED_MODULE_0__.db.query(`SELECT ts_ms FROM ${TABLE}\n     WHERE matrix_type=$1 AND ts_ms <= $2\n     ORDER BY ts_ms DESC LIMIT 1`, [\n        matrix_type,\n        ts_ms\n    ]);\n    const v = rows[0]?.ts_ms;\n    return v == null ? null : Number(v);\n}\nasync function getSnapshotByType(matrix_type, ts_ms, coins) {\n    const { rows } = await _pool_server__WEBPACK_IMPORTED_MODULE_0__.db.query(`SELECT base, quote, value FROM ${TABLE}\n     WHERE matrix_type=$1 AND ts_ms=$2 AND base = ANY($3) AND quote = ANY($3)`, [\n        matrix_type,\n        ts_ms,\n        coins\n    ]);\n    return rows;\n}\nasync function getPrevSnapshotByType(matrix_type, beforeTs, coins) {\n    const { rows } = await _pool_server__WEBPACK_IMPORTED_MODULE_0__.db.query(`SELECT DISTINCT ON (base, quote) base, quote, value\n       FROM ${TABLE}\n      WHERE matrix_type=$1\n        AND ts_ms < $2\n        AND base  = ANY($3)\n        AND quote = ANY($3)\n   ORDER BY base, quote, ts_ms DESC`, [\n        matrix_type,\n        beforeTs,\n        coins\n    ]);\n    return rows;\n}\nasync function countRowsAt(matrix_type, ts_ms) {\n    const { rows } = await _pool_server__WEBPACK_IMPORTED_MODULE_0__.db.query(`SELECT count(*)::int AS n FROM ${TABLE} WHERE matrix_type=$1 AND ts_ms=$2`, [\n        matrix_type,\n        ts_ms\n    ]);\n    return rows[0]?.n ?? 0;\n}\nconst openingCache = new Map();\nconst keyStr = (k)=>`${k.base}:${k.quote ?? \"USDT\"}:${k.window ?? \"1h\"}:${k.appSessionId ?? \"global\"}`;\n/** Read last opening for a (base,quote,window,session) from STR-AUX; fallback to compat view */ async function getOpeningFromDb(k) {\n    // Source of truth: strategy_aux.str_aux_session with opening_stamp = TRUE\n    const q1 = `\n    SELECT opening_ts AS ts, opening_price AS price\n      FROM strategy_aux.str_aux_session\n     WHERE pair_base=$1 AND pair_quote=$2 AND window_key=$3\n       AND ($4::text IS NULL OR app_session_id=$4)\n       AND opening_stamp = TRUE\n  ORDER BY opening_ts DESC\n     LIMIT 1\n  `;\n    const r1 = await _pool_server__WEBPACK_IMPORTED_MODULE_0__.db.query(q1, [\n        k.base,\n        k.quote ?? \"USDT\",\n        k.window ?? \"1h\",\n        k.appSessionId ?? null\n    ]);\n    if (r1.rows.length) {\n        return {\n            price: Number(r1.rows[0].price),\n            ts: Number(r1.rows[0].ts)\n        };\n    }\n    // Compatibility view (kept for older code paths)\n    const q2 = `SELECT session_ts AS ts, opening_price AS price\n                FROM session_openings\n            ORDER BY session_ts DESC\n               LIMIT 1`;\n    const r2 = await _pool_server__WEBPACK_IMPORTED_MODULE_0__.db.query(q2);\n    if (r2.rows.length) {\n        return {\n            price: Number(r2.rows[0].price),\n            ts: Number(r2.rows[0].ts)\n        };\n    }\n    return null;\n}\n/**\r\n * Ensure an opening exists + cache it for this process.\r\n * If you pass openingTs/openingPrice, we try to upsert via the SQL function `upsert_str_aux_opening` (if present).\r\n */ async function ensureOpening(k, opts = {}) {\n    const ck = keyStr(k);\n    const hit = openingCache.get(ck);\n    if (hit) return hit;\n    // If given explicit opening, try to persist (no-op if the function doesn't exist).\n    if (opts.openingPrice != null && opts.openingTs != null) {\n        try {\n            await _pool_server__WEBPACK_IMPORTED_MODULE_0__.db.query(`SELECT upsert_str_aux_opening($1,$2,$3,$4,$5,$6,$7)`, [\n                k.base,\n                k.quote ?? \"USDT\",\n                k.window ?? \"1h\",\n                k.appSessionId ?? \"global\",\n                opts.openingTs,\n                opts.openingPrice,\n                `idem:${k.base}:${k.quote ?? \"USDT\"}:${k.window ?? \"1h\"}:${k.appSessionId ?? \"global\"}:${opts.openingTs}`\n            ]);\n        } catch  {}\n    }\n    const row = await getOpeningFromDb(k);\n    if (row) {\n        openingCache.set(ck, row);\n        return row;\n    }\n    return null;\n}\nfunction clearOpeningCache(k) {\n    if (!k) return openingCache.clear();\n    openingCache.delete(keyStr(k));\n}\n/** Internal: iterate off-diagonal cells that have finite numbers */ function* cellsOf(coins, values) {\n    for (const b of coins){\n        for (const q of coins){\n            if (b === q) continue;\n            const v = values?.[b]?.[q];\n            if (v == null || Number.isNaN(Number(v))) continue;\n            yield {\n                base: b,\n                quote: q,\n                value: Number(v)\n            };\n        }\n    }\n}\n/** Stage all cells for a (matrix_type, ts_ms). Overwrites on conflict in STAGE. */ async function stageMatrixGrid(opts) {\n    const { appSessionId, matrixType, tsMs, coins, values, meta, client: external } = opts;\n    const client = external ?? await _pool_server__WEBPACK_IMPORTED_MODULE_0__.db.connect();\n    const release = !external;\n    try {\n        const rows = Array.from(cellsOf(coins, values));\n        if (!rows.length) return {\n            ok: true,\n            staged: 0\n        };\n        const metaJson = JSON.stringify(meta ?? {});\n        const stageInfo = await ensureStageInfo(client);\n        const text = `\n      INSERT INTO ${stageInfo.ident}\n        (ts_ms, matrix_type, base, quote, value, meta, app_session_id)\n      VALUES ${rows.map((_, i)=>`($1,$2,$${i * 3 + 3},$${i * 3 + 4},$${i * 3 + 5},$${rows.length * 3 + 3},$${rows.length * 3 + 4})`).join(\",\")}\n      ON CONFLICT (ts_ms, matrix_type, base, quote)\n      DO UPDATE SET value = EXCLUDED.value, meta = EXCLUDED.meta, app_session_id = EXCLUDED.app_session_id\n    `;\n        const params = [\n            tsMs,\n            matrixType\n        ];\n        for (const r of rows)params.push(r.base, r.quote, r.value);\n        params.push(metaJson, appSessionId);\n        await client.query(text, params);\n        return {\n            ok: true,\n            staged: rows.length\n        };\n    } finally{\n        if (release) client.release();\n    }\n}\n/** Publish staged rows into main table + cycle_document + ledger (see DDL) */ async function commitMatrixGrid(opts) {\n    const { matrixType, tsMs, coins, client: external } = opts;\n    const client = external ?? await _pool_server__WEBPACK_IMPORTED_MODULE_0__.db.connect();\n    const release = !external;\n    const manageTx = !external;\n    try {\n        if (manageTx) await client.query(\"BEGIN\");\n        const stageInfo = await ensureStageInfo(client);\n        const matrixTable = await getMatrixValuesTableIdent(client);\n        const stageRows = await client.query(`SELECT base, quote\n         FROM ${stageInfo.ident}\n        WHERE ts_ms = $1 AND matrix_type = $2`, [\n            tsMs,\n            matrixType\n        ]);\n        const stagedCells = stageRows.rowCount ?? stageRows.rows.length;\n        const coinsFromStage = new Set();\n        for (const row of stageRows.rows){\n            const base = String(row.base ?? \"\").toUpperCase();\n            const quote = String(row.quote ?? \"\").toUpperCase();\n            if (base) coinsFromStage.add(base);\n            if (quote) coinsFromStage.add(quote);\n        }\n        const eligibleCoins = coins?.length && dedupeUpper(coins).length ? dedupeUpper(coins) : Array.from(coinsFromStage);\n        const expectedCells = eligibleCoins.length * Math.max(eligibleCoins.length - 1, 0);\n        await client.query(`\n      INSERT INTO ${matrixTable}\n        (ts_ms, matrix_type, base, quote, value, meta)\n      SELECT ts_ms, matrix_type, base, quote, value, meta\n        FROM ${stageInfo.ident}\n       WHERE ts_ms = $1 AND matrix_type = $2\n      ON CONFLICT (ts_ms, matrix_type, base, quote)\n      DO UPDATE SET value = EXCLUDED.value, meta = EXCLUDED.meta\n    `, [\n            tsMs,\n            matrixType\n        ]);\n        const stagedPairs = new Set(stageRows.rows.map((row)=>{\n            const base = String(row.base ?? \"\").toUpperCase();\n            const quote = String(row.quote ?? \"\").toUpperCase();\n            if (!base || !quote || base === quote) return null;\n            return `${base}${quote}`;\n        }).filter(Boolean));\n        let missingCount = 0;\n        for (const base of eligibleCoins){\n            for (const quote of eligibleCoins){\n                if (base === quote) continue;\n                if (!stagedPairs.has(`${base}${quote}`)) missingCount += 1;\n            }\n        }\n        if (manageTx) await client.query(\"COMMIT\");\n        return {\n            ok: true,\n            matrix_type: matrixType,\n            ts_ms: tsMs,\n            expected_cells: expectedCells,\n            staged_cells: stagedCells,\n            missing_count: missingCount,\n            complete: missingCount === 0 && stagedCells === expectedCells\n        };\n    } catch (err) {\n        if (manageTx) await client.query(\"ROLLBACK\");\n        throw err;\n    } finally{\n        if (release) client.release();\n    }\n}\n/** Convenience: read prev benchmark grid for a coin set (paired map) */ async function mapPrevBenchmark(beforeTs, coins) {\n    const prev = await getPrevSnapshotByType(\"benchmark\", beforeTs, coins);\n    const m = new Map();\n    for (const r of prev)m.set(`${r.base}/${r.quote}`, Number(r.value));\n    return m;\n}\n/**\r\n * Persist the current live slices for the active coin-universe:\r\n *  - benchmark (full NN)\r\n *  - pct24h   (as-is from live)\r\n *  - id_pct   (derived vs prev benchmark so pct_drv has history on next tick)\r\n *\r\n * All three use the SAME ts_ms to keep slices aligned.\r\n */ async function persistLiveMatricesSlice(opts) {\n    const { appSessionId, coins, tsMs, benchmark, pct24h, idemPrefix } = opts;\n    // 1) stage+commit benchmark\n    await stageMatrixGrid({\n        appSessionId,\n        matrixType: \"benchmark\",\n        tsMs,\n        coins,\n        values: benchmark,\n        meta: {\n            source: \"live\"\n        }\n    });\n    await commitMatrixGrid({\n        appSessionId,\n        matrixType: \"benchmark\",\n        tsMs,\n        coins,\n        idem: `${idemPrefix ?? \"benchmark\"}:${tsMs}`\n    });\n    // 2) stage+commit pct24h (optional)\n    if (pct24h) {\n        await stageMatrixGrid({\n            appSessionId,\n            matrixType: \"pct24h\",\n            tsMs,\n            coins,\n            values: pct24h,\n            meta: {\n                source: \"live\"\n            }\n        });\n        await commitMatrixGrid({\n            appSessionId,\n            matrixType: \"pct24h\",\n            tsMs,\n            coins,\n            idem: `${idemPrefix ?? \"pct24h\"}:${tsMs}`\n        });\n    }\n    // 3) derive id_pct vs prev(benchmark) and persist\n    const prevMap = await mapPrevBenchmark(tsMs, coins);\n    const idObj = {};\n    for (const b of coins){\n        idObj[b] = {};\n        for (const q of coins){\n            if (b === q) continue;\n            const now = benchmark?.[b]?.[q];\n            const prev = prevMap.get(`${b}/${q}`);\n            if (now == null || prev == null || Math.abs(prev) < 1e-300) {\n                idObj[b][q] = null;\n            } else {\n                idObj[b][q] = (Number(now) - prev) / prev; // id_pct = (bm_new - bm_prev)/bm_prev\n            }\n        }\n    }\n    await stageMatrixGrid({\n        appSessionId,\n        matrixType: \"id_pct\",\n        tsMs,\n        coins,\n        values: idObj,\n        meta: {\n            source: \"derived@db\",\n            base: \"prev(benchmark)\"\n        }\n    });\n    await commitMatrixGrid({\n        appSessionId,\n        matrixType: \"id_pct\",\n        tsMs,\n        coins,\n        idem: `${idemPrefix ?? \"id_pct\"}:${tsMs}`\n    });\n}\nconst BASE_STEP = {\n    name: \"BASE DDLs\",\n    files: [\n        \"00_extensions.sql\",\n        \"01_settings.sql\",\n        \"02_market.sql\",\n        \"03_docs.sql\",\n        \"04_matrices.sql\",\n        \"05_str_aux.sql\",\n        \"06_cin_aux_core.sql\",\n        \"07_cin_aux_runtime.sql\",\n        \"08_cin_aux_functions.sql\",\n        \"09_ops.sql\",\n        \"09_ingest.sql\",\n        \"10_helpers.sql\",\n        \"11_views_latest.sql\"\n    ]\n};\nconst PATCH_STEP = {\n    name: \"PATCH SET v1\",\n    files: [\n        \"01_settings_patches.sql\",\n        \"02_market_patches.sql\",\n        \"03_docs_patches.sql\",\n        \"04_matrices_patches.sql\",\n        \"05_str_aux_patches.sql\",\n        \"06_cin_aux_core_patches.sql\",\n        \"07_cin_aux_runtime_patches.sql\",\n        \"08_cin_aux_functions_patches.sql\",\n        \"09_mea_dynamics_patches.sql\",\n        \"10_ops_patches.sql\",\n        \"11_remove_bootstrap.sql\"\n    ]\n};\nconst SEED_STEP = {\n    name: \"SEEDS\",\n    files: [\n        \"01_seed.sql\",\n        \"02_seed_jobs.sql\"\n    ]\n};\nconst VERIFY_STEP = {\n    name: \"VERIFY\",\n    files: [\n        \"03_verify.sql\"\n    ]\n};\nasync function spawnCommand(cmd, args, env) {\n    const { spawn } = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! node:child_process */ \"node:child_process\", 23));\n    return new Promise((resolve, reject)=>{\n        const child = spawn(cmd, args, {\n            stdio: \"inherit\",\n            env\n        });\n        child.on(\"error\", reject);\n        child.on(\"exit\", (code)=>code === 0 ? resolve() : reject(new Error(`${cmd} exited with ${code}`)));\n    });\n}\nasync function runDbTool(argv = typeof process !== \"undefined\" ? process.argv.slice(2) : [], opts = {}) {\n    const [{ resolve, join }, fs, dotenv] = await Promise.all([\n        Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! node:path */ \"node:path\", 23)),\n        Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! node:fs */ \"node:fs\", 23)),\n        __webpack_require__.e(/*! import() */ \"vendor-chunks/dotenv@17.2.2\").then(__webpack_require__.t.bind(__webpack_require__, /*! dotenv */ \"(rsc)/./node_modules/.pnpm/dotenv@17.2.2/node_modules/dotenv/lib/main.js\", 23))\n    ]);\n    const ROOT = resolve(process.cwd(), opts.root ?? \"db\");\n    const ENV_FILE = join(ROOT, \".env.db\");\n    if (fs.existsSync(ENV_FILE)) {\n        dotenv.config({\n            path: ENV_FILE\n        });\n    }\n    const pg = {\n        host: process.env.PGHOST ?? \"localhost\",\n        port: String(process.env.PGPORT ?? \"5432\"),\n        db: process.env.PGDATABASE ?? \"postgres\",\n        user: process.env.PGUSER ?? \"postgres\",\n        pass: process.env.PGPASSWORD ?? \"\"\n    };\n    const fileExists = (file)=>fs.existsSync(join(ROOT, file));\n    async function ensurePsql() {\n        await spawnCommand(\"psql\", [\n            \"--version\"\n        ]);\n    }\n    async function execSql(file) {\n        if (!fileExists(file)) return;\n        const full = join(ROOT, file);\n        await spawnCommand(\"psql\", [\n            \"-X\",\n            \"-v\",\n            \"ON_ERROR_STOP=1\",\n            \"-h\",\n            pg.host,\n            \"-p\",\n            pg.port,\n            \"-U\",\n            pg.user,\n            \"-d\",\n            pg.db,\n            \"-f\",\n            full\n        ], {\n            ...process.env,\n            PGPASSWORD: pg.pass\n        });\n    }\n    async function runStep(step) {\n        console.log(`\\n=== ${step.name} ===`);\n        for (const file of step.files){\n            if (!fileExists(file)) continue;\n            console.log(`-> ${file}`);\n            await execSql(file);\n        }\n    }\n    async function ensureDb() {\n        const sql = `DO $$\n     BEGIN\n       IF NOT EXISTS (SELECT 1 FROM pg_database WHERE datname = '${pg.db}') THEN\n         EXECUTE 'CREATE DATABASE ${pg.db}';\n       END IF;\n     END$$;`;\n        await spawnCommand(\"psql\", [\n            \"-X\",\n            \"-v\",\n            \"ON_ERROR_STOP=1\",\n            \"-h\",\n            pg.host,\n            \"-p\",\n            pg.port,\n            \"-U\",\n            pg.user,\n            \"-d\",\n            \"postgres\",\n            \"-c\",\n            sql\n        ], {\n            ...process.env,\n            PGPASSWORD: pg.pass\n        });\n    }\n    function usage() {\n        console.log(`\nUsage:\n  pnpm db:apply     # base DDLs + patches\n  pnpm db:seed      # seeds (universe/timing/session/jobs)\n  pnpm db:verify    # quick checks\n  pnpm db:all       # ensure DB, apply, seed, verify\n  pnpm db:psql      # open interactive psql to PGDATABASE\n\nENV: read from db/.env.db (PGHOST, PGPORT, PGDATABASE, PGUSER, PGPASSWORD)\n`.trim());\n    }\n    const [cmd = \"\"] = argv;\n    await ensurePsql();\n    if (cmd === \"apply\") {\n        await runStep(BASE_STEP);\n        await runStep(PATCH_STEP);\n        console.log(\"[ok] apply complete\");\n        return;\n    }\n    if (cmd === \"seed\") {\n        await runStep(SEED_STEP);\n        console.log(\"[ok] seed complete\");\n        return;\n    }\n    if (cmd === \"verify\") {\n        await runStep(VERIFY_STEP);\n        console.log(\"[ok] verify complete\");\n        return;\n    }\n    if (cmd === \"all\") {\n        await ensureDb();\n        await runStep(BASE_STEP);\n        await runStep(PATCH_STEP);\n        await runStep(SEED_STEP);\n        await runStep(VERIFY_STEP);\n        console.log(\"[ok] all done\");\n        return;\n    }\n    if (cmd === \"psql\") {\n        await spawnCommand(\"psql\", [\n            \"-h\",\n            pg.host,\n            \"-p\",\n            pg.port,\n            \"-U\",\n            pg.user,\n            \"-d\",\n            pg.db\n        ], {\n            ...process.env,\n            PGPASSWORD: pg.pass\n        });\n        return;\n    }\n    usage();\n    throw new Error(`Unknown db command \"${cmd}\"`);\n}\nasync function maybeRunDbToolFromCli() {\n    if (typeof process === \"undefined\" || !process.argv?.[1]) return;\n    try {\n        const { pathToFileURL } = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! node:url */ \"node:url\", 23));\n        if (\"file:///H:/Users/Gus/source/repo/dynamics/dynamics-b/cryptopi-dynamics/src/core/db/db.ts\" !== pathToFileURL(process.argv[1]).href) return;\n    } catch  {\n        return;\n    }\n    try {\n        await runDbTool(process.argv.slice(2));\n    } catch (err) {\n        console.error(err);\n        process.exitCode = 1;\n    }\n}\nvoid maybeRunDbToolFromCli();\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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MEMsUUFBUUMsR0FBRyxDQUFDO1FBQ1o7SUFDRjtJQUVBLElBQUl6QyxRQUFRLFFBQVE7UUFDbEIsTUFBTUQsYUFDSixRQUNBO1lBQUM7WUFBTXdCLEdBQUdDLElBQUk7WUFBRTtZQUFNRCxHQUFHRyxJQUFJO1lBQUU7WUFBTUgsR0FBR00sSUFBSTtZQUFFO1lBQU1OLEdBQUdoTSxFQUFFO1NBQUMsRUFDMUQ7WUFBRSxHQUFHTSxRQUFRQyxHQUFHO1lBQUVrTSxZQUFZVCxHQUFHUSxJQUFJO1FBQUM7UUFFeEM7SUFDRjtJQUVBWTtJQUNBLE1BQU0sSUFBSW5NLE1BQU0sQ0FBQyxvQkFBb0IsRUFBRXdKLElBQUksQ0FBQyxDQUFDO0FBQy9DO0FBRUEsZUFBZTRDO0lBQ2IsSUFBSSxPQUFPL00sWUFBWSxlQUFlLENBQUNBLFFBQVE4SyxJQUFJLEVBQUUsQ0FBQyxFQUFFLEVBQUU7SUFDMUQsSUFBSTtRQUNGLE1BQU0sRUFBRWtDLGFBQWEsRUFBRSxHQUFHLE1BQU0sc0hBQWtCO1FBQ2xELElBQUksMEZBQWUsS0FBS0EsY0FBY2hOLFFBQVE4SyxJQUFJLENBQUMsRUFBRSxFQUFHb0MsSUFBSSxFQUFFO0lBQ2hFLEVBQUUsT0FBTTtRQUNOO0lBQ0Y7SUFFQSxJQUFJO1FBQ0YsTUFBTXJDLFVBQVU3SyxRQUFROEssSUFBSSxDQUFDQyxLQUFLLENBQUM7SUFDckMsRUFBRSxPQUFPaEMsS0FBSztRQUNaNEQsUUFBUVEsS0FBSyxDQUFDcEU7UUFDZC9JLFFBQVFvTixRQUFRLEdBQUc7SUFDckI7QUFDRjtBQUVBLEtBQUtMIiwic291cmNlcyI6WyJIOlxcVXNlcnNcXEd1c1xcc291cmNlXFxyZXBvXFxkeW5hbWljc1xcZHluYW1pY3MtYlxcY3J5cHRvcGktZHluYW1pY3NcXHNyY1xcY29yZVxcZGJcXGRiLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9jb3JlL2RiL2RiLnRzXHJcbmltcG9ydCB0eXBlIHsgUG9vbENsaWVudCwgUXVlcnlSZXN1bHQsIFF1ZXJ5UmVzdWx0Um93IH0gZnJvbSBcInBnXCI7XG5pbXBvcnQgeyBkYiwgZ2V0UG9vbCwgcXVlcnksIHdpdGhDbGllbnQgfSBmcm9tIFwiLi9wb29sX3NlcnZlclwiO1xuXG5leHBvcnQgeyBkYiwgZ2V0UG9vbCwgcXVlcnksIHdpdGhDbGllbnQgfSBmcm9tIFwiLi9wb29sX3NlcnZlclwiO1xuZXhwb3J0IHsgc3FsIH0gZnJvbSBcIi4vc2Vzc2lvblwiO1xuZXhwb3J0IHR5cGUgeyBTcWxUYWcgfSBmcm9tIFwiLi9zZXNzaW9uXCI7XG5cclxuLyoqIC0tLS0tLS0gRHluYW1pY3MgbWF0cmljZXMgKGtlcHQgc2lnbmF0dXJlcykgLS0tLS0tLSAqL1xyXG4vLyBPcHRpb25hbCBlbnYgb3ZlcnJpZGU7IGRlZmF1bHRzIHRvIG91ciBjYW5vbmljYWwgdGFibGVcbmNvbnN0IFJBV19UQUJMRSA9IHByb2Nlc3MuZW52Lk1BVFJJWF9UQUJMRSB8fCBcIm1hdHJpY2VzLmR5bl92YWx1ZXNcIjtcblxuLy8gUHJldmVudCBTUUwgaW5qZWN0aW9uIG9uIGlkZW50aWZpZXJcbmZ1bmN0aW9uIGFzSWRlbnQobmFtZTogc3RyaW5nKSB7XG4gIGNvbnN0IHBhcnRzID0gU3RyaW5nKG5hbWUpLnNwbGl0KFwiLlwiKS5maWx0ZXIoQm9vbGVhbik7XG4gIGlmICghcGFydHMubGVuZ3RoKSB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgdGFibGUgaWRlbnRpZmllcjogJHtuYW1lfWApO1xuICByZXR1cm4gcGFydHMubWFwKChwYXJ0KSA9PiB7XG4gICAgaWYgKCEvXltBLVphLXpfXVtBLVphLXowLTlfXSokLy50ZXN0KHBhcnQpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgdGFibGUgaWRlbnRpZmllcjogJHtuYW1lfWApO1xuICAgIH1cbiAgICByZXR1cm4gYFwiJHtwYXJ0fVwiYDtcbiAgfSkuam9pbihcIi5cIik7XG59XG5jb25zdCBUQUJMRSA9IGFzSWRlbnQoUkFXX1RBQkxFKTtcblxuY29uc3QgUkFXX1NUQUdFX1RBQkxFID1cbiAgcHJvY2Vzcy5lbnYuTUFUUklYX1NUQUdFX1RBQkxFIHx8IFwibWF0cmljZXMuZHluX3ZhbHVlc19zdGFnZVwiO1xuY29uc3QgUkFXX0NPTU1JVF9UQUJMRSA9XG4gIHByb2Nlc3MuZW52Lk1BVFJJWF9DT01NSVRfVEFCTEUgfHxcbiAgcHJvY2Vzcy5lbnYuTUFUUklYX1RBQkxFIHx8XG4gIFwibWF0cmljZXMuZHluX3ZhbHVlc1wiO1xuXG5jb25zdCBTVEFHRV9UQUJMRV9DQU5ESURBVEVTID0gQXJyYXkuZnJvbShcbiAgbmV3IFNldChcbiAgICBbXG4gICAgICBwcm9jZXNzLmVudi5NQVRSSVhfU1RBR0VfVEFCTEUsXG4gICAgICBcIm1hdHJpY2VzLmR5bl92YWx1ZXNfc3RhZ2VcIixcbiAgICAgIFwicHVibGljLmR5bl9tYXRyaXhfdmFsdWVzX3N0YWdlXCIsXG4gICAgXS5maWx0ZXIoQm9vbGVhbikgYXMgc3RyaW5nW11cbiAgKVxuKTtcblxuY29uc3QgTUFUUklYX1RBQkxFX0NBTkRJREFURVMgPSBBcnJheS5mcm9tKFxuICBuZXcgU2V0KFxuICAgIFtcbiAgICAgIHByb2Nlc3MuZW52Lk1BVFJJWF9DT01NSVRfVEFCTEUsXG4gICAgICBwcm9jZXNzLmVudi5NQVRSSVhfVEFCTEUsXG4gICAgICBcIm1hdHJpY2VzLmR5bl92YWx1ZXNcIixcbiAgICAgIFwicHVibGljLmR5bl9tYXRyaXhfdmFsdWVzXCIsXG4gICAgXS5maWx0ZXIoQm9vbGVhbikgYXMgc3RyaW5nW11cbiAgKVxuKTtcblxudHlwZSBSZWxhdGlvbkluZm8gPSB7IHJhdzogc3RyaW5nOyBpZGVudDogc3RyaW5nOyBraW5kOiBzdHJpbmcgfTtcblxuZnVuY3Rpb24gc3BsaXRRdWFsaWZpZWROYW1lKG5hbWU6IHN0cmluZyk6IHsgc2NoZW1hOiBzdHJpbmc7IHJlbGF0aW9uOiBzdHJpbmcgfSB7XG4gIGNvbnN0IHBhcnRzID0gU3RyaW5nKG5hbWUpLnNwbGl0KFwiLlwiKTtcbiAgaWYgKHBhcnRzLmxlbmd0aCA9PT0gMSkgcmV0dXJuIHsgc2NoZW1hOiBcInB1YmxpY1wiLCByZWxhdGlvbjogcGFydHNbMF0hIH07XG4gIGNvbnN0IHJlbGF0aW9uID0gcGFydHMucG9wKCkhO1xuICByZXR1cm4geyBzY2hlbWE6IHBhcnRzLmpvaW4oXCIuXCIpLCByZWxhdGlvbiB9O1xufVxuXG5hc3luYyBmdW5jdGlvbiBlbnN1cmVNYXRyaXhUYWJsZXMoY2xpZW50OiBQb29sQ2xpZW50KSB7XG4gIGF3YWl0IGNsaWVudC5xdWVyeShgQ1JFQVRFIFNDSEVNQSBJRiBOT1QgRVhJU1RTIG1hdHJpY2VzYCk7XG4gIGF3YWl0IGNsaWVudC5xdWVyeShgXG4gICAgRE8gJCRcbiAgICBCRUdJTlxuICAgICAgSUYgRVhJU1RTIChcbiAgICAgICAgU0VMRUNUIDFcbiAgICAgICAgRlJPTSBwZ19jbGFzcyBjXG4gICAgICAgIEpPSU4gcGdfbmFtZXNwYWNlIG4gT04gbi5vaWQgPSBjLnJlbG5hbWVzcGFjZVxuICAgICAgICBXSEVSRSBuLm5zcG5hbWUgPSAnbWF0cmljZXMnXG4gICAgICAgICAgQU5EIGMucmVsbmFtZSA9ICdkeW5fdmFsdWVzJ1xuICAgICAgICAgIEFORCBjLnJlbGtpbmQgSU4gKCd2JywnbScpXG4gICAgICApIFRIRU5cbiAgICAgICAgRVhFQ1VURSAnRFJPUCBWSUVXIElGIEVYSVNUUyBtYXRyaWNlcy5keW5fdmFsdWVzIENBU0NBREUnO1xuICAgICAgRU5EIElGO1xuICAgICAgSUYgRVhJU1RTIChcbiAgICAgICAgU0VMRUNUIDFcbiAgICAgICAgRlJPTSBwZ19jbGFzcyBjXG4gICAgICAgIEpPSU4gcGdfbmFtZXNwYWNlIG4gT04gbi5vaWQgPSBjLnJlbG5hbWVzcGFjZVxuICAgICAgICBXSEVSRSBuLm5zcG5hbWUgPSAnbWF0cmljZXMnXG4gICAgICAgICAgQU5EIGMucmVsbmFtZSA9ICdkeW5fdmFsdWVzX3N0YWdlJ1xuICAgICAgICAgIEFORCBjLnJlbGtpbmQgSU4gKCd2JywnbScpXG4gICAgICApIFRIRU5cbiAgICAgICAgRVhFQ1VURSAnRFJPUCBWSUVXIElGIEVYSVNUUyBtYXRyaWNlcy5keW5fdmFsdWVzX3N0YWdlIENBU0NBREUnO1xuICAgICAgRU5EIElGO1xuICAgIEVORFxuICAgICQkO1xuICBgKTtcbiAgYXdhaXQgY2xpZW50LnF1ZXJ5KGBcbiAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBtYXRyaWNlcy5keW5fdmFsdWVzIChcbiAgICAgIHRzX21zICAgICAgICBiaWdpbnQgICAgICAgICAgIE5PVCBOVUxMLFxuICAgICAgbWF0cml4X3R5cGUgIHRleHQgICAgICAgICAgICAgTk9UIE5VTEwgQ0hFQ0sgKG1hdHJpeF90eXBlIElOICgnYmVuY2htYXJrJywnZGVsdGEnLCdwY3QyNGgnLCdpZF9wY3QnLCdwY3RfZHJ2JywncmVmJywncGN0X3JlZicpKSxcbiAgICAgIGJhc2UgICAgICAgICB0ZXh0ICAgICAgICAgICAgIE5PVCBOVUxMLFxuICAgICAgcXVvdGUgICAgICAgIHRleHQgICAgICAgICAgICAgTk9UIE5VTEwsXG4gICAgICB2YWx1ZSAgICAgICAgZG91YmxlIHByZWNpc2lvbiBOT1QgTlVMTCxcbiAgICAgIG1ldGEgICAgICAgICBqc29uYiAgICAgICAgICAgIE5PVCBOVUxMIERFRkFVTFQgJ3t9Jzo6anNvbmIsXG4gICAgICBjcmVhdGVkX2F0ICAgdGltZXN0YW1wdHogICAgICBOT1QgTlVMTCBERUZBVUxUIG5vdygpLFxuICAgICAgUFJJTUFSWSBLRVkgKHRzX21zLCBtYXRyaXhfdHlwZSwgYmFzZSwgcXVvdGUpXG4gICAgKVxuICBgKTtcbiAgYXdhaXQgY2xpZW50LnF1ZXJ5KGBcbiAgICBDUkVBVEUgSU5ERVggSUYgTk9UIEVYSVNUUyBpZHhfbWF0cmljZXNfZHluX3ZhbHVlc19wYWlyXG4gICAgICBPTiBtYXRyaWNlcy5keW5fdmFsdWVzIChtYXRyaXhfdHlwZSwgYmFzZSwgcXVvdGUsIHRzX21zIERFU0MpXG4gIGApO1xuICBhd2FpdCBjbGllbnQucXVlcnkoYFxuICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIG1hdHJpY2VzLmR5bl92YWx1ZXNfc3RhZ2UgKFxuICAgICAgdHNfbXMgICAgICAgICBiaWdpbnQgICAgICAgICAgIE5PVCBOVUxMLFxuICAgICAgbWF0cml4X3R5cGUgICB0ZXh0ICAgICAgICAgICAgIE5PVCBOVUxMLFxuICAgICAgYmFzZSAgICAgICAgICB0ZXh0ICAgICAgICAgICAgIE5PVCBOVUxMLFxuICAgICAgcXVvdGUgICAgICAgICB0ZXh0ICAgICAgICAgICAgIE5PVCBOVUxMLFxuICAgICAgdmFsdWUgICAgICAgICBkb3VibGUgcHJlY2lzaW9uIE5PVCBOVUxMLFxuICAgICAgbWV0YSAgICAgICAgICBqc29uYiAgICAgICAgICAgIE5PVCBOVUxMIERFRkFVTFQgJ3t9Jzo6anNvbmIsXG4gICAgICBhcHBfc2Vzc2lvbl9pZCB0ZXh0LFxuICAgICAgY3JlYXRlZF9hdCAgICB0aW1lc3RhbXB0eiAgICAgIE5PVCBOVUxMIERFRkFVTFQgbm93KCksXG4gICAgICBQUklNQVJZIEtFWSAodHNfbXMsIG1hdHJpeF90eXBlLCBiYXNlLCBxdW90ZSlcbiAgICApXG4gIGApO1xufVxuXG5hc3luYyBmdW5jdGlvbiBmaW5kRXhpc3RpbmdUYWJsZShcbiAgY2xpZW50OiBQb29sQ2xpZW50LFxuICBjYW5kaWRhdGVzOiBzdHJpbmdbXVxuKTogUHJvbWlzZTxSZWxhdGlvbkluZm8gfCBudWxsPiB7XG4gIGZvciAoY29uc3QgcmF3IG9mIGNhbmRpZGF0ZXMpIHtcbiAgICBjb25zdCB7IHNjaGVtYSwgcmVsYXRpb24gfSA9IHNwbGl0UXVhbGlmaWVkTmFtZShyYXcpO1xuICAgIGNvbnN0IHsgcm93cyB9ID0gYXdhaXQgY2xpZW50LnF1ZXJ5PHsga2luZD86IHN0cmluZyB9PihcbiAgICAgIGBcbiAgICAgICAgU0VMRUNUIGMucmVsa2luZCBBUyBraW5kXG4gICAgICAgICAgRlJPTSBwZ19jbGFzcyBjXG4gICAgICAgICAgSk9JTiBwZ19uYW1lc3BhY2UgbiBPTiBuLm9pZCA9IGMucmVsbmFtZXNwYWNlXG4gICAgICAgICBXSEVSRSBuLm5zcG5hbWUgPSAkMSBBTkQgYy5yZWxuYW1lID0gJDJcbiAgICAgIGAsXG4gICAgICBbc2NoZW1hLCByZWxhdGlvbl1cbiAgICApO1xuICAgIGNvbnN0IGtpbmQgPSByb3dzWzBdPy5raW5kO1xuICAgIGlmIChraW5kICYmIChraW5kID09PSBcInJcIiB8fCBraW5kID09PSBcInBcIikpIHtcbiAgICAgIHJldHVybiB7IHJhdywgaWRlbnQ6IGFzSWRlbnQocmF3KSwga2luZCB9O1xuICAgIH1cbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxubGV0IGNhY2hlZFN0YWdlSW5mbzogUmVsYXRpb25JbmZvIHwgbnVsbCA9IG51bGw7XG5sZXQgY2FjaGVkTWF0cml4SW5mbzogUmVsYXRpb25JbmZvIHwgbnVsbCA9IG51bGw7XG5cbmFzeW5jIGZ1bmN0aW9uIGVuc3VyZVN0YWdlSW5mbyhjbGllbnQ6IFBvb2xDbGllbnQpOiBQcm9taXNlPFJlbGF0aW9uSW5mbz4ge1xuICBpZiAoY2FjaGVkU3RhZ2VJbmZvKSByZXR1cm4gY2FjaGVkU3RhZ2VJbmZvO1xuICBsZXQgaW5mbyA9XG4gICAgKGF3YWl0IGZpbmRFeGlzdGluZ1RhYmxlKGNsaWVudCwgW1JBV19TVEFHRV9UQUJMRSwgLi4uU1RBR0VfVEFCTEVfQ0FORElEQVRFU10pKSA/P1xuICAgIChhd2FpdCBmaW5kRXhpc3RpbmdUYWJsZShjbGllbnQsIFNUQUdFX1RBQkxFX0NBTkRJREFURVMpKTtcbiAgaWYgKCFpbmZvKSB7XG4gICAgYXdhaXQgZW5zdXJlTWF0cml4VGFibGVzKGNsaWVudCk7XG4gICAgaW5mbyA9XG4gICAgICAoYXdhaXQgZmluZEV4aXN0aW5nVGFibGUoY2xpZW50LCBbUkFXX1NUQUdFX1RBQkxFLCAuLi5TVEFHRV9UQUJMRV9DQU5ESURBVEVTXSkpID8/XG4gICAgICAoYXdhaXQgZmluZEV4aXN0aW5nVGFibGUoY2xpZW50LCBTVEFHRV9UQUJMRV9DQU5ESURBVEVTKSk7XG4gICAgaWYgKCFpbmZvKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIGBNYXRyaXggc3RhZ2UgdGFibGUgbm90IGZvdW5kLiBDaGVja2VkOiAke1tcbiAgICAgICAgICBSQVdfU1RBR0VfVEFCTEUsXG4gICAgICAgICAgLi4uU1RBR0VfVEFCTEVfQ0FORElEQVRFUyxcbiAgICAgICAgXVxuICAgICAgICAgIC5maWx0ZXIoQm9vbGVhbilcbiAgICAgICAgICAuam9pbihcIiwgXCIpfWBcbiAgICAgICk7XG4gICAgfVxuICB9XG4gIGNhY2hlZFN0YWdlSW5mbyA9IGluZm87XG4gIHJldHVybiBpbmZvO1xufVxuXG5hc3luYyBmdW5jdGlvbiBlbnN1cmVNYXRyaXhJbmZvKGNsaWVudDogUG9vbENsaWVudCk6IFByb21pc2U8UmVsYXRpb25JbmZvPiB7XG4gIGlmIChjYWNoZWRNYXRyaXhJbmZvKSByZXR1cm4gY2FjaGVkTWF0cml4SW5mbztcbiAgbGV0IGluZm8gPVxuICAgIChhd2FpdCBmaW5kRXhpc3RpbmdUYWJsZShjbGllbnQsIFtSQVdfQ09NTUlUX1RBQkxFLCAuLi5NQVRSSVhfVEFCTEVfQ0FORElEQVRFU10pKSA/P1xuICAgIChhd2FpdCBmaW5kRXhpc3RpbmdUYWJsZShjbGllbnQsIE1BVFJJWF9UQUJMRV9DQU5ESURBVEVTKSk7XG4gIGlmICghaW5mbykge1xuICAgIGF3YWl0IGVuc3VyZU1hdHJpeFRhYmxlcyhjbGllbnQpO1xuICAgIGluZm8gPVxuICAgICAgKGF3YWl0IGZpbmRFeGlzdGluZ1RhYmxlKGNsaWVudCwgW1JBV19DT01NSVRfVEFCTEUsIC4uLk1BVFJJWF9UQUJMRV9DQU5ESURBVEVTXSkpID8/XG4gICAgICAoYXdhaXQgZmluZEV4aXN0aW5nVGFibGUoY2xpZW50LCBNQVRSSVhfVEFCTEVfQ0FORElEQVRFUykpO1xuICAgIGlmICghaW5mbykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBgTWF0cml4IHZhbHVlcyB0YWJsZSBub3QgZm91bmQuIENoZWNrZWQ6ICR7W1xuICAgICAgICAgIFJBV19DT01NSVRfVEFCTEUsXG4gICAgICAgICAgLi4uTUFUUklYX1RBQkxFX0NBTkRJREFURVMsXG4gICAgICAgIF1cbiAgICAgICAgICAuZmlsdGVyKEJvb2xlYW4pXG4gICAgICAgICAgLmpvaW4oXCIsIFwiKX1gXG4gICAgICApO1xuICAgIH1cbiAgfVxuICBpZiAoIWluZm8pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICBgTWF0cml4IHZhbHVlcyB0YWJsZSBub3QgZm91bmQuIENoZWNrZWQ6ICR7W1xuICAgICAgICBSQVdfQ09NTUlUX1RBQkxFLFxuICAgICAgICAuLi5NQVRSSVhfVEFCTEVfQ0FORElEQVRFUyxcbiAgICAgIF1cbiAgICAgICAgLmZpbHRlcihCb29sZWFuKVxuICAgICAgICAuam9pbihcIiwgXCIpfWBcbiAgICApO1xuICB9XG4gIGNhY2hlZE1hdHJpeEluZm8gPSBpbmZvO1xuICByZXR1cm4gaW5mbztcbn1cblxuZnVuY3Rpb24gZGVkdXBlVXBwZXIoeHM6IHJlYWRvbmx5IHN0cmluZ1tdIHwgdW5kZWZpbmVkIHwgbnVsbCk6IHN0cmluZ1tdIHtcbiAgaWYgKCF4cz8ubGVuZ3RoKSByZXR1cm4gW107XG4gIGNvbnN0IG91dDogc3RyaW5nW10gPSBbXTtcbiAgY29uc3Qgc2VlbiA9IG5ldyBTZXQ8c3RyaW5nPigpO1xuICBmb3IgKGNvbnN0IHggb2YgeHMpIHtcbiAgICBjb25zdCB1cCA9IFN0cmluZyh4ID8/IFwiXCIpLnRyaW0oKS50b1VwcGVyQ2FzZSgpO1xuICAgIGlmICghdXAgfHwgc2Vlbi5oYXModXApKSBjb250aW51ZTtcbiAgICBzZWVuLmFkZCh1cCk7XG4gICAgb3V0LnB1c2godXApO1xuICB9XG4gIHJldHVybiBvdXQ7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRNYXRyaXhTdGFnZVRhYmxlSWRlbnQoXG4gIGNsaWVudD86IFBvb2xDbGllbnRcbik6IFByb21pc2U8c3RyaW5nPiB7XG4gIGlmIChjYWNoZWRTdGFnZUluZm8pIHJldHVybiBjYWNoZWRTdGFnZUluZm8uaWRlbnQ7XG4gIGNvbnN0IHVzZUNsaWVudCA9IGNsaWVudCA/PyAoYXdhaXQgZGIuY29ubmVjdCgpKTtcbiAgY29uc3QgcmVsZWFzZSA9ICFjbGllbnQ7XG4gIHRyeSB7XG4gICAgY29uc3QgaW5mbyA9IGF3YWl0IGVuc3VyZVN0YWdlSW5mbyh1c2VDbGllbnQpO1xuICAgIHJldHVybiBpbmZvLmlkZW50O1xuICB9IGZpbmFsbHkge1xuICAgIGlmIChyZWxlYXNlKSB1c2VDbGllbnQucmVsZWFzZSgpO1xuICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGdldE1hdHJpeFZhbHVlc1RhYmxlSWRlbnQoXG4gIGNsaWVudDogUG9vbENsaWVudFxuKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgY29uc3QgaW5mbyA9IGF3YWl0IGVuc3VyZU1hdHJpeEluZm8oY2xpZW50KTtcbiAgcmV0dXJuIGluZm8uaWRlbnQ7XG59XG5cclxuLyoqIE1hdHJpeCB0eXBlIHVuaW9uIChhbGlnbnMgd2l0aCBEREwpICovXHJcbmV4cG9ydCB0eXBlIE1hdHJpeFR5cGUgPSBcImJlbmNobWFya1wiIHwgXCJkZWx0YVwiIHwgXCJwY3QyNGhcIiB8IFwiaWRfcGN0XCIgfCBcInBjdF9kcnZcIiB8IFwicmVmXCIgfCBcInBjdF9yZWZcIjtcclxuXHJcbi8qKiBCdWxrIHVwc2VydCBkaXJlY3RseSBpbnRvIG1haW4gdGFibGUgKGJ5cGFzc2VzIHN0YWdlL2NvbW1pdCkgKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwc2VydE1hdHJpeFJvd3Mocm93czoge1xyXG4gIHRzX21zOiBudW1iZXI7XHJcbiAgbWF0cml4X3R5cGU6IE1hdHJpeFR5cGU7XHJcbiAgYmFzZTogc3RyaW5nOyBxdW90ZTogc3RyaW5nOyB2YWx1ZTogbnVtYmVyO1xyXG4gIG1ldGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xyXG59W10pIHtcclxuICBpZiAoIXJvd3MubGVuZ3RoKSByZXR1cm47XHJcbiAgY29uc3QgY2xpZW50ID0gYXdhaXQgZGIuY29ubmVjdCgpO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB2YWx1ZXM6IGFueVtdID0gW107XHJcbiAgICBjb25zdCBjaHVua3MgPSByb3dzLm1hcCgociwgaSkgPT4ge1xyXG4gICAgICBjb25zdCBqID0gaSAqIDY7XHJcbiAgICAgIHZhbHVlcy5wdXNoKHIudHNfbXMsIHIubWF0cml4X3R5cGUsIHIuYmFzZSwgci5xdW90ZSwgci52YWx1ZSwgSlNPTi5zdHJpbmdpZnkoci5tZXRhID8/IHt9KSk7XHJcbiAgICAgIHJldHVybiBgKCQke2orMX0sICQke2orMn0sICQke2orM30sICQke2orNH0sICQke2orNX0sICQke2orNn0pYDtcclxuICAgIH0pLmpvaW4oXCIsXCIpO1xyXG5cclxuICAgIGNvbnN0IHNxbCA9IGBcclxuICAgICAgSU5TRVJUIElOVE8gJHtUQUJMRX0gKHRzX21zLCBtYXRyaXhfdHlwZSwgYmFzZSwgcXVvdGUsIHZhbHVlLCBtZXRhKVxyXG4gICAgICBWQUxVRVMgJHtjaHVua3N9XHJcbiAgICAgIE9OIENPTkZMSUNUICh0c19tcywgbWF0cml4X3R5cGUsIGJhc2UsIHF1b3RlKVxyXG4gICAgICBETyBVUERBVEUgU0VUIHZhbHVlID0gRVhDTFVERUQudmFsdWUsIG1ldGEgPSBFWENMVURFRC5tZXRhO1xyXG4gICAgYDtcclxuICAgIGF3YWl0IGNsaWVudC5xdWVyeShzcWwsIHZhbHVlcyk7XHJcbiAgfSBmaW5hbGx5IHtcclxuICAgIGNsaWVudC5yZWxlYXNlKCk7XHJcbiAgfVxyXG59XHJcblxyXG4vKiogU25hcHNob3RzICYgbG9va3VwcyAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0TGF0ZXN0QnlUeXBlKG1hdHJpeF90eXBlOiBzdHJpbmcsIGNvaW5zOiBzdHJpbmdbXSkge1xyXG4gIGNvbnN0IGNsaWVudCA9IGF3YWl0IGRiLmNvbm5lY3QoKTtcclxuICB0cnkge1xyXG4gICAgY29uc3QgeyByb3dzIH0gPSBhd2FpdCBjbGllbnQucXVlcnkoXHJcbiAgICAgIGBTRUxFQ1QgdHNfbXMgRlJPTSAke1RBQkxFfSBXSEVSRSBtYXRyaXhfdHlwZT0kMSBPUkRFUiBCWSB0c19tcyBERVNDIExJTUlUIDFgLFxyXG4gICAgICBbbWF0cml4X3R5cGVdXHJcbiAgICApO1xyXG4gICAgaWYgKCFyb3dzLmxlbmd0aCkgcmV0dXJuIHsgdHNfbXM6IG51bGwsIHZhbHVlczogW10gYXMgYW55W10gfTtcclxuICAgIGNvbnN0IHRzX21zID0gTnVtYmVyKHJvd3NbMF0udHNfbXMpO1xyXG4gICAgY29uc3QgeyByb3dzOiB2YWxzIH0gPSBhd2FpdCBjbGllbnQucXVlcnkoXHJcbiAgICAgIGBTRUxFQ1QgYmFzZSwgcXVvdGUsIHZhbHVlIEZST00gJHtUQUJMRX1cclxuICAgICAgIFdIRVJFIG1hdHJpeF90eXBlPSQxIEFORCB0c19tcz0kMiBBTkQgYmFzZSA9IEFOWSgkMykgQU5EIHF1b3RlID0gQU5ZKCQzKWAsXHJcbiAgICAgIFttYXRyaXhfdHlwZSwgdHNfbXMsIGNvaW5zXVxyXG4gICAgKTtcclxuICAgIHJldHVybiB7IHRzX21zLCB2YWx1ZXM6IHZhbHMgfTtcclxuICB9IGZpbmFsbHkgeyBjbGllbnQucmVsZWFzZSgpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcmV2VmFsdWUobWF0cml4X3R5cGU6IHN0cmluZywgYmFzZTogc3RyaW5nLCBxdW90ZTogc3RyaW5nLCBiZWZvcmVUczogbnVtYmVyKSB7XHJcbiAgY29uc3QgeyByb3dzIH0gPSBhd2FpdCBkYi5xdWVyeShcclxuICAgIGBTRUxFQ1QgdmFsdWUgRlJPTSAke1RBQkxFfVxyXG4gICAgIFdIRVJFIG1hdHJpeF90eXBlPSQxIEFORCBiYXNlPSQyIEFORCBxdW90ZT0kMyBBTkQgdHNfbXMgPCAkNFxyXG4gICAgIE9SREVSIEJZIHRzX21zIERFU0MgTElNSVQgMWAsXHJcbiAgICBbbWF0cml4X3R5cGUsIGJhc2UsIHF1b3RlLCBiZWZvcmVUc11cclxuICApO1xyXG4gIHJldHVybiByb3dzLmxlbmd0aCA/IE51bWJlcihyb3dzWzBdLnZhbHVlKSA6IG51bGw7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRMYXRlc3RUc0ZvclR5cGUobWF0cml4X3R5cGU6IHN0cmluZykge1xyXG4gIGNvbnN0IHsgcm93cyB9ID0gYXdhaXQgZGIucXVlcnkoXHJcbiAgICBgU0VMRUNUIE1BWCh0c19tcykgQVMgdHNfbXMgRlJPTSAke1RBQkxFfSBXSEVSRSBtYXRyaXhfdHlwZT0kMWAsXHJcbiAgICBbbWF0cml4X3R5cGVdXHJcbiAgKTtcclxuICBjb25zdCB2ID0gcm93c1swXT8udHNfbXM7XHJcbiAgcmV0dXJuIHYgPT0gbnVsbCA/IG51bGwgOiBOdW1iZXIodik7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXROZWFyZXN0VHNBdE9yQmVmb3JlKG1hdHJpeF90eXBlOiBzdHJpbmcsIHRzX21zOiBudW1iZXIpIHtcclxuICBjb25zdCB7IHJvd3MgfSA9IGF3YWl0IGRiLnF1ZXJ5KFxyXG4gICAgYFNFTEVDVCB0c19tcyBGUk9NICR7VEFCTEV9XHJcbiAgICAgV0hFUkUgbWF0cml4X3R5cGU9JDEgQU5EIHRzX21zIDw9ICQyXHJcbiAgICAgT1JERVIgQlkgdHNfbXMgREVTQyBMSU1JVCAxYCxcclxuICAgIFttYXRyaXhfdHlwZSwgdHNfbXNdXHJcbiAgKTtcclxuICBjb25zdCB2ID0gcm93c1swXT8udHNfbXM7XHJcbiAgcmV0dXJuIHYgPT0gbnVsbCA/IG51bGwgOiBOdW1iZXIodik7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTbmFwc2hvdEJ5VHlwZShtYXRyaXhfdHlwZTogc3RyaW5nLCB0c19tczogbnVtYmVyLCBjb2luczogc3RyaW5nW10pIHtcclxuICBjb25zdCB7IHJvd3MgfSA9IGF3YWl0IGRiLnF1ZXJ5KFxyXG4gICAgYFNFTEVDVCBiYXNlLCBxdW90ZSwgdmFsdWUgRlJPTSAke1RBQkxFfVxyXG4gICAgIFdIRVJFIG1hdHJpeF90eXBlPSQxIEFORCB0c19tcz0kMiBBTkQgYmFzZSA9IEFOWSgkMykgQU5EIHF1b3RlID0gQU5ZKCQzKWAsXHJcbiAgICBbbWF0cml4X3R5cGUsIHRzX21zLCBjb2luc11cclxuICApO1xyXG4gIHJldHVybiByb3dzIGFzIHsgYmFzZTpzdHJpbmc7IHF1b3RlOnN0cmluZzsgdmFsdWU6bnVtYmVyIH1bXTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByZXZTbmFwc2hvdEJ5VHlwZShtYXRyaXhfdHlwZTogc3RyaW5nLCBiZWZvcmVUczogbnVtYmVyLCBjb2luczogc3RyaW5nW10pIHtcclxuICBjb25zdCB7IHJvd3MgfSA9IGF3YWl0IGRiLnF1ZXJ5KFxyXG4gICAgYFNFTEVDVCBESVNUSU5DVCBPTiAoYmFzZSwgcXVvdGUpIGJhc2UsIHF1b3RlLCB2YWx1ZVxyXG4gICAgICAgRlJPTSAke1RBQkxFfVxyXG4gICAgICBXSEVSRSBtYXRyaXhfdHlwZT0kMVxyXG4gICAgICAgIEFORCB0c19tcyA8ICQyXHJcbiAgICAgICAgQU5EIGJhc2UgID0gQU5ZKCQzKVxyXG4gICAgICAgIEFORCBxdW90ZSA9IEFOWSgkMylcclxuICAgT1JERVIgQlkgYmFzZSwgcXVvdGUsIHRzX21zIERFU0NgLFxyXG4gICAgW21hdHJpeF90eXBlLCBiZWZvcmVUcywgY29pbnNdXHJcbiAgKTtcclxuICByZXR1cm4gcm93cyBhcyB7IGJhc2U6IHN0cmluZzsgcXVvdGU6IHN0cmluZzsgdmFsdWU6IG51bWJlciB9W107XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjb3VudFJvd3NBdChtYXRyaXhfdHlwZTogc3RyaW5nLCB0c19tczogbnVtYmVyKSB7XHJcbiAgY29uc3QgeyByb3dzIH0gPSBhd2FpdCBkYi5xdWVyeShcclxuICAgIGBTRUxFQ1QgY291bnQoKik6OmludCBBUyBuIEZST00gJHtUQUJMRX0gV0hFUkUgbWF0cml4X3R5cGU9JDEgQU5EIHRzX21zPSQyYCxcclxuICAgIFttYXRyaXhfdHlwZSwgdHNfbXNdXHJcbiAgKTtcclxuICByZXR1cm4gcm93c1swXT8ubiA/PyAwO1xyXG59XHJcblxyXG5cclxuLy8g4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAIE9wZW5pbmcgaGVscGVycyAoREIgKyBjYWNoZSkg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAXHJcbnR5cGUgT3BlbmluZ0tleSA9IHsgYmFzZTogc3RyaW5nOyBxdW90ZT86IHN0cmluZzsgd2luZG93Pzogc3RyaW5nOyBhcHBTZXNzaW9uSWQ/OiBzdHJpbmcgfTtcclxuY29uc3Qgb3BlbmluZ0NhY2hlID0gbmV3IE1hcDxzdHJpbmcsIHsgcHJpY2U6IG51bWJlcjsgdHM6IG51bWJlciB9PigpO1xyXG5jb25zdCBrZXlTdHIgPSAoazogT3BlbmluZ0tleSkgPT5cclxuICBgJHtrLmJhc2V9OiR7ay5xdW90ZSA/PyBcIlVTRFRcIn06JHtrLndpbmRvdyA/PyBcIjFoXCJ9OiR7ay5hcHBTZXNzaW9uSWQgPz8gXCJnbG9iYWxcIn1gO1xyXG5cclxuLyoqIFJlYWQgbGFzdCBvcGVuaW5nIGZvciBhIChiYXNlLHF1b3RlLHdpbmRvdyxzZXNzaW9uKSBmcm9tIFNUUi1BVVg7IGZhbGxiYWNrIHRvIGNvbXBhdCB2aWV3ICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRPcGVuaW5nRnJvbURiKFxyXG4gIGs6IE9wZW5pbmdLZXlcclxuKTogUHJvbWlzZTx7IHByaWNlOiBudW1iZXI7IHRzOiBudW1iZXIgfSB8IG51bGw+IHtcclxuICAvLyBTb3VyY2Ugb2YgdHJ1dGg6IHN0cmF0ZWd5X2F1eC5zdHJfYXV4X3Nlc3Npb24gd2l0aCBvcGVuaW5nX3N0YW1wID0gVFJVRVxyXG4gIGNvbnN0IHExID0gYFxyXG4gICAgU0VMRUNUIG9wZW5pbmdfdHMgQVMgdHMsIG9wZW5pbmdfcHJpY2UgQVMgcHJpY2VcclxuICAgICAgRlJPTSBzdHJhdGVneV9hdXguc3RyX2F1eF9zZXNzaW9uXHJcbiAgICAgV0hFUkUgcGFpcl9iYXNlPSQxIEFORCBwYWlyX3F1b3RlPSQyIEFORCB3aW5kb3dfa2V5PSQzXHJcbiAgICAgICBBTkQgKCQ0Ojp0ZXh0IElTIE5VTEwgT1IgYXBwX3Nlc3Npb25faWQ9JDQpXHJcbiAgICAgICBBTkQgb3BlbmluZ19zdGFtcCA9IFRSVUVcclxuICBPUkRFUiBCWSBvcGVuaW5nX3RzIERFU0NcclxuICAgICBMSU1JVCAxXHJcbiAgYDtcclxuICBjb25zdCByMSA9IGF3YWl0IGRiLnF1ZXJ5KHExLCBbay5iYXNlLCBrLnF1b3RlID8/IFwiVVNEVFwiLCBrLndpbmRvdyA/PyBcIjFoXCIsIGsuYXBwU2Vzc2lvbklkID8/IG51bGxdKTtcclxuICBpZiAocjEucm93cy5sZW5ndGgpIHtcclxuICAgIHJldHVybiB7IHByaWNlOiBOdW1iZXIocjEucm93c1swXS5wcmljZSksIHRzOiBOdW1iZXIocjEucm93c1swXS50cykgfTtcclxuICB9XHJcblxyXG4gIC8vIENvbXBhdGliaWxpdHkgdmlldyAoa2VwdCBmb3Igb2xkZXIgY29kZSBwYXRocylcclxuICBjb25zdCBxMiA9IGBTRUxFQ1Qgc2Vzc2lvbl90cyBBUyB0cywgb3BlbmluZ19wcmljZSBBUyBwcmljZVxyXG4gICAgICAgICAgICAgICAgRlJPTSBzZXNzaW9uX29wZW5pbmdzXHJcbiAgICAgICAgICAgIE9SREVSIEJZIHNlc3Npb25fdHMgREVTQ1xyXG4gICAgICAgICAgICAgICBMSU1JVCAxYDtcclxuICBjb25zdCByMiA9IGF3YWl0IGRiLnF1ZXJ5KHEyKTtcclxuICBpZiAocjIucm93cy5sZW5ndGgpIHtcclxuICAgIHJldHVybiB7IHByaWNlOiBOdW1iZXIocjIucm93c1swXS5wcmljZSksIHRzOiBOdW1iZXIocjIucm93c1swXS50cykgfTtcclxuICB9XHJcbiAgcmV0dXJuIG51bGw7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBFbnN1cmUgYW4gb3BlbmluZyBleGlzdHMgKyBjYWNoZSBpdCBmb3IgdGhpcyBwcm9jZXNzLlxyXG4gKiBJZiB5b3UgcGFzcyBvcGVuaW5nVHMvb3BlbmluZ1ByaWNlLCB3ZSB0cnkgdG8gdXBzZXJ0IHZpYSB0aGUgU1FMIGZ1bmN0aW9uIGB1cHNlcnRfc3RyX2F1eF9vcGVuaW5nYCAoaWYgcHJlc2VudCkuXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZW5zdXJlT3BlbmluZyhcclxuICBrOiBPcGVuaW5nS2V5LFxyXG4gIG9wdHM6IHsgb3BlbmluZ1RzPzogbnVtYmVyOyBvcGVuaW5nUHJpY2U/OiBudW1iZXI7IGV0YVBjdD86IG51bWJlcjsgZXBzU2hpZnRQY3Q/OiBudW1iZXI7IEs/OiBudW1iZXIgfSA9IHt9XHJcbikge1xyXG4gIGNvbnN0IGNrID0ga2V5U3RyKGspO1xyXG4gIGNvbnN0IGhpdCA9IG9wZW5pbmdDYWNoZS5nZXQoY2spO1xyXG4gIGlmIChoaXQpIHJldHVybiBoaXQ7XHJcblxyXG4gIC8vIElmIGdpdmVuIGV4cGxpY2l0IG9wZW5pbmcsIHRyeSB0byBwZXJzaXN0IChuby1vcCBpZiB0aGUgZnVuY3Rpb24gZG9lc24ndCBleGlzdCkuXHJcbiAgaWYgKG9wdHMub3BlbmluZ1ByaWNlICE9IG51bGwgJiYgb3B0cy5vcGVuaW5nVHMgIT0gbnVsbCkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgYXdhaXQgZGIucXVlcnkoXHJcbiAgICAgICAgYFNFTEVDVCB1cHNlcnRfc3RyX2F1eF9vcGVuaW5nKCQxLCQyLCQzLCQ0LCQ1LCQ2LCQ3KWAsXHJcbiAgICAgICAgW1xyXG4gICAgICAgICAgay5iYXNlLCBrLnF1b3RlID8/IFwiVVNEVFwiLCBrLndpbmRvdyA/PyBcIjFoXCIsIGsuYXBwU2Vzc2lvbklkID8/IFwiZ2xvYmFsXCIsXHJcbiAgICAgICAgICBvcHRzLm9wZW5pbmdUcywgb3B0cy5vcGVuaW5nUHJpY2UsXHJcbiAgICAgICAgICBgaWRlbToke2suYmFzZX06JHtrLnF1b3RlID8/IFwiVVNEVFwifToke2sud2luZG93ID8/IFwiMWhcIn06JHtrLmFwcFNlc3Npb25JZCA/PyBcImdsb2JhbFwifToke29wdHMub3BlbmluZ1RzfWBcclxuICAgICAgICBdXHJcbiAgICAgICk7XHJcbiAgICB9IGNhdGNoIHsgLyogZnVuY3Rpb24gbWF5IG5vdCBleGlzdCB5ZXQ7IGl0J3MgZmluZSAqLyB9XHJcbiAgfVxyXG5cclxuICBjb25zdCByb3cgPSBhd2FpdCBnZXRPcGVuaW5nRnJvbURiKGspO1xyXG4gIGlmIChyb3cpIHtcclxuICAgIG9wZW5pbmdDYWNoZS5zZXQoY2ssIHJvdyk7XHJcbiAgICByZXR1cm4gcm93O1xyXG4gIH1cclxuICByZXR1cm4gbnVsbDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyT3BlbmluZ0NhY2hlKGs/OiBPcGVuaW5nS2V5KSB7XHJcbiAgaWYgKCFrKSByZXR1cm4gb3BlbmluZ0NhY2hlLmNsZWFyKCk7XHJcbiAgb3BlbmluZ0NhY2hlLmRlbGV0ZShrZXlTdHIoaykpO1xyXG59XHJcblxyXG5cclxuLy8g4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAIE1hdHJpY2VzIFNUQUdFL0NPTU1JVCBoZWxwZXJzIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgFxyXG4vKiogR3JpZCBvYmplY3Qgc2hhcGUgdXNlZCBhY3Jvc3MgZmVhdHVyZXMgKEJBU0UgLT4gUVVPVEUgLT4gdmFsdWV8bnVsbCkgKi9cclxuZXhwb3J0IHR5cGUgTWF0cml4R3JpZE9iamVjdCA9IFJlY29yZDxzdHJpbmcsIFJlY29yZDxzdHJpbmcsIG51bWJlciB8IG51bGw+PjtcclxuXHJcbi8qKiBJbnRlcm5hbDogaXRlcmF0ZSBvZmYtZGlhZ29uYWwgY2VsbHMgdGhhdCBoYXZlIGZpbml0ZSBudW1iZXJzICovXHJcbmZ1bmN0aW9uKiBjZWxsc09mKGNvaW5zOiBzdHJpbmdbXSwgdmFsdWVzOiBNYXRyaXhHcmlkT2JqZWN0KSB7XHJcbiAgZm9yIChjb25zdCBiIG9mIGNvaW5zKSB7XHJcbiAgICBmb3IgKGNvbnN0IHEgb2YgY29pbnMpIHtcclxuICAgICAgaWYgKGIgPT09IHEpIGNvbnRpbnVlO1xyXG4gICAgICBjb25zdCB2ID0gdmFsdWVzPy5bYl0/LltxXTtcclxuICAgICAgaWYgKHYgPT0gbnVsbCB8fCBOdW1iZXIuaXNOYU4oTnVtYmVyKHYpKSkgY29udGludWU7XHJcbiAgICAgIHlpZWxkIHsgYmFzZTogYiwgcXVvdGU6IHEsIHZhbHVlOiBOdW1iZXIodikgfTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbi8qKiBTdGFnZSBhbGwgY2VsbHMgZm9yIGEgKG1hdHJpeF90eXBlLCB0c19tcykuIE92ZXJ3cml0ZXMgb24gY29uZmxpY3QgaW4gU1RBR0UuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzdGFnZU1hdHJpeEdyaWQob3B0czoge1xuICBhcHBTZXNzaW9uSWQ6IHN0cmluZztcbiAgbWF0cml4VHlwZTogTWF0cml4VHlwZTtcbiAgdHNNczogbnVtYmVyO1xuICBjb2luczogc3RyaW5nW107XG4gIHZhbHVlczogTWF0cml4R3JpZE9iamVjdDtcbiAgbWV0YT86IGFueTtcbiAgY2xpZW50PzogUG9vbENsaWVudDtcbn0pIHtcbiAgY29uc3QgeyBhcHBTZXNzaW9uSWQsIG1hdHJpeFR5cGUsIHRzTXMsIGNvaW5zLCB2YWx1ZXMsIG1ldGEsIGNsaWVudDogZXh0ZXJuYWwgfSA9XG4gICAgb3B0cztcbiAgY29uc3QgY2xpZW50ID0gZXh0ZXJuYWwgPz8gKGF3YWl0IGRiLmNvbm5lY3QoKSk7XG4gIGNvbnN0IHJlbGVhc2UgPSAhZXh0ZXJuYWw7XG4gIHRyeSB7XG4gICAgY29uc3Qgcm93cyA9IEFycmF5LmZyb20oY2VsbHNPZihjb2lucywgdmFsdWVzKSk7XG4gICAgaWYgKCFyb3dzLmxlbmd0aCkgcmV0dXJuIHsgb2s6IHRydWUsIHN0YWdlZDogMCB9O1xuXG4gICAgY29uc3QgbWV0YUpzb24gPSBKU09OLnN0cmluZ2lmeShtZXRhID8/IHt9KTtcbiAgICBjb25zdCBzdGFnZUluZm8gPSBhd2FpdCBlbnN1cmVTdGFnZUluZm8oY2xpZW50KTtcbiAgICBjb25zdCB0ZXh0ID0gYFxuICAgICAgSU5TRVJUIElOVE8gJHtzdGFnZUluZm8uaWRlbnR9XG4gICAgICAgICh0c19tcywgbWF0cml4X3R5cGUsIGJhc2UsIHF1b3RlLCB2YWx1ZSwgbWV0YSwgYXBwX3Nlc3Npb25faWQpXG4gICAgICBWQUxVRVMgJHtyb3dzXG4gICAgICAgIC5tYXAoXG4gICAgICAgICAgKF8sIGkpID0+XG4gICAgICAgICAgICBgKCQxLCQyLCQke2kgKiAzICsgM30sJCR7aSAqIDMgKyA0fSwkJHtpICogMyArIDV9LCQke1xuICAgICAgICAgICAgICByb3dzLmxlbmd0aCAqIDMgKyAzXG4gICAgICAgICAgICB9LCQke3Jvd3MubGVuZ3RoICogMyArIDR9KWBcbiAgICAgICAgKVxuICAgICAgICAuam9pbihcIixcIil9XG4gICAgICBPTiBDT05GTElDVCAodHNfbXMsIG1hdHJpeF90eXBlLCBiYXNlLCBxdW90ZSlcbiAgICAgIERPIFVQREFURSBTRVQgdmFsdWUgPSBFWENMVURFRC52YWx1ZSwgbWV0YSA9IEVYQ0xVREVELm1ldGEsIGFwcF9zZXNzaW9uX2lkID0gRVhDTFVERUQuYXBwX3Nlc3Npb25faWRcbiAgICBgO1xuICAgIGNvbnN0IHBhcmFtczogYW55W10gPSBbdHNNcywgbWF0cml4VHlwZV07XG4gICAgZm9yIChjb25zdCByIG9mIHJvd3MpIHBhcmFtcy5wdXNoKHIuYmFzZSwgci5xdW90ZSwgci52YWx1ZSk7XG4gICAgcGFyYW1zLnB1c2gobWV0YUpzb24sIGFwcFNlc3Npb25JZCk7XG4gICAgYXdhaXQgY2xpZW50LnF1ZXJ5KHRleHQsIHBhcmFtcyk7XG4gICAgcmV0dXJuIHsgb2s6IHRydWUsIHN0YWdlZDogcm93cy5sZW5ndGggfTtcbiAgfSBmaW5hbGx5IHtcbiAgICBpZiAocmVsZWFzZSkgY2xpZW50LnJlbGVhc2UoKTtcbiAgfVxufVxuXG4vKiogUHVibGlzaCBzdGFnZWQgcm93cyBpbnRvIG1haW4gdGFibGUgKyBjeWNsZV9kb2N1bWVudCArIGxlZGdlciAoc2VlIERETCkgKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjb21taXRNYXRyaXhHcmlkKG9wdHM6IHtcbiAgYXBwU2Vzc2lvbklkOiBzdHJpbmc7XG4gIG1hdHJpeFR5cGU6IE1hdHJpeFR5cGU7XG4gIHRzTXM6IG51bWJlcjtcbiAgY29pbnM/OiBzdHJpbmdbXTtcbiAgaWRlbT86IHN0cmluZyB8IG51bGw7XG4gIGNsaWVudD86IFBvb2xDbGllbnQ7XG59KSB7XG4gIGNvbnN0IHsgbWF0cml4VHlwZSwgdHNNcywgY29pbnMsIGNsaWVudDogZXh0ZXJuYWwgfSA9IG9wdHM7XG4gIGNvbnN0IGNsaWVudCA9IGV4dGVybmFsID8/IChhd2FpdCBkYi5jb25uZWN0KCkpO1xuICBjb25zdCByZWxlYXNlID0gIWV4dGVybmFsO1xuICBjb25zdCBtYW5hZ2VUeCA9ICFleHRlcm5hbDtcbiAgdHJ5IHtcbiAgICBpZiAobWFuYWdlVHgpIGF3YWl0IGNsaWVudC5xdWVyeShcIkJFR0lOXCIpO1xuXG4gICAgY29uc3Qgc3RhZ2VJbmZvID0gYXdhaXQgZW5zdXJlU3RhZ2VJbmZvKGNsaWVudCk7XG4gICAgY29uc3QgbWF0cml4VGFibGUgPSBhd2FpdCBnZXRNYXRyaXhWYWx1ZXNUYWJsZUlkZW50KGNsaWVudCk7XG5cbiAgICBjb25zdCBzdGFnZVJvd3MgPSBhd2FpdCBjbGllbnQucXVlcnk8eyBiYXNlOiBzdHJpbmc7IHF1b3RlOiBzdHJpbmcgfT4oXG4gICAgICBgU0VMRUNUIGJhc2UsIHF1b3RlXG4gICAgICAgICBGUk9NICR7c3RhZ2VJbmZvLmlkZW50fVxuICAgICAgICBXSEVSRSB0c19tcyA9ICQxIEFORCBtYXRyaXhfdHlwZSA9ICQyYCxcbiAgICAgIFt0c01zLCBtYXRyaXhUeXBlXVxuICAgICk7XG5cbiAgICBjb25zdCBzdGFnZWRDZWxscyA9IHN0YWdlUm93cy5yb3dDb3VudCA/PyBzdGFnZVJvd3Mucm93cy5sZW5ndGg7XG5cbiAgICBjb25zdCBjb2luc0Zyb21TdGFnZSA9IG5ldyBTZXQ8c3RyaW5nPigpO1xuICAgIGZvciAoY29uc3Qgcm93IG9mIHN0YWdlUm93cy5yb3dzKSB7XG4gICAgICBjb25zdCBiYXNlID0gU3RyaW5nKHJvdy5iYXNlID8/IFwiXCIpLnRvVXBwZXJDYXNlKCk7XG4gICAgICBjb25zdCBxdW90ZSA9IFN0cmluZyhyb3cucXVvdGUgPz8gXCJcIikudG9VcHBlckNhc2UoKTtcbiAgICAgIGlmIChiYXNlKSBjb2luc0Zyb21TdGFnZS5hZGQoYmFzZSk7XG4gICAgICBpZiAocXVvdGUpIGNvaW5zRnJvbVN0YWdlLmFkZChxdW90ZSk7XG4gICAgfVxuXG4gICAgY29uc3QgZWxpZ2libGVDb2lucyA9XG4gICAgICBjb2lucz8ubGVuZ3RoICYmIGRlZHVwZVVwcGVyKGNvaW5zKS5sZW5ndGhcbiAgICAgICAgPyBkZWR1cGVVcHBlcihjb2lucylcbiAgICAgICAgOiBBcnJheS5mcm9tKGNvaW5zRnJvbVN0YWdlKTtcblxuICAgIGNvbnN0IGV4cGVjdGVkQ2VsbHMgPVxuICAgICAgZWxpZ2libGVDb2lucy5sZW5ndGggKiBNYXRoLm1heChlbGlnaWJsZUNvaW5zLmxlbmd0aCAtIDEsIDApO1xuXG4gICAgYXdhaXQgY2xpZW50LnF1ZXJ5KFxuICAgICAgYFxuICAgICAgSU5TRVJUIElOVE8gJHttYXRyaXhUYWJsZX1cbiAgICAgICAgKHRzX21zLCBtYXRyaXhfdHlwZSwgYmFzZSwgcXVvdGUsIHZhbHVlLCBtZXRhKVxuICAgICAgU0VMRUNUIHRzX21zLCBtYXRyaXhfdHlwZSwgYmFzZSwgcXVvdGUsIHZhbHVlLCBtZXRhXG4gICAgICAgIEZST00gJHtzdGFnZUluZm8uaWRlbnR9XG4gICAgICAgV0hFUkUgdHNfbXMgPSAkMSBBTkQgbWF0cml4X3R5cGUgPSAkMlxuICAgICAgT04gQ09ORkxJQ1QgKHRzX21zLCBtYXRyaXhfdHlwZSwgYmFzZSwgcXVvdGUpXG4gICAgICBETyBVUERBVEUgU0VUIHZhbHVlID0gRVhDTFVERUQudmFsdWUsIG1ldGEgPSBFWENMVURFRC5tZXRhXG4gICAgYCxcbiAgICAgIFt0c01zLCBtYXRyaXhUeXBlXVxuICAgICk7XG5cbiAgICBjb25zdCBzdGFnZWRQYWlycyA9IG5ldyBTZXQoXG4gICAgICBzdGFnZVJvd3Mucm93c1xuICAgICAgICAubWFwKChyb3cpID0+IHtcbiAgICAgICAgICBjb25zdCBiYXNlID0gU3RyaW5nKHJvdy5iYXNlID8/IFwiXCIpLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgICAgY29uc3QgcXVvdGUgPSBTdHJpbmcocm93LnF1b3RlID8/IFwiXCIpLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgICAgaWYgKCFiYXNlIHx8ICFxdW90ZSB8fCBiYXNlID09PSBxdW90ZSkgcmV0dXJuIG51bGw7XG4gICAgICAgICAgcmV0dXJuIGAke2Jhc2V94oaSJHtxdW90ZX1gO1xuICAgICAgICB9KVxuICAgICAgICAuZmlsdGVyKEJvb2xlYW4pIGFzIHN0cmluZ1tdXG4gICAgKTtcblxuICAgIGxldCBtaXNzaW5nQ291bnQgPSAwO1xuICAgIGZvciAoY29uc3QgYmFzZSBvZiBlbGlnaWJsZUNvaW5zKSB7XG4gICAgICBmb3IgKGNvbnN0IHF1b3RlIG9mIGVsaWdpYmxlQ29pbnMpIHtcbiAgICAgICAgaWYgKGJhc2UgPT09IHF1b3RlKSBjb250aW51ZTtcbiAgICAgICAgaWYgKCFzdGFnZWRQYWlycy5oYXMoYCR7YmFzZX3ihpIke3F1b3RlfWApKSBtaXNzaW5nQ291bnQgKz0gMTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAobWFuYWdlVHgpIGF3YWl0IGNsaWVudC5xdWVyeShcIkNPTU1JVFwiKTtcblxuICAgIHJldHVybiB7XG4gICAgICBvazogdHJ1ZSxcbiAgICAgIG1hdHJpeF90eXBlOiBtYXRyaXhUeXBlLFxuICAgICAgdHNfbXM6IHRzTXMsXG4gICAgICBleHBlY3RlZF9jZWxsczogZXhwZWN0ZWRDZWxscyxcbiAgICAgIHN0YWdlZF9jZWxsczogc3RhZ2VkQ2VsbHMsXG4gICAgICBtaXNzaW5nX2NvdW50OiBtaXNzaW5nQ291bnQsXG4gICAgICBjb21wbGV0ZTogbWlzc2luZ0NvdW50ID09PSAwICYmIHN0YWdlZENlbGxzID09PSBleHBlY3RlZENlbGxzLFxuICAgIH07XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGlmIChtYW5hZ2VUeCkgYXdhaXQgY2xpZW50LnF1ZXJ5KFwiUk9MTEJBQ0tcIik7XG4gICAgdGhyb3cgZXJyO1xuICB9IGZpbmFsbHkge1xuICAgIGlmIChyZWxlYXNlKSBjbGllbnQucmVsZWFzZSgpO1xuICB9XG59XG5cclxuLyoqIENvbnZlbmllbmNlOiByZWFkIHByZXYgYmVuY2htYXJrIGdyaWQgZm9yIGEgY29pbiBzZXQgKHBhaXJlZCBtYXApICovXHJcbmFzeW5jIGZ1bmN0aW9uIG1hcFByZXZCZW5jaG1hcmsoYmVmb3JlVHM6IG51bWJlciwgY29pbnM6IHN0cmluZ1tdKSB7XHJcbiAgY29uc3QgcHJldiA9IGF3YWl0IGdldFByZXZTbmFwc2hvdEJ5VHlwZShcImJlbmNobWFya1wiLCBiZWZvcmVUcywgY29pbnMpO1xyXG4gIGNvbnN0IG0gPSBuZXcgTWFwPHN0cmluZywgbnVtYmVyPigpO1xyXG4gIGZvciAoY29uc3QgciBvZiBwcmV2KSBtLnNldChgJHtyLmJhc2V9LyR7ci5xdW90ZX1gLCBOdW1iZXIoci52YWx1ZSkpO1xyXG4gIHJldHVybiBtO1xyXG59XHJcblxyXG4vKipcclxuICogUGVyc2lzdCB0aGUgY3VycmVudCBsaXZlIHNsaWNlcyBmb3IgdGhlIGFjdGl2ZSBjb2luLXVuaXZlcnNlOlxyXG4gKiAgLSBiZW5jaG1hcmsgKGZ1bGwgTsOXTilcclxuICogIC0gcGN0MjRoICAgKGFzLWlzIGZyb20gbGl2ZSlcclxuICogIC0gaWRfcGN0ICAgKGRlcml2ZWQgdnMgcHJldiBiZW5jaG1hcmsgc28gcGN0X2RydiBoYXMgaGlzdG9yeSBvbiBuZXh0IHRpY2spXHJcbiAqXHJcbiAqIEFsbCB0aHJlZSB1c2UgdGhlIFNBTUUgdHNfbXMgdG8ga2VlcCBzbGljZXMgYWxpZ25lZC5cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwZXJzaXN0TGl2ZU1hdHJpY2VzU2xpY2Uob3B0czoge1xuICBhcHBTZXNzaW9uSWQ6IHN0cmluZztcbiAgY29pbnM6IHN0cmluZ1tdO1xuICB0c01zOiBudW1iZXI7XG4gIGJlbmNobWFyazogTWF0cml4R3JpZE9iamVjdDtcbiAgcGN0MjRoPzogTWF0cml4R3JpZE9iamVjdDtcclxuICBpZGVtUHJlZml4Pzogc3RyaW5nO1xyXG59KSB7XHJcbiAgY29uc3QgeyBhcHBTZXNzaW9uSWQsIGNvaW5zLCB0c01zLCBiZW5jaG1hcmssIHBjdDI0aCwgaWRlbVByZWZpeCB9ID0gb3B0cztcclxuXHJcbiAgLy8gMSkgc3RhZ2UrY29tbWl0IGJlbmNobWFya1xyXG4gIGF3YWl0IHN0YWdlTWF0cml4R3JpZCh7XHJcbiAgICBhcHBTZXNzaW9uSWQsXHJcbiAgICBtYXRyaXhUeXBlOiBcImJlbmNobWFya1wiLFxyXG4gICAgdHNNcyxcclxuICAgIGNvaW5zLFxyXG4gICAgdmFsdWVzOiBiZW5jaG1hcmssXHJcbiAgICBtZXRhOiB7IHNvdXJjZTogXCJsaXZlXCIgfVxyXG4gIH0pO1xyXG4gIGF3YWl0IGNvbW1pdE1hdHJpeEdyaWQoe1xyXG4gICAgYXBwU2Vzc2lvbklkLFxyXG4gICAgbWF0cml4VHlwZTogXCJiZW5jaG1hcmtcIixcclxuICAgIHRzTXMsXHJcbiAgICBjb2lucyxcclxuICAgIGlkZW06IGAke2lkZW1QcmVmaXggPz8gXCJiZW5jaG1hcmtcIn06JHt0c01zfWBcclxuICB9KTtcclxuXHJcbiAgLy8gMikgc3RhZ2UrY29tbWl0IHBjdDI0aCAob3B0aW9uYWwpXHJcbiAgaWYgKHBjdDI0aCkge1xyXG4gICAgYXdhaXQgc3RhZ2VNYXRyaXhHcmlkKHtcclxuICAgICAgYXBwU2Vzc2lvbklkLFxyXG4gICAgICBtYXRyaXhUeXBlOiBcInBjdDI0aFwiLFxyXG4gICAgICB0c01zLFxyXG4gICAgICBjb2lucyxcclxuICAgICAgdmFsdWVzOiBwY3QyNGgsXHJcbiAgICAgIG1ldGE6IHsgc291cmNlOiBcImxpdmVcIiB9XHJcbiAgICB9KTtcclxuICAgIGF3YWl0IGNvbW1pdE1hdHJpeEdyaWQoe1xyXG4gICAgICBhcHBTZXNzaW9uSWQsXHJcbiAgICAgIG1hdHJpeFR5cGU6IFwicGN0MjRoXCIsXHJcbiAgICAgIHRzTXMsXHJcbiAgICAgIGNvaW5zLFxyXG4gICAgICBpZGVtOiBgJHtpZGVtUHJlZml4ID8/IFwicGN0MjRoXCJ9OiR7dHNNc31gXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIDMpIGRlcml2ZSBpZF9wY3QgdnMgcHJldihiZW5jaG1hcmspIGFuZCBwZXJzaXN0XHJcbiAgY29uc3QgcHJldk1hcCA9IGF3YWl0IG1hcFByZXZCZW5jaG1hcmsodHNNcywgY29pbnMpO1xyXG4gIGNvbnN0IGlkT2JqOiBNYXRyaXhHcmlkT2JqZWN0ID0ge307XHJcbiAgZm9yIChjb25zdCBiIG9mIGNvaW5zKSB7XHJcbiAgICBpZE9ialtiXSA9IHt9IGFzIFJlY29yZDxzdHJpbmcsIG51bWJlciB8IG51bGw+O1xyXG4gICAgZm9yIChjb25zdCBxIG9mIGNvaW5zKSB7XHJcbiAgICAgIGlmIChiID09PSBxKSBjb250aW51ZTtcclxuICAgICAgY29uc3Qgbm93ID0gYmVuY2htYXJrPy5bYl0/LltxXTtcclxuICAgICAgY29uc3QgcHJldiA9IHByZXZNYXAuZ2V0KGAke2J9LyR7cX1gKTtcclxuICAgICAgaWYgKG5vdyA9PSBudWxsIHx8IHByZXYgPT0gbnVsbCB8fCBNYXRoLmFicyhwcmV2KSA8IDFlLTMwMCkge1xyXG4gICAgICAgIGlkT2JqW2JdW3FdID0gbnVsbDtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpZE9ialtiXVtxXSA9IChOdW1iZXIobm93KSAtIHByZXYpIC8gcHJldjsgLy8gaWRfcGN0ID0gKGJtX25ldyAtIGJtX3ByZXYpL2JtX3ByZXZcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuICBhd2FpdCBzdGFnZU1hdHJpeEdyaWQoe1xyXG4gICAgYXBwU2Vzc2lvbklkLFxyXG4gICAgbWF0cml4VHlwZTogXCJpZF9wY3RcIixcclxuICAgIHRzTXMsXHJcbiAgICBjb2lucyxcclxuICAgIHZhbHVlczogaWRPYmosXHJcbiAgICBtZXRhOiB7IHNvdXJjZTogXCJkZXJpdmVkQGRiXCIsIGJhc2U6IFwicHJldihiZW5jaG1hcmspXCIgfVxyXG4gIH0pO1xyXG4gIGF3YWl0IGNvbW1pdE1hdHJpeEdyaWQoe1xuICAgIGFwcFNlc3Npb25JZCxcbiAgICBtYXRyaXhUeXBlOiBcImlkX3BjdFwiLFxuICAgIHRzTXMsXG4gICAgY29pbnMsXG4gICAgaWRlbTogYCR7aWRlbVByZWZpeCA/PyBcImlkX3BjdFwifToke3RzTXN9YFxuICB9KTtcbn1cblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICAgICAgICAgICAgICAgICAgQ0xJIHV0aWxpdGllcyAoZm9ybWVyIGRiLm10cykgICAgICAgICAgICAgICAgICAgICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxudHlwZSBTdGVwID0geyBuYW1lOiBzdHJpbmc7IGZpbGVzOiBzdHJpbmdbXSB9O1xuXG5jb25zdCBCQVNFX1NURVA6IFN0ZXAgPSB7XG4gIG5hbWU6IFwiQkFTRSBERExzXCIsXG4gIGZpbGVzOiBbXG4gICAgXCIwMF9leHRlbnNpb25zLnNxbFwiLFxuICAgIFwiMDFfc2V0dGluZ3Muc3FsXCIsXG4gICAgXCIwMl9tYXJrZXQuc3FsXCIsXG4gICAgXCIwM19kb2NzLnNxbFwiLFxuICAgIFwiMDRfbWF0cmljZXMuc3FsXCIsXG4gICAgXCIwNV9zdHJfYXV4LnNxbFwiLFxuICAgIFwiMDZfY2luX2F1eF9jb3JlLnNxbFwiLFxuICAgIFwiMDdfY2luX2F1eF9ydW50aW1lLnNxbFwiLFxuICAgIFwiMDhfY2luX2F1eF9mdW5jdGlvbnMuc3FsXCIsXG4gICAgXCIwOV9vcHMuc3FsXCIsXG4gICAgXCIwOV9pbmdlc3Quc3FsXCIsXG4gICAgXCIxMF9oZWxwZXJzLnNxbFwiLFxuICAgIFwiMTFfdmlld3NfbGF0ZXN0LnNxbFwiLFxuICBdLFxufTtcblxuY29uc3QgUEFUQ0hfU1RFUDogU3RlcCA9IHtcbiAgbmFtZTogXCJQQVRDSCBTRVQgdjFcIixcbiAgZmlsZXM6IFtcbiAgICBcIjAxX3NldHRpbmdzX3BhdGNoZXMuc3FsXCIsXG4gICAgXCIwMl9tYXJrZXRfcGF0Y2hlcy5zcWxcIixcbiAgICBcIjAzX2RvY3NfcGF0Y2hlcy5zcWxcIixcbiAgICBcIjA0X21hdHJpY2VzX3BhdGNoZXMuc3FsXCIsXG4gICAgXCIwNV9zdHJfYXV4X3BhdGNoZXMuc3FsXCIsXG4gICAgXCIwNl9jaW5fYXV4X2NvcmVfcGF0Y2hlcy5zcWxcIixcbiAgICBcIjA3X2Npbl9hdXhfcnVudGltZV9wYXRjaGVzLnNxbFwiLFxuICAgIFwiMDhfY2luX2F1eF9mdW5jdGlvbnNfcGF0Y2hlcy5zcWxcIixcbiAgICBcIjA5X21lYV9keW5hbWljc19wYXRjaGVzLnNxbFwiLFxuICAgIFwiMTBfb3BzX3BhdGNoZXMuc3FsXCIsXG4gICAgXCIxMV9yZW1vdmVfYm9vdHN0cmFwLnNxbFwiLFxuICBdLFxufTtcblxuY29uc3QgU0VFRF9TVEVQOiBTdGVwID0geyBuYW1lOiBcIlNFRURTXCIsIGZpbGVzOiBbXCIwMV9zZWVkLnNxbFwiLCBcIjAyX3NlZWRfam9icy5zcWxcIl0gfTtcbmNvbnN0IFZFUklGWV9TVEVQOiBTdGVwID0geyBuYW1lOiBcIlZFUklGWVwiLCBmaWxlczogW1wiMDNfdmVyaWZ5LnNxbFwiXSB9O1xuXG5hc3luYyBmdW5jdGlvbiBzcGF3bkNvbW1hbmQoY21kOiBzdHJpbmcsIGFyZ3M6IHN0cmluZ1tdLCBlbnY/OiBOb2RlSlMuUHJvY2Vzc0Vudikge1xuICBjb25zdCB7IHNwYXduIH0gPSBhd2FpdCBpbXBvcnQoXCJub2RlOmNoaWxkX3Byb2Nlc3NcIik7XG4gIHJldHVybiBuZXcgUHJvbWlzZTx2b2lkPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgY29uc3QgY2hpbGQgPSBzcGF3bihjbWQsIGFyZ3MsIHsgc3RkaW86IFwiaW5oZXJpdFwiLCBlbnYgfSk7XG4gICAgY2hpbGQub24oXCJlcnJvclwiLCByZWplY3QpO1xuICAgIGNoaWxkLm9uKFwiZXhpdFwiLCAoY29kZSkgPT4gKGNvZGUgPT09IDAgPyByZXNvbHZlKCkgOiByZWplY3QobmV3IEVycm9yKGAke2NtZH0gZXhpdGVkIHdpdGggJHtjb2RlfWApKSkpO1xuICB9KTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJ1bkRiVG9vbChcbiAgYXJndjogc3RyaW5nW10gPSB0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIiA/IHByb2Nlc3MuYXJndi5zbGljZSgyKSA6IFtdLFxuICBvcHRzOiB7IHJvb3Q/OiBzdHJpbmcgfSA9IHt9LFxuKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IFt7IHJlc29sdmUsIGpvaW4gfSwgZnMsIGRvdGVudl0gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgaW1wb3J0KFwibm9kZTpwYXRoXCIpLFxuICAgIGltcG9ydChcIm5vZGU6ZnNcIiksXG4gICAgaW1wb3J0KFwiZG90ZW52XCIpLFxuICBdKTtcblxuICBjb25zdCBST09UID0gcmVzb2x2ZShwcm9jZXNzLmN3ZCgpLCBvcHRzLnJvb3QgPz8gXCJkYlwiKTtcbiAgY29uc3QgRU5WX0ZJTEUgPSBqb2luKFJPT1QsIFwiLmVudi5kYlwiKTtcbiAgaWYgKGZzLmV4aXN0c1N5bmMoRU5WX0ZJTEUpKSB7XG4gICAgZG90ZW52LmNvbmZpZyh7IHBhdGg6IEVOVl9GSUxFIH0pO1xuICB9XG5cbiAgY29uc3QgcGcgPSB7XG4gICAgaG9zdDogcHJvY2Vzcy5lbnYuUEdIT1NUID8/IFwibG9jYWxob3N0XCIsXG4gICAgcG9ydDogU3RyaW5nKHByb2Nlc3MuZW52LlBHUE9SVCA/PyBcIjU0MzJcIiksXG4gICAgZGI6IHByb2Nlc3MuZW52LlBHREFUQUJBU0UgPz8gXCJwb3N0Z3Jlc1wiLFxuICAgIHVzZXI6IHByb2Nlc3MuZW52LlBHVVNFUiA/PyBcInBvc3RncmVzXCIsXG4gICAgcGFzczogcHJvY2Vzcy5lbnYuUEdQQVNTV09SRCA/PyBcIlwiLFxuICB9O1xuXG4gIGNvbnN0IGZpbGVFeGlzdHMgPSAoZmlsZTogc3RyaW5nKSA9PiBmcy5leGlzdHNTeW5jKGpvaW4oUk9PVCwgZmlsZSkpO1xuXG4gIGFzeW5jIGZ1bmN0aW9uIGVuc3VyZVBzcWwoKSB7XG4gICAgYXdhaXQgc3Bhd25Db21tYW5kKFwicHNxbFwiLCBbXCItLXZlcnNpb25cIl0pO1xuICB9XG5cbiAgYXN5bmMgZnVuY3Rpb24gZXhlY1NxbChmaWxlOiBzdHJpbmcpIHtcbiAgICBpZiAoIWZpbGVFeGlzdHMoZmlsZSkpIHJldHVybjtcbiAgICBjb25zdCBmdWxsID0gam9pbihST09ULCBmaWxlKTtcbiAgICBhd2FpdCBzcGF3bkNvbW1hbmQoXG4gICAgICBcInBzcWxcIixcbiAgICAgIFtcbiAgICAgICAgXCItWFwiLFxuICAgICAgICBcIi12XCIsXG4gICAgICAgIFwiT05fRVJST1JfU1RPUD0xXCIsXG4gICAgICAgIFwiLWhcIixcbiAgICAgICAgcGcuaG9zdCxcbiAgICAgICAgXCItcFwiLFxuICAgICAgICBwZy5wb3J0LFxuICAgICAgICBcIi1VXCIsXG4gICAgICAgIHBnLnVzZXIsXG4gICAgICAgIFwiLWRcIixcbiAgICAgICAgcGcuZGIsXG4gICAgICAgIFwiLWZcIixcbiAgICAgICAgZnVsbCxcbiAgICAgIF0sXG4gICAgICB7IC4uLnByb2Nlc3MuZW52LCBQR1BBU1NXT1JEOiBwZy5wYXNzIH0sXG4gICAgKTtcbiAgfVxuXG4gIGFzeW5jIGZ1bmN0aW9uIHJ1blN0ZXAoc3RlcDogU3RlcCkge1xuICAgIGNvbnNvbGUubG9nKGBcXG49PT0gJHtzdGVwLm5hbWV9ID09PWApO1xuICAgIGZvciAoY29uc3QgZmlsZSBvZiBzdGVwLmZpbGVzKSB7XG4gICAgICBpZiAoIWZpbGVFeGlzdHMoZmlsZSkpIGNvbnRpbnVlO1xuICAgICAgY29uc29sZS5sb2coYC0+ICR7ZmlsZX1gKTtcbiAgICAgIGF3YWl0IGV4ZWNTcWwoZmlsZSk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZnVuY3Rpb24gZW5zdXJlRGIoKSB7XG4gICAgY29uc3Qgc3FsID0gYERPICQkXG4gICAgIEJFR0lOXG4gICAgICAgSUYgTk9UIEVYSVNUUyAoU0VMRUNUIDEgRlJPTSBwZ19kYXRhYmFzZSBXSEVSRSBkYXRuYW1lID0gJyR7cGcuZGJ9JykgVEhFTlxuICAgICAgICAgRVhFQ1VURSAnQ1JFQVRFIERBVEFCQVNFICR7cGcuZGJ9JztcbiAgICAgICBFTkQgSUY7XG4gICAgIEVORCQkO2A7XG4gICAgYXdhaXQgc3Bhd25Db21tYW5kKFxuICAgICAgXCJwc3FsXCIsXG4gICAgICBbXG4gICAgICAgIFwiLVhcIixcbiAgICAgICAgXCItdlwiLFxuICAgICAgICBcIk9OX0VSUk9SX1NUT1A9MVwiLFxuICAgICAgICBcIi1oXCIsXG4gICAgICAgIHBnLmhvc3QsXG4gICAgICAgIFwiLXBcIixcbiAgICAgICAgcGcucG9ydCxcbiAgICAgICAgXCItVVwiLFxuICAgICAgICBwZy51c2VyLFxuICAgICAgICBcIi1kXCIsXG4gICAgICAgIFwicG9zdGdyZXNcIixcbiAgICAgICAgXCItY1wiLFxuICAgICAgICBzcWwsXG4gICAgICBdLFxuICAgICAgeyAuLi5wcm9jZXNzLmVudiwgUEdQQVNTV09SRDogcGcucGFzcyB9LFxuICAgICk7XG4gIH1cblxuICBmdW5jdGlvbiB1c2FnZSgpIHtcbiAgICBjb25zb2xlLmxvZyhgXG5Vc2FnZTpcbiAgcG5wbSBkYjphcHBseSAgICAgIyBiYXNlIERETHMgKyBwYXRjaGVzXG4gIHBucG0gZGI6c2VlZCAgICAgICMgc2VlZHMgKHVuaXZlcnNlL3RpbWluZy9zZXNzaW9uL2pvYnMpXG4gIHBucG0gZGI6dmVyaWZ5ICAgICMgcXVpY2sgY2hlY2tzXG4gIHBucG0gZGI6YWxsICAgICAgICMgZW5zdXJlIERCLCBhcHBseSwgc2VlZCwgdmVyaWZ5XG4gIHBucG0gZGI6cHNxbCAgICAgICMgb3BlbiBpbnRlcmFjdGl2ZSBwc3FsIHRvIFBHREFUQUJBU0VcblxuRU5WOiByZWFkIGZyb20gZGIvLmVudi5kYiAoUEdIT1NULCBQR1BPUlQsIFBHREFUQUJBU0UsIFBHVVNFUiwgUEdQQVNTV09SRClcbmAudHJpbSgpKTtcbiAgfVxuXG4gIGNvbnN0IFtjbWQgPSBcIlwiXSA9IGFyZ3Y7XG4gIGF3YWl0IGVuc3VyZVBzcWwoKTtcblxuICBpZiAoY21kID09PSBcImFwcGx5XCIpIHtcbiAgICBhd2FpdCBydW5TdGVwKEJBU0VfU1RFUCk7XG4gICAgYXdhaXQgcnVuU3RlcChQQVRDSF9TVEVQKTtcbiAgICBjb25zb2xlLmxvZyhcIltva10gYXBwbHkgY29tcGxldGVcIik7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKGNtZCA9PT0gXCJzZWVkXCIpIHtcbiAgICBhd2FpdCBydW5TdGVwKFNFRURfU1RFUCk7XG4gICAgY29uc29sZS5sb2coXCJbb2tdIHNlZWQgY29tcGxldGVcIik7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKGNtZCA9PT0gXCJ2ZXJpZnlcIikge1xuICAgIGF3YWl0IHJ1blN0ZXAoVkVSSUZZX1NURVApO1xuICAgIGNvbnNvbGUubG9nKFwiW29rXSB2ZXJpZnkgY29tcGxldGVcIik7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKGNtZCA9PT0gXCJhbGxcIikge1xuICAgIGF3YWl0IGVuc3VyZURiKCk7XG4gICAgYXdhaXQgcnVuU3RlcChCQVNFX1NURVApO1xuICAgIGF3YWl0IHJ1blN0ZXAoUEFUQ0hfU1RFUCk7XG4gICAgYXdhaXQgcnVuU3RlcChTRUVEX1NURVApO1xuICAgIGF3YWl0IHJ1blN0ZXAoVkVSSUZZX1NURVApO1xuICAgIGNvbnNvbGUubG9nKFwiW29rXSBhbGwgZG9uZVwiKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoY21kID09PSBcInBzcWxcIikge1xuICAgIGF3YWl0IHNwYXduQ29tbWFuZChcbiAgICAgIFwicHNxbFwiLFxuICAgICAgW1wiLWhcIiwgcGcuaG9zdCwgXCItcFwiLCBwZy5wb3J0LCBcIi1VXCIsIHBnLnVzZXIsIFwiLWRcIiwgcGcuZGJdLFxuICAgICAgeyAuLi5wcm9jZXNzLmVudiwgUEdQQVNTV09SRDogcGcucGFzcyB9LFxuICAgICk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdXNhZ2UoKTtcbiAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIGRiIGNvbW1hbmQgXCIke2NtZH1cImApO1xufVxuXG5hc3luYyBmdW5jdGlvbiBtYXliZVJ1bkRiVG9vbEZyb21DbGkoKSB7XG4gIGlmICh0eXBlb2YgcHJvY2VzcyA9PT0gXCJ1bmRlZmluZWRcIiB8fCAhcHJvY2Vzcy5hcmd2Py5bMV0pIHJldHVybjtcbiAgdHJ5IHtcbiAgICBjb25zdCB7IHBhdGhUb0ZpbGVVUkwgfSA9IGF3YWl0IGltcG9ydChcIm5vZGU6dXJsXCIpO1xuICAgIGlmIChpbXBvcnQubWV0YS51cmwgIT09IHBhdGhUb0ZpbGVVUkwocHJvY2Vzcy5hcmd2WzFdISkuaHJlZikgcmV0dXJuO1xuICB9IGNhdGNoIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB0cnkge1xuICAgIGF3YWl0IHJ1bkRiVG9vbChwcm9jZXNzLmFyZ3Yuc2xpY2UoMikpO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgcHJvY2Vzcy5leGl0Q29kZSA9IDE7XG4gIH1cbn1cblxudm9pZCBtYXliZVJ1bkRiVG9vbEZyb21DbGkoKTtcbiJdLCJuYW1lcyI6WyJkYiIsImdldFBvb2wiLCJxdWVyeSIsIndpdGhDbGllbnQiLCJzcWwiLCJSQVdfVEFCTEUiLCJwcm9jZXNzIiwiZW52IiwiTUFUUklYX1RBQkxFIiwiYXNJZGVudCIsIm5hbWUiLCJwYXJ0cyIsIlN0cmluZyIsInNwbGl0IiwiZmlsdGVyIiwiQm9vbGVhbiIsImxlbmd0aCIsIkVycm9yIiwibWFwIiwicGFydCIsInRlc3QiLCJqb2luIiwiVEFCTEUiLCJSQVdfU1RBR0VfVEFCTEUiLCJNQVRSSVhfU1RBR0VfVEFCTEUiLCJSQVdfQ09NTUlUX1RBQkxFIiwiTUFUUklYX0NPTU1JVF9UQUJMRSIsIlNUQUdFX1RBQkxFX0NBTkRJREFURVMiLCJBcnJheSIsImZyb20iLCJTZXQiLCJNQVRSSVhfVEFCTEVfQ0FORElEQVRFUyIsInNwbGl0UXVhbGlmaWVkTmFtZSIsInNjaGVtYSIsInJlbGF0aW9uIiwicG9wIiwiZW5zdXJlTWF0cml4VGFibGVzIiwiY2xpZW50IiwiZmluZEV4aXN0aW5nVGFibGUiLCJjYW5kaWRhdGVzIiwicmF3Iiwicm93cyIsImtpbmQiLCJpZGVudCIsImNhY2hlZFN0YWdlSW5mbyIsImNhY2hlZE1hdHJpeEluZm8iLCJlbnN1cmVTdGFnZUluZm8iLCJpbmZvIiwiZW5zdXJlTWF0cml4SW5mbyIsImRlZHVwZVVwcGVyIiwieHMiLCJvdXQiLCJzZWVuIiwieCIsInVwIiwidHJpbSIsInRvVXBwZXJDYXNlIiwiaGFzIiwiYWRkIiwicHVzaCIsImdldE1hdHJpeFN0YWdlVGFibGVJZGVudCIsInVzZUNsaWVudCIsImNvbm5lY3QiLCJyZWxlYXNlIiwiZ2V0TWF0cml4VmFsdWVzVGFibGVJZGVudCIsInVwc2VydE1hdHJpeFJvd3MiLCJ2YWx1ZXMiLCJjaHVua3MiLCJyIiwiaSIsImoiLCJ0c19tcyIsIm1hdHJpeF90eXBlIiwiYmFzZSIsInF1b3RlIiwidmFsdWUiLCJKU09OIiwic3RyaW5naWZ5IiwibWV0YSIsImdldExhdGVzdEJ5VHlwZSIsImNvaW5zIiwiTnVtYmVyIiwidmFscyIsImdldFByZXZWYWx1ZSIsImJlZm9yZVRzIiwiZ2V0TGF0ZXN0VHNGb3JUeXBlIiwidiIsImdldE5lYXJlc3RUc0F0T3JCZWZvcmUiLCJnZXRTbmFwc2hvdEJ5VHlwZSIsImdldFByZXZTbmFwc2hvdEJ5VHlwZSIsImNvdW50Um93c0F0IiwibiIsIm9wZW5pbmdDYWNoZSIsIk1hcCIsImtleVN0ciIsImsiLCJ3aW5kb3ciLCJhcHBTZXNzaW9uSWQiLCJnZXRPcGVuaW5nRnJvbURiIiwicTEiLCJyMSIsInByaWNlIiwidHMiLCJxMiIsInIyIiwiZW5zdXJlT3BlbmluZyIsIm9wdHMiLCJjayIsImhpdCIsImdldCIsIm9wZW5pbmdQcmljZSIsIm9wZW5pbmdUcyIsInJvdyIsInNldCIsImNsZWFyT3BlbmluZ0NhY2hlIiwiY2xlYXIiLCJkZWxldGUiLCJjZWxsc09mIiwiYiIsInEiLCJpc05hTiIsInN0YWdlTWF0cml4R3JpZCIsIm1hdHJpeFR5cGUiLCJ0c01zIiwiZXh0ZXJuYWwiLCJvayIsInN0YWdlZCIsIm1ldGFKc29uIiwic3RhZ2VJbmZvIiwidGV4dCIsIl8iLCJwYXJhbXMiLCJjb21taXRNYXRyaXhHcmlkIiwibWFuYWdlVHgiLCJtYXRyaXhUYWJsZSIsInN0YWdlUm93cyIsInN0YWdlZENlbGxzIiwicm93Q291bnQiLCJjb2luc0Zyb21TdGFnZSIsImVsaWdpYmxlQ29pbnMiLCJleHBlY3RlZENlbGxzIiwiTWF0aCIsIm1heCIsInN0YWdlZFBhaXJzIiwibWlzc2luZ0NvdW50IiwiZXhwZWN0ZWRfY2VsbHMiLCJzdGFnZWRfY2VsbHMiLCJtaXNzaW5nX2NvdW50IiwiY29tcGxldGUiLCJlcnIiLCJtYXBQcmV2QmVuY2htYXJrIiwicHJldiIsIm0iLCJwZXJzaXN0TGl2ZU1hdHJpY2VzU2xpY2UiLCJiZW5jaG1hcmsiLCJwY3QyNGgiLCJpZGVtUHJlZml4Iiwic291cmNlIiwiaWRlbSIsInByZXZNYXAiLCJpZE9iaiIsIm5vdyIsImFicyIsIkJBU0VfU1RFUCIsImZpbGVzIiwiUEFUQ0hfU1RFUCIsIlNFRURfU1RFUCIsIlZFUklGWV9TVEVQIiwic3Bhd25Db21tYW5kIiwiY21kIiwiYXJncyIsInNwYXduIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJjaGlsZCIsInN0ZGlvIiwib24iLCJjb2RlIiwicnVuRGJUb29sIiwiYXJndiIsInNsaWNlIiwiZnMiLCJkb3RlbnYiLCJhbGwiLCJST09UIiwiY3dkIiwicm9vdCIsIkVOVl9GSUxFIiwiZXhpc3RzU3luYyIsImNvbmZpZyIsInBhdGgiLCJwZyIsImhvc3QiLCJQR0hPU1QiLCJwb3J0IiwiUEdQT1JUIiwiUEdEQVRBQkFTRSIsInVzZXIiLCJQR1VTRVIiLCJwYXNzIiwiUEdQQVNTV09SRCIsImZpbGVFeGlzdHMiLCJmaWxlIiwiZW5zdXJlUHNxbCIsImV4ZWNTcWwiLCJmdWxsIiwicnVuU3RlcCIsInN0ZXAiLCJjb25zb2xlIiwibG9nIiwiZW5zdXJlRGIiLCJ1c2FnZSIsIm1heWJlUnVuRGJUb29sRnJvbUNsaSIsInBhdGhUb0ZpbGVVUkwiLCJ1cmwiLCJocmVmIiwiZXJyb3IiLCJleGl0Q29kZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/core/db/db.ts\n");

/***/ }),

/***/ "(rsc)/./src/core/db/pool_server.ts":
/*!************************************!*\
  !*** ./src/core/db/pool_server.ts ***!
  \************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DEFAULT_SEARCH_PATH: () => (/* binding */ DEFAULT_SEARCH_PATH),\n/* harmony export */   TABLES: () => (/* binding */ TABLES),\n/* harmony export */   appendAppLedger: () => (/* binding */ appendAppLedger),\n/* harmony export */   appendTransferLedger: () => (/* binding */ appendTransferLedger),\n/* harmony export */   db: () => (/* binding */ db),\n/* harmony export */   getAppLedgerSince: () => (/* binding */ getAppLedgerSince),\n/* harmony export */   getDb: () => (/* binding */ getDb),\n/* harmony export */   getPool: () => (/* binding */ getPool),\n/* harmony export */   listTransferLegs: () => (/* binding */ listTransferLegs),\n/* harmony export */   query: () => (/* binding */ query),\n/* harmony export */   serverDb: () => (/* binding */ serverDb),\n/* harmony export */   withClient: () => (/* binding */ withClient)\n/* harmony export */ });\n/* harmony import */ var pg__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pg */ \"pg\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([pg__WEBPACK_IMPORTED_MODULE_0__]);\npg__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n/**\n * Unified PG pool + convenience helpers + lightweight ledgers.\n * This replaces the old pool/server/ledger trio with a single source of truth.\n */ /*  Environment helpers  */ function asBool(v, fallback = false) {\n    if (v == null) return fallback;\n    const s = String(v).trim().toLowerCase();\n    return s === \"1\" || s === \"true\" || s === \"yes\" || s === \"on\";\n}\n/*  Pool configuration  */ const useUrl = !!process.env.DATABASE_URL;\nconst baseConfig = useUrl ? {\n    connectionString: String(process.env.DATABASE_URL)\n} : {\n    host: String(process.env.PGHOST ?? \"localhost\"),\n    port: Number(process.env.PGPORT ?? 1026),\n    user: String(process.env.PGUSER ?? \"postgres\"),\n    password: String(process.env.PGPASSWORD ?? \"gus\"),\n    database: String(process.env.PGDATABASE ?? \"cryptopie\")\n};\nconst poolConfig = {\n    ...baseConfig,\n    max: Number(process.env.DB_POOL_MAX ?? process.env.PGPOOL_MAX ?? 10),\n    idleTimeoutMillis: Number(process.env.DB_IDLE_MS ?? 45000),\n    connectionTimeoutMillis: Number(process.env.DB_CONN_TIMEOUT_MS ?? 5000),\n    ssl: asBool(process.env.DB_SSL ?? process.env.PGSSL) ? {\n        rejectUnauthorized: false\n    } : undefined\n};\nconst SESSION_STATEMENT_TIMEOUT = Number(process.env.DB_STATEMENT_TIMEOUT_MS ?? 15000);\nconst SESSION_IDLE_TX_TIMEOUT = Number(process.env.DB_IDLE_TX_TIMEOUT_MS ?? 15000);\nconst SESSION_TZ = String(process.env.DB_TIMEZONE ?? \"UTC\").replace(/'/g, \"''\");\nconst DEFAULT_SEARCH_PATH = [\n    \"settings\",\n    \"market\",\n    \"docs\",\n    \"matrices\",\n    \"str_aux\",\n    \"cin_aux\",\n    \"mea_dynamics\",\n    \"ingest\",\n    \"ops\",\n    \"public\"\n].join(\", \");\nfunction ensurePool() {\n    if (!global.__core_pg_pool__) {\n        const pool = new pg__WEBPACK_IMPORTED_MODULE_0__.Pool(poolConfig);\n        pool.on(\"connect\", (client)=>{\n            const bootstrap = [\n                `SET statement_timeout = ${SESSION_STATEMENT_TIMEOUT}`,\n                `SET idle_in_transaction_session_timeout = ${SESSION_IDLE_TX_TIMEOUT}`,\n                `SET TIME ZONE '${SESSION_TZ}'`,\n                `SET search_path = ${DEFAULT_SEARCH_PATH}`\n            ];\n            for (const statement of bootstrap){\n                void client.query(statement).catch(()=>{\n                /* ignore bootstrap failures so the pool stays usable */ });\n            }\n        });\n        global.__core_pg_pool__ = pool;\n    }\n    return global.__core_pg_pool__;\n}\nfunction getPool() {\n    return ensurePool();\n}\nfunction getDb() {\n    return ensurePool();\n}\n/*  Query helpers  */ async function withClient(fn) {\n    const client = await ensurePool().connect();\n    try {\n        return await fn(client);\n    } finally{\n        client.release();\n    }\n}\nasync function query(text, params) {\n    return ensurePool().query(text, params);\n}\nconst db = ensurePool();\nconst serverDb = {\n    query (text, params) {\n        return ensurePool().query(text, params);\n    }\n};\n/*  Table constants  */ const TABLES = {\n    matrices: process.env.MATRIX_TABLE || \"matrices.dyn_values\",\n    matricesStage: process.env.MATRIX_STAGE_TABLE || \"matrices.dyn_values_stage\",\n    ledger: process.env.APP_LEDGER_TABLE || \"ops.app_ledger\",\n    transfers: process.env.TRANSFER_LEDGER_TABLE || \"ops.transfer_ledger\"\n};\n/** Safe insert; ignores missing table or duplicate key. */ async function appendAppLedger(e) {\n    const sql = `\n    INSERT INTO ${TABLES.ledger}\n      (topic, event, payload, session_id, idempotency_key, ts_epoch_ms)\n    VALUES ($1,$2,$3,$4,$5,$6)\n    ON CONFLICT (idempotency_key) DO NOTHING\n  `;\n    try {\n        await query(sql, [\n            e.topic,\n            e.event,\n            e.payload ?? null,\n            e.session_id ?? null,\n            e.idempotency_key ?? null,\n            e.ts_epoch_ms\n        ]);\n    } catch (err) {\n        if (err?.code === \"42P01\") {\n            console.warn(\"appendAppLedger: ledger table missing (ops.app_ledger). Skipping log.\");\n            return;\n        }\n        throw err;\n    }\n}\nasync function getAppLedgerSince(sinceMs, topic) {\n    try {\n        const { rows } = await query(`SELECT * FROM ${TABLES.ledger}\n        WHERE ts_epoch_ms >= $1\n          AND ($2::text IS NULL OR topic = $2)\n     ORDER BY ts_epoch_ms ASC`, [\n            sinceMs,\n            topic ?? null\n        ]);\n        return rows;\n    } catch (err) {\n        if (err?.code === \"42P01\") {\n            console.warn(\"getAppLedgerSince: ledger table missing (ops.app_ledger).\");\n            return [];\n        }\n        throw err;\n    }\n}\n/*  Transfer ledger helpers  */ async function appendTransferLedger(row) {\n    const q = `\n    INSERT INTO ${TABLES.transfers} (\n      app_session_id, cycle_ts, leg_seq, route_id, intent_id,\n      from_symbol, to_symbol, qty_from, qty_to,\n      price_from_usdt, price_to_usdt, fee_usdt, exec_ts, tx_id\n    )\n    VALUES (\n      $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,COALESCE($12,0),$13,$14\n    )\n    ON CONFLICT (app_session_id, cycle_ts, leg_seq) DO NOTHING\n  `;\n    try {\n        await query(q, [\n            row.app_session_id,\n            row.cycle_ts,\n            row.leg_seq,\n            row.route_id ?? null,\n            row.intent_id ?? null,\n            row.from_symbol,\n            row.to_symbol,\n            row.qty_from,\n            row.qty_to,\n            row.price_from_usdt,\n            row.price_to_usdt,\n            row.fee_usdt ?? 0,\n            row.exec_ts,\n            row.tx_id ?? null\n        ]);\n    } catch (err) {\n        if (err?.code === \"42P01\") {\n            console.warn(\"appendTransferLedger: transfer_ledger table missing (ops.transfer_ledger).\");\n            return;\n        }\n        throw err;\n    }\n}\nasync function listTransferLegs(app_session_id, opts) {\n    const { rows } = await query(`SELECT * FROM ${TABLES.transfers}\n      WHERE app_session_id = $1\n        AND ($2::bigint IS NULL OR cycle_ts < $2)\n   ORDER BY cycle_ts DESC, leg_seq DESC\n      LIMIT $3`, [\n        app_session_id,\n        opts?.before ?? null,\n        opts?.limit ?? 200\n    ]);\n    return rows;\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvY29yZS9kYi9wb29sX3NlcnZlci50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQWtGO0FBRWxGOzs7Q0FHQyxHQUVELHlEQUF5RCxHQUN6RCxTQUFTQyxPQUFPQyxDQUFVLEVBQUVDLFdBQVcsS0FBSztJQUMxQyxJQUFJRCxLQUFLLE1BQU0sT0FBT0M7SUFDdEIsTUFBTUMsSUFBSUMsT0FBT0gsR0FBR0ksSUFBSSxHQUFHQyxXQUFXO0lBQ3RDLE9BQU9ILE1BQU0sT0FBT0EsTUFBTSxVQUFVQSxNQUFNLFNBQVNBLE1BQU07QUFDM0Q7QUFFQSx3REFBd0QsR0FDeEQsTUFBTUksU0FBUyxDQUFDLENBQUNDLFFBQVFDLEdBQUcsQ0FBQ0MsWUFBWTtBQUN6QyxNQUFNQyxhQUFhSixTQUNmO0lBQUVLLGtCQUFrQlIsT0FBT0ksUUFBUUMsR0FBRyxDQUFDQyxZQUFZO0FBQUUsSUFDckQ7SUFDRUcsTUFBTVQsT0FBT0ksUUFBUUMsR0FBRyxDQUFDSyxNQUFNLElBQUk7SUFDbkNDLE1BQU1DLE9BQU9SLFFBQVFDLEdBQUcsQ0FBQ1EsTUFBTSxJQUFJO0lBQ25DQyxNQUFNZCxPQUFPSSxRQUFRQyxHQUFHLENBQUNVLE1BQU0sSUFBSTtJQUNuQ0MsVUFBVWhCLE9BQU9JLFFBQVFDLEdBQUcsQ0FBQ1ksVUFBVSxJQUFJO0lBQzNDQyxVQUFVbEIsT0FBT0ksUUFBUUMsR0FBRyxDQUFDYyxVQUFVLElBQUk7QUFDN0M7QUFFSixNQUFNQyxhQUFhO0lBQ2pCLEdBQUdiLFVBQVU7SUFDYmMsS0FBS1QsT0FBT1IsUUFBUUMsR0FBRyxDQUFDaUIsV0FBVyxJQUFJbEIsUUFBUUMsR0FBRyxDQUFDa0IsVUFBVSxJQUFJO0lBQ2pFQyxtQkFBbUJaLE9BQU9SLFFBQVFDLEdBQUcsQ0FBQ29CLFVBQVUsSUFBSTtJQUNwREMseUJBQXlCZCxPQUFPUixRQUFRQyxHQUFHLENBQUNzQixrQkFBa0IsSUFBSTtJQUNsRUMsS0FBS2hDLE9BQU9RLFFBQVFDLEdBQUcsQ0FBQ3dCLE1BQU0sSUFBSXpCLFFBQVFDLEdBQUcsQ0FBQ3lCLEtBQUssSUFDL0M7UUFBRUMsb0JBQW9CO0lBQWUsSUFDckNDO0FBQ047QUFFQSxNQUFNQyw0QkFBNEJyQixPQUFPUixRQUFRQyxHQUFHLENBQUM2Qix1QkFBdUIsSUFBSTtBQUNoRixNQUFNQywwQkFBMEJ2QixPQUFPUixRQUFRQyxHQUFHLENBQUMrQixxQkFBcUIsSUFBSTtBQUM1RSxNQUFNQyxhQUFhckMsT0FBT0ksUUFBUUMsR0FBRyxDQUFDaUMsV0FBVyxJQUFJLE9BQU9DLE9BQU8sQ0FBQyxNQUFNO0FBQ25FLE1BQU1DLHNCQUFzQjtJQUNqQztJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtDQUNELENBQUNDLElBQUksQ0FBQyxNQUFNO0FBUWIsU0FBU0M7SUFDUCxJQUFJLENBQUNDLE9BQU9DLGdCQUFnQixFQUFFO1FBQzVCLE1BQU1DLE9BQU8sSUFBSWxELG9DQUFJQSxDQUFDeUI7UUFDdEJ5QixLQUFLQyxFQUFFLENBQUMsV0FBVyxDQUFDQztZQUNsQixNQUFNQyxZQUFZO2dCQUNoQixDQUFDLHdCQUF3QixFQUFFZiwyQkFBMkI7Z0JBQ3RELENBQUMsMENBQTBDLEVBQUVFLHlCQUF5QjtnQkFDdEUsQ0FBQyxlQUFlLEVBQUVFLFdBQVcsQ0FBQyxDQUFDO2dCQUMvQixDQUFDLGtCQUFrQixFQUFFRyxxQkFBcUI7YUFDM0M7WUFDRCxLQUFLLE1BQU1TLGFBQWFELFVBQVc7Z0JBQ2pDLEtBQUtELE9BQU9HLEtBQUssQ0FBQ0QsV0FBV0UsS0FBSyxDQUFDO2dCQUNqQyxzREFBc0QsR0FDeEQ7WUFDRjtRQUNGO1FBQ0FSLE9BQU9DLGdCQUFnQixHQUFHQztJQUM1QjtJQUNBLE9BQU9GLE9BQU9DLGdCQUFnQjtBQUNoQztBQUVPLFNBQVNRO0lBQ2QsT0FBT1Y7QUFDVDtBQUNPLFNBQVNXO0lBQ2QsT0FBT1g7QUFDVDtBQUVBLG1EQUFtRCxHQUM1QyxlQUFlWSxXQUFjQyxFQUFzQztJQUN4RSxNQUFNUixTQUFTLE1BQU1MLGFBQWFjLE9BQU87SUFDekMsSUFBSTtRQUNGLE9BQU8sTUFBTUQsR0FBR1I7SUFDbEIsU0FBVTtRQUNSQSxPQUFPVSxPQUFPO0lBQ2hCO0FBQ0Y7QUFFTyxlQUFlUCxNQUNwQlEsSUFBWSxFQUNaQyxNQUFjO0lBRWQsT0FBT2pCLGFBQWFRLEtBQUssQ0FBSVEsTUFBTUM7QUFDckM7QUFFTyxNQUFNQyxLQUFXbEIsYUFBYTtBQUM5QixNQUFNbUIsV0FBVztJQUN0QlgsT0FBZVEsSUFBWSxFQUFFQyxNQUFjO1FBQ3pDLE9BQU9qQixhQUFhUSxLQUFLLENBQUlRLE1BQU1DO0lBQ3JDO0FBQ0YsRUFBRTtBQUVGLHFEQUFxRCxHQUM5QyxNQUFNRyxTQUFTO0lBQ3BCQyxVQUFVM0QsUUFBUUMsR0FBRyxDQUFDMkQsWUFBWSxJQUFJO0lBQ3RDQyxlQUFlN0QsUUFBUUMsR0FBRyxDQUFDNkQsa0JBQWtCLElBQUk7SUFDakRDLFFBQVEvRCxRQUFRQyxHQUFHLENBQUMrRCxnQkFBZ0IsSUFBSTtJQUN4Q0MsV0FBV2pFLFFBQVFDLEdBQUcsQ0FBQ2lFLHFCQUFxQixJQUFJO0FBQ2xELEVBQVc7QUFZWCx5REFBeUQsR0FDbEQsZUFBZUMsZ0JBQWdCQyxDQUFpQjtJQUNyRCxNQUFNQyxNQUFNLENBQUM7Z0JBQ0MsRUFBRVgsT0FBT0ssTUFBTSxDQUFDOzs7O0VBSTlCLENBQUM7SUFDRCxJQUFJO1FBQ0YsTUFBTWpCLE1BQU11QixLQUFLO1lBQ2ZELEVBQUVFLEtBQUs7WUFDUEYsRUFBRUcsS0FBSztZQUNQSCxFQUFFSSxPQUFPLElBQUk7WUFDYkosRUFBRUssVUFBVSxJQUFJO1lBQ2hCTCxFQUFFTSxlQUFlLElBQUk7WUFDckJOLEVBQUVPLFdBQVc7U0FDZDtJQUNILEVBQUUsT0FBT0MsS0FBVTtRQUNqQixJQUFJQSxLQUFLQyxTQUFTLFNBQVM7WUFDekJDLFFBQVFDLElBQUksQ0FBQztZQUNiO1FBQ0Y7UUFDQSxNQUFNSDtJQUNSO0FBQ0Y7QUFFTyxlQUFlSSxrQkFBa0JDLE9BQWUsRUFBRVgsS0FBYztJQUNyRSxJQUFJO1FBQ0YsTUFBTSxFQUFFWSxJQUFJLEVBQUUsR0FBRyxNQUFNcEMsTUFDckIsQ0FBQyxjQUFjLEVBQUVZLE9BQU9LLE1BQU0sQ0FBQzs7OzZCQUdSLENBQUMsRUFDeEI7WUFBQ2tCO1lBQVNYLFNBQVM7U0FBSztRQUUxQixPQUFPWTtJQUNULEVBQUUsT0FBT04sS0FBVTtRQUNqQixJQUFJQSxLQUFLQyxTQUFTLFNBQVM7WUFDekJDLFFBQVFDLElBQUksQ0FBQztZQUNiLE9BQU8sRUFBRTtRQUNYO1FBQ0EsTUFBTUg7SUFDUjtBQUNGO0FBRUEsNkRBQTZELEdBQ3RELGVBQWVPLHFCQUFxQkMsR0FlMUM7SUFDQyxNQUFNQyxJQUFJLENBQUM7Z0JBQ0csRUFBRTNCLE9BQU9PLFNBQVMsQ0FBQzs7Ozs7Ozs7O0VBU2pDLENBQUM7SUFDRCxJQUFJO1FBQ0YsTUFBTW5CLE1BQU11QyxHQUFHO1lBQ2JELElBQUlFLGNBQWM7WUFDbEJGLElBQUlHLFFBQVE7WUFDWkgsSUFBSUksT0FBTztZQUNYSixJQUFJSyxRQUFRLElBQUk7WUFDaEJMLElBQUlNLFNBQVMsSUFBSTtZQUNqQk4sSUFBSU8sV0FBVztZQUNmUCxJQUFJUSxTQUFTO1lBQ2JSLElBQUlTLFFBQVE7WUFDWlQsSUFBSVUsTUFBTTtZQUNWVixJQUFJVyxlQUFlO1lBQ25CWCxJQUFJWSxhQUFhO1lBQ2pCWixJQUFJYSxRQUFRLElBQUk7WUFDaEJiLElBQUljLE9BQU87WUFDWGQsSUFBSWUsS0FBSyxJQUFJO1NBQ2Q7SUFDSCxFQUFFLE9BQU92QixLQUFVO1FBQ2pCLElBQUlBLEtBQUtDLFNBQVMsU0FBUztZQUN6QkMsUUFBUUMsSUFBSSxDQUFDO1lBQ2I7UUFDRjtRQUNBLE1BQU1IO0lBQ1I7QUFDRjtBQUVPLGVBQWV3QixpQkFDcEJkLGNBQXNCLEVBQ3RCZSxJQUEwQztJQUUxQyxNQUFNLEVBQUVuQixJQUFJLEVBQUUsR0FBRyxNQUFNcEMsTUFDckIsQ0FBQyxjQUFjLEVBQUVZLE9BQU9PLFNBQVMsQ0FBQzs7OztjQUl4QixDQUFDLEVBQ1g7UUFBQ3FCO1FBQWdCZSxNQUFNQyxVQUFVO1FBQU1ELE1BQU1FLFNBQVM7S0FBSTtJQUU1RCxPQUFPckI7QUFDVCIsInNvdXJjZXMiOlsiSDpcXFVzZXJzXFxHdXNcXHNvdXJjZVxccmVwb1xcZHluYW1pY3NcXGR5bmFtaWNzLWJcXGNyeXB0b3BpLWR5bmFtaWNzXFxzcmNcXGNvcmVcXGRiXFxwb29sX3NlcnZlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQb29sLCB0eXBlIFBvb2xDbGllbnQsIHR5cGUgUXVlcnlSZXN1bHQsIHR5cGUgUXVlcnlSZXN1bHRSb3cgfSBmcm9tIFwicGdcIjtcblxuLyoqXG4gKiBVbmlmaWVkIFBHIHBvb2wgKyBjb252ZW5pZW5jZSBoZWxwZXJzICsgbGlnaHR3ZWlnaHQgbGVkZ2Vycy5cbiAqIFRoaXMgcmVwbGFjZXMgdGhlIG9sZCBwb29sL3NlcnZlci9sZWRnZXIgdHJpbyB3aXRoIGEgc2luZ2xlIHNvdXJjZSBvZiB0cnV0aC5cbiAqL1xuXG4vKiDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAgRW52aXJvbm1lbnQgaGVscGVycyDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAgKi9cbmZ1bmN0aW9uIGFzQm9vbCh2OiB1bmtub3duLCBmYWxsYmFjayA9IGZhbHNlKTogYm9vbGVhbiB7XG4gIGlmICh2ID09IG51bGwpIHJldHVybiBmYWxsYmFjaztcbiAgY29uc3QgcyA9IFN0cmluZyh2KS50cmltKCkudG9Mb3dlckNhc2UoKTtcbiAgcmV0dXJuIHMgPT09IFwiMVwiIHx8IHMgPT09IFwidHJ1ZVwiIHx8IHMgPT09IFwieWVzXCIgfHwgcyA9PT0gXCJvblwiO1xufVxuXG4vKiDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAgUG9vbCBjb25maWd1cmF0aW9uIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCAqL1xuY29uc3QgdXNlVXJsID0gISFwcm9jZXNzLmVudi5EQVRBQkFTRV9VUkw7XG5jb25zdCBiYXNlQ29uZmlnID0gdXNlVXJsXG4gID8geyBjb25uZWN0aW9uU3RyaW5nOiBTdHJpbmcocHJvY2Vzcy5lbnYuREFUQUJBU0VfVVJMKSB9XG4gIDoge1xuICAgICAgaG9zdDogU3RyaW5nKHByb2Nlc3MuZW52LlBHSE9TVCA/PyBcImxvY2FsaG9zdFwiKSxcbiAgICAgIHBvcnQ6IE51bWJlcihwcm9jZXNzLmVudi5QR1BPUlQgPz8gMTAyNiksXG4gICAgICB1c2VyOiBTdHJpbmcocHJvY2Vzcy5lbnYuUEdVU0VSID8/IFwicG9zdGdyZXNcIiksXG4gICAgICBwYXNzd29yZDogU3RyaW5nKHByb2Nlc3MuZW52LlBHUEFTU1dPUkQgPz8gXCJndXNcIiksXG4gICAgICBkYXRhYmFzZTogU3RyaW5nKHByb2Nlc3MuZW52LlBHREFUQUJBU0UgPz8gXCJjcnlwdG9waWVcIiksXG4gICAgfTtcblxuY29uc3QgcG9vbENvbmZpZyA9IHtcbiAgLi4uYmFzZUNvbmZpZyxcbiAgbWF4OiBOdW1iZXIocHJvY2Vzcy5lbnYuREJfUE9PTF9NQVggPz8gcHJvY2Vzcy5lbnYuUEdQT09MX01BWCA/PyAxMCksXG4gIGlkbGVUaW1lb3V0TWlsbGlzOiBOdW1iZXIocHJvY2Vzcy5lbnYuREJfSURMRV9NUyA/PyA0NV8wMDApLFxuICBjb25uZWN0aW9uVGltZW91dE1pbGxpczogTnVtYmVyKHByb2Nlc3MuZW52LkRCX0NPTk5fVElNRU9VVF9NUyA/PyA1XzAwMCksXG4gIHNzbDogYXNCb29sKHByb2Nlc3MuZW52LkRCX1NTTCA/PyBwcm9jZXNzLmVudi5QR1NTTClcbiAgICA/IHsgcmVqZWN0VW5hdXRob3JpemVkOiBmYWxzZSBhcyBjb25zdCB9XG4gICAgOiB1bmRlZmluZWQsXG59O1xuXG5jb25zdCBTRVNTSU9OX1NUQVRFTUVOVF9USU1FT1VUID0gTnVtYmVyKHByb2Nlc3MuZW52LkRCX1NUQVRFTUVOVF9USU1FT1VUX01TID8/IDE1XzAwMCk7XG5jb25zdCBTRVNTSU9OX0lETEVfVFhfVElNRU9VVCA9IE51bWJlcihwcm9jZXNzLmVudi5EQl9JRExFX1RYX1RJTUVPVVRfTVMgPz8gMTVfMDAwKTtcbmNvbnN0IFNFU1NJT05fVFogPSBTdHJpbmcocHJvY2Vzcy5lbnYuREJfVElNRVpPTkUgPz8gXCJVVENcIikucmVwbGFjZSgvJy9nLCBcIicnXCIpO1xuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VBUkNIX1BBVEggPSBbXG4gIFwic2V0dGluZ3NcIixcbiAgXCJtYXJrZXRcIixcbiAgXCJkb2NzXCIsXG4gIFwibWF0cmljZXNcIixcbiAgXCJzdHJfYXV4XCIsXG4gIFwiY2luX2F1eFwiLFxuICBcIm1lYV9keW5hbWljc1wiLFxuICBcImluZ2VzdFwiLFxuICBcIm9wc1wiLFxuICBcInB1YmxpY1wiLFxuXS5qb2luKFwiLCBcIik7XG5cbi8qIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCBQb29sIHNpbmdsZXRvbiDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAgKi9cbmRlY2xhcmUgZ2xvYmFsIHtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXZhclxuICB2YXIgX19jb3JlX3BnX3Bvb2xfXzogUG9vbCB8IHVuZGVmaW5lZDtcbn1cblxuZnVuY3Rpb24gZW5zdXJlUG9vbCgpOiBQb29sIHtcbiAgaWYgKCFnbG9iYWwuX19jb3JlX3BnX3Bvb2xfXykge1xuICAgIGNvbnN0IHBvb2wgPSBuZXcgUG9vbChwb29sQ29uZmlnIGFzIGFueSk7XG4gICAgcG9vbC5vbihcImNvbm5lY3RcIiwgKGNsaWVudDogUG9vbENsaWVudCkgPT4ge1xuICAgICAgY29uc3QgYm9vdHN0cmFwID0gW1xuICAgICAgICBgU0VUIHN0YXRlbWVudF90aW1lb3V0ID0gJHtTRVNTSU9OX1NUQVRFTUVOVF9USU1FT1VUfWAsXG4gICAgICAgIGBTRVQgaWRsZV9pbl90cmFuc2FjdGlvbl9zZXNzaW9uX3RpbWVvdXQgPSAke1NFU1NJT05fSURMRV9UWF9USU1FT1VUfWAsXG4gICAgICAgIGBTRVQgVElNRSBaT05FICcke1NFU1NJT05fVFp9J2AsXG4gICAgICAgIGBTRVQgc2VhcmNoX3BhdGggPSAke0RFRkFVTFRfU0VBUkNIX1BBVEh9YCxcbiAgICAgIF07XG4gICAgICBmb3IgKGNvbnN0IHN0YXRlbWVudCBvZiBib290c3RyYXApIHtcbiAgICAgICAgdm9pZCBjbGllbnQucXVlcnkoc3RhdGVtZW50KS5jYXRjaCgoKSA9PiB7XG4gICAgICAgICAgLyogaWdub3JlIGJvb3RzdHJhcCBmYWlsdXJlcyBzbyB0aGUgcG9vbCBzdGF5cyB1c2FibGUgKi9cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgZ2xvYmFsLl9fY29yZV9wZ19wb29sX18gPSBwb29sO1xuICB9XG4gIHJldHVybiBnbG9iYWwuX19jb3JlX3BnX3Bvb2xfXyE7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRQb29sKCk6IFBvb2wge1xuICByZXR1cm4gZW5zdXJlUG9vbCgpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGdldERiKCk6IFBvb2wge1xuICByZXR1cm4gZW5zdXJlUG9vbCgpO1xufVxuXG4vKiDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAgUXVlcnkgaGVscGVycyDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAgKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB3aXRoQ2xpZW50PFQ+KGZuOiAoY2xpZW50OiBQb29sQ2xpZW50KSA9PiBQcm9taXNlPFQ+KTogUHJvbWlzZTxUPiB7XG4gIGNvbnN0IGNsaWVudCA9IGF3YWl0IGVuc3VyZVBvb2woKS5jb25uZWN0KCk7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGF3YWl0IGZuKGNsaWVudCk7XG4gIH0gZmluYWxseSB7XG4gICAgY2xpZW50LnJlbGVhc2UoKTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcXVlcnk8VCBleHRlbmRzIFF1ZXJ5UmVzdWx0Um93ID0gUXVlcnlSZXN1bHRSb3c+KFxuICB0ZXh0OiBzdHJpbmcsXG4gIHBhcmFtcz86IGFueVtdLFxuKTogUHJvbWlzZTxRdWVyeVJlc3VsdDxUPj4ge1xuICByZXR1cm4gZW5zdXJlUG9vbCgpLnF1ZXJ5PFQ+KHRleHQsIHBhcmFtcyk7XG59XG5cbmV4cG9ydCBjb25zdCBkYjogUG9vbCA9IGVuc3VyZVBvb2woKTtcbmV4cG9ydCBjb25zdCBzZXJ2ZXJEYiA9IHtcbiAgcXVlcnk8VCA9IGFueT4odGV4dDogc3RyaW5nLCBwYXJhbXM/OiBhbnlbXSkge1xuICAgIHJldHVybiBlbnN1cmVQb29sKCkucXVlcnk8VD4odGV4dCwgcGFyYW1zKTtcbiAgfSxcbn07XG5cbi8qIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCBUYWJsZSBjb25zdGFudHMg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAICovXG5leHBvcnQgY29uc3QgVEFCTEVTID0ge1xuICBtYXRyaWNlczogcHJvY2Vzcy5lbnYuTUFUUklYX1RBQkxFIHx8IFwibWF0cmljZXMuZHluX3ZhbHVlc1wiLFxuICBtYXRyaWNlc1N0YWdlOiBwcm9jZXNzLmVudi5NQVRSSVhfU1RBR0VfVEFCTEUgfHwgXCJtYXRyaWNlcy5keW5fdmFsdWVzX3N0YWdlXCIsXG4gIGxlZGdlcjogcHJvY2Vzcy5lbnYuQVBQX0xFREdFUl9UQUJMRSB8fCBcIm9wcy5hcHBfbGVkZ2VyXCIsXG4gIHRyYW5zZmVyczogcHJvY2Vzcy5lbnYuVFJBTlNGRVJfTEVER0VSX1RBQkxFIHx8IFwib3BzLnRyYW5zZmVyX2xlZGdlclwiLFxufSBhcyBjb25zdDtcblxuLyog4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAIExlZGdlciBoZWxwZXJzIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCAqL1xuZXhwb3J0IHR5cGUgQXBwTGVkZ2VyRXZlbnQgPSB7XG4gIHRvcGljOiBzdHJpbmc7ICAgICAgICAgICAgICAvLyBlLmcuIFwicGlwZWxpbmVcIlxuICBldmVudDogc3RyaW5nOyAgICAgICAgICAgICAgLy8gZS5nLiBcImR5bl9tYXRyaXhfdXBzZXJ0XCJcbiAgcGF5bG9hZD86IHVua25vd247XG4gIHNlc3Npb25faWQ/OiBzdHJpbmc7XG4gIGlkZW1wb3RlbmN5X2tleT86IHN0cmluZztcbiAgdHNfZXBvY2hfbXM6IG51bWJlcjtcbn07XG5cbi8qKiBTYWZlIGluc2VydDsgaWdub3JlcyBtaXNzaW5nIHRhYmxlIG9yIGR1cGxpY2F0ZSBrZXkuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXBwZW5kQXBwTGVkZ2VyKGU6IEFwcExlZGdlckV2ZW50KTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IHNxbCA9IGBcbiAgICBJTlNFUlQgSU5UTyAke1RBQkxFUy5sZWRnZXJ9XG4gICAgICAodG9waWMsIGV2ZW50LCBwYXlsb2FkLCBzZXNzaW9uX2lkLCBpZGVtcG90ZW5jeV9rZXksIHRzX2Vwb2NoX21zKVxuICAgIFZBTFVFUyAoJDEsJDIsJDMsJDQsJDUsJDYpXG4gICAgT04gQ09ORkxJQ1QgKGlkZW1wb3RlbmN5X2tleSkgRE8gTk9USElOR1xuICBgO1xuICB0cnkge1xuICAgIGF3YWl0IHF1ZXJ5KHNxbCwgW1xuICAgICAgZS50b3BpYyxcbiAgICAgIGUuZXZlbnQsXG4gICAgICBlLnBheWxvYWQgPz8gbnVsbCxcbiAgICAgIGUuc2Vzc2lvbl9pZCA/PyBudWxsLFxuICAgICAgZS5pZGVtcG90ZW5jeV9rZXkgPz8gbnVsbCxcbiAgICAgIGUudHNfZXBvY2hfbXMsXG4gICAgXSk7XG4gIH0gY2F0Y2ggKGVycjogYW55KSB7XG4gICAgaWYgKGVycj8uY29kZSA9PT0gXCI0MlAwMVwiKSB7XG4gICAgICBjb25zb2xlLndhcm4oXCJhcHBlbmRBcHBMZWRnZXI6IGxlZGdlciB0YWJsZSBtaXNzaW5nIChvcHMuYXBwX2xlZGdlcikuIFNraXBwaW5nIGxvZy5cIik7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRocm93IGVycjtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QXBwTGVkZ2VyU2luY2Uoc2luY2VNczogbnVtYmVyLCB0b3BpYz86IHN0cmluZykge1xuICB0cnkge1xuICAgIGNvbnN0IHsgcm93cyB9ID0gYXdhaXQgcXVlcnkoXG4gICAgICBgU0VMRUNUICogRlJPTSAke1RBQkxFUy5sZWRnZXJ9XG4gICAgICAgIFdIRVJFIHRzX2Vwb2NoX21zID49ICQxXG4gICAgICAgICAgQU5EICgkMjo6dGV4dCBJUyBOVUxMIE9SIHRvcGljID0gJDIpXG4gICAgIE9SREVSIEJZIHRzX2Vwb2NoX21zIEFTQ2AsXG4gICAgICBbc2luY2VNcywgdG9waWMgPz8gbnVsbF0sXG4gICAgKTtcbiAgICByZXR1cm4gcm93cztcbiAgfSBjYXRjaCAoZXJyOiBhbnkpIHtcbiAgICBpZiAoZXJyPy5jb2RlID09PSBcIjQyUDAxXCIpIHtcbiAgICAgIGNvbnNvbGUud2FybihcImdldEFwcExlZGdlclNpbmNlOiBsZWRnZXIgdGFibGUgbWlzc2luZyAob3BzLmFwcF9sZWRnZXIpLlwiKTtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gICAgdGhyb3cgZXJyO1xuICB9XG59XG5cbi8qIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCBUcmFuc2ZlciBsZWRnZXIgaGVscGVycyDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAgKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhcHBlbmRUcmFuc2ZlckxlZGdlcihyb3c6IHtcbiAgYXBwX3Nlc3Npb25faWQ6IHN0cmluZztcbiAgY3ljbGVfdHM6IG51bWJlcjtcbiAgbGVnX3NlcTogbnVtYmVyO1xuICByb3V0ZV9pZD86IHN0cmluZyB8IG51bGw7XG4gIGludGVudF9pZD86IHN0cmluZyB8IG51bGw7XG4gIGZyb21fc3ltYm9sOiBzdHJpbmc7XG4gIHRvX3N5bWJvbDogc3RyaW5nO1xuICBxdHlfZnJvbTogbnVtYmVyO1xuICBxdHlfdG86IG51bWJlcjtcbiAgcHJpY2VfZnJvbV91c2R0OiBudW1iZXI7XG4gIHByaWNlX3RvX3VzZHQ6IG51bWJlcjtcbiAgZmVlX3VzZHQ/OiBudW1iZXI7XG4gIGV4ZWNfdHM6IG51bWJlcjtcbiAgdHhfaWQ/OiBzdHJpbmcgfCBudWxsO1xufSk6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCBxID0gYFxuICAgIElOU0VSVCBJTlRPICR7VEFCTEVTLnRyYW5zZmVyc30gKFxuICAgICAgYXBwX3Nlc3Npb25faWQsIGN5Y2xlX3RzLCBsZWdfc2VxLCByb3V0ZV9pZCwgaW50ZW50X2lkLFxuICAgICAgZnJvbV9zeW1ib2wsIHRvX3N5bWJvbCwgcXR5X2Zyb20sIHF0eV90byxcbiAgICAgIHByaWNlX2Zyb21fdXNkdCwgcHJpY2VfdG9fdXNkdCwgZmVlX3VzZHQsIGV4ZWNfdHMsIHR4X2lkXG4gICAgKVxuICAgIFZBTFVFUyAoXG4gICAgICAkMSwkMiwkMywkNCwkNSwkNiwkNywkOCwkOSwkMTAsJDExLENPQUxFU0NFKCQxMiwwKSwkMTMsJDE0XG4gICAgKVxuICAgIE9OIENPTkZMSUNUIChhcHBfc2Vzc2lvbl9pZCwgY3ljbGVfdHMsIGxlZ19zZXEpIERPIE5PVEhJTkdcbiAgYDtcbiAgdHJ5IHtcbiAgICBhd2FpdCBxdWVyeShxLCBbXG4gICAgICByb3cuYXBwX3Nlc3Npb25faWQsXG4gICAgICByb3cuY3ljbGVfdHMsXG4gICAgICByb3cubGVnX3NlcSxcbiAgICAgIHJvdy5yb3V0ZV9pZCA/PyBudWxsLFxuICAgICAgcm93LmludGVudF9pZCA/PyBudWxsLFxuICAgICAgcm93LmZyb21fc3ltYm9sLFxuICAgICAgcm93LnRvX3N5bWJvbCxcbiAgICAgIHJvdy5xdHlfZnJvbSxcbiAgICAgIHJvdy5xdHlfdG8sXG4gICAgICByb3cucHJpY2VfZnJvbV91c2R0LFxuICAgICAgcm93LnByaWNlX3RvX3VzZHQsXG4gICAgICByb3cuZmVlX3VzZHQgPz8gMCxcbiAgICAgIHJvdy5leGVjX3RzLFxuICAgICAgcm93LnR4X2lkID8/IG51bGwsXG4gICAgXSk7XG4gIH0gY2F0Y2ggKGVycjogYW55KSB7XG4gICAgaWYgKGVycj8uY29kZSA9PT0gXCI0MlAwMVwiKSB7XG4gICAgICBjb25zb2xlLndhcm4oXCJhcHBlbmRUcmFuc2ZlckxlZGdlcjogdHJhbnNmZXJfbGVkZ2VyIHRhYmxlIG1pc3NpbmcgKG9wcy50cmFuc2Zlcl9sZWRnZXIpLlwiKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhyb3cgZXJyO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsaXN0VHJhbnNmZXJMZWdzKFxuICBhcHBfc2Vzc2lvbl9pZDogc3RyaW5nLFxuICBvcHRzPzogeyBiZWZvcmU/OiBudW1iZXI7IGxpbWl0PzogbnVtYmVyIH0sXG4pIHtcbiAgY29uc3QgeyByb3dzIH0gPSBhd2FpdCBxdWVyeShcbiAgICBgU0VMRUNUICogRlJPTSAke1RBQkxFUy50cmFuc2ZlcnN9XG4gICAgICBXSEVSRSBhcHBfc2Vzc2lvbl9pZCA9ICQxXG4gICAgICAgIEFORCAoJDI6OmJpZ2ludCBJUyBOVUxMIE9SIGN5Y2xlX3RzIDwgJDIpXG4gICBPUkRFUiBCWSBjeWNsZV90cyBERVNDLCBsZWdfc2VxIERFU0NcbiAgICAgIExJTUlUICQzYCxcbiAgICBbYXBwX3Nlc3Npb25faWQsIG9wdHM/LmJlZm9yZSA/PyBudWxsLCBvcHRzPy5saW1pdCA/PyAyMDBdLFxuICApO1xuICByZXR1cm4gcm93cztcbn1cblxuZXhwb3J0IHR5cGUgeyBQb29sLCBQb29sQ2xpZW50LCBRdWVyeVJlc3VsdCwgUXVlcnlSZXN1bHRSb3cgfTtcbiJdLCJuYW1lcyI6WyJQb29sIiwiYXNCb29sIiwidiIsImZhbGxiYWNrIiwicyIsIlN0cmluZyIsInRyaW0iLCJ0b0xvd2VyQ2FzZSIsInVzZVVybCIsInByb2Nlc3MiLCJlbnYiLCJEQVRBQkFTRV9VUkwiLCJiYXNlQ29uZmlnIiwiY29ubmVjdGlvblN0cmluZyIsImhvc3QiLCJQR0hPU1QiLCJwb3J0IiwiTnVtYmVyIiwiUEdQT1JUIiwidXNlciIsIlBHVVNFUiIsInBhc3N3b3JkIiwiUEdQQVNTV09SRCIsImRhdGFiYXNlIiwiUEdEQVRBQkFTRSIsInBvb2xDb25maWciLCJtYXgiLCJEQl9QT09MX01BWCIsIlBHUE9PTF9NQVgiLCJpZGxlVGltZW91dE1pbGxpcyIsIkRCX0lETEVfTVMiLCJjb25uZWN0aW9uVGltZW91dE1pbGxpcyIsIkRCX0NPTk5fVElNRU9VVF9NUyIsInNzbCIsIkRCX1NTTCIsIlBHU1NMIiwicmVqZWN0VW5hdXRob3JpemVkIiwidW5kZWZpbmVkIiwiU0VTU0lPTl9TVEFURU1FTlRfVElNRU9VVCIsIkRCX1NUQVRFTUVOVF9USU1FT1VUX01TIiwiU0VTU0lPTl9JRExFX1RYX1RJTUVPVVQiLCJEQl9JRExFX1RYX1RJTUVPVVRfTVMiLCJTRVNTSU9OX1RaIiwiREJfVElNRVpPTkUiLCJyZXBsYWNlIiwiREVGQVVMVF9TRUFSQ0hfUEFUSCIsImpvaW4iLCJlbnN1cmVQb29sIiwiZ2xvYmFsIiwiX19jb3JlX3BnX3Bvb2xfXyIsInBvb2wiLCJvbiIsImNsaWVudCIsImJvb3RzdHJhcCIsInN0YXRlbWVudCIsInF1ZXJ5IiwiY2F0Y2giLCJnZXRQb29sIiwiZ2V0RGIiLCJ3aXRoQ2xpZW50IiwiZm4iLCJjb25uZWN0IiwicmVsZWFzZSIsInRleHQiLCJwYXJhbXMiLCJkYiIsInNlcnZlckRiIiwiVEFCTEVTIiwibWF0cmljZXMiLCJNQVRSSVhfVEFCTEUiLCJtYXRyaWNlc1N0YWdlIiwiTUFUUklYX1NUQUdFX1RBQkxFIiwibGVkZ2VyIiwiQVBQX0xFREdFUl9UQUJMRSIsInRyYW5zZmVycyIsIlRSQU5TRkVSX0xFREdFUl9UQUJMRSIsImFwcGVuZEFwcExlZGdlciIsImUiLCJzcWwiLCJ0b3BpYyIsImV2ZW50IiwicGF5bG9hZCIsInNlc3Npb25faWQiLCJpZGVtcG90ZW5jeV9rZXkiLCJ0c19lcG9jaF9tcyIsImVyciIsImNvZGUiLCJjb25zb2xlIiwid2FybiIsImdldEFwcExlZGdlclNpbmNlIiwic2luY2VNcyIsInJvd3MiLCJhcHBlbmRUcmFuc2ZlckxlZGdlciIsInJvdyIsInEiLCJhcHBfc2Vzc2lvbl9pZCIsImN5Y2xlX3RzIiwibGVnX3NlcSIsInJvdXRlX2lkIiwiaW50ZW50X2lkIiwiZnJvbV9zeW1ib2wiLCJ0b19zeW1ib2wiLCJxdHlfZnJvbSIsInF0eV90byIsInByaWNlX2Zyb21fdXNkdCIsInByaWNlX3RvX3VzZHQiLCJmZWVfdXNkdCIsImV4ZWNfdHMiLCJ0eF9pZCIsImxpc3RUcmFuc2ZlckxlZ3MiLCJvcHRzIiwiYmVmb3JlIiwibGltaXQiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/core/db/pool_server.ts\n");

/***/ }),

/***/ "(rsc)/./src/core/db/session.ts":
/*!********************************!*\
  !*** ./src/core/db/session.ts ***!
  \********************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   align: () => (/* binding */ align),\n/* harmony export */   createAppSession: () => (/* binding */ createAppSession),\n/* harmony export */   currentAppSession: () => (/* binding */ currentAppSession),\n/* harmony export */   endOfWindow: () => (/* binding */ endOfWindow),\n/* harmony export */   ensureCycle: () => (/* binding */ ensureCycle),\n/* harmony export */   ensureCyclesBetween: () => (/* binding */ ensureCyclesBetween),\n/* harmony export */   floorToPeriod: () => (/* binding */ floorToPeriod),\n/* harmony export */   formatWindow: () => (/* binding */ formatWindow),\n/* harmony export */   getLatestCycle: () => (/* binding */ getLatestCycle),\n/* harmony export */   listAppSessions: () => (/* binding */ listAppSessions),\n/* harmony export */   listWindowStarts: () => (/* binding */ listWindowStarts),\n/* harmony export */   nextWindowStart: () => (/* binding */ nextWindowStart),\n/* harmony export */   nowMs: () => (/* binding */ nowMs),\n/* harmony export */   parseDuration: () => (/* binding */ parseDuration),\n/* harmony export */   parseNowOrMs: () => (/* binding */ parseNowOrMs),\n/* harmony export */   prevWindowStart: () => (/* binding */ prevWindowStart),\n/* harmony export */   sql: () => (/* binding */ sql),\n/* harmony export */   startOfWindow: () => (/* binding */ startOfWindow),\n/* harmony export */   stepIndexSince: () => (/* binding */ stepIndexSince),\n/* harmony export */   toMs: () => (/* binding */ toMs),\n/* harmony export */   useAppSession: () => (/* binding */ useAppSession),\n/* harmony export */   windowRange: () => (/* binding */ windowRange)\n/* harmony export */ });\n/* harmony import */ var _pool_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./pool_server */ \"(rsc)/./src/core/db/pool_server.ts\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_3__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pool_server__WEBPACK_IMPORTED_MODULE_0__]);\n_pool_server__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n// Session + timeframe utilities (shared across CLI/server) + lightweight SQL tag helper.\n\n\n\n\nfunction compileSql(strings, values) {\n    let text = \"\";\n    const params = [];\n    for(let i = 0; i < strings.length; i++){\n        text += strings[i];\n        if (i < values.length) {\n            params.push(values[i]);\n            text += `$${params.length}`;\n        }\n    }\n    return {\n        text,\n        params\n    };\n}\nasync function runSqlTag(strings, values) {\n    const { text, params } = compileSql(strings, values);\n    const res = await (0,_pool_server__WEBPACK_IMPORTED_MODULE_0__.getPool)().query(text, params);\n    return res.rows;\n}\nconst sql = Object.assign(async function sql(strings, ...values) {\n    return runSqlTag(strings, values);\n}, {\n    begin: async (fn)=>{\n        return (0,_pool_server__WEBPACK_IMPORTED_MODULE_0__.withClient)(async (client)=>{\n            await client.query(\"BEGIN\");\n            try {\n                const tx = async (strings, ...values)=>{\n                    const { text, params } = compileSql(strings, values);\n                    const res = await client.query(text, params);\n                    return res.rows;\n                };\n                const result = await fn(tx);\n                await client.query(\"COMMIT\");\n                return result;\n            } catch (err) {\n                await client.query(\"ROLLBACK\");\n                throw err;\n            }\n        });\n    }\n});\n/** Parse \"1h30m15s\", \"45m\", \"3500ms\" (case-insensitive). Numbers are treated as ms. */ function parseDuration(input) {\n    if (typeof input === \"number\" && Number.isFinite(input)) return Math.max(0, Math.floor(input));\n    const s = String(input).trim().toLowerCase();\n    if (/^\\d+$/.test(s)) return parseInt(s, 10); // plain ms\n    const re = /(-?\\d+(?:\\.\\d+)?)(ms|s|m|h|d)/g;\n    let m, total = 0;\n    while(m = re.exec(s)){\n        const v = parseFloat(m[1]);\n        const u = m[2];\n        if (u === \"ms\") total += v;\n        else if (u === \"s\") total += v * 1000;\n        else if (u === \"m\") total += v * 60000;\n        else if (u === \"h\") total += v * 3600000;\n        else if (u === \"d\") total += v * 86400000;\n    }\n    return Math.max(0, Math.floor(total));\n}\n/** Canonical pretty formatter for common windows; else returns e.g. \"900000ms\". */ function formatWindow(ms) {\n    const map = {\n        1000: \"1s\",\n        5000: \"5s\",\n        15000: \"15s\",\n        30000: \"30s\",\n        60000: \"1m\",\n        300000: \"5m\",\n        900000: \"15m\",\n        1800000: \"30m\",\n        3600000: \"1h\",\n        7200000: \"2h\",\n        14400000: \"4h\",\n        86400000: \"1d\"\n    };\n    return map[ms] ?? `${ms}ms`;\n}\nfunction toMs(w) {\n    return parseDuration(w);\n}\n/*  Window alignment  */ function startOfWindow(ts, w) {\n    const ms = toMs(w) || 1;\n    return Math.floor(ts / ms) * ms;\n}\nfunction endOfWindow(ts, w) {\n    const ms = toMs(w) || 1;\n    return Math.ceil(ts / ms) * ms;\n}\nfunction align(ts, w, mode = \"floor\") {\n    const ms = toMs(w) || 1;\n    if (mode === \"ceil\") return Math.ceil(ts / ms) * ms;\n    if (mode === \"round\") return Math.round(ts / ms) * ms;\n    return Math.floor(ts / ms) * ms;\n}\nfunction prevWindowStart(ts, w) {\n    const ms = toMs(w) || 1;\n    return startOfWindow(ts, ms) - ms;\n}\nfunction nextWindowStart(ts, w) {\n    const ms = toMs(w) || 1;\n    return endOfWindow(ts, ms);\n}\nfunction windowRange(ts, w) {\n    const s = startOfWindow(ts, w);\n    const ms = toMs(w) || 1;\n    return {\n        start: s,\n        end: s + ms\n    };\n}\nfunction listWindowStarts(startTs, endTs, w) {\n    const ms = toMs(w) || 1;\n    const first = startOfWindow(startTs, ms);\n    const out = [];\n    for(let t = first; t < endTs; t += ms)out.push(t);\n    return out;\n}\nfunction stepIndexSince(epochStart, ts, w) {\n    const ms = toMs(w) || 1;\n    return Math.max(0, Math.floor((ts - epochStart) / ms));\n}\n/*  Cycles (DB-backed)  */ function floorToPeriod(ts, period) {\n    const ms = toMs(period) || 1;\n    return Math.floor(ts / ms) * ms;\n}\nasync function ensureCycle(cycleTs) {\n    await _pool_server__WEBPACK_IMPORTED_MODULE_0__.db.query(`INSERT INTO cycles (cycle_ts) VALUES ($1)\n       ON CONFLICT (cycle_ts) DO NOTHING`, [\n        cycleTs\n    ]);\n}\nasync function ensureCyclesBetween(fromTs, toTs, period) {\n    const ms = toMs(period) || 1;\n    const start = floorToPeriod(fromTs, ms);\n    const end = floorToPeriod(toTs, ms);\n    const values = [];\n    for(let t = start; t <= end; t += ms)values.push(t);\n    if (!values.length) return 0;\n    // bulk insert in one statement\n    const params = values.map((_, i)=>`($${i + 1})`).join(\",\");\n    await _pool_server__WEBPACK_IMPORTED_MODULE_0__.db.query(`INSERT INTO cycles (cycle_ts) VALUES ${params}\n       ON CONFLICT (cycle_ts) DO NOTHING`, values);\n    return values.length;\n}\nasync function getLatestCycle() {\n    const { rows } = await _pool_server__WEBPACK_IMPORTED_MODULE_0__.db.query(`SELECT cycle_ts FROM cycles ORDER BY cycle_ts DESC LIMIT 1`);\n    return rows.length ? Number(rows[0].cycle_ts) : null;\n}\nconst SESSION_FILE = (0,path__WEBPACK_IMPORTED_MODULE_2__.resolve)(process.cwd(), \"var\", \"current-session.json\");\nfunction ensureSessionFileDir() {\n    (0,fs__WEBPACK_IMPORTED_MODULE_1__.mkdirSync)((0,path__WEBPACK_IMPORTED_MODULE_2__.dirname)(SESSION_FILE), {\n        recursive: true\n    });\n}\nfunction newSessionId() {\n    const rnd = (0,crypto__WEBPACK_IMPORTED_MODULE_3__.randomBytes)(4).toString(\"hex\");\n    return `sess_${Date.now()}_${rnd}`;\n}\n/** Create a new app session row (or ensure an existing id). Returns id. */ async function createAppSession(id) {\n    const sid = id ?? newSessionId();\n    await _pool_server__WEBPACK_IMPORTED_MODULE_0__.db.query(`INSERT INTO app_sessions (app_session_id) VALUES ($1)\n       ON CONFLICT (app_session_id) DO NOTHING`, [\n        sid\n    ]);\n    return sid;\n}\n/** Mark an id as the current CLI/default session (saved to var/current-session.json). */ function useAppSession(id) {\n    ensureSessionFileDir();\n    (0,fs__WEBPACK_IMPORTED_MODULE_1__.writeFileSync)(SESSION_FILE, JSON.stringify({\n        id\n    }, null, 2), \"utf8\");\n}\n/** Read current CLI/default session id (ENV wins). */ function currentAppSession() {\n    if (process.env.APP_SESSION_ID) return String(process.env.APP_SESSION_ID);\n    if (!(0,fs__WEBPACK_IMPORTED_MODULE_1__.existsSync)(SESSION_FILE)) return null;\n    try {\n        const j = JSON.parse((0,fs__WEBPACK_IMPORTED_MODULE_1__.readFileSync)(SESSION_FILE, \"utf8\"));\n        return typeof j?.id === \"string\" ? j.id : null;\n    } catch  {\n        return null;\n    }\n}\n/** List most recent app sessions for selection UIs. */ async function listAppSessions(limit = 50) {\n    const { rows } = await _pool_server__WEBPACK_IMPORTED_MODULE_0__.db.query(`SELECT app_session_id, started_at\n       FROM app_sessions\n   ORDER BY started_at DESC\n      LIMIT $1`, [\n        limit\n    ]);\n    return rows;\n}\n/*  Convenience helpers  */ function nowMs() {\n    return Date.now();\n}\nfunction parseNowOrMs(s) {\n    if (!s || s === \"now\") return Date.now();\n    const n = Number(s);\n    if (Number.isFinite(n)) return n;\n    return parseDuration(s); // allow \"5m\" here too\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ZHluYW1pY3NcXGR5bmFtaWNzLWJcXGNyeXB0b3BpLWR5bmFtaWNzXFxzcmNcXGNvcmVcXGRiXFxzZXNzaW9uLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFNlc3Npb24gKyB0aW1lZnJhbWUgdXRpbGl0aWVzIChzaGFyZWQgYWNyb3NzIENMSS9zZXJ2ZXIpICsgbGlnaHR3ZWlnaHQgU1FMIHRhZyBoZWxwZXIuXG5cbmltcG9ydCB0eXBlIHsgUXVlcnlSZXN1bHQgfSBmcm9tIFwicGdcIjtcbmltcG9ydCB7IGRiLCBnZXRQb29sLCB3aXRoQ2xpZW50IH0gZnJvbSBcIi4vcG9vbF9zZXJ2ZXJcIjtcbmltcG9ydCB7IG1rZGlyU3luYywgZXhpc3RzU3luYywgcmVhZEZpbGVTeW5jLCB3cml0ZUZpbGVTeW5jIH0gZnJvbSBcImZzXCI7XG5pbXBvcnQgeyByZXNvbHZlLCBkaXJuYW1lIH0gZnJvbSBcInBhdGhcIjtcbmltcG9ydCB7IHJhbmRvbUJ5dGVzIH0gZnJvbSBcImNyeXB0b1wiO1xuXG4vKiDvv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv70gVGFnZ2VkIFNRTCBoZWxwZXIg77+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+9ICovXG5cbnR5cGUgU3FsVHJhbnNhY3Rpb25UYWcgPSA8VCA9IGFueT4oXG4gIHN0cmluZ3M6IFRlbXBsYXRlU3RyaW5nc0FycmF5LFxuICAuLi52YWx1ZXM6IGFueVtdXG4pID0+IFByb21pc2U8VFtdPjtcblxuZXhwb3J0IGludGVyZmFjZSBTcWxUYWcgZXh0ZW5kcyBTcWxUcmFuc2FjdGlvblRhZyB7XG4gIGJlZ2luPFQ+KGZuOiAodHg6IFNxbFRyYW5zYWN0aW9uVGFnKSA9PiBQcm9taXNlPFQ+KTogUHJvbWlzZTxUPjtcbn1cblxuZnVuY3Rpb24gY29tcGlsZVNxbChzdHJpbmdzOiBUZW1wbGF0ZVN0cmluZ3NBcnJheSwgdmFsdWVzOiBhbnlbXSkge1xuICBsZXQgdGV4dCA9IFwiXCI7XG4gIGNvbnN0IHBhcmFtczogYW55W10gPSBbXTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdHJpbmdzLmxlbmd0aDsgaSsrKSB7XG4gICAgdGV4dCArPSBzdHJpbmdzW2ldO1xuICAgIGlmIChpIDwgdmFsdWVzLmxlbmd0aCkge1xuICAgICAgcGFyYW1zLnB1c2godmFsdWVzW2ldKTtcbiAgICAgIHRleHQgKz0gYCQke3BhcmFtcy5sZW5ndGh9YDtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHsgdGV4dCwgcGFyYW1zIH07XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHJ1blNxbFRhZzxUPihcbiAgc3RyaW5nczogVGVtcGxhdGVTdHJpbmdzQXJyYXksXG4gIHZhbHVlczogYW55W11cbik6IFByb21pc2U8VFtdPiB7XG4gIGNvbnN0IHsgdGV4dCwgcGFyYW1zIH0gPSBjb21waWxlU3FsKHN0cmluZ3MsIHZhbHVlcyk7XG4gIGNvbnN0IHJlczogUXVlcnlSZXN1bHQ8VD4gPSBhd2FpdCBnZXRQb29sKCkucXVlcnk8VD4odGV4dCwgcGFyYW1zKTtcbiAgcmV0dXJuIHJlcy5yb3dzO1xufVxuXG5leHBvcnQgY29uc3Qgc3FsID0gT2JqZWN0LmFzc2lnbihcbiAgYXN5bmMgZnVuY3Rpb24gc3FsPFQgPSBhbnk+KFxuICAgIHN0cmluZ3M6IFRlbXBsYXRlU3RyaW5nc0FycmF5LFxuICAgIC4uLnZhbHVlczogYW55W11cbiAgKTogUHJvbWlzZTxUW10+IHtcbiAgICByZXR1cm4gcnVuU3FsVGFnPFQ+KHN0cmluZ3MsIHZhbHVlcyk7XG4gIH0sXG4gIHtcbiAgICBiZWdpbjogYXN5bmMgPFQ+KGZuOiAodHg6IFNxbFRyYW5zYWN0aW9uVGFnKSA9PiBQcm9taXNlPFQ+KTogUHJvbWlzZTxUPiA9PiB7XG4gICAgICByZXR1cm4gd2l0aENsaWVudChhc3luYyAoY2xpZW50KSA9PiB7XG4gICAgICAgIGF3YWl0IGNsaWVudC5xdWVyeShcIkJFR0lOXCIpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHR4OiBTcWxUcmFuc2FjdGlvblRhZyA9IGFzeW5jIDxSID0gYW55PihcbiAgICAgICAgICAgIHN0cmluZ3M6IFRlbXBsYXRlU3RyaW5nc0FycmF5LFxuICAgICAgICAgICAgLi4udmFsdWVzOiBhbnlbXVxuICAgICAgICAgICk6IFByb21pc2U8UltdPiA9PiB7XG4gICAgICAgICAgICBjb25zdCB7IHRleHQsIHBhcmFtcyB9ID0gY29tcGlsZVNxbChzdHJpbmdzLCB2YWx1ZXMpO1xuICAgICAgICAgICAgY29uc3QgcmVzOiBRdWVyeVJlc3VsdDxSPiA9IGF3YWl0IGNsaWVudC5xdWVyeTxSPih0ZXh0LCBwYXJhbXMpO1xuICAgICAgICAgICAgcmV0dXJuIHJlcy5yb3dzO1xuICAgICAgICAgIH07XG4gICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZm4odHgpO1xuICAgICAgICAgIGF3YWl0IGNsaWVudC5xdWVyeShcIkNPTU1JVFwiKTtcbiAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICBhd2FpdCBjbGllbnQucXVlcnkoXCJST0xMQkFDS1wiKTtcbiAgICAgICAgICB0aHJvdyBlcnI7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0sXG4gIH1cbikgYXMgU3FsVGFnO1xuXG4vKiDvv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv70gRHVyYXRpb24gJiBXaW5kb3dzIO+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/vSAqL1xuXG5leHBvcnQgdHlwZSBXaW5kb3dMaWtlID0gc3RyaW5nIHwgbnVtYmVyOyAvLyBcIjMwc1wiLFwiNW1cIixcIjFoXCIsXCIxZFwiIG9yIG1zXG5cbi8qKiBQYXJzZSBcIjFoMzBtMTVzXCIsIFwiNDVtXCIsIFwiMzUwMG1zXCIgKGNhc2UtaW5zZW5zaXRpdmUpLiBOdW1iZXJzIGFyZSB0cmVhdGVkIGFzIG1zLiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlRHVyYXRpb24oaW5wdXQ6IFdpbmRvd0xpa2UpOiBudW1iZXIge1xuICBpZiAodHlwZW9mIGlucHV0ID09PSBcIm51bWJlclwiICYmIE51bWJlci5pc0Zpbml0ZShpbnB1dCkpIHJldHVybiBNYXRoLm1heCgwLCBNYXRoLmZsb29yKGlucHV0KSk7XG4gIGNvbnN0IHMgPSBTdHJpbmcoaW5wdXQpLnRyaW0oKS50b0xvd2VyQ2FzZSgpO1xuICBpZiAoL15cXGQrJC8udGVzdChzKSkgcmV0dXJuIHBhcnNlSW50KHMsIDEwKTsgLy8gcGxhaW4gbXNcbiAgY29uc3QgcmUgPSAvKC0/XFxkKyg/OlxcLlxcZCspPykobXN8c3xtfGh8ZCkvZztcbiAgbGV0IG06IFJlZ0V4cEV4ZWNBcnJheSB8IG51bGwsIHRvdGFsID0gMDtcbiAgd2hpbGUgKChtID0gcmUuZXhlYyhzKSkpIHtcbiAgICBjb25zdCB2ID0gcGFyc2VGbG9hdChtWzFdKTtcbiAgICBjb25zdCB1ID0gbVsyXTtcbiAgICBpZiAodSA9PT0gXCJtc1wiKSB0b3RhbCArPSB2O1xuICAgIGVsc2UgaWYgKHUgPT09IFwic1wiKSB0b3RhbCArPSB2ICogMV8wMDA7XG4gICAgZWxzZSBpZiAodSA9PT0gXCJtXCIpIHRvdGFsICs9IHYgKiA2MF8wMDA7XG4gICAgZWxzZSBpZiAodSA9PT0gXCJoXCIpIHRvdGFsICs9IHYgKiAzXzYwMF8wMDA7XG4gICAgZWxzZSBpZiAodSA9PT0gXCJkXCIpIHRvdGFsICs9IHYgKiA4Nl80MDBfMDAwO1xuICB9XG4gIHJldHVybiBNYXRoLm1heCgwLCBNYXRoLmZsb29yKHRvdGFsKSk7XG59XG5cbi8qKiBDYW5vbmljYWwgcHJldHR5IGZvcm1hdHRlciBmb3IgY29tbW9uIHdpbmRvd3M7IGVsc2UgcmV0dXJucyBlLmcuIFwiOTAwMDAwbXNcIi4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmb3JtYXRXaW5kb3cobXM6IG51bWJlcik6IHN0cmluZyB7XG4gIGNvbnN0IG1hcDogUmVjb3JkPG51bWJlciwgc3RyaW5nPiA9IHtcbiAgICAxXzAwMDogXCIxc1wiLCA1XzAwMDogXCI1c1wiLCAxNV8wMDA6IFwiMTVzXCIsIDMwXzAwMDogXCIzMHNcIixcbiAgICA2MF8wMDA6IFwiMW1cIiwgMzAwXzAwMDogXCI1bVwiLCA5MDBfMDAwOiBcIjE1bVwiLCAxXzgwMF8wMDA6IFwiMzBtXCIsXG4gICAgM182MDBfMDAwOiBcIjFoXCIsIDdfMjAwXzAwMDogXCIyaFwiLCAxNF80MDBfMDAwOiBcIjRoXCIsIDg2XzQwMF8wMDA6IFwiMWRcIlxuICB9O1xuICByZXR1cm4gbWFwW21zXSA/PyBgJHttc31tc2A7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB0b01zKHc6IFdpbmRvd0xpa2UpOiBudW1iZXIgeyByZXR1cm4gcGFyc2VEdXJhdGlvbih3KTsgfVxuXG4vKiDvv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv70gV2luZG93IGFsaWdubWVudCDvv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv73vv70gKi9cblxuZXhwb3J0IGZ1bmN0aW9uIHN0YXJ0T2ZXaW5kb3codHM6IG51bWJlciwgdzogV2luZG93TGlrZSk6IG51bWJlciB7XG4gIGNvbnN0IG1zID0gdG9Ncyh3KSB8fCAxO1xuICByZXR1cm4gTWF0aC5mbG9vcih0cyAvIG1zKSAqIG1zO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGVuZE9mV2luZG93KHRzOiBudW1iZXIsIHc6IFdpbmRvd0xpa2UpOiBudW1iZXIge1xuICBjb25zdCBtcyA9IHRvTXModykgfHwgMTtcbiAgcmV0dXJuIE1hdGguY2VpbCh0cyAvIG1zKSAqIG1zO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGFsaWduKHRzOiBudW1iZXIsIHc6IFdpbmRvd0xpa2UsIG1vZGU6IFwiZmxvb3JcInxcImNlaWxcInxcInJvdW5kXCIgPSBcImZsb29yXCIpOiBudW1iZXIge1xuICBjb25zdCBtcyA9IHRvTXModykgfHwgMTtcbiAgaWYgKG1vZGUgPT09IFwiY2VpbFwiKSByZXR1cm4gTWF0aC5jZWlsKHRzIC8gbXMpICogbXM7XG4gIGlmIChtb2RlID09PSBcInJvdW5kXCIpIHJldHVybiBNYXRoLnJvdW5kKHRzIC8gbXMpICogbXM7XG4gIHJldHVybiBNYXRoLmZsb29yKHRzIC8gbXMpICogbXM7XG59XG5leHBvcnQgZnVuY3Rpb24gcHJldldpbmRvd1N0YXJ0KHRzOiBudW1iZXIsIHc6IFdpbmRvd0xpa2UpOiBudW1iZXIge1xuICBjb25zdCBtcyA9IHRvTXModykgfHwgMTsgcmV0dXJuIHN0YXJ0T2ZXaW5kb3codHMsIG1zKSAtIG1zO1xufVxuZXhwb3J0IGZ1bmN0aW9uIG5leHRXaW5kb3dTdGFydCh0czogbnVtYmVyLCB3OiBXaW5kb3dMaWtlKTogbnVtYmVyIHtcbiAgY29uc3QgbXMgPSB0b01zKHcpIHx8IDE7IHJldHVybiBlbmRPZldpbmRvdyh0cywgbXMpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIHdpbmRvd1JhbmdlKHRzOiBudW1iZXIsIHc6IFdpbmRvd0xpa2UpOiB7IHN0YXJ0OiBudW1iZXI7IGVuZDogbnVtYmVyIH0ge1xuICBjb25zdCBzID0gc3RhcnRPZldpbmRvdyh0cywgdyk7IGNvbnN0IG1zID0gdG9Ncyh3KSB8fCAxOyByZXR1cm4geyBzdGFydDogcywgZW5kOiBzICsgbXMgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBsaXN0V2luZG93U3RhcnRzKHN0YXJ0VHM6IG51bWJlciwgZW5kVHM6IG51bWJlciwgdzogV2luZG93TGlrZSk6IG51bWJlcltdIHtcbiAgY29uc3QgbXMgPSB0b01zKHcpIHx8IDE7XG4gIGNvbnN0IGZpcnN0ID0gc3RhcnRPZldpbmRvdyhzdGFydFRzLCBtcyk7XG4gIGNvbnN0IG91dDogbnVtYmVyW10gPSBbXTtcbiAgZm9yIChsZXQgdCA9IGZpcnN0OyB0IDwgZW5kVHM7IHQgKz0gbXMpIG91dC5wdXNoKHQpO1xuICByZXR1cm4gb3V0O1xufVxuZXhwb3J0IGZ1bmN0aW9uIHN0ZXBJbmRleFNpbmNlKGVwb2NoU3RhcnQ6IG51bWJlciwgdHM6IG51bWJlciwgdzogV2luZG93TGlrZSk6IG51bWJlciB7XG4gIGNvbnN0IG1zID0gdG9Ncyh3KSB8fCAxO1xuICByZXR1cm4gTWF0aC5tYXgoMCwgTWF0aC5mbG9vcigodHMgLSBlcG9jaFN0YXJ0KSAvIG1zKSk7XG59XG5cbi8qIO+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/vSBDeWNsZXMgKERCLWJhY2tlZCkg77+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+9ICovXG5cbmV4cG9ydCBmdW5jdGlvbiBmbG9vclRvUGVyaW9kKHRzOiBudW1iZXIsIHBlcmlvZDogV2luZG93TGlrZSk6IG51bWJlciB7XG4gIGNvbnN0IG1zID0gdG9NcyhwZXJpb2QpIHx8IDE7XG4gIHJldHVybiBNYXRoLmZsb29yKHRzIC8gbXMpICogbXM7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBlbnN1cmVDeWNsZShjeWNsZVRzOiBudW1iZXIpOiBQcm9taXNlPHZvaWQ+IHtcbiAgYXdhaXQgZGIucXVlcnkoXG4gICAgYElOU0VSVCBJTlRPIGN5Y2xlcyAoY3ljbGVfdHMpIFZBTFVFUyAoJDEpXG4gICAgICAgT04gQ09ORkxJQ1QgKGN5Y2xlX3RzKSBETyBOT1RISU5HYCxcbiAgICBbY3ljbGVUc11cbiAgKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGVuc3VyZUN5Y2xlc0JldHdlZW4oZnJvbVRzOiBudW1iZXIsIHRvVHM6IG51bWJlciwgcGVyaW9kOiBXaW5kb3dMaWtlKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgY29uc3QgbXMgPSB0b01zKHBlcmlvZCkgfHwgMTtcbiAgY29uc3Qgc3RhcnQgPSBmbG9vclRvUGVyaW9kKGZyb21UcywgbXMpO1xuICBjb25zdCBlbmQgPSBmbG9vclRvUGVyaW9kKHRvVHMsIG1zKTtcbiAgY29uc3QgdmFsdWVzOiBudW1iZXJbXSA9IFtdO1xuICBmb3IgKGxldCB0ID0gc3RhcnQ7IHQgPD0gZW5kOyB0ICs9IG1zKSB2YWx1ZXMucHVzaCh0KTtcbiAgaWYgKCF2YWx1ZXMubGVuZ3RoKSByZXR1cm4gMDtcblxuICAvLyBidWxrIGluc2VydCBpbiBvbmUgc3RhdGVtZW50XG4gIGNvbnN0IHBhcmFtcyA9IHZhbHVlcy5tYXAoKF8sIGkpID0+IGAoJCR7aSArIDF9KWApLmpvaW4oXCIsXCIpO1xuICBhd2FpdCBkYi5xdWVyeShcbiAgICBgSU5TRVJUIElOVE8gY3ljbGVzIChjeWNsZV90cykgVkFMVUVTICR7cGFyYW1zfVxuICAgICAgIE9OIENPTkZMSUNUIChjeWNsZV90cykgRE8gTk9USElOR2AsXG4gICAgdmFsdWVzXG4gICk7XG4gIHJldHVybiB2YWx1ZXMubGVuZ3RoO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0TGF0ZXN0Q3ljbGUoKTogUHJvbWlzZTxudW1iZXIgfCBudWxsPiB7XG4gIGNvbnN0IHsgcm93cyB9ID0gYXdhaXQgZGIucXVlcnkoYFNFTEVDVCBjeWNsZV90cyBGUk9NIGN5Y2xlcyBPUkRFUiBCWSBjeWNsZV90cyBERVNDIExJTUlUIDFgKTtcbiAgcmV0dXJuIHJvd3MubGVuZ3RoID8gTnVtYmVyKHJvd3NbMF0uY3ljbGVfdHMpIDogbnVsbDtcbn1cblxuLyog77+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+9IEFwcCBTZXNzaW9uIFJlZ2lzdHJ5IO+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/vSAqL1xuXG5leHBvcnQgdHlwZSBBcHBTZXNzaW9uID0geyBhcHBfc2Vzc2lvbl9pZDogc3RyaW5nOyBzdGFydGVkX2F0OiBzdHJpbmcgfTtcblxuY29uc3QgU0VTU0lPTl9GSUxFID0gcmVzb2x2ZShwcm9jZXNzLmN3ZCgpLCBcInZhclwiLCBcImN1cnJlbnQtc2Vzc2lvbi5qc29uXCIpO1xuZnVuY3Rpb24gZW5zdXJlU2Vzc2lvbkZpbGVEaXIoKSB7IG1rZGlyU3luYyhkaXJuYW1lKFNFU1NJT05fRklMRSksIHsgcmVjdXJzaXZlOiB0cnVlIH0pOyB9XG5mdW5jdGlvbiBuZXdTZXNzaW9uSWQoKSB7XG4gIGNvbnN0IHJuZCA9IHJhbmRvbUJ5dGVzKDQpLnRvU3RyaW5nKFwiaGV4XCIpO1xuICByZXR1cm4gYHNlc3NfJHtEYXRlLm5vdygpfV8ke3JuZH1gO1xufVxuXG4vKiogQ3JlYXRlIGEgbmV3IGFwcCBzZXNzaW9uIHJvdyAob3IgZW5zdXJlIGFuIGV4aXN0aW5nIGlkKS4gUmV0dXJucyBpZC4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVBcHBTZXNzaW9uKGlkPzogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgY29uc3Qgc2lkID0gaWQgPz8gbmV3U2Vzc2lvbklkKCk7XG4gIGF3YWl0IGRiLnF1ZXJ5KFxuICAgIGBJTlNFUlQgSU5UTyBhcHBfc2Vzc2lvbnMgKGFwcF9zZXNzaW9uX2lkKSBWQUxVRVMgKCQxKVxuICAgICAgIE9OIENPTkZMSUNUIChhcHBfc2Vzc2lvbl9pZCkgRE8gTk9USElOR2AsXG4gICAgW3NpZF1cbiAgKTtcbiAgcmV0dXJuIHNpZDtcbn1cblxuLyoqIE1hcmsgYW4gaWQgYXMgdGhlIGN1cnJlbnQgQ0xJL2RlZmF1bHQgc2Vzc2lvbiAoc2F2ZWQgdG8gdmFyL2N1cnJlbnQtc2Vzc2lvbi5qc29uKS4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1c2VBcHBTZXNzaW9uKGlkOiBzdHJpbmcpIHtcbiAgZW5zdXJlU2Vzc2lvbkZpbGVEaXIoKTtcbiAgd3JpdGVGaWxlU3luYyhTRVNTSU9OX0ZJTEUsIEpTT04uc3RyaW5naWZ5KHsgaWQgfSwgbnVsbCwgMiksIFwidXRmOFwiKTtcbn1cblxuLyoqIFJlYWQgY3VycmVudCBDTEkvZGVmYXVsdCBzZXNzaW9uIGlkIChFTlYgd2lucykuICovXG5leHBvcnQgZnVuY3Rpb24gY3VycmVudEFwcFNlc3Npb24oKTogc3RyaW5nIHwgbnVsbCB7XG4gIGlmIChwcm9jZXNzLmVudi5BUFBfU0VTU0lPTl9JRCkgcmV0dXJuIFN0cmluZyhwcm9jZXNzLmVudi5BUFBfU0VTU0lPTl9JRCk7XG4gIGlmICghZXhpc3RzU3luYyhTRVNTSU9OX0ZJTEUpKSByZXR1cm4gbnVsbDtcbiAgdHJ5IHtcbiAgICBjb25zdCBqID0gSlNPTi5wYXJzZShyZWFkRmlsZVN5bmMoU0VTU0lPTl9GSUxFLCBcInV0ZjhcIikpO1xuICAgIHJldHVybiB0eXBlb2Ygaj8uaWQgPT09IFwic3RyaW5nXCIgPyBqLmlkIDogbnVsbDtcbiAgfSBjYXRjaCB7IHJldHVybiBudWxsOyB9XG59XG5cbi8qKiBMaXN0IG1vc3QgcmVjZW50IGFwcCBzZXNzaW9ucyBmb3Igc2VsZWN0aW9uIFVJcy4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsaXN0QXBwU2Vzc2lvbnMobGltaXQgPSA1MCk6IFByb21pc2U8QXBwU2Vzc2lvbltdPiB7XG4gIGNvbnN0IHsgcm93cyB9ID0gYXdhaXQgZGIucXVlcnkoXG4gICAgYFNFTEVDVCBhcHBfc2Vzc2lvbl9pZCwgc3RhcnRlZF9hdFxuICAgICAgIEZST00gYXBwX3Nlc3Npb25zXG4gICBPUkRFUiBCWSBzdGFydGVkX2F0IERFU0NcbiAgICAgIExJTUlUICQxYCxcbiAgICBbbGltaXRdXG4gICk7XG4gIHJldHVybiByb3dzIGFzIEFwcFNlc3Npb25bXTtcbn1cblxuLyog77+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+9IENvbnZlbmllbmNlIGhlbHBlcnMg77+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+977+9ICovXG5cbmV4cG9ydCBmdW5jdGlvbiBub3dNcygpIHsgcmV0dXJuIERhdGUubm93KCk7IH1cblxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlTm93T3JNcyhzPzogc3RyaW5nKTogbnVtYmVyIHtcbiAgaWYgKCFzIHx8IHMgPT09IFwibm93XCIpIHJldHVybiBEYXRlLm5vdygpO1xuICBjb25zdCBuID0gTnVtYmVyKHMpO1xuICBpZiAoTnVtYmVyLmlzRmluaXRlKG4pKSByZXR1cm4gbjtcbiAgcmV0dXJuIHBhcnNlRHVyYXRpb24ocyk7IC8vIGFsbG93IFwiNW1cIiBoZXJlIHRvb1xufVxuIl0sIm5hbWVzIjpbImRiIiwiZ2V0UG9vbCIsIndpdGhDbGllbnQiLCJta2RpclN5bmMiLCJleGlzdHNTeW5jIiwicmVhZEZpbGVTeW5jIiwid3JpdGVGaWxlU3luYyIsInJlc29sdmUiLCJkaXJuYW1lIiwicmFuZG9tQnl0ZXMiLCJjb21waWxlU3FsIiwic3RyaW5ncyIsInZhbHVlcyIsInRleHQiLCJwYXJhbXMiLCJpIiwibGVuZ3RoIiwicHVzaCIsInJ1blNxbFRhZyIsInJlcyIsInF1ZXJ5Iiwicm93cyIsInNxbCIsIk9iamVjdCIsImFzc2lnbiIsImJlZ2luIiwiZm4iLCJjbGllbnQiLCJ0eCIsInJlc3VsdCIsImVyciIsInBhcnNlRHVyYXRpb24iLCJpbnB1dCIsIk51bWJlciIsImlzRmluaXRlIiwiTWF0aCIsIm1heCIsImZsb29yIiwicyIsIlN0cmluZyIsInRyaW0iLCJ0b0xvd2VyQ2FzZSIsInRlc3QiLCJwYXJzZUludCIsInJlIiwibSIsInRvdGFsIiwiZXhlYyIsInYiLCJwYXJzZUZsb2F0IiwidSIsImZvcm1hdFdpbmRvdyIsIm1zIiwibWFwIiwidG9NcyIsInciLCJzdGFydE9mV2luZG93IiwidHMiLCJlbmRPZldpbmRvdyIsImNlaWwiLCJhbGlnbiIsIm1vZGUiLCJyb3VuZCIsInByZXZXaW5kb3dTdGFydCIsIm5leHRXaW5kb3dTdGFydCIsIndpbmRvd1JhbmdlIiwic3RhcnQiLCJlbmQiLCJsaXN0V2luZG93U3RhcnRzIiwic3RhcnRUcyIsImVuZFRzIiwiZmlyc3QiLCJvdXQiLCJ0Iiwic3RlcEluZGV4U2luY2UiLCJlcG9jaFN0YXJ0IiwiZmxvb3JUb1BlcmlvZCIsInBlcmlvZCIsImVuc3VyZUN5Y2xlIiwiY3ljbGVUcyIsImVuc3VyZUN5Y2xlc0JldHdlZW4iLCJmcm9tVHMiLCJ0b1RzIiwiXyIsImpvaW4iLCJnZXRMYXRlc3RDeWNsZSIsImN5Y2xlX3RzIiwiU0VTU0lPTl9GSUxFIiwicHJvY2VzcyIsImN3ZCIsImVuc3VyZVNlc3Npb25GaWxlRGlyIiwicmVjdXJzaXZlIiwibmV3U2Vzc2lvbklkIiwicm5kIiwidG9TdHJpbmciLCJEYXRlIiwibm93IiwiY3JlYXRlQXBwU2Vzc2lvbiIsImlkIiwic2lkIiwidXNlQXBwU2Vzc2lvbiIsIkpTT04iLCJzdHJpbmdpZnkiLCJjdXJyZW50QXBwU2Vzc2lvbiIsImVudiIsIkFQUF9TRVNTSU9OX0lEIiwiaiIsInBhcnNlIiwibGlzdEFwcFNlc3Npb25zIiwibGltaXQiLCJub3dNcyIsInBhcnNlTm93T3JNcyIsIm4iXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/core/db/session.ts\n");

/***/ }),

/***/ "(rsc)/./src/core/features/cin-aux/runtimeQueries.ts":
/*!*****************************************************!*\
  !*** ./src/core/features/cin-aux/runtimeQueries.ts ***!
  \*****************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   KNOWN_STABLE_QUOTES: () => (/* binding */ KNOWN_STABLE_QUOTES),\n/* harmony export */   fetchRuntimeAssets: () => (/* binding */ fetchRuntimeAssets),\n/* harmony export */   fetchRuntimeSessionSummary: () => (/* binding */ fetchRuntimeSessionSummary),\n/* harmony export */   fetchUniverseBaseAssets: () => (/* binding */ fetchUniverseBaseAssets),\n/* harmony export */   listRuntimeSessions: () => (/* binding */ listRuntimeSessions),\n/* harmony export */   mapRuntimeSessionRow: () => (/* binding */ mapRuntimeSessionRow)\n/* harmony export */ });\n/* harmony import */ var _core_db_db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/core/db/db */ \"(rsc)/./src/core/db/db.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_core_db_db__WEBPACK_IMPORTED_MODULE_0__]);\n_core_db_db__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\nconst STATUS_DRIFTED = 0.005;\nconst STATUS_BROKEN = 0.02;\nfunction asString(value, fallback = \"0\") {\n    if (value === null || value === undefined) return fallback;\n    return typeof value === \"string\" ? value : String(value);\n}\nfunction toNumber(value) {\n    const n = Number(value);\n    return Number.isFinite(n) ? n : 0;\n}\nfunction runtimeStatusFromDelta(deltaRatio) {\n    const ratio = Number(deltaRatio);\n    if (!Number.isFinite(ratio)) return \"balanced\";\n    const abs = Math.abs(ratio);\n    if (abs >= STATUS_BROKEN) return \"broken\";\n    if (abs >= STATUS_DRIFTED) return \"drifted\";\n    return \"balanced\";\n}\nfunction mapRuntimeSessionRow(row) {\n    return {\n        sessionId: Number(row.session_id),\n        windowLabel: row.window_label,\n        startedAt: row.started_at,\n        endedAt: row.ended_at,\n        closed: Boolean(row.closed),\n        imprintPrincipalChurnUsdt: asString(row.imprint_principal_churn_usdt),\n        imprintProfitChurnUsdt: asString(row.imprint_profit_churn_usdt),\n        imprintGeneratedProfitUsdt: asString(row.imprint_generated_profit_usdt ?? \"0\"),\n        imprintTraceSumUsdt: asString(row.imprint_trace_sum_usdt ?? \"0\"),\n        imprintDevrefSumUsdt: asString(row.imprint_devref_sum_usdt ?? \"0\"),\n        luggageTotalPrincipalUsdt: asString(row.luggage_total_principal_usdt),\n        luggageTotalProfitUsdt: asString(row.luggage_total_profit_usdt),\n        cinTotalMtmUsdt: row.cin_total_mtm_usdt != null ? asString(row.cin_total_mtm_usdt) : null,\n        refTotalUsdt: row.ref_total_usdt != null ? asString(row.ref_total_usdt) : null,\n        deltaUsdt: row.delta_usdt != null ? asString(row.delta_usdt) : null,\n        deltaRatio: row.delta_ratio != null ? asString(row.delta_ratio) : null,\n        status: runtimeStatusFromDelta(row.delta_ratio)\n    };\n}\nasync function fetchRuntimeSessionSummary(sessionId) {\n    const { rows } = await _core_db_db__WEBPACK_IMPORTED_MODULE_0__.db.query(`\n      SELECT s.*, recon.cin_total_mtm_usdt, recon.ref_total_usdt, recon.delta_usdt, recon.delta_ratio\n        FROM cin_aux.v_rt_session_summary s\n        LEFT JOIN cin_aux.v_rt_session_recon recon\n          ON recon.session_id = s.session_id\n       WHERE s.session_id = $1\n    `, [\n        sessionId\n    ]);\n    if (rows.length === 0) return null;\n    return mapRuntimeSessionRow(rows[0]);\n}\nasync function listRuntimeSessions() {\n    const { rows } = await _core_db_db__WEBPACK_IMPORTED_MODULE_0__.db.query(`\n      SELECT s.*, recon.cin_total_mtm_usdt, recon.ref_total_usdt, recon.delta_usdt, recon.delta_ratio\n        FROM cin_aux.v_rt_session_summary s\n        LEFT JOIN cin_aux.v_rt_session_recon recon\n          ON recon.session_id = s.session_id\n       ORDER BY s.started_at DESC\n    `);\n    return rows.map(mapRuntimeSessionRow);\n}\nasync function fetchRuntimeAssets(sessionId) {\n    const { rows } = await _core_db_db__WEBPACK_IMPORTED_MODULE_0__.db.query(`\n      SELECT\n        ap.*,\n        (cu.base_asset IS NOT NULL) AS in_universe,\n        ref.ref_usdt\n      FROM cin_aux.v_rt_asset_pnl ap\n      LEFT JOIN settings.coin_universe cu\n        ON cu.enabled = TRUE\n       AND cu.base_asset IS NOT NULL\n       AND UPPER(cu.base_asset) = UPPER(ap.asset_id)\n      LEFT JOIN cin_aux.rt_reference ref\n        ON ref.session_id = ap.session_id\n       AND UPPER(ref.asset_id) = UPPER(ap.asset_id)\n      WHERE ap.session_id = $1\n      ORDER BY ap.mtm_value_usdt DESC NULLS LAST, ap.asset_id ASC\n    `, [\n        sessionId\n    ]);\n    const totalMtm = rows.reduce((acc, row)=>acc + toNumber(row.mtm_value_usdt), 0);\n    return rows.map((row)=>{\n        const mtmValue = toNumber(row.mtm_value_usdt);\n        return {\n            sessionId: Number(row.session_id),\n            assetId: row.asset_id,\n            openingPrincipal: asString(row.opening_principal ?? \"0\"),\n            openingProfit: asString(row.opening_profit ?? \"0\"),\n            principalUsdt: asString(row.principal_usdt ?? \"0\"),\n            profitUsdt: asString(row.profit_usdt ?? \"0\"),\n            lastMarkTs: row.last_mark_ts,\n            priceUsdt: row.price_usdt != null ? asString(row.price_usdt) : null,\n            bulkUsdt: asString(row.bulk_usdt ?? \"0\"),\n            mtmValueUsdt: asString(row.mtm_value_usdt ?? \"0\"),\n            weightInPortfolio: totalMtm > 0 && Number.isFinite(mtmValue) ? mtmValue / totalMtm : null,\n            realizedPnlUsdt: row.realized_pnl_usdt != null ? asString(row.realized_pnl_usdt) : null,\n            inUniverse: Boolean(row.in_universe),\n            referenceUsdt: row.ref_usdt != null ? asString(row.ref_usdt) : null\n        };\n    });\n}\nconst KNOWN_STABLE_QUOTES = [\n    \"USDT\",\n    \"FDUSD\",\n    \"USDC\",\n    \"TUSD\",\n    \"BUSD\",\n    \"USD\",\n    \"BTC\",\n    \"ETH\",\n    \"BNB\"\n];\nasync function fetchUniverseBaseAssets() {\n    const { rows } = await _core_db_db__WEBPACK_IMPORTED_MODULE_0__.db.query(`\n      SELECT DISTINCT UPPER(asset) AS asset\n        FROM (\n          SELECT base_asset AS asset\n            FROM settings.coin_universe\n           WHERE enabled = TRUE AND base_asset IS NOT NULL\n          UNION ALL\n          SELECT quote_asset AS asset\n            FROM settings.coin_universe\n           WHERE enabled = TRUE AND quote_asset IS NOT NULL\n        ) scoped\n       WHERE asset IS NOT NULL\n    `);\n    const universe = new Set();\n    for (const row of rows){\n        if (row.asset) {\n            universe.add(row.asset);\n        }\n    }\n    for (const stable of KNOWN_STABLE_QUOTES){\n        universe.add(stable);\n    }\n    return universe;\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvY29yZS9mZWF0dXJlcy9jaW4tYXV4L3J1bnRpbWVRdWVyaWVzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBa0M7QUFPbEMsTUFBTUMsaUJBQWlCO0FBQ3ZCLE1BQU1DLGdCQUFnQjtBQUV0QixTQUFTQyxTQUFTQyxLQUFjLEVBQUVDLFdBQVcsR0FBRztJQUM5QyxJQUFJRCxVQUFVLFFBQVFBLFVBQVVFLFdBQVcsT0FBT0Q7SUFDbEQsT0FBTyxPQUFPRCxVQUFVLFdBQVdBLFFBQVFHLE9BQU9IO0FBQ3BEO0FBRUEsU0FBU0ksU0FBU0osS0FBYztJQUM5QixNQUFNSyxJQUFJQyxPQUFPTjtJQUNqQixPQUFPTSxPQUFPQyxRQUFRLENBQUNGLEtBQUtBLElBQUk7QUFDbEM7QUFFQSxTQUFTRyx1QkFBdUJDLFVBQW1CO0lBQ2pELE1BQU1DLFFBQVFKLE9BQU9HO0lBQ3JCLElBQUksQ0FBQ0gsT0FBT0MsUUFBUSxDQUFDRyxRQUFRLE9BQU87SUFDcEMsTUFBTUMsTUFBTUMsS0FBS0QsR0FBRyxDQUFDRDtJQUNyQixJQUFJQyxPQUFPYixlQUFlLE9BQU87SUFDakMsSUFBSWEsT0FBT2QsZ0JBQWdCLE9BQU87SUFDbEMsT0FBTztBQUNUO0FBRU8sU0FBU2dCLHFCQUFxQkMsR0FBUTtJQUMzQyxPQUFPO1FBQ0xDLFdBQVdULE9BQU9RLElBQUlFLFVBQVU7UUFDaENDLGFBQWFILElBQUlJLFlBQVk7UUFDN0JDLFdBQVdMLElBQUlNLFVBQVU7UUFDekJDLFNBQVNQLElBQUlRLFFBQVE7UUFDckJDLFFBQVFDLFFBQVFWLElBQUlTLE1BQU07UUFDMUJFLDJCQUEyQjFCLFNBQVNlLElBQUlZLDRCQUE0QjtRQUNwRUMsd0JBQXdCNUIsU0FBU2UsSUFBSWMseUJBQXlCO1FBQzlEQyw0QkFBNEI5QixTQUFTZSxJQUFJZ0IsNkJBQTZCLElBQUk7UUFDMUVDLHFCQUFxQmhDLFNBQVNlLElBQUlrQixzQkFBc0IsSUFBSTtRQUM1REMsc0JBQXNCbEMsU0FB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Ozs7Ozs7Ozs7SUFZRCxDQUFDO0lBRUgsTUFBTW9DLFdBQVcsSUFBSUM7SUFDckIsS0FBSyxNQUFNeEUsT0FBT2tDLEtBQU07UUFDdEIsSUFBSWxDLElBQUl5RSxLQUFLLEVBQUU7WUFDYkYsU0FBU0csR0FBRyxDQUFDMUUsSUFBSXlFLEtBQUs7UUFDeEI7SUFDRjtJQUNBLEtBQUssTUFBTUUsVUFBVU4sb0JBQXFCO1FBQ3hDRSxTQUFTRyxHQUFHLENBQUNDO0lBQ2Y7SUFDQSxPQUFPSjtBQUNUIiwic291cmNlcyI6WyJIOlxcVXNlcnNcXEd1c1xcc291cmNlXFxyZXBvXFxkeW5hbWljc1xcZHluYW1pY3MtYlxcY3J5cHRvcGktZHluYW1pY3NcXHNyY1xcY29yZVxcZmVhdHVyZXNcXGNpbi1hdXhcXHJ1bnRpbWVRdWVyaWVzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGRiIH0gZnJvbSBcIkAvY29yZS9kYi9kYlwiO1xuaW1wb3J0IHR5cGUge1xuICBDaW5SdW50aW1lQXNzZXRQbmwsXG4gIENpblJ1bnRpbWVTZXNzaW9uU3VtbWFyeSxcbiAgQ2luUnVudGltZVN0YXR1cyxcbn0gZnJvbSBcIi4vY2luQXV4Q29udHJhY3RzXCI7XG5cbmNvbnN0IFNUQVRVU19EUklGVEVEID0gMC4wMDU7XG5jb25zdCBTVEFUVVNfQlJPS0VOID0gMC4wMjtcblxuZnVuY3Rpb24gYXNTdHJpbmcodmFsdWU6IHVua25vd24sIGZhbGxiYWNrID0gXCIwXCIpOiBzdHJpbmcge1xuICBpZiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCkgcmV0dXJuIGZhbGxiYWNrO1xuICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiID8gdmFsdWUgOiBTdHJpbmcodmFsdWUpO1xufVxuXG5mdW5jdGlvbiB0b051bWJlcih2YWx1ZTogdW5rbm93bik6IG51bWJlciB7XG4gIGNvbnN0IG4gPSBOdW1iZXIodmFsdWUpO1xuICByZXR1cm4gTnVtYmVyLmlzRmluaXRlKG4pID8gbiA6IDA7XG59XG5cbmZ1bmN0aW9uIHJ1bnRpbWVTdGF0dXNGcm9tRGVsdGEoZGVsdGFSYXRpbzogdW5rbm93bik6IENpblJ1bnRpbWVTdGF0dXMge1xuICBjb25zdCByYXRpbyA9IE51bWJlcihkZWx0YVJhdGlvKTtcbiAgaWYgKCFOdW1iZXIuaXNGaW5pdGUocmF0aW8pKSByZXR1cm4gXCJiYWxhbmNlZFwiO1xuICBjb25zdCBhYnMgPSBNYXRoLmFicyhyYXRpbyk7XG4gIGlmIChhYnMgPj0gU1RBVFVTX0JST0tFTikgcmV0dXJuIFwiYnJva2VuXCI7XG4gIGlmIChhYnMgPj0gU1RBVFVTX0RSSUZURUQpIHJldHVybiBcImRyaWZ0ZWRcIjtcbiAgcmV0dXJuIFwiYmFsYW5jZWRcIjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1hcFJ1bnRpbWVTZXNzaW9uUm93KHJvdzogYW55KTogQ2luUnVudGltZVNlc3Npb25TdW1tYXJ5IHtcbiAgcmV0dXJuIHtcbiAgICBzZXNzaW9uSWQ6IE51bWJlcihyb3cuc2Vzc2lvbl9pZCksXG4gICAgd2luZG93TGFiZWw6IHJvdy53aW5kb3dfbGFiZWwsXG4gICAgc3RhcnRlZEF0OiByb3cuc3RhcnRlZF9hdCxcbiAgICBlbmRlZEF0OiByb3cuZW5kZWRfYXQsXG4gICAgY2xvc2VkOiBCb29sZWFuKHJvdy5jbG9zZWQpLFxuICAgIGltcHJpbnRQcmluY2lwYWxDaHVyblVzZHQ6IGFzU3RyaW5nKHJvdy5pbXByaW50X3ByaW5jaXBhbF9jaHVybl91c2R0KSxcbiAgICBpbXByaW50UHJvZml0Q2h1cm5Vc2R0OiBhc1N0cmluZyhyb3cuaW1wcmludF9wcm9maXRfY2h1cm5fdXNkdCksXG4gICAgaW1wcmludEdlbmVyYXRlZFByb2ZpdFVzZHQ6IGFzU3RyaW5nKHJvdy5pbXByaW50X2dlbmVyYXRlZF9wcm9maXRfdXNkdCA/PyBcIjBcIiksXG4gICAgaW1wcmludFRyYWNlU3VtVXNkdDogYXNTdHJpbmcocm93LmltcHJpbnRfdHJhY2Vfc3VtX3VzZHQgPz8gXCIwXCIpLFxuICAgIGltcHJpbnREZXZyZWZTdW1Vc2R0OiBhc1N0cmluZyhyb3cuaW1wcmludF9kZXZyZWZfc3VtX3VzZHQgPz8gXCIwXCIpLFxuICAgIGx1Z2dhZ2VUb3RhbFByaW5jaXBhbFVzZHQ6IGFzU3RyaW5nKHJvdy5sdWdnYWdlX3RvdGFsX3ByaW5jaXBhbF91c2R0KSxcbiAgICBsdWdnYWdlVG90YWxQcm9maXRVc2R0OiBhc1N0cmluZyhyb3cubHVnZ2FnZV90b3RhbF9wcm9maXRfdXNkdCksXG4gICAgY2luVG90YWxNdG1Vc2R0OiByb3cuY2luX3RvdGFsX210bV91c2R0ICE9IG51bGwgPyBhc1N0cmluZyhyb3cuY2luX3RvdGFsX210bV91c2R0KSA6IG51bGwsXG4gICAgcmVmVG90YWxVc2R0OiByb3cucmVmX3RvdGFsX3VzZHQgIT0gbnVsbCA/IGFzU3RyaW5nKHJvdy5yZWZfdG90YWxfdXNkdCkgOiBudWxsLFxuICAgIGRlbHRhVXNkdDogcm93LmRlbHRhX3VzZHQgIT0gbnVsbCA/IGFzU3RyaW5nKHJvdy5kZWx0YV91c2R0KSA6IG51bGwsXG4gICAgZGVsdGFSYXRpbzogcm93LmRlbHRhX3JhdGlvICE9IG51bGwgPyBhc1N0cmluZyhyb3cuZGVsdGFfcmF0aW8pIDogbnVsbCxcbiAgICBzdGF0dXM6IHJ1bnRpbWVTdGF0dXNGcm9tRGVsdGEocm93LmRlbHRhX3JhdGlvKSxcbiAgfTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZldGNoUnVudGltZVNlc3Npb25TdW1tYXJ5KFxuICBzZXNzaW9uSWQ6IG51bWJlcixcbik6IFByb21pc2U8Q2luUnVudGltZVNlc3Npb25TdW1tYXJ5IHwgbnVsbD4ge1xuICBjb25zdCB7IHJvd3MgfSA9IGF3YWl0IGRiLnF1ZXJ5KFxuICAgIGBcbiAgICAgIFNFTEVDVCBzLiosIHJlY29uLmNpbl90b3RhbF9tdG1fdXNkdCwgcmVjb24ucmVmX3RvdGFsX3VzZHQsIHJlY29uLmRlbHRhX3VzZHQsIHJlY29uLmRlbHRhX3JhdGlvXG4gICAgICAgIEZST00gY2luX2F1eC52X3J0X3Nlc3Npb25fc3VtbWFyeSBzXG4gICAgICAgIExFRlQgSk9JTiBjaW5fYXV4LnZfcnRfc2Vzc2lvbl9yZWNvbiByZWNvblxuICAgICAgICAgIE9OIHJlY29uLnNlc3Npb25faWQgPSBzLnNlc3Npb25faWRcbiAgICAgICBXSEVSRSBzLnNlc3Npb25faWQgPSAkMVxuICAgIGAsXG4gICAgW3Nlc3Npb25JZF0sXG4gICk7XG4gIGlmIChyb3dzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIG51bGw7XG4gIHJldHVybiBtYXBSdW50aW1lU2Vzc2lvblJvdyhyb3dzWzBdKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxpc3RSdW50aW1lU2Vzc2lvbnMoKTogUHJvbWlzZTxDaW5SdW50aW1lU2Vzc2lvblN1bW1hcnlbXT4ge1xuICBjb25zdCB7IHJvd3MgfSA9IGF3YWl0IGRiLnF1ZXJ5KFxuICAgIGBcbiAgICAgIFNFTEVDVCBzLiosIHJlY29uLmNpbl90b3RhbF9tdG1fdXNkdCwgcmVjb24ucmVmX3RvdGFsX3VzZHQsIHJlY29uLmRlbHRhX3VzZHQsIHJlY29uLmRlbHRhX3JhdGlvXG4gICAgICAgIEZST00gY2luX2F1eC52X3J0X3Nlc3Npb25fc3VtbWFyeSBzXG4gICAgICAgIExFRlQgSk9JTiBjaW5fYXV4LnZfcnRfc2Vzc2lvbl9yZWNvbiByZWNvblxuICAgICAgICAgIE9OIHJlY29uLnNlc3Npb25faWQgPSBzLnNlc3Npb25faWRcbiAgICAgICBPUkRFUiBCWSBzLnN0YXJ0ZWRfYXQgREVTQ1xuICAgIGAsXG4gICk7XG4gIHJldHVybiByb3dzLm1hcChtYXBSdW50aW1lU2Vzc2lvblJvdyk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmZXRjaFJ1bnRpbWVBc3NldHMoXG4gIHNlc3Npb25JZDogbnVtYmVyLFxuKTogUHJvbWlzZTwoQ2luUnVudGltZUFzc2V0UG5sICYgeyBpblVuaXZlcnNlOiBib29sZWFuOyByZWZlcmVuY2VVc2R0OiBzdHJpbmcgfCBudWxsIH0pW10+IHtcbiAgY29uc3QgeyByb3dzIH0gPSBhd2FpdCBkYi5xdWVyeShcbiAgICBgXG4gICAgICBTRUxFQ1RcbiAgICAgICAgYXAuKixcbiAgICAgICAgKGN1LmJhc2VfYXNzZXQgSVMgTk9UIE5VTEwpIEFTIGluX3VuaXZlcnNlLFxuICAgICAgICByZWYucmVmX3VzZHRcbiAgICAgIEZST00gY2luX2F1eC52X3J0X2Fzc2V0X3BubCBhcFxuICAgICAgTEVGVCBKT0lOIHNldHRpbmdzLmNvaW5fdW5pdmVyc2UgY3VcbiAgICAgICAgT04gY3UuZW5hYmxlZCA9IFRSVUVcbiAgICAgICBBTkQgY3UuYmFzZV9hc3NldCBJUyBOT1QgTlVMTFxuICAgICAgIEFORCBVUFBFUihjdS5iYXNlX2Fzc2V0KSA9IFVQUEVSKGFwLmFzc2V0X2lkKVxuICAgICAgTEVGVCBKT0lOIGNpbl9hdXgucnRfcmVmZXJlbmNlIHJlZlxuICAgICAgICBPTiByZWYuc2Vzc2lvbl9pZCA9IGFwLnNlc3Npb25faWRcbiAgICAgICBBTkQgVVBQRVIocmVmLmFzc2V0X2lkKSA9IFVQUEVSKGFwLmFzc2V0X2lkKVxuICAgICAgV0hFUkUgYXAuc2Vzc2lvbl9pZCA9ICQxXG4gICAgICBPUkRFUiBCWSBhcC5tdG1fdmFsdWVfdXNkdCBERVNDIE5VTExTIExBU1QsIGFwLmFzc2V0X2lkIEFTQ1xuICAgIGAsXG4gICAgW3Nlc3Npb25JZF0sXG4gICk7XG5cbiAgY29uc3QgdG90YWxNdG0gPSByb3dzLnJlZHVjZSgoYWNjLCByb3cpID0+IGFjYyArIHRvTnVtYmVyKHJvdy5tdG1fdmFsdWVfdXNkdCksIDApO1xuXG4gIHJldHVybiByb3dzLm1hcCgocm93KSA9PiB7XG4gICAgY29uc3QgbXRtVmFsdWUgPSB0b051bWJlcihyb3cubXRtX3ZhbHVlX3VzZHQpO1xuICAgIHJldHVybiB7XG4gICAgICBzZXNzaW9uSWQ6IE51bWJlcihyb3cuc2Vzc2lvbl9pZCksXG4gICAgICBhc3NldElkOiByb3cuYXNzZXRfaWQsXG4gICAgICBvcGVuaW5nUHJpbmNpcGFsOiBhc1N0cmluZyhyb3cub3BlbmluZ19wcmluY2lwYWwgPz8gXCIwXCIpLFxuICAgICAgb3BlbmluZ1Byb2ZpdDogYXNTdHJpbmcocm93Lm9wZW5pbmdfcHJvZml0ID8/IFwiMFwiKSxcbiAgICAgIHByaW5jaXBhbFVzZHQ6IGFzU3RyaW5nKHJvdy5wcmluY2lwYWxfdXNkdCA/PyBcIjBcIiksXG4gICAgICBwcm9maXRVc2R0OiBhc1N0cmluZyhyb3cucHJvZml0X3VzZHQgPz8gXCIwXCIpLFxuICAgICAgbGFzdE1hcmtUczogcm93Lmxhc3RfbWFya190cyxcbiAgICAgIHByaWNlVXNkdDogcm93LnByaWNlX3VzZHQgIT0gbnVsbCA/IGFzU3RyaW5nKHJvdy5wcmljZV91c2R0KSA6IG51bGwsXG4gICAgICBidWxrVXNkdDogYXNTdHJpbmcocm93LmJ1bGtfdXNkdCA/PyBcIjBcIiksXG4gICAgICBtdG1WYWx1ZVVzZHQ6IGFzU3RyaW5nKHJvdy5tdG1fdmFsdWVfdXNkdCA/PyBcIjBcIiksXG4gICAgICB3ZWlnaHRJblBvcnRmb2xpbzpcbiAgICAgICAgdG90YWxNdG0gPiAwICYmIE51bWJlci5pc0Zpbml0ZShtdG1WYWx1ZSkgPyBtdG1WYWx1ZSAvIHRvdGFsTXRtIDogbnVsbCxcbiAgICAgIHJlYWxpemVkUG5sVXNkdDogcm93LnJlYWxpemVkX3BubF91c2R0ICE9IG51bGwgPyBhc1N0cmluZyhyb3cucmVhbGl6ZWRfcG5sX3VzZHQpIDogbnVsbCxcbiAgICAgIGluVW5pdmVyc2U6IEJvb2xlYW4ocm93LmluX3VuaXZlcnNlKSxcbiAgICAgIHJlZmVyZW5jZVVzZHQ6IHJvdy5yZWZfdXNkdCAhPSBudWxsID8gYXNTdHJpbmcocm93LnJlZl91c2R0KSA6IG51bGwsXG4gICAgfTtcbiAgfSk7XG59XG5cbmV4cG9ydCBjb25zdCBLTk9XTl9TVEFCTEVfUVVPVEVTID0gW1wiVVNEVFwiLCBcIkZEVVNEXCIsIFwiVVNEQ1wiLCBcIlRVU0RcIiwgXCJCVVNEXCIsIFwiVVNEXCIsIFwiQlRDXCIsIFwiRVRIXCIsIFwiQk5CXCJdO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZmV0Y2hVbml2ZXJzZUJhc2VBc3NldHMoKTogUHJvbWlzZTxTZXQ8c3RyaW5nPj4ge1xuICBjb25zdCB7IHJvd3MgfSA9IGF3YWl0IGRiLnF1ZXJ5KFxuICAgIGBcbiAgICAgIFNFTEVDVCBESVNUSU5DVCBVUFBFUihhc3NldCkgQVMgYXNzZXRcbiAgICAgICAgRlJPTSAoXG4gICAgICAgICAgU0VMRUNUIGJhc2VfYXNzZXQgQVMgYXNzZXRcbiAgICAgICAgICAgIEZST00gc2V0dGluZ3MuY29pbl91bml2ZXJzZVxuICAgICAgICAgICBXSEVSRSBlbmFibGVkID0gVFJVRSBBTkQgYmFzZV9hc3NldCBJUyBOT1QgTlVMTFxuICAgICAgICAgIFVOSU9OIEFMTFxuICAgICAgICAgIFNFTEVDVCBxdW90ZV9hc3NldCBBUyBhc3NldFxuICAgICAgICAgICAgRlJPTSBzZXR0aW5ncy5jb2luX3VuaXZlcnNlXG4gICAgICAgICAgIFdIRVJFIGVuYWJsZWQgPSBUUlVFIEFORCBxdW90ZV9hc3NldCBJUyBOT1QgTlVMTFxuICAgICAgICApIHNjb3BlZFxuICAgICAgIFdIRVJFIGFzc2V0IElTIE5PVCBOVUxMXG4gICAgYCxcbiAgKTtcbiAgY29uc3QgdW5pdmVyc2UgPSBuZXcgU2V0PHN0cmluZz4oKTtcbiAgZm9yIChjb25zdCByb3cgb2Ygcm93cykge1xuICAgIGlmIChyb3cuYXNzZXQpIHtcbiAgICAgIHVuaXZlcnNlLmFkZChyb3cuYXNzZXQpO1xuICAgIH1cbiAgfVxuICBmb3IgKGNvbnN0IHN0YWJsZSBvZiBLTk9XTl9TVEFCTEVfUVVPVEVTKSB7XG4gICAgdW5pdmVyc2UuYWRkKHN0YWJsZSk7XG4gIH1cbiAgcmV0dXJuIHVuaXZlcnNlO1xufVxuIl0sIm5hbWVzIjpbImRiIiwiU1RBVFVTX0RSSUZURUQiLCJTVEFUVVNfQlJPS0VOIiwiYXNTdHJpbmciLCJ2YWx1ZSIsImZhbGxiYWNrIiwidW5kZWZpbmVkIiwiU3RyaW5nIiwidG9OdW1iZXIiLCJuIiwiTnVtYmVyIiwiaXNGaW5pdGUiLCJydW50aW1lU3RhdHVzRnJvbURlbHRhIiwiZGVsdGFSYXRpbyIsInJhdGlvIiwiYWJzIiwiTWF0aCIsIm1hcFJ1bnRpbWVTZXNzaW9uUm93Iiwicm93Iiwic2Vzc2lvbklkIiwic2Vzc2lvbl9pZCIsIndpbmRvd0xhYmVsIiwid2luZG93X2xhYmVsIiwic3RhcnRlZEF0Iiwic3RhcnRlZF9hdCIsImVuZGVkQXQiLCJlbmRlZF9hdCIsImNsb3NlZCIsIkJvb2xlYW4iLCJpbXByaW50UHJpbmNpcGFsQ2h1cm5Vc2R0IiwiaW1wcmludF9wcmluY2lwYWxfY2h1cm5fdXNkdCIsImltcHJpbnRQcm9maXRDaHVyblVzZHQiLCJpbXByaW50X3Byb2ZpdF9jaHVybl91c2R0IiwiaW1wcmludEdlbmVyYXRlZFByb2ZpdFVzZHQiLCJpbXByaW50X2dlbmVyYXRlZF9wcm9maXRfdXNkdCIsImltcHJpbnRUcmFjZVN1bVVzZHQiLCJpbXByaW50X3RyYWNlX3N1bV91c2R0IiwiaW1wcmludERldnJlZlN1bVVzZHQiLCJpbXByaW50X2RldnJlZl9zdW1fdXNkdCIsImx1Z2dhZ2VUb3RhbFByaW5jaXBhbFVzZHQiLCJsdWdnYWdlX3RvdGFsX3ByaW5jaXBhbF91c2R0IiwibHVnZ2FnZVRvdGFsUHJvZml0VXNkdCIsImx1Z2dhZ2VfdG90YWxfcHJvZml0X3VzZHQiLCJjaW5Ub3RhbE10bVVzZHQiLCJjaW5fdG90YWxfbXRtX3VzZHQiLCJyZWZUb3RhbFVzZHQiLCJyZWZfdG90YWxfdXNkdCIsImRlbHRhVXNkdCIsImRlbHRhX3VzZHQiLCJkZWx0YV9yYXRpbyIsInN0YXR1cyIsImZldGNoUnVudGltZVNlc3Npb25TdW1tYXJ5Iiwicm93cyIsInF1ZXJ5IiwibGVuZ3RoIiwibGlzdFJ1bnRpbWVTZXNzaW9ucyIsIm1hcCIsImZldGNoUnVudGltZUFzc2V0cyIsInRvdGFsTXRtIiwicmVkdWNlIiwiYWNjIiwibXRtX3ZhbHVlX3VzZHQiLCJtdG1WYWx1ZSIsImFzc2V0SWQiLCJhc3NldF9pZCIsIm9wZW5pbmdQcmluY2lwYWwiLCJvcGVuaW5nX3ByaW5jaXBhbCIsIm9wZW5pbmdQcm9maXQiLCJvcGVuaW5nX3Byb2ZpdCIsInByaW5jaXBhbFVzZHQiLCJwcmluY2lwYWxfdXNkdCIsInByb2ZpdFVzZHQiLCJwcm9maXRfdXNkdCIsImxhc3RNYXJrVHMiLCJsYXN0X21hcmtfdHMiLCJwcmljZVVzZHQiLCJwcmljZV91c2R0IiwiYnVsa1VzZHQiLCJidWxrX3VzZHQiLCJtdG1WYWx1ZVVzZHQiLCJ3ZWlnaHRJblBvcnRmb2xpbyIsInJlYWxpemVkUG5sVXNkdCIsInJlYWxpemVkX3BubF91c2R0IiwiaW5Vbml2ZXJzZSIsImluX3VuaXZlcnNlIiwicmVmZXJlbmNlVXNkdCIsInJlZl91c2R0IiwiS05PV05fU1RBQkxFX1FVT1RFUyIsImZldGNoVW5pdmVyc2VCYXNlQXNzZXRzIiwidW5pdmVyc2UiLCJTZXQiLCJhc3NldCIsImFkZCIsInN0YWJsZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/core/features/cin-aux/runtimeQueries.ts\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!**************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \**************************************************************************************************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "../app-render/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/server/app-render/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/action-async-storage.external.js");

/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "./work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("fs");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "next/dist/shared/lib/no-fallback-error.external":
/*!******************************************************************!*\
  !*** external "next/dist/shared/lib/no-fallback-error.external" ***!
  \******************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/no-fallback-error.external");

/***/ }),

/***/ "next/dist/shared/lib/router/utils/app-paths":
/*!**************************************************************!*\
  !*** external "next/dist/shared/lib/router/utils/app-paths" ***!
  \**************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/app-paths");

/***/ }),

/***/ "node:child_process":
/*!*************************************!*\
  !*** external "node:child_process" ***!
  \*************************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:child_process");

/***/ }),

/***/ "node:fs":
/*!**************************!*\
  !*** external "node:fs" ***!
  \**************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:fs");

/***/ }),

/***/ "node:path":
/*!****************************!*\
  !*** external "node:path" ***!
  \****************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:path");

/***/ }),

/***/ "node:url":
/*!***************************!*\
  !*** external "node:url" ***!
  \***************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:url");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("path");

/***/ }),

/***/ "pg":
/*!*********************!*\
  !*** external "pg" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = import("pg");;

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5"], () => (__webpack_exec__("(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fcin-aux%2Fruntime%2Fsessions%2Froute&page=%2Fapi%2Fcin-aux%2Fruntime%2Fsessions%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcin-aux%2Fruntime%2Fsessions%2Froute.ts&appDir=H%3A%5CUsers%5CGus%5Csource%5Crepo%5Cdynamics%5Cdynamics-b%5Ccryptopi-dynamics%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=H%3A%5CUsers%5CGus%5Csource%5Crepo%5Cdynamics%5Cdynamics-b%5Ccryptopi-dynamics&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!")));
module.exports = __webpack_exports__;

})();