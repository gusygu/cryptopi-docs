/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/moo-aux/route";
exports.ids = ["app/api/moo-aux/route"];
exports.modules = {

/***/ "(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fmoo-aux%2Froute&page=%2Fapi%2Fmoo-aux%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmoo-aux%2Froute.ts&appDir=H%3A%5CUsers%5CGus%5Csource%5Crepo%5Cdynamics%5Cdynamics-b%5Ccryptopi-dynamics%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=H%3A%5CUsers%5CGus%5Csource%5Crepo%5Cdynamics%5Cdynamics-b%5Ccryptopi-dynamics&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!":
/*!**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fmoo-aux%2Froute&page=%2Fapi%2Fmoo-aux%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmoo-aux%2Froute.ts&appDir=H%3A%5CUsers%5CGus%5Csource%5Crepo%5Cdynamics%5Cdynamics-b%5Ccryptopi-dynamics%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=H%3A%5CUsers%5CGus%5Csource%5Crepo%5Cdynamics%5Cdynamics-b%5Ccryptopi-dynamics&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=! ***!
  \**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   handler: () => (/* binding */ handler),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/dist/server/request-meta */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/request-meta.js\");\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! next/dist/server/lib/trace/tracer */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/lib/trace/tracer.js\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next/dist/shared/lib/router/utils/app-paths */ \"next/dist/shared/lib/router/utils/app-paths\");\n/* harmony import */ var next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! next/dist/server/base-http/node */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/base-http/node.js\");\n/* harmony import */ var next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! next/dist/server/web/spec-extension/adapters/next-request */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/web/spec-extension/adapters/next-request.js\");\n/* harmony import */ var next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! next/dist/server/lib/trace/constants */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/lib/trace/constants.js\");\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! next/dist/server/instrumentation/utils */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/instrumentation/utils.js\");\n/* harmony import */ var next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! next/dist/server/send-response */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/send-response.js\");\n/* harmony import */ var next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! next/dist/server/web/utils */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/web/utils.js\");\n/* harmony import */ var next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__);\n/* harmony import */ var next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! next/dist/server/lib/cache-control */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/lib/cache-control.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! next/dist/lib/constants */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/lib/constants.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13___default = /*#__PURE__*/__webpack_require__.n(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__);\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! next/dist/shared/lib/no-fallback-error.external */ \"next/dist/shared/lib/no-fallback-error.external\");\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__);\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! next/dist/server/response-cache */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/response-cache/index.js\");\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__);\n/* harmony import */ var H_Users_Gus_source_repo_dynamics_dynamics_b_cryptopi_dynamics_src_app_api_moo_aux_route_ts__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./src/app/api/moo-aux/route.ts */ \"(rsc)/./src/app/api/moo-aux/route.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([H_Users_Gus_source_repo_dynamics_dynamics_b_cryptopi_dynamics_src_app_api_moo_aux_route_ts__WEBPACK_IMPORTED_MODULE_16__]);\nH_Users_Gus_source_repo_dynamics_dynamics_b_cryptopi_dynamics_src_app_api_moo_aux_route_ts__WEBPACK_IMPORTED_MODULE_16__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/moo-aux/route\",\n        pathname: \"/api/moo-aux\",\n        filename: \"route\",\n        bundlePath: \"app/api/moo-aux/route\"\n    },\n    distDir: \".next\" || 0,\n    relativeProjectDir:  false || '',\n    resolvedPagePath: \"H:\\\\Users\\\\Gus\\\\source\\\\repo\\\\dynamics\\\\dynamics-b\\\\cryptopi-dynamics\\\\src\\\\app\\\\api\\\\moo-aux\\\\route.ts\",\n    nextConfigOutput,\n    userland: H_Users_Gus_source_repo_dynamics_dynamics_b_cryptopi_dynamics_src_app_api_moo_aux_route_ts__WEBPACK_IMPORTED_MODULE_16__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\nasync function handler(req, res, ctx) {\n    var _nextConfig_experimental;\n    let srcPage = \"/api/moo-aux/route\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (false) {} else if (srcPage === '/index') {\n        // we always normalize /index specifically\n        srcPage = '/';\n    }\n    const multiZoneDraftMode = false;\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage,\n        multiZoneDraftMode\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return null;\n    }\n    const { buildId, params, nextConfig, isDraftMode, prerenderManifest, routerServerContext, isOnDemandRevalidate, revalidateOnlyGenerated, resolvedPathname } = prepareResult;\n    const normalizedSrcPage = (0,next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__.normalizeAppPath)(srcPage);\n    let isIsr = Boolean(prerenderManifest.dynamicRoutes[normalizedSrcPage] || prerenderManifest.routes[resolvedPathname]);\n    if (isIsr && !isDraftMode) {\n        const isPrerendered = Boolean(prerenderManifest.routes[resolvedPathname]);\n        const prerenderInfo = prerenderManifest.dynamicRoutes[normalizedSrcPage];\n        if (prerenderInfo) {\n            if (prerenderInfo.fallback === false && !isPrerendered) {\n                throw new next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__.NoFallbackError();\n            }\n        }\n    }\n    let cacheKey = null;\n    if (isIsr && !routeModule.isDev && !isDraftMode) {\n        cacheKey = resolvedPathname;\n        // ensure /index and / is normalized to one key\n        cacheKey = cacheKey === '/index' ? '/' : cacheKey;\n    }\n    const supportsDynamicResponse = // If we're in development, we always support dynamic HTML\n    routeModule.isDev === true || // If this is not SSG or does not have static paths, then it supports\n    // dynamic HTML.\n    !isIsr;\n    // This is a revalidation request if the request is for a static\n    // page and it is not being resumed from a postponed render and\n    // it is not a dynamic RSC request then it is a revalidation\n    // request.\n    const isRevalidate = isIsr && !supportsDynamicResponse;\n    const method = req.method || 'GET';\n    const tracer = (0,next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__.getTracer)();\n    const activeSpan = tracer.getActiveScopeSpan();\n    const context = {\n        params,\n        prerenderManifest,\n        renderOpts: {\n            experimental: {\n                cacheComponents: Boolean(nextConfig.experimental.cacheComponents),\n                authInterrupts: Boolean(nextConfig.experimental.authInterrupts)\n            },\n            supportsDynamicResponse,\n            incrementalCache: (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'incrementalCache'),\n            cacheLifeProfiles: (_nextConfig_experimental = nextConfig.experimental) == null ? void 0 : _nextConfig_experimental.cacheLife,\n            isRevalidate,\n            waitUntil: ctx.waitUntil,\n            onClose: (cb)=>{\n                res.on('close', cb);\n            },\n            onAfterTaskError: undefined,\n            onInstrumentationRequestError: (error, _request, errorContext)=>routeModule.onRequestError(req, error, errorContext, routerServerContext)\n        },\n        sharedContext: {\n            buildId\n        }\n    };\n    const nodeNextReq = new next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__.NodeNextRequest(req);\n    const nodeNextRes = new next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__.NodeNextResponse(res);\n    const nextReq = next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__.NextRequestAdapter.fromNodeNextRequest(nodeNextReq, (0,next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__.signalFromNodeResponse)(res));\n    try {\n        const invokeRouteModule = async (span)=>{\n            return routeModule.handle(nextReq, context).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__.BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${req.url}`);\n                }\n            });\n        };\n        const handleResponse = async (currentSpan)=>{\n            var _cacheEntry_value;\n            const responseGenerator = async ({ previousCacheEntry })=>{\n                try {\n                    if (!(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode') && isOnDemandRevalidate && revalidateOnlyGenerated && !previousCacheEntry) {\n                        res.statusCode = 404;\n                        // on-demand revalidate always sets this header\n                        res.setHeader('x-nextjs-cache', 'REVALIDATED');\n                        res.end('This page could not be found');\n                        return null;\n                    }\n                    const response = await invokeRouteModule(currentSpan);\n                    req.fetchMetrics = context.renderOpts.fetchMetrics;\n                    let pendingWaitUntil = context.renderOpts.pendingWaitUntil;\n                    // Attempt using provided waitUntil if available\n                    // if it's not we fallback to sendResponse's handling\n                    if (pendingWaitUntil) {\n                        if (ctx.waitUntil) {\n                            ctx.waitUntil(pendingWaitUntil);\n                            pendingWaitUntil = undefined;\n                        }\n                    }\n                    const cacheTags = context.renderOpts.collectedTags;\n                    // If the request is for a static response, we can cache it so long\n                    // as it's not edge.\n                    if (isIsr) {\n                        const blob = await response.blob();\n                        // Copy the headers from the response.\n                        const headers = (0,next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__.toNodeOutgoingHttpHeaders)(response.headers);\n                        if (cacheTags) {\n                            headers[next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.NEXT_CACHE_TAGS_HEADER] = cacheTags;\n                        }\n                        if (!headers['content-type'] && blob.type) {\n                            headers['content-type'] = blob.type;\n                        }\n                        const revalidate = typeof context.renderOpts.collectedRevalidate === 'undefined' || context.renderOpts.collectedRevalidate >= next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.INFINITE_CACHE ? false : context.renderOpts.collectedRevalidate;\n                        const expire = typeof context.renderOpts.collectedExpire === 'undefined' || context.renderOpts.collectedExpire >= next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.INFINITE_CACHE ? undefined : context.renderOpts.collectedExpire;\n                        // Create the cache entry for the response.\n                        const cacheEntry = {\n                            value: {\n                                kind: next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__.CachedRouteKind.APP_ROUTE,\n                                status: response.status,\n                                body: Buffer.from(await blob.arrayBuffer()),\n                                headers\n                            },\n                            cacheControl: {\n                                revalidate,\n                                expire\n                            }\n                        };\n                        return cacheEntry;\n                    } else {\n                        // send response without caching if not ISR\n                        await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, response, context.renderOpts.pendingWaitUntil);\n                        return null;\n                    }\n                } catch (err) {\n                    // if this is a background revalidate we need to report\n                    // the request error here as it won't be bubbled\n                    if (previousCacheEntry == null ? void 0 : previousCacheEntry.isStale) {\n                        await routeModule.onRequestError(req, err, {\n                            routerKind: 'App Router',\n                            routePath: srcPage,\n                            routeType: 'route',\n                            revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__.getRevalidateReason)({\n                                isRevalidate,\n                                isOnDemandRevalidate\n                            })\n                        }, routerServerContext);\n                    }\n                    throw err;\n                }\n            };\n            const cacheEntry = await routeModule.handleResponse({\n                req,\n                nextConfig,\n                cacheKey,\n                routeKind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n                isFallback: false,\n                prerenderManifest,\n                isRoutePPREnabled: false,\n                isOnDemandRevalidate,\n                revalidateOnlyGenerated,\n                responseGenerator,\n                waitUntil: ctx.waitUntil\n            });\n            // we don't create a cacheEntry for ISR\n            if (!isIsr) {\n                return null;\n            }\n            if ((cacheEntry == null ? void 0 : (_cacheEntry_value = cacheEntry.value) == null ? void 0 : _cacheEntry_value.kind) !== next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__.CachedRouteKind.APP_ROUTE) {\n                var _cacheEntry_value1;\n                throw Object.defineProperty(new Error(`Invariant: app-route received invalid cache entry ${cacheEntry == null ? void 0 : (_cacheEntry_value1 = cacheEntry.value) == null ? void 0 : _cacheEntry_value1.kind}`), \"__NEXT_ERROR_CODE\", {\n                    value: \"E701\",\n                    enumerable: false,\n                    configurable: true\n                });\n            }\n            if (!(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode')) {\n                res.setHeader('x-nextjs-cache', isOnDemandRevalidate ? 'REVALIDATED' : cacheEntry.isMiss ? 'MISS' : cacheEntry.isStale ? 'STALE' : 'HIT');\n            }\n            // Draft mode should never be cached\n            if (isDraftMode) {\n                res.setHeader('Cache-Control', 'private, no-cache, no-store, max-age=0, must-revalidate');\n            }\n            const headers = (0,next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__.fromNodeOutgoingHttpHeaders)(cacheEntry.value.headers);\n            if (!((0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode') && isIsr)) {\n                headers.delete(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.NEXT_CACHE_TAGS_HEADER);\n            }\n            // If cache control is already set on the response we don't\n            // override it to allow users to customize it via next.config\n            if (cacheEntry.cacheControl && !res.getHeader('Cache-Control') && !headers.get('Cache-Control')) {\n                headers.set('Cache-Control', (0,next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_12__.getCacheControlHeader)(cacheEntry.cacheControl));\n            }\n            await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, new Response(cacheEntry.value.body, {\n                headers,\n                status: cacheEntry.value.status || 200\n            }));\n            return null;\n        };\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await handleResponse(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__.BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${req.url}`,\n                    kind: next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__.SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, handleResponse));\n        }\n    } catch (err) {\n        // if we aren't wrapped by base-server handle here\n        if (!activeSpan && !(err instanceof next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__.NoFallbackError)) {\n            await routeModule.onRequestError(req, err, {\n                routerKind: 'App Router',\n                routePath: normalizedSrcPage,\n                routeType: 'route',\n                revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__.getRevalidateReason)({\n                    isRevalidate,\n                    isOnDemandRevalidate\n                })\n            });\n        }\n        // rethrow so that we can handle serving error page\n        // If this is during static generation, throw the error again.\n        if (isIsr) throw err;\n        // Otherwise, send a 500 response.\n        await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, new Response(null, {\n            status: 500\n        }));\n        return null;\n    }\n}\n\n//# sourceMappingURL=app-route.js.map\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbmV4dEAxNS41LjJfQHBsYXl3cmlnaHQrdGVzX2I3ZTZjMjgwZTlhMWI0MzA5MzQ3YzBiZjBhYjQ3NmQ1L25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtYXBwLWxvYWRlci9pbmRleC5qcz9uYW1lPWFwcCUyRmFwaSUyRm1vby1hdXglMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRm1vby1hdXglMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZtb28tYXV4JTJGcm91dGUudHMmYXBwRGlyPUglM0ElNUNVc2VycyU1Q0d1cyU1Q3NvdXJjZSU1Q3JlcG8lNUNkeW5hbWljcyU1Q2R5bmFtaWNzLWIlNUNjcnlwdG9waS1keW5hbWljcyU1Q3NyYyU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9SCUzQSU1Q1VzZXJzJTVDR3VzJTVDc291cmNlJTVDcmVwbyU1Q2R5bmFtaWNzJTVDZHluYW1pY3MtYiU1Q2NyeXB0b3BpLWR5bmFtaWNzJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEJmlzR2xvYmFsTm90Rm91bmRFbmFibGVkPSEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBK0Y7QUFDdkM7QUFDcUI7QUFDZDtBQUNTO0FBQ087QUFDSztBQUNtQztBQUNqRDtBQUNPO0FBQ2Y7QUFDc0M7QUFDekI7QUFDTTtBQUNDO0FBQ2hCO0FBQ2tFO0FBQ3BJO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix5R0FBbUI7QUFD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O0FBQ0E7QUFDQTtBQUNBLDRCQUE0Qix3RkFBMkI7QUFDdkQsa0JBQWtCLDZFQUFjO0FBQ2hDLCtCQUErQiw0RUFBc0I7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkMsMEZBQXFCO0FBQ2xFO0FBQ0Esa0JBQWtCLDZFQUFZO0FBQzlCO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWLDZFQUE2RSxnRkFBYztBQUMzRixpQ0FBaUMsUUFBUSxFQUFFLFFBQVE7QUFDbkQsMEJBQTBCLHVFQUFRO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsTUFBTTtBQUNOO0FBQ0EsNENBQTRDLDZGQUFlO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLDJGQUFtQjtBQUNyRDtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyw2RUFBWTtBQUMxQjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7O0FBRUEiLCJzb3VyY2VzIjpbIiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgeyBnZXRSZXF1ZXN0TWV0YSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JlcXVlc3QtbWV0YVwiO1xuaW1wb3J0IHsgZ2V0VHJhY2VyLCBTcGFuS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi90cmFjZS90cmFjZXJcIjtcbmltcG9ydCB7IG5vcm1hbGl6ZUFwcFBhdGggfSBmcm9tIFwibmV4dC9kaXN0L3NoYXJlZC9saWIvcm91dGVyL3V0aWxzL2FwcC1wYXRoc1wiO1xuaW1wb3J0IHsgTm9kZU5leHRSZXF1ZXN0LCBOb2RlTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvYmFzZS1odHRwL25vZGVcIjtcbmltcG9ydCB7IE5leHRSZXF1ZXN0QWRhcHRlciwgc2lnbmFsRnJvbU5vZGVSZXNwb25zZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3dlYi9zcGVjLWV4dGVuc2lvbi9hZGFwdGVycy9uZXh0LXJlcXVlc3RcIjtcbmltcG9ydCB7IEJhc2VTZXJ2ZXJTcGFuIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3RyYWNlL2NvbnN0YW50c1wiO1xuaW1wb3J0IHsgZ2V0UmV2YWxpZGF0ZVJlYXNvbiB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2luc3RydW1lbnRhdGlvbi91dGlsc1wiO1xuaW1wb3J0IHsgc2VuZFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvc2VuZC1yZXNwb25zZVwiO1xuaW1wb3J0IHsgZnJvbU5vZGVPdXRnb2luZ0h0dHBIZWFkZXJzLCB0b05vZGVPdXRnb2luZ0h0dHBIZWFkZXJzIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvd2ViL3V0aWxzXCI7XG5pbXBvcnQgeyBnZXRDYWNoZUNvbnRyb2xIZWFkZXIgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvY2FjaGUtY29udHJvbFwiO1xuaW1wb3J0IHsgSU5GSU5JVEVfQ0FDSEUsIE5FWFRfQ0FDSEVfVEFHU19IRUFERVIgfSBmcm9tIFwibmV4dC9kaXN0L2xpYi9jb25zdGFudHNcIjtcbmltcG9ydCB7IE5vRmFsbGJhY2tFcnJvciB9IGZyb20gXCJuZXh0L2Rpc3Qvc2hhcmVkL2xpYi9uby1mYWxsYmFjay1lcnJvci5leHRlcm5hbFwiO1xuaW1wb3J0IHsgQ2FjaGVkUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcmVzcG9uc2UtY2FjaGVcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJIOlxcXFxVc2Vyc1xcXFxHdXNcXFxcc291cmNlXFxcXHJlcG9cXFxcZHluYW1pY3NcXFxcZHluYW1pY3MtYlxcXFxjcnlwdG9waS1keW5hbWljc1xcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFxtb28tYXV4XFxcXHJvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9tb28tYXV4L3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvbW9vLWF1eFwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvbW9vLWF1eC9yb3V0ZVwiXG4gICAgfSxcbiAgICBkaXN0RGlyOiBwcm9jZXNzLmVudi5fX05FWFRfUkVMQVRJVkVfRElTVF9ESVIgfHwgJycsXG4gICAgcmVsYXRpdmVQcm9qZWN0RGlyOiBwcm9jZXNzLmVudi5fX05FWFRfUkVMQVRJVkVfUFJPSkVDVF9ESVIgfHwgJycsXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJIOlxcXFxVc2Vyc1xcXFxHdXNcXFxcc291cmNlXFxcXHJlcG9cXFxcZHluYW1pY3NcXFxcZHluYW1pY3MtYlxcXFxjcnlwdG9waS1keW5hbWljc1xcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFxtb28tYXV4XFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgd29ya0FzeW5jU3RvcmFnZSwgd29ya1VuaXRBc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgd29ya0FzeW5jU3RvcmFnZSxcbiAgICAgICAgd29ya1VuaXRBc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCB3b3JrQXN5bmNTdG9yYWdlLCB3b3JrVW5pdEFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIHBhdGNoRmV0Y2gsICB9O1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMsIGN0eCkge1xuICAgIHZhciBfbmV4dENvbmZpZ19leHBlcmltZW50YWw7XG4gICAgbGV0IHNyY1BhZ2UgPSBcIi9hcGkvbW9vLWF1eC9yb3V0ZVwiO1xuICAgIC8vIHR1cmJvcGFjayBkb2Vzbid0IG5vcm1hbGl6ZSBgL2luZGV4YCBpbiB0aGUgcGFnZSBuYW1lXG4gICAgLy8gc28gd2UgbmVlZCB0byB0byBwcm9jZXNzIGR5bmFtaWMgcm91dGVzIHByb3Blcmx5XG4gICAgLy8gVE9ETzogZml4IHR1cmJvcGFjayBwcm92aWRpbmcgZGlmZmVyaW5nIHZhbHVlIGZyb20gd2VicGFja1xuICAgIGlmIChwcm9jZXNzLmVudi5UVVJCT1BBQ0spIHtcbiAgICAgICAgc3JjUGFnZSA9IHNyY1BhZ2UucmVwbGFjZSgvXFwvaW5kZXgkLywgJycpIHx8ICcvJztcbiAgICB9IGVsc2UgaWYgKHNyY1BhZ2UgPT09ICcvaW5kZXgnKSB7XG4gICAgICAgIC8vIHdlIGFsd2F5cyBub3JtYWxpemUgL2luZGV4IHNwZWNpZmljYWxseVxuICAgICAgICBzcmNQYWdlID0gJy8nO1xuICAgIH1cbiAgICBjb25zdCBtdWx0aVpvbmVEcmFmdE1vZGUgPSBwcm9jZXNzLmVudi5fX05FWFRfTVVMVElfWk9ORV9EUkFGVF9NT0RFO1xuICAgIGNvbnN0IHByZXBhcmVSZXN1bHQgPSBhd2FpdCByb3V0ZU1vZHVsZS5wcmVwYXJlKHJlcSwgcmVzLCB7XG4gICAgICAgIHNyY1BhZ2UsXG4gICAgICAgIG11bHRpWm9uZURyYWZ0TW9kZVxuICAgIH0pO1xuICAgIGlmICghcHJlcGFyZVJlc3VsdCkge1xuICAgICAgICByZXMuc3RhdHVzQ29kZSA9IDQwMDtcbiAgICAgICAgcmVzLmVuZCgnQmFkIFJlcXVlc3QnKTtcbiAgICAgICAgY3R4LndhaXRVbnRpbCA9PSBudWxsID8gdm9pZCAwIDogY3R4LndhaXRVbnRpbC5jYWxsKGN0eCwgUHJvbWlzZS5yZXNvbHZlKCkpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgY29uc3QgeyBidWlsZElkLCBwYXJhbXMsIG5leHRDb25maWcsIGlzRHJhZnRNb2RlLCBwcmVyZW5kZXJNYW5pZmVzdCwgcm91dGVyU2VydmVyQ29udGV4dCwgaXNPbkRlbWFuZFJldmFsaWRhdGUsIHJldmFsaWRhdGVPbmx5R2VuZXJhdGVkLCByZXNvbHZlZFBhdGhuYW1lIH0gPSBwcmVwYXJlUmVzdWx0O1xuICAgIGNvbnN0IG5vcm1hbGl6ZWRTcmNQYWdlID0gbm9ybWFsaXplQXBwUGF0aChzcmNQYWdlKTtcbiAgICBsZXQgaXNJc3IgPSBCb29sZWFuKHByZXJlbmRlck1hbmlmZXN0LmR5bmFtaWNSb3V0ZXNbbm9ybWFsaXplZFNyY1BhZ2VdIHx8IHByZXJlbmRlck1hbmlmZXN0LnJvdXRlc1tyZXNvbHZlZFBhdGhuYW1lXSk7XG4gICAgaWYgKGlzSXNyICYmICFpc0RyYWZ0TW9kZSkge1xuICAgICAgICBjb25zdCBpc1ByZXJlbmRlcmVkID0gQm9vbGVhbihwcmVyZW5kZXJNYW5pZmVzdC5yb3V0ZXNbcmVzb2x2ZWRQYXRobmFtZV0pO1xuICAgICAgICBjb25zdCBwcmVyZW5kZXJJbmZvID0gcHJlcmVuZGVyTWFuaWZlc3QuZHluYW1pY1JvdXRlc1tub3JtYWxpemVkU3JjUGFnZV07XG4gICAgICAgIGlmIChwcmVyZW5kZXJJbmZvKSB7XG4gICAgICAgICAgICBpZiAocHJlcmVuZGVySW5mby5mYWxsYmFjayA9PT0gZmFsc2UgJiYgIWlzUHJlcmVuZGVyZWQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm9GYWxsYmFja0Vycm9yKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgbGV0IGNhY2hlS2V5ID0gbnVsbDtcbiAgICBpZiAoaXNJc3IgJiYgIXJvdXRlTW9kdWxlLmlzRGV2ICYmICFpc0RyYWZ0TW9kZSkge1xuICAgICAgICBjYWNoZUtleSA9IHJlc29sdmVkUGF0aG5hbWU7XG4gICAgICAgIC8vIGVuc3VyZSAvaW5kZXggYW5kIC8gaXMgbm9ybWFsaXplZCB0byBvbmUga2V5XG4gICAgICAgIGNhY2hlS2V5ID0gY2FjaGVLZXkgPT09ICcvaW5kZXgnID8gJy8nIDogY2FjaGVLZXk7XG4gICAgfVxuICAgIGNvbnN0IHN1cHBvcnRzRHluYW1pY1Jlc3BvbnNlID0gLy8gSWYgd2UncmUgaW4gZGV2ZWxvcG1lbnQsIHdlIGFsd2F5cyBzdXBwb3J0IGR5bmFtaWMgSFRNTFxuICAgIHJvdXRlTW9kdWxlLmlzRGV2ID09PSB0cnVlIHx8IC8vIElmIHRoaXMgaXMgbm90IFNTRyBvciBkb2VzIG5vdCBoYXZlIHN0YXRpYyBwYXRocywgdGhlbiBpdCBzdXBwb3J0c1xuICAgIC8vIGR5bmFtaWMgSFRNTC5cbiAgICAhaXNJc3I7XG4gICAgLy8gVGhpcyBpcyBhIHJldmFsaWRhdGlvbiByZXF1ZXN0IGlmIHRoZSByZXF1ZXN0IGlzIGZvciBhIHN0YXRpY1xuICAgIC8vIHBhZ2UgYW5kIGl0IGlzIG5vdCBiZWluZyByZXN1bWVkIGZyb20gYSBwb3N0cG9uZWQgcmVuZGVyIGFuZFxuICAgIC8vIGl0IGlzIG5vdCBhIGR5bmFtaWMgUlNDIHJlcXVlc3QgdGhlbiBpdCBpcyBhIHJldmFsaWRhdGlvblxuICAgIC8vIHJlcXVlc3QuXG4gICAgY29uc3QgaXNSZXZhbGlkYXRlID0gaXNJc3IgJiYgIXN1cHBvcnRzRHluYW1pY1Jlc3BvbnNlO1xuICAgIGNvbnN0IG1ldGhvZCA9IHJlcS5tZXRob2QgfHwgJ0dFVCc7XG4gICAgY29uc3QgdHJhY2VyID0gZ2V0VHJhY2VyKCk7XG4gICAgY29uc3QgYWN0aXZlU3BhbiA9IHRyYWNlci5nZXRBY3RpdmVTY29wZVNwYW4oKTtcbiAgICBjb25zdCBjb250ZXh0ID0ge1xuICAgICAgICBwYXJhbXMsXG4gICAgICAgIHByZXJlbmRlck1hbmlmZXN0LFxuICAgICAgICByZW5kZXJPcHRzOiB7XG4gICAgICAgICAgICBleHBlcmltZW50YWw6IHtcbiAgICAgICAgICAgICAgICBjYWNoZUNvbXBvbmVudHM6IEJvb2xlYW4obmV4dENvbmZpZy5leHBlcmltZW50YWwuY2FjaGVDb21wb25lbnRzKSxcbiAgICAgICAgICAgICAgICBhdXRoSW50ZXJydXB0czogQm9vbGVhbihuZXh0Q29uZmlnLmV4cGVyaW1lbnRhbC5hdXRoSW50ZXJydXB0cylcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzdXBwb3J0c0R5bmFtaWNSZXNwb25zZSxcbiAgICAgICAgICAgIGluY3JlbWVudGFsQ2FjaGU6IGdldFJlcXVlc3RNZXRhKHJlcSwgJ2luY3JlbWVudGFsQ2FjaGUnKSxcbiAgICAgICAgICAgIGNhY2hlTGlmZVByb2ZpbGVzOiAoX25leHRDb25maWdfZXhwZXJpbWVudGFsID0gbmV4dENvbmZpZy5leHBlcmltZW50YWwpID09IG51bGwgPyB2b2lkIDAgOiBfbmV4dENvbmZpZ19leHBlcmltZW50YWwuY2FjaGVMaWZlLFxuICAgICAgICAgICAgaXNSZXZhbGlkYXRlLFxuICAgICAgICAgICAgd2FpdFVudGlsOiBjdHgud2FpdFVudGlsLFxuICAgICAgICAgICAgb25DbG9zZTogKGNiKT0+e1xuICAgICAgICAgICAgICAgIHJlcy5vbignY2xvc2UnLCBjYik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgb25BZnRlclRhc2tFcnJvcjogdW5kZWZpbmVkLFxuICAgICAgICAgICAgb25JbnN0cnVtZW50YXRpb25SZXF1ZXN0RXJyb3I6IChlcnJvciwgX3JlcXVlc3QsIGVycm9yQ29udGV4dCk9PnJvdXRlTW9kdWxlLm9uUmVxdWVzdEVycm9yKHJlcSwgZXJyb3IsIGVycm9yQ29udGV4dCwgcm91dGVyU2VydmVyQ29udGV4dClcbiAgICAgICAgfSxcbiAgICAgICAgc2hhcmVkQ29udGV4dDoge1xuICAgICAgICAgICAgYnVpbGRJZFxuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBub2RlTmV4dFJlcSA9IG5ldyBOb2RlTmV4dFJlcXVlc3QocmVxKTtcbiAgICBjb25zdCBub2RlTmV4dFJlcyA9IG5ldyBOb2RlTmV4dFJlc3BvbnNlKHJlcyk7XG4gICAgY29uc3QgbmV4dFJlcSA9IE5leHRSZXF1ZXN0QWRhcHRlci5mcm9tTm9kZU5leHRSZXF1ZXN0KG5vZGVOZXh0UmVxLCBzaWduYWxGcm9tTm9kZVJlc3BvbnNlKHJlcykpO1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGludm9rZVJvdXRlTW9kdWxlID0gYXN5bmMgKHNwYW4pPT57XG4gICAgICAgICAgICByZXR1cm4gcm91dGVNb2R1bGUuaGFuZGxlKG5leHRSZXEsIGNvbnRleHQpLmZpbmFsbHkoKCk9PntcbiAgICAgICAgICAgICAgICBpZiAoIXNwYW4pIHJldHVybjtcbiAgICAgICAgICAgICAgICBzcGFuLnNldEF0dHJpYnV0ZXMoe1xuICAgICAgICAgICAgICAgICAgICAnaHR0cC5zdGF0dXNfY29kZSc6IHJlcy5zdGF0dXNDb2RlLFxuICAgICAgICAgICAgICAgICAgICAnbmV4dC5yc2MnOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJvb3RTcGFuQXR0cmlidXRlcyA9IHRyYWNlci5nZXRSb290U3BhbkF0dHJpYnV0ZXMoKTtcbiAgICAgICAgICAgICAgICAvLyBXZSB3ZXJlIHVuYWJsZSB0byBnZXQgYXR0cmlidXRlcywgcHJvYmFibHkgT1RFTCBpcyBub3QgZW5hYmxlZFxuICAgICAgICAgICAgICAgIGlmICghcm9vdFNwYW5BdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQuc3Bhbl90eXBlJykgIT09IEJhc2VTZXJ2ZXJTcGFuLmhhbmRsZVJlcXVlc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBVbmV4cGVjdGVkIHJvb3Qgc3BhbiB0eXBlICcke3Jvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQuc3Bhbl90eXBlJyl9Jy4gUGxlYXNlIHJlcG9ydCB0aGlzIE5leHQuanMgaXNzdWUgaHR0cHM6Ly9naXRodWIuY29tL3ZlcmNlbC9uZXh0LmpzYCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3Qgcm91dGUgPSByb290U3BhbkF0dHJpYnV0ZXMuZ2V0KCduZXh0LnJvdXRlJyk7XG4gICAgICAgICAgICAgICAgaWYgKHJvdXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBgJHttZXRob2R9ICR7cm91dGV9YDtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi5zZXRBdHRyaWJ1dGVzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICduZXh0LnJvdXRlJzogcm91dGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAnaHR0cC5yb3V0ZSc6IHJvdXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ25leHQuc3Bhbl9uYW1lJzogbmFtZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi51cGRhdGVOYW1lKG5hbWUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNwYW4udXBkYXRlTmFtZShgJHttZXRob2R9ICR7cmVxLnVybH1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgaGFuZGxlUmVzcG9uc2UgPSBhc3luYyAoY3VycmVudFNwYW4pPT57XG4gICAgICAgICAgICB2YXIgX2NhY2hlRW50cnlfdmFsdWU7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZUdlbmVyYXRvciA9IGFzeW5jICh7IHByZXZpb3VzQ2FjaGVFbnRyeSB9KT0+e1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghZ2V0UmVxdWVzdE1ldGEocmVxLCAnbWluaW1hbE1vZGUnKSAmJiBpc09uRGVtYW5kUmV2YWxpZGF0ZSAmJiByZXZhbGlkYXRlT25seUdlbmVyYXRlZCAmJiAhcHJldmlvdXNDYWNoZUVudHJ5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMuc3RhdHVzQ29kZSA9IDQwNDtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9uLWRlbWFuZCByZXZhbGlkYXRlIGFsd2F5cyBzZXRzIHRoaXMgaGVhZGVyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXMuc2V0SGVhZGVyKCd4LW5leHRqcy1jYWNoZScsICdSRVZBTElEQVRFRCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzLmVuZCgnVGhpcyBwYWdlIGNvdWxkIG5vdCBiZSBmb3VuZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBpbnZva2VSb3V0ZU1vZHVsZShjdXJyZW50U3Bhbik7XG4gICAgICAgICAgICAgICAgICAgIHJlcS5mZXRjaE1ldHJpY3MgPSBjb250ZXh0LnJlbmRlck9wdHMuZmV0Y2hNZXRyaWNzO1xuICAgICAgICAgICAgICAgICAgICBsZXQgcGVuZGluZ1dhaXRVbnRpbCA9IGNvbnRleHQucmVuZGVyT3B0cy5wZW5kaW5nV2FpdFVudGlsO1xuICAgICAgICAgICAgICAgICAgICAvLyBBdHRlbXB0IHVzaW5nIHByb3ZpZGVkIHdhaXRVbnRpbCBpZiBhdmFpbGFibGVcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgaXQncyBub3Qgd2UgZmFsbGJhY2sgdG8gc2VuZFJlc3BvbnNlJ3MgaGFuZGxpbmdcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBlbmRpbmdXYWl0VW50aWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdHgud2FpdFVudGlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LndhaXRVbnRpbChwZW5kaW5nV2FpdFVudGlsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZW5kaW5nV2FpdFVudGlsID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhY2hlVGFncyA9IGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRUYWdzO1xuICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgcmVxdWVzdCBpcyBmb3IgYSBzdGF0aWMgcmVzcG9uc2UsIHdlIGNhbiBjYWNoZSBpdCBzbyBsb25nXG4gICAgICAgICAgICAgICAgICAgIC8vIGFzIGl0J3Mgbm90IGVkZ2UuXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc0lzcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYmxvYiA9IGF3YWl0IHJlc3BvbnNlLmJsb2IoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENvcHkgdGhlIGhlYWRlcnMgZnJvbSB0aGUgcmVzcG9uc2UuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBoZWFkZXJzID0gdG9Ob2RlT3V0Z29pbmdIdHRwSGVhZGVycyhyZXNwb25zZS5oZWFkZXJzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYWNoZVRhZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzW05FWFRfQ0FDSEVfVEFHU19IRUFERVJdID0gY2FjaGVUYWdzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFoZWFkZXJzWydjb250ZW50LXR5cGUnXSAmJiBibG9iLnR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzWydjb250ZW50LXR5cGUnXSA9IGJsb2IudHlwZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJldmFsaWRhdGUgPSB0eXBlb2YgY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZFJldmFsaWRhdGUgPT09ICd1bmRlZmluZWQnIHx8IGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRSZXZhbGlkYXRlID49IElORklOSVRFX0NBQ0hFID8gZmFsc2UgOiBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkUmV2YWxpZGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4cGlyZSA9IHR5cGVvZiBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkRXhwaXJlID09PSAndW5kZWZpbmVkJyB8fCBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkRXhwaXJlID49IElORklOSVRFX0NBQ0hFID8gdW5kZWZpbmVkIDogY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZEV4cGlyZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENyZWF0ZSB0aGUgY2FjaGUgZW50cnkgZm9yIHRoZSByZXNwb25zZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhY2hlRW50cnkgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2luZDogQ2FjaGVkUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiByZXNwb25zZS5zdGF0dXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvZHk6IEJ1ZmZlci5mcm9tKGF3YWl0IGJsb2IuYXJyYXlCdWZmZXIoKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlQ29udHJvbDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXZhbGlkYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBpcmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhY2hlRW50cnk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZW5kIHJlc3BvbnNlIHdpdGhvdXQgY2FjaGluZyBpZiBub3QgSVNSXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBzZW5kUmVzcG9uc2Uobm9kZU5leHRSZXEsIG5vZGVOZXh0UmVzLCByZXNwb25zZSwgY29udGV4dC5yZW5kZXJPcHRzLnBlbmRpbmdXYWl0VW50aWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhpcyBpcyBhIGJhY2tncm91bmQgcmV2YWxpZGF0ZSB3ZSBuZWVkIHRvIHJlcG9ydFxuICAgICAgICAgICAgICAgICAgICAvLyB0aGUgcmVxdWVzdCBlcnJvciBoZXJlIGFzIGl0IHdvbid0IGJlIGJ1YmJsZWRcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByZXZpb3VzQ2FjaGVFbnRyeSA9PSBudWxsID8gdm9pZCAwIDogcHJldmlvdXNDYWNoZUVudHJ5LmlzU3RhbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHJvdXRlTW9kdWxlLm9uUmVxdWVzdEVycm9yKHJlcSwgZXJyLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm91dGVyS2luZDogJ0FwcCBSb3V0ZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdXRlUGF0aDogc3JjUGFnZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3V0ZVR5cGU6ICdyb3V0ZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV2YWxpZGF0ZVJlYXNvbjogZ2V0UmV2YWxpZGF0ZVJlYXNvbih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzUmV2YWxpZGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNPbkRlbWFuZFJldmFsaWRhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgcm91dGVyU2VydmVyQ29udGV4dCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjb25zdCBjYWNoZUVudHJ5ID0gYXdhaXQgcm91dGVNb2R1bGUuaGFuZGxlUmVzcG9uc2Uoe1xuICAgICAgICAgICAgICAgIHJlcSxcbiAgICAgICAgICAgICAgICBuZXh0Q29uZmlnLFxuICAgICAgICAgICAgICAgIGNhY2hlS2V5LFxuICAgICAgICAgICAgICAgIHJvdXRlS2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgICAgICAgICBpc0ZhbGxiYWNrOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBwcmVyZW5kZXJNYW5pZmVzdCxcbiAgICAgICAgICAgICAgICBpc1JvdXRlUFBSRW5hYmxlZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgaXNPbkRlbWFuZFJldmFsaWRhdGUsXG4gICAgICAgICAgICAgICAgcmV2YWxpZGF0ZU9ubHlHZW5lcmF0ZWQsXG4gICAgICAgICAgICAgICAgcmVzcG9uc2VHZW5lcmF0b3IsXG4gICAgICAgICAgICAgICAgd2FpdFVudGlsOiBjdHgud2FpdFVudGlsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vIHdlIGRvbid0IGNyZWF0ZSBhIGNhY2hlRW50cnkgZm9yIElTUlxuICAgICAgICAgICAgaWYgKCFpc0lzcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKChjYWNoZUVudHJ5ID09IG51bGwgPyB2b2lkIDAgOiAoX2NhY2hlRW50cnlfdmFsdWUgPSBjYWNoZUVudHJ5LnZhbHVlKSA9PSBudWxsID8gdm9pZCAwIDogX2NhY2hlRW50cnlfdmFsdWUua2luZCkgIT09IENhY2hlZFJvdXRlS2luZC5BUFBfUk9VVEUpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2NhY2hlRW50cnlfdmFsdWUxO1xuICAgICAgICAgICAgICAgIHRocm93IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXcgRXJyb3IoYEludmFyaWFudDogYXBwLXJvdXRlIHJlY2VpdmVkIGludmFsaWQgY2FjaGUgZW50cnkgJHtjYWNoZUVudHJ5ID09IG51bGwgPyB2b2lkIDAgOiAoX2NhY2hlRW50cnlfdmFsdWUxID0gY2FjaGVFbnRyeS52YWx1ZSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9jYWNoZUVudHJ5X3ZhbHVlMS5raW5kfWApLCBcIl9fTkVYVF9FUlJPUl9DT0RFXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFwiRTcwMVwiLFxuICAgICAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWdldFJlcXVlc3RNZXRhKHJlcSwgJ21pbmltYWxNb2RlJykpIHtcbiAgICAgICAgICAgICAgICByZXMuc2V0SGVhZGVyKCd4LW5leHRqcy1jYWNoZScsIGlzT25EZW1hbmRSZXZhbGlkYXRlID8gJ1JFVkFMSURBVEVEJyA6IGNhY2hlRW50cnkuaXNNaXNzID8gJ01JU1MnIDogY2FjaGVFbnRyeS5pc1N0YWxlID8gJ1NUQUxFJyA6ICdISVQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIERyYWZ0IG1vZGUgc2hvdWxkIG5ldmVyIGJlIGNhY2hlZFxuICAgICAgICAgICAgaWYgKGlzRHJhZnRNb2RlKSB7XG4gICAgICAgICAgICAgICAgcmVzLnNldEhlYWRlcignQ2FjaGUtQ29udHJvbCcsICdwcml2YXRlLCBuby1jYWNoZSwgbm8tc3RvcmUsIG1heC1hZ2U9MCwgbXVzdC1yZXZhbGlkYXRlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBoZWFkZXJzID0gZnJvbU5vZGVPdXRnb2luZ0h0dHBIZWFkZXJzKGNhY2hlRW50cnkudmFsdWUuaGVhZGVycyk7XG4gICAgICAgICAgICBpZiAoIShnZXRSZXF1ZXN0TWV0YShyZXEsICdtaW5pbWFsTW9kZScpICYmIGlzSXNyKSkge1xuICAgICAgICAgICAgICAgIGhlYWRlcnMuZGVsZXRlKE5FWFRfQ0FDSEVfVEFHU19IRUFERVIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gSWYgY2FjaGUgY29udHJvbCBpcyBhbHJlYWR5IHNldCBvbiB0aGUgcmVzcG9uc2Ugd2UgZG9uJ3RcbiAgICAgICAgICAgIC8vIG92ZXJyaWRlIGl0IHRvIGFsbG93IHVzZXJzIHRvIGN1c3RvbWl6ZSBpdCB2aWEgbmV4dC5jb25maWdcbiAgICAgICAgICAgIGlmIChjYWNoZUVudHJ5LmNhY2hlQ29udHJvbCAmJiAhcmVzLmdldEhlYWRlcignQ2FjaGUtQ29udHJvbCcpICYmICFoZWFkZXJzLmdldCgnQ2FjaGUtQ29udHJvbCcpKSB7XG4gICAgICAgICAgICAgICAgaGVhZGVycy5zZXQoJ0NhY2hlLUNvbnRyb2wnLCBnZXRDYWNoZUNvbnRyb2xIZWFkZXIoY2FjaGVFbnRyeS5jYWNoZUNvbnRyb2wpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGF3YWl0IHNlbmRSZXNwb25zZShub2RlTmV4dFJlcSwgbm9kZU5leHRSZXMsIG5ldyBSZXNwb25zZShjYWNoZUVudHJ5LnZhbHVlLmJvZHksIHtcbiAgICAgICAgICAgICAgICBoZWFkZXJzLFxuICAgICAgICAgICAgICAgIHN0YXR1czogY2FjaGVFbnRyeS52YWx1ZS5zdGF0dXMgfHwgMjAwXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfTtcbiAgICAgICAgLy8gVE9ETzogYWN0aXZlU3BhbiBjb2RlIHBhdGggaXMgZm9yIHdoZW4gd3JhcHBlZCBieVxuICAgICAgICAvLyBuZXh0LXNlcnZlciBjYW4gYmUgcmVtb3ZlZCB3aGVuIHRoaXMgaXMgbm8gbG9uZ2VyIHVzZWRcbiAgICAgICAgaWYgKGFjdGl2ZVNwYW4pIHtcbiAgICAgICAgICAgIGF3YWl0IGhhbmRsZVJlc3BvbnNlKGFjdGl2ZVNwYW4pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYXdhaXQgdHJhY2VyLndpdGhQcm9wYWdhdGVkQ29udGV4dChyZXEuaGVhZGVycywgKCk9PnRyYWNlci50cmFjZShCYXNlU2VydmVyU3Bhbi5oYW5kbGVSZXF1ZXN0LCB7XG4gICAgICAgICAgICAgICAgICAgIHNwYW5OYW1lOiBgJHttZXRob2R9ICR7cmVxLnVybH1gLFxuICAgICAgICAgICAgICAgICAgICBraW5kOiBTcGFuS2luZC5TRVJWRVIsXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLm1ldGhvZCc6IG1ldGhvZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLnRhcmdldCc6IHJlcS51cmxcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIGhhbmRsZVJlc3BvbnNlKSk7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgLy8gaWYgd2UgYXJlbid0IHdyYXBwZWQgYnkgYmFzZS1zZXJ2ZXIgaGFuZGxlIGhlcmVcbiAgICAgICAgaWYgKCFhY3RpdmVTcGFuICYmICEoZXJyIGluc3RhbmNlb2YgTm9GYWxsYmFja0Vycm9yKSkge1xuICAgICAgICAgICAgYXdhaXQgcm91dGVNb2R1bGUub25SZXF1ZXN0RXJyb3IocmVxLCBlcnIsIHtcbiAgICAgICAgICAgICAgICByb3V0ZXJLaW5kOiAnQXBwIFJvdXRlcicsXG4gICAgICAgICAgICAgICAgcm91dGVQYXRoOiBub3JtYWxpemVkU3JjUGFnZSxcbiAgICAgICAgICAgICAgICByb3V0ZVR5cGU6ICdyb3V0ZScsXG4gICAgICAgICAgICAgICAgcmV2YWxpZGF0ZVJlYXNvbjogZ2V0UmV2YWxpZGF0ZVJlYXNvbih7XG4gICAgICAgICAgICAgICAgICAgIGlzUmV2YWxpZGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgaXNPbkRlbWFuZFJldmFsaWRhdGVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gcmV0aHJvdyBzbyB0aGF0IHdlIGNhbiBoYW5kbGUgc2VydmluZyBlcnJvciBwYWdlXG4gICAgICAgIC8vIElmIHRoaXMgaXMgZHVyaW5nIHN0YXRpYyBnZW5lcmF0aW9uLCB0aHJvdyB0aGUgZXJyb3IgYWdhaW4uXG4gICAgICAgIGlmIChpc0lzcikgdGhyb3cgZXJyO1xuICAgICAgICAvLyBPdGhlcndpc2UsIHNlbmQgYSA1MDAgcmVzcG9uc2UuXG4gICAgICAgIGF3YWl0IHNlbmRSZXNwb25zZShub2RlTmV4dFJlcSwgbm9kZU5leHRSZXMsIG5ldyBSZXNwb25zZShudWxsLCB7XG4gICAgICAgICAgICBzdGF0dXM6IDUwMFxuICAgICAgICB9KSk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fmoo-aux%2Froute&page=%2Fapi%2Fmoo-aux%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmoo-aux%2Froute.ts&appDir=H%3A%5CUsers%5CGus%5Csource%5Crepo%5Cdynamics%5Cdynamics-b%5Ccryptopi-dynamics%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=H%3A%5CUsers%5CGus%5Csource%5Crepo%5Cdynamics%5Cdynamics-b%5Ccryptopi-dynamics&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/build/webpack/loaders/next-flight-action-entry-loader.js?actions=%5B%5B%22H%3A%5C%5CUsers%5C%5CGus%5C%5Csource%5C%5Crepo%5C%5Cdynamics%5C%5Cdynamics-b%5C%5Ccryptopi-dynamics%5C%5Csrc%5C%5Clib%5C%5Csettings%5C%5Cserver.ts%22%2C%5B%7B%22id%22%3A%2200532f31c65bd9d7119874b7c000efa42c3a9e2e3a%22%2C%22exportedName%22%3A%22getAll%22%2C%22filename%22%3A%22..%2FH%3A%5C%5CUsers%5C%5CGus%5C%5Csource%5C%5Crepo%5C%5Cdynamics%5C%5Cdynamics-b%5C%5Ccryptopi-dynamics%5C%5Csrc%5C%5Clib%5C%5Csettings%5C%5Cserver.ts%22%7D%2C%7B%22id%22%3A%2200696b0d07c16ebe05246c326940d3b9133dac036c%22%2C%22exportedName%22%3A%22resolveCoinsFromSettings%22%2C%22filename%22%3A%22..%2FH%3A%5C%5CUsers%5C%5CGus%5C%5Csource%5C%5Crepo%5C%5Cdynamics%5C%5Cdynamics-b%5C%5Ccryptopi-dynamics%5C%5Csrc%5C%5Clib%5C%5Csettings%5C%5Cserver.ts%22%7D%2C%7B%22id%22%3A%22402b519d81502a95cf319ddb5b60bce32907aa6f08%22%2C%22exportedName%22%3A%22setAll%22%2C%22filename%22%3A%22..%2FH%3A%5C%5CUsers%5C%5CGus%5C%5Csource%5C%5Crepo%5C%5Cdynamics%5C%5Cdynamics-b%5C%5Ccryptopi-dynamics%5C%5Csrc%5C%5Clib%5C%5Csettings%5C%5Cserver.ts%22%7D%2C%7B%22id%22%3A%2240f9a1c8f3a3ab5d85ba51065396bf00a061db869e%22%2C%22exportedName%22%3A%22serializeSettingsCookie%22%2C%22filename%22%3A%22..%2FH%3A%5C%5CUsers%5C%5CGus%5C%5Csource%5C%5Crepo%5C%5Cdynamics%5C%5Cdynamics-b%5C%5Ccryptopi-dynamics%5C%5Csrc%5C%5Clib%5C%5Csettings%5C%5Cserver.ts%22%7D%5D%5D%5D&__client_imported__=!":
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/build/webpack/loaders/next-flight-action-entry-loader.js?actions=%5B%5B%22H%3A%5C%5CUsers%5C%5CGus%5C%5Csource%5C%5Crepo%5C%5Cdynamics%5C%5Cdynamics-b%5C%5Ccryptopi-dynamics%5C%5Csrc%5C%5Clib%5C%5Csettings%5C%5Cserver.ts%22%2C%5B%7B%22id%22%3A%2200532f31c65bd9d7119874b7c000efa42c3a9e2e3a%22%2C%22exportedName%22%3A%22getAll%22%2C%22filename%22%3A%22..%2FH%3A%5C%5CUsers%5C%5CGus%5C%5Csource%5C%5Crepo%5C%5Cdynamics%5C%5Cdynamics-b%5C%5Ccryptopi-dynamics%5C%5Csrc%5C%5Clib%5C%5Csettings%5C%5Cserver.ts%22%7D%2C%7B%22id%22%3A%2200696b0d07c16ebe05246c326940d3b9133dac036c%22%2C%22exportedName%22%3A%22resolveCoinsFromSettings%22%2C%22filename%22%3A%22..%2FH%3A%5C%5CUsers%5C%5CGus%5C%5Csource%5C%5Crepo%5C%5Cdynamics%5C%5Cdynamics-b%5C%5Ccryptopi-dynamics%5C%5Csrc%5C%5Clib%5C%5Csettings%5C%5Cserver.ts%22%7D%2C%7B%22id%22%3A%22402b519d81502a95cf319ddb5b60bce32907aa6f08%22%2C%22exportedName%22%3A%22setAll%22%2C%22filename%22%3A%22..%2FH%3A%5C%5CUsers%5C%5CGus%5C%5Csource%5C%5Crepo%5C%5Cdynamics%5C%5Cdynamics-b%5C%5Ccryptopi-dynamics%5C%5Csrc%5C%5Clib%5C%5Csettings%5C%5Cserver.ts%22%7D%2C%7B%22id%22%3A%2240f9a1c8f3a3ab5d85ba51065396bf00a061db869e%22%2C%22exportedName%22%3A%22serializeSettingsCookie%22%2C%22filename%22%3A%22..%2FH%3A%5C%5CUsers%5C%5CGus%5C%5Csource%5C%5Crepo%5C%5Cdynamics%5C%5Cdynamics-b%5C%5Ccryptopi-dynamics%5C%5Csrc%5C%5Clib%5C%5Csettings%5C%5Cserver.ts%22%7D%5D%5D%5D&__client_imported__=! ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"00532f31c65bd9d7119874b7c000efa42c3a9e2e3a\": () => (/* reexport safe */ H_Users_Gus_source_repo_dynamics_dynamics_b_cryptopi_dynamics_src_lib_settings_server_ts__WEBPACK_IMPORTED_MODULE_0__.getAll),\n/* harmony export */   \"00696b0d07c16ebe05246c326940d3b9133dac036c\": () => (/* reexport safe */ H_Users_Gus_source_repo_dynamics_dynamics_b_cryptopi_dynamics_src_lib_settings_server_ts__WEBPACK_IMPORTED_MODULE_0__.resolveCoinsFromSettings),\n/* harmony export */   \"402b519d81502a95cf319ddb5b60bce32907aa6f08\": () => (/* reexport safe */ H_Users_Gus_source_repo_dynamics_dynamics_b_cryptopi_dynamics_src_lib_settings_server_ts__WEBPACK_IMPORTED_MODULE_0__.setAll),\n/* harmony export */   \"40f9a1c8f3a3ab5d85ba51065396bf00a061db869e\": () => (/* reexport safe */ H_Users_Gus_source_repo_dynamics_dynamics_b_cryptopi_dynamics_src_lib_settings_server_ts__WEBPACK_IMPORTED_MODULE_0__.serializeSettingsCookie)\n/* harmony export */ });\n/* harmony import */ var H_Users_Gus_source_repo_dynamics_dynamics_b_cryptopi_dynamics_src_lib_settings_server_ts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./src/lib/settings/server.ts */ \"(rsc)/./src/lib/settings/server.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([H_Users_Gus_source_repo_dynamics_dynamics_b_cryptopi_dynamics_src_lib_settings_server_ts__WEBPACK_IMPORTED_MODULE_0__]);\nH_Users_Gus_source_repo_dynamics_dynamics_b_cryptopi_dynamics_src_lib_settings_server_ts__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbmV4dEAxNS41LjJfQHBsYXl3cmlnaHQrdGVzX2I3ZTZjMjgwZTlhMWI0MzA5MzQ3YzBiZjBhYjQ3NmQ1L25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtZmxpZ2h0LWFjdGlvbi1lbnRyeS1sb2FkZXIuanM/YWN0aW9ucz0lNUIlNUIlMjJIJTNBJTVDJTVDVXNlcnMlNUMlNUNHdXMlNUMlNUNzb3VyY2UlNUMlNUNyZXBvJTVDJTVDZHluYW1pY3MlNUMlNUNkeW5hbWljcy1iJTVDJTVDY3J5cHRvcGktZHluYW1pY3MlNUMlNUNzcmMlNUMlNUNsaWIlNUMlNUNzZXR0aW5ncyU1QyU1Q3NlcnZlci50cyUyMiUyQyU1QiU3QiUyMmlkJTIyJTNBJTIyMDA1MzJmMzFjNjViZDlkNzExOTg3NGI3YzAwMGVmYTQyYzNhOWUyZTNhJTIyJTJDJTIyZXhwb3J0ZWROYW1lJTIyJTNBJTIyZ2V0QWxsJTIyJTJDJTIyZmlsZW5hbWUlMjIlM0ElMjIuLiUyRkglM0ElNUMlNUNVc2VycyU1QyU1Q0d1cyU1QyU1Q3NvdXJjZSU1QyU1Q3JlcG8lNUMlNUNkeW5hbWljcyU1QyU1Q2R5bmFtaWNzLWIlNUMlNUNjcnlwdG9waS1keW5hbWljcyU1QyU1Q3NyYyU1QyU1Q2xpYiU1QyU1Q3NldHRpbmdzJTVDJTVDc2VydmVyLnRzJTIyJTdEJTJDJTdCJTIyaWQlMjIlM0ElMjIwMDY5NmIwZDA3YzE2ZWJlMDUyNDZjMzI2OTQwZDNiOTEzM2RhYzAzNmMlMjIlMkMlMjJleHBvcnRlZE5hbWUlMjIlM0ElMjJyZXNvbHZlQ29pbnNGcm9tU2V0dGluZ3MlMjIlMkMlMjJmaWxlbmFtZSUyMiUzQSUyMi4uJTJGSCUzQSU1QyU1Q1VzZXJzJTVDJTVDR3VzJTVDJTVDc291cmNlJTVDJTVDcmVwbyU1QyU1Q2R5bmFtaWNzJTVDJTVDZHluYW1pY3MtYiU1QyU1Q2NyeXB0b3BpLWR5bmFtaWNzJTVDJTVDc3JjJTVDJTVDbGliJTVDJTVDc2V0dGluZ3MlNUMlNUNzZXJ2ZXIudHMlMjIlN0QlMkMlN0IlMjJpZCUyMiUzQSUyMjQwMmI1MTlkODE1MDJhOTVjZjMxOWRkYjViNjBiY2UzMjkwN2FhNmYwOCUyMiUyQyUyMmV4cG9ydGVkTmFtZSUyMiUzQSUyMnNldEFsbCUyMiUyQyUyMmZpbGVuYW1lJTIyJTNBJTIyLi4lMkZIJTNBJTVDJTVDVXNlcnMlNUMlNUNHdXMlNUMlNUNzb3VyY2UlNUMlNUNyZXBvJTVDJTVDZHluYW1pY3MlNUMlNUNkeW5hbWljcy1iJTVDJTVDY3J5cHRvcGktZHluYW1pY3MlNUMlNUNzcmMlNUMlNUNsaWIlNUMlNUNzZXR0aW5ncyU1QyU1Q3NlcnZlci50cyUyMiU3RCUyQyU3QiUyMmlkJTIyJTNBJTIyNDBmOWExYzhmM2EzYWI1ZDg1YmE1MTA2NTM5NmJmMDBhMDYxZGI4NjllJTIyJTJDJTIyZXhwb3J0ZWROYW1lJTIyJTNBJTIyc2VyaWFsaXplU2V0dGluZ3NDb29raWUlMjIlMkMlMjJmaWxlbmFtZSUyMiUzQSUyMi4uJTJGSCUzQSU1QyU1Q1VzZXJzJTVDJTVDR3VzJTVDJTVDc291cmNlJTVDJTVDcmVwbyU1QyU1Q2R5bmFtaWNzJTVDJTVDZHluYW1pY3MtYiU1QyU1Q2NyeXB0b3BpLWR5bmFtaWNzJTVDJTVDc3JjJTVDJTVDbGliJTVDJTVDc2V0dGluZ3MlNUMlNUNzZXJ2ZXIudHMlMjIlN0QlNUQlNUQlNUQmX19jbGllbnRfaW1wb3J0ZWRfXz0hIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUM2SztBQUNrQjtBQUNsQjtBQUNpQiIsInNvdXJjZXMiOlsiIl0sInNvdXJjZXNDb250ZW50IjpbIlxuZXhwb3J0IHsgZ2V0QWxsIGFzIFwiMDA1MzJmMzFjNjViZDlkNzExOTg3NGI3YzAwMGVmYTQyYzNhOWUyZTNhXCIgfSBmcm9tIFwiSDpcXFxcVXNlcnNcXFxcR3VzXFxcXHNvdXJjZVxcXFxyZXBvXFxcXGR5bmFtaWNzXFxcXGR5bmFtaWNzLWJcXFxcY3J5cHRvcGktZHluYW1pY3NcXFxcc3JjXFxcXGxpYlxcXFxzZXR0aW5nc1xcXFxzZXJ2ZXIudHNcIlxuZXhwb3J0IHsgcmVzb2x2ZUNvaW5zRnJvbVNldHRpbmdzIGFzIFwiMDA2OTZiMGQwN2MxNmViZTA1MjQ2YzMyNjk0MGQzYjkxMzNkYWMwMzZjXCIgfSBmcm9tIFwiSDpcXFxcVXNlcnNcXFxcR3VzXFxcXHNvdXJjZVxcXFxyZXBvXFxcXGR5bmFtaWNzXFxcXGR5bmFtaWNzLWJcXFxcY3J5cHRvcGktZHluYW1pY3NcXFxcc3JjXFxcXGxpYlxcXFxzZXR0aW5nc1xcXFxzZXJ2ZXIudHNcIlxuZXhwb3J0IHsgc2V0QWxsIGFzIFwiNDAyYjUxOWQ4MTUwMmE5NWNmMzE5ZGRiNWI2MGJjZTMyOTA3YWE2ZjA4XCIgfSBmcm9tIFwiSDpcXFxcVXNlcnNcXFxcR3VzXFxcXHNvdXJjZVxcXFxyZXBvXFxcXGR5bmFtaWNzXFxcXGR5bmFtaWNzLWJcXFxcY3J5cHRvcGktZHluYW1pY3NcXFxcc3JjXFxcXGxpYlxcXFxzZXR0aW5nc1xcXFxzZXJ2ZXIudHNcIlxuZXhwb3J0IHsgc2VyaWFsaXplU2V0dGluZ3NDb29raWUgYXMgXCI0MGY5YTFjOGYzYTNhYjVkODViYTUxMDY1Mzk2YmYwMGEwNjFkYjg2OWVcIiB9IGZyb20gXCJIOlxcXFxVc2Vyc1xcXFxHdXNcXFxcc291cmNlXFxcXHJlcG9cXFxcZHluYW1pY3NcXFxcZHluYW1pY3MtYlxcXFxjcnlwdG9waS1keW5hbWljc1xcXFxzcmNcXFxcbGliXFxcXHNldHRpbmdzXFxcXHNlcnZlci50c1wiXG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/build/webpack/loaders/next-flight-action-entry-loader.js?actions=%5B%5B%22H%3A%5C%5CUsers%5C%5CGus%5C%5Csource%5C%5Crepo%5C%5Cdynamics%5C%5Cdynamics-b%5C%5Ccryptopi-dynamics%5C%5Csrc%5C%5Clib%5C%5Csettings%5C%5Cserver.ts%22%2C%5B%7B%22id%22%3A%2200532f31c65bd9d7119874b7c000efa42c3a9e2e3a%22%2C%22exportedName%22%3A%22getAll%22%2C%22filename%22%3A%22..%2FH%3A%5C%5CUsers%5C%5CGus%5C%5Csource%5C%5Crepo%5C%5Cdynamics%5C%5Cdynamics-b%5C%5Ccryptopi-dynamics%5C%5Csrc%5C%5Clib%5C%5Csettings%5C%5Cserver.ts%22%7D%2C%7B%22id%22%3A%2200696b0d07c16ebe05246c326940d3b9133dac036c%22%2C%22exportedName%22%3A%22resolveCoinsFromSettings%22%2C%22filename%22%3A%22..%2FH%3A%5C%5CUsers%5C%5CGus%5C%5Csource%5C%5Crepo%5C%5Cdynamics%5C%5Cdynamics-b%5C%5Ccryptopi-dynamics%5C%5Csrc%5C%5Clib%5C%5Csettings%5C%5Cserver.ts%22%7D%2C%7B%22id%22%3A%22402b519d81502a95cf319ddb5b60bce32907aa6f08%22%2C%22exportedName%22%3A%22setAll%22%2C%22filename%22%3A%22..%2FH%3A%5C%5CUsers%5C%5CGus%5C%5Csource%5C%5Crepo%5C%5Cdynamics%5C%5Cdynamics-b%5C%5Ccryptopi-dynamics%5C%5Csrc%5C%5Clib%5C%5Csettings%5C%5Cserver.ts%22%7D%2C%7B%22id%22%3A%2240f9a1c8f3a3ab5d85ba51065396bf00a061db869e%22%2C%22exportedName%22%3A%22serializeSettingsCookie%22%2C%22filename%22%3A%22..%2FH%3A%5C%5CUsers%5C%5CGus%5C%5Csource%5C%5Crepo%5C%5Cdynamics%5C%5Cdynamics-b%5C%5Ccryptopi-dynamics%5C%5Csrc%5C%5Clib%5C%5Csettings%5C%5Cserver.ts%22%7D%5D%5D%5D&__client_imported__=!\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!**************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \**************************************************************************************************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./src/app/api/moo-aux/route.ts":
/*!**************************************!*\
  !*** ./src/app/api/moo-aux/route.ts ***!
  \**************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   dynamic: () => (/* binding */ dynamic),\n/* harmony export */   revalidate: () => (/* binding */ revalidate)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/api/server.js\");\n/* harmony import */ var _core_db_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/core/db/db */ \"(rsc)/./src/core/db/db.ts\");\n/* harmony import */ var _core_features_moo_aux_measures__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/core/features/moo-aux/measures */ \"(rsc)/./src/core/features/moo-aux/measures.ts\");\n/* harmony import */ var _core_features_moo_aux_tiers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/core/features/moo-aux/tiers */ \"(rsc)/./src/core/features/moo-aux/tiers.ts\");\n/* harmony import */ var _lib_markets_availability__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/markets/availability */ \"(rsc)/./src/lib/markets/availability.ts\");\n/* harmony import */ var _lib_settings_server__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/lib/settings/server */ \"(rsc)/./src/lib/settings/server.ts\");\n/* harmony import */ var _lib_mea_mood__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/lib/mea/mood */ \"(rsc)/./src/lib/mea/mood.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_core_db_db__WEBPACK_IMPORTED_MODULE_1__, _core_features_moo_aux_measures__WEBPACK_IMPORTED_MODULE_2__, _lib_settings_server__WEBPACK_IMPORTED_MODULE_5__]);\n([_core_db_db__WEBPACK_IMPORTED_MODULE_1__, _core_features_moo_aux_measures__WEBPACK_IMPORTED_MODULE_2__, _lib_settings_server__WEBPACK_IMPORTED_MODULE_5__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n\n\n\n// NEW: mood imports (added in lib/mood.ts per our plan)\n\nconst dynamic = \"force-dynamic\";\nconst revalidate = 0;\nconst CACHE_HEADERS = {\n    \"Cache-Control\": \"no-store\"\n};\nconst DEFAULT_COINS = [\n    \"USDT\",\n    \"BTC\",\n    \"ETH\",\n    \"BNB\",\n    \"SOL\"\n];\nasync function GET(req) {\n    try {\n        const url = new URL(req.url);\n        // -------- timing\n        const tsParam = Number(url.searchParams.get(\"ts\") ?? url.searchParams.get(\"timestamp\"));\n        const tsMs = Number.isFinite(tsParam) && tsParam > 0 ? tsParam : Date.now();\n        // -------- coins universe\n        const { coins: initialCoins, source: coinsSource } = await resolveCoins(url);\n        // -------- id_pct grid (DB-backed)\n        const { grid: idPctGridRaw, source: idPctSource } = await readIdPctGrid(initialCoins, tsMs);\n        const dedupedCoins = dedupeCoins([\n            ...initialCoins,\n            ...coinsFromGrid(idPctGridRaw)\n        ]);\n        if (!dedupedCoins.length) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                ok: true,\n                coins: [],\n                k: 0,\n                grid: {}\n            }, {\n                headers: CACHE_HEADERS\n            });\n        }\n        let coins = dedupedCoins;\n        if (!coins.includes(\"USDT\")) coins = [\n            \"USDT\",\n            ...coins\n        ];\n        // -------- availability filter\n        const availability = await (0,_lib_markets_availability__WEBPACK_IMPORTED_MODULE_4__.resolvePairAvailability)(coins);\n        const allowedSymbols = availability.set;\n        // -------- normalize id_pct grid + balances\n        const idPctGrid = ensureIdPctGrid(idPctGridRaw, coins);\n        const { balances, source: balanceSource } = await readBalancesFromLedger(coins);\n        // -------- divisor (k)\n        const kParam = Number(url.searchParams.get(\"k\"));\n        const divisor = Number.isFinite(kParam) && kParam > 0 ? Math.floor(kParam) : Math.max(1, coins.length - 1);\n        // ======== NEW: mood normalization & coefficient (anchored) ========\n        // Query overrides (optional) for testing:\n        const q_gfmDeltaPct = toNum(url.searchParams.get(\"gfmDeltaPct\")); // e.g. 0.01 for +1%\n        const q_tendencyRaw = toNum(url.searchParams.get(\"tendencyRaw\"));\n        const q_swapRaw = toNum(url.searchParams.get(\"swapRaw\"));\n        const refs = {\n            gfmScale: toNum(url.searchParams.get(\"gfmScale\")) ?? 20,\n            vtMu: toNum(url.searchParams.get(\"vtMu\")) ?? 0,\n            vtSigma: toNum(url.searchParams.get(\"vtSigma\")) ?? 0.02,\n            vsMu: toNum(url.searchParams.get(\"vsMu\")) ?? 0,\n            vsSigma: toNum(url.searchParams.get(\"vsSigma\")) ?? 0.05,\n            vsAlpha: toNum(url.searchParams.get(\"vsAlpha\")) ?? 0.75\n        };\n        // If query provides raw mood inputs, use them; else fall back to neutral (or wire your metrics here)\n        const haveRaw = q_gfmDeltaPct != null || q_tendencyRaw != null || q_swapRaw != null;\n        const moodInputs = haveRaw ? (0,_lib_mea_mood__WEBPACK_IMPORTED_MODULE_6__.normalizeMoodInputs)({\n            gfmDeltaPct: q_gfmDeltaPct ?? 0,\n            tendencyRaw: q_tendencyRaw ?? 0,\n            swapRaw: q_swapRaw ?? 0\n        }, refs) : {\n            vTendency: 0.8,\n            GFM: 1.0,\n            vSwap: 0\n        };\n        const { coeff: moodCoeff, buckets } = (0,_lib_mea_mood__WEBPACK_IMPORTED_MODULE_6__.computeMoodCoeffV1)(moodInputs);\n        const moodUUID = (0,_lib_mea_mood__WEBPACK_IMPORTED_MODULE_6__.moodUUIDFromBuckets)(buckets);\n        // ================================================================\n        // -------- build MEA weights (legacy function untouched)\n        const grid = (0,_core_features_moo_aux_measures__WEBPACK_IMPORTED_MODULE_2__.buildMeaAux)({\n            coins,\n            idPct: idPctGrid,\n            balances,\n            k: divisor,\n            rules: _core_features_moo_aux_tiers__WEBPACK_IMPORTED_MODULE_3__.DEFAULT_TIER_RULES\n        });\n        // Apply mood scaling non-destructively (keep legacy behavior intact)\n        for (const base of coins){\n            for (const quote of coins){\n                if (quote === base) continue;\n                const v = grid?.[base]?.[quote];\n                if (v != null) grid[base][quote] = Number(v) * moodCoeff;\n            }\n        }\n        // -------- mask unavailable symbols/pairs\n        if (allowedSymbols.size) {\n            (0,_lib_markets_availability__WEBPACK_IMPORTED_MODULE_4__.maskUnavailableMatrix)(grid, allowedSymbols);\n            (0,_lib_markets_availability__WEBPACK_IMPORTED_MODULE_4__.maskUnavailableMatrix)(idPctGrid, allowedSymbols);\n        }\n        // -------- response\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            ok: true,\n            ts_ms: tsMs,\n            coins,\n            k: divisor,\n            grid,\n            id_pct: idPctGrid,\n            balances,\n            mood: {\n                coeff: moodCoeff,\n                uuid: moodUUID,\n                // echo inputs/refs for transparency (helpful when testing via query)\n                inputs: moodInputs,\n                refs\n            },\n            sources: {\n                coins: coinsSource,\n                id_pct: idPctSource,\n                balances: balanceSource\n            },\n            availability: {\n                symbols: availability.symbols,\n                pairs: availability.pairs\n            }\n        }, {\n            headers: CACHE_HEADERS\n        });\n    } catch (err) {\n        const message = err instanceof Error ? err.message : String(err);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            ok: false,\n            error: message\n        }, {\n            status: 500,\n            headers: CACHE_HEADERS\n        });\n    }\n}\n//  helpers (unchanged + small additions)\nfunction toNum(x) {\n    if (x == null) return null;\n    const n = Number(x);\n    return Number.isFinite(n) ? n : null;\n}\nfunction normalizeCoinSymbol(raw) {\n    if (raw == null) return null;\n    const trimmed = String(raw).trim().toUpperCase();\n    return trimmed ? trimmed : null;\n}\nfunction dedupeCoins(list) {\n    const seen = new Set();\n    const out = [];\n    for (const item of list){\n        const norm = normalizeCoinSymbol(item);\n        if (!norm || seen.has(norm)) continue;\n        seen.add(norm);\n        out.push(norm);\n    }\n    return out;\n}\nfunction emptyBalances(coins) {\n    const out = {};\n    for (const coin of coins)out[coin] = 0;\n    return out;\n}\nfunction coinsFromGrid(grid) {\n    const set = new Set();\n    for (const base of Object.keys(grid ?? {})){\n        if (base) set.add(base);\n        const row = grid?.[base] ?? {};\n        for (const quote of Object.keys(row)){\n            if (quote) set.add(quote);\n        }\n    }\n    return Array.from(set);\n}\nfunction ensureIdPctGrid(grid, coins) {\n    for (const base of coins){\n        if (!grid[base]) grid[base] = {};\n        for (const quote of coins){\n            if (base === quote) {\n                grid[base][quote] = null;\n                continue;\n            }\n            const raw = Number(grid[base][quote]);\n            grid[base][quote] = Number.isFinite(raw) ? raw : 0;\n        }\n    }\n    return grid;\n}\nasync function resolveCoins(url) {\n    const coinsParam = url.searchParams.get(\"coins\");\n    if (coinsParam) {\n        const tokens = coinsParam.split(/[,\\s]+/).map((token)=>token.trim().toUpperCase()).filter(Boolean);\n        const coins = dedupeCoins(tokens);\n        if (coins.length) return {\n            coins,\n            source: \"query\"\n        };\n    }\n    try {\n        const settingsCoins = await (0,_lib_settings_server__WEBPACK_IMPORTED_MODULE_5__.resolveCoinsFromSettings)();\n        const coins = dedupeCoins(settingsCoins);\n        if (coins.length) return {\n            coins,\n            source: \"settings\"\n        };\n    } catch  {\n    // ignore parse errors from cookies/session\n    }\n    return {\n        coins: [\n            ...DEFAULT_COINS\n        ],\n        source: \"fallback\"\n    };\n}\nasync function readBalancesFromLedger(coins) {\n    if (!coins.length) return {\n        balances: {},\n        source: \"empty\"\n    };\n    const targets = coins.map((coin)=>coin.toUpperCase());\n    const zeros = emptyBalances(targets);\n    try {\n        const { rows } = await _core_db_db__WEBPACK_IMPORTED_MODULE_1__.db.query(`SELECT asset, amount\n         FROM wallet_balances_latest\n        WHERE asset = ANY($1::text[])`, [\n            targets\n        ]);\n        if (rows?.length) {\n            const balances = {\n                ...zeros\n            };\n            for (const row of rows){\n                const asset = normalizeCoinSymbol(row.asset);\n                if (!asset) continue;\n                const amount = Number(row.amount);\n                balances[asset] = Number.isFinite(amount) ? amount : 0;\n            }\n            return {\n                balances,\n                source: \"wallet_balances_latest\"\n            };\n        }\n    } catch  {\n    // preferred view may not exist; fall through\n    }\n    try {\n        const { rows } = await _core_db_db__WEBPACK_IMPORTED_MODULE_1__.db.query(`SELECT DISTINCT ON (asset) asset, amount\n         FROM balances\n        WHERE asset = ANY($1::text[])\n        ORDER BY asset, ts_epoch_ms DESC`, [\n            targets\n        ]);\n        if (rows?.length) {\n            const balances = {\n                ...zeros\n            };\n            for (const row of rows){\n                const asset = normalizeCoinSymbol(row.asset);\n                if (!asset) continue;\n                const amount = Number(row.amount);\n                balances[asset] = Number.isFinite(amount) ? amount : 0;\n            }\n            return {\n                balances,\n                source: \"balances\"\n            };\n        }\n    } catch  {\n    // optional historical table; fall through\n    }\n    return {\n        balances: zeros,\n        source: \"fallback:zero\"\n    };\n}\nasync function readIdPctGrid(coins, tsMs) {\n    const targets = coins.map((coin)=>coin.toUpperCase());\n    const baseGrid = {};\n    for (const base of targets){\n        baseGrid[base] = {};\n        for (const quote of targets)baseGrid[base][quote] = base === quote ? null : 0;\n    }\n    if (!targets.length) return {\n        grid: baseGrid,\n        source: \"empty\"\n    };\n    if (Number.isFinite(tsMs)) {\n        try {\n            const { rows } = await _core_db_db__WEBPACK_IMPORTED_MODULE_1__.db.query(`SELECT DISTINCT ON (base, quote) base, quote, id_pct\n           FROM id_pct_pairs\n          WHERE ts_epoch_ms <= $1\n            AND base = ANY($2::text[])\n            AND quote = ANY($2::text[])\n          ORDER BY base, quote, ts_epoch_ms DESC`, [\n                tsMs,\n                targets\n            ]);\n            if (rows?.length) {\n                for (const row of rows){\n                    const base = normalizeCoinSymbol(row.base);\n                    const quote = normalizeCoinSymbol(row.quote);\n                    if (!base || !quote || base === quote) continue;\n                    const idp = Number(row.id_pct);\n                    if (!baseGrid[base]) baseGrid[base] = {};\n                    baseGrid[base][quote] = Number.isFinite(idp) ? idp : 0;\n                }\n                return {\n                    grid: ensureIdPctGrid(baseGrid, targets),\n                    source: \"id_pct_pairs\"\n                };\n            }\n        } catch  {\n        // fall back to latest view\n        }\n    }\n    try {\n        const { rows } = await _core_db_db__WEBPACK_IMPORTED_MODULE_1__.db.query(`SELECT base, quote, id_pct\n         FROM id_pct_latest\n        WHERE base = ANY($1::text[])\n          AND quote = ANY($1::text[])`, [\n            targets\n        ]);\n        if (rows?.length) {\n            for (const row of rows){\n                const base = normalizeCoinSymbol(row.base);\n                const quote = normalizeCoinSymbol(row.quote);\n                if (!base || !quote || base === quote) continue;\n                const idp = Number(row.id_pct);\n                if (!baseGrid[base]) baseGrid[base] = {};\n                baseGrid[base][quote] = Number.isFinite(idp) ? idp : 0;\n            }\n            return {\n                grid: ensureIdPctGrid(baseGrid, targets),\n                source: \"id_pct_latest\"\n            };\n        }\n    } catch  {\n    // fall through to metrics table\n    }\n    const metricKeys = [];\n    for (const base of targets){\n        for (const quote of targets){\n            if (base === quote) continue;\n            metricKeys.push(`id_pct:${base}|${quote}`);\n        }\n    }\n    if (metricKeys.length) {\n        try {\n            const { rows } = await _core_db_db__WEBPACK_IMPORTED_MODULE_1__.db.query(`SELECT DISTINCT ON (metric_key) metric_key, value\n           FROM metrics\n          WHERE metric_key = ANY($1::text[])\n          ORDER BY metric_key, ts_epoch_ms DESC`, [\n                metricKeys\n            ]);\n            if (rows?.length) {\n                for (const row of rows){\n                    const key = String(row.metric_key ?? \"\");\n                    const [, payload] = key.split(\"id_pct:\");\n                    if (!payload) continue;\n                    const [baseRaw, quoteRaw] = payload.split(\"|\");\n                    const base = normalizeCoinSymbol(baseRaw);\n                    const quote = normalizeCoinSymbol(quoteRaw);\n                    if (!base || !quote || base === quote) continue;\n                    if (!baseGrid[base]) baseGrid[base] = {};\n                    const idp = Number(row.value);\n                    baseGrid[base][quote] = Number.isFinite(idp) ? idp : 0;\n                }\n                return {\n                    grid: ensureIdPctGrid(baseGrid, targets),\n                    source: \"metrics\"\n                };\n            }\n        } catch  {\n        // ignore and fall back to zeros\n        }\n    }\n    return {\n        grid: ensureIdPctGrid(baseGrid, targets),\n        source: \"fallback:zero\"\n    };\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QkFDdEIsTUFBTU8sTUFBTTNDLE9BQU91QixJQUFJcUIsVUFBVSxJQUFJO29CQUNyQyxNQUFNLEdBQUdDLFFBQVEsR0FBR0YsSUFBSWYsS0FBSyxDQUFDO29CQUM5QixJQUFJLENBQUNpQixTQUFTO29CQUNkLE1BQU0sQ0FBQ0MsU0FBU0MsU0FBUyxHQUFHRixRQUFRakIsS0FBSyxDQUFDO29CQUMxQyxNQUFNM0MsT0FBT29CLG9CQUFvQnlDO29CQUNqQyxNQUFNNUQsUUFBUW1CLG9CQUFvQjBDO29CQUNsQyxJQUFJLENBQUM5RCxRQUFRLENBQUNDLFNBQVNELFNBQVNDLE9BQU87b0JBQ3ZDLElBQUksQ0FBQ3NELFFBQVEsQ0FBQ3ZELEtBQUssRUFBRXVELFFBQVEsQ0FBQ3ZELEtBQUssR0FBRyxDQUFDO29CQUN2QyxNQUFNd0QsTUFBTXZILE9BQU9xRyxJQUFJeUIsS0FBSztvQkFDNUJSLFFBQVEsQ0FBQ3ZELEtBQUssQ0FBQ0MsTUFBTSxHQUFHaEUsT0FBT0ksUUFBUSxDQUFDbUgsT0FBT0EsTUFBTTtnQkFDdkQ7Z0JBQ0EsT0FBTztvQkFBRTNHLE1BQU1pQixnQkFBZ0J5RixVQUFVTjtvQkFBVXZHLFFBQVE7Z0JBQVU7WUFDdkU7UUFDRixFQUFFLE9BQU07UUFDTixnQ0FBZ0M7UUFDbEM7SUFDRjtJQUVBLE9BQU87UUFBRUcsTUFBTWlCLGdCQUFnQnlGLFVBQVVOO1FBQVV2RyxRQUFRO0lBQWdCO0FBQzdFIiwic291cmNlcyI6WyJIOlxcVXNlcnNcXEd1c1xcc291cmNlXFxyZXBvXFxkeW5hbWljc1xcZHluYW1pY3MtYlxcY3J5cHRvcGktZHluYW1pY3NcXHNyY1xcYXBwXFxhcGlcXG1vby1hdXhcXHJvdXRlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIjtcblxuaW1wb3J0IHsgZGIgfSBmcm9tIFwiQC9jb3JlL2RiL2RiXCI7XG5pbXBvcnQge1xuICBidWlsZE1lYUF1eCxcbiAgdHlwZSBCYWxhbmNlc01hcCxcbiAgdHlwZSBJZFBjdEdyaWQsXG59IGZyb20gXCJAL2NvcmUvZmVhdHVyZXMvbW9vLWF1eC9tZWFzdXJlc1wiO1xuaW1wb3J0IHsgREVGQVVMVF9USUVSX1JVTEVTIH0gZnJvbSBcIkAvY29yZS9mZWF0dXJlcy9tb28tYXV4L3RpZXJzXCI7XG5pbXBvcnQgeyByZXNvbHZlUGFpckF2YWlsYWJpbGl0eSwgbWFza1VuYXZhaWxhYmxlTWF0cml4IH0gZnJvbSBcIkAvbGliL21hcmtldHMvYXZhaWxhYmlsaXR5XCI7XG5pbXBvcnQgdHlwZSB7IFBhaXJBdmFpbGFiaWxpdHlTbmFwc2hvdCB9IGZyb20gXCJAL2xpYi9tYXJrZXRzL2F2YWlsYWJpbGl0eVwiO1xuaW1wb3J0IHsgcmVzb2x2ZUNvaW5zRnJvbVNldHRpbmdzIH0gZnJvbSBcIkAvbGliL3NldHRpbmdzL3NlcnZlclwiO1xuXG4vLyBORVc6IG1vb2QgaW1wb3J0cyAoYWRkZWQgaW4gbGliL21vb2QudHMgcGVyIG91ciBwbGFuKVxuaW1wb3J0IHtcbiAgbm9ybWFsaXplTW9vZElucHV0cyxcbiAgY29tcHV0ZU1vb2RDb2VmZlYxLFxuICBtb29kVVVJREZyb21CdWNrZXRzLFxuICB0eXBlIE1vb2RSZWZlcmVudGlhbHMsXG59IGZyb20gXCJAL2xpYi9tZWEvbW9vZFwiO1xuXG5leHBvcnQgY29uc3QgZHluYW1pYyA9IFwiZm9yY2UtZHluYW1pY1wiO1xuZXhwb3J0IGNvbnN0IHJldmFsaWRhdGUgPSAwO1xuXG5jb25zdCBDQUNIRV9IRUFERVJTID0geyBcIkNhY2hlLUNvbnRyb2xcIjogXCJuby1zdG9yZVwiIH07XG5jb25zdCBERUZBVUxUX0NPSU5TID0gW1wiVVNEVFwiLCBcIkJUQ1wiLCBcIkVUSFwiLCBcIkJOQlwiLCBcIlNPTFwiXTtcblxudHlwZSBCYWxhbmNlUmVhZFJlc3VsdCA9IHsgYmFsYW5jZXM6IEJhbGFuY2VzTWFwOyBzb3VyY2U6IHN0cmluZyB9O1xudHlwZSBJZFBjdFJlYWRSZXN1bHQgPSB7IGdyaWQ6IElkUGN0R3JpZDsgc291cmNlOiBzdHJpbmcgfTtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChyZXE6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc3QgdXJsID0gbmV3IFVSTChyZXEudXJsKTtcblxuICAgIC8vIC0tLS0tLS0tIHRpbWluZ1xuICAgIGNvbnN0IHRzUGFyYW0gPSBOdW1iZXIodXJsLnNlYXJjaFBhcmFtcy5nZXQoXCJ0c1wiKSA/PyB1cmwuc2VhcmNoUGFyYW1zLmdldChcInRpbWVzdGFtcFwiKSk7XG4gICAgY29uc3QgdHNNcyA9IE51bWJlci5pc0Zpbml0ZSh0c1BhcmFtKSAmJiB0c1BhcmFtID4gMCA/IHRzUGFyYW0gOiBEYXRlLm5vdygpO1xuXG4gICAgLy8gLS0tLS0tLS0gY29pbnMgdW5pdmVyc2VcbiAgICBjb25zdCB7IGNvaW5zOiBpbml0aWFsQ29pbnMsIHNvdXJjZTogY29pbnNTb3VyY2UgfSA9IGF3YWl0IHJlc29sdmVDb2lucyh1cmwpO1xuXG4gICAgLy8gLS0tLS0tLS0gaWRfcGN0IGdyaWQgKERCLWJhY2tlZClcbiAgICBjb25zdCB7IGdyaWQ6IGlkUGN0R3JpZFJhdywgc291cmNlOiBpZFBjdFNvdXJjZSB9ID0gYXdhaXQgcmVhZElkUGN0R3JpZChpbml0aWFsQ29pbnMsIHRzTXMpO1xuICAgIGNvbnN0IGRlZHVwZWRDb2lucyA9IGRlZHVwZUNvaW5zKFsuLi5pbml0aWFsQ29pbnMsIC4uLmNvaW5zRnJvbUdyaWQoaWRQY3RHcmlkUmF3KV0pO1xuICAgIGlmICghZGVkdXBlZENvaW5zLmxlbmd0aCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IG9rOiB0cnVlLCBjb2luczogW10sIGs6IDAsIGdyaWQ6IHt9IH0sXG4gICAgICAgIHsgaGVhZGVyczogQ0FDSEVfSEVBREVSUyB9LFxuICAgICAgKTtcbiAgICB9XG4gICAgbGV0IGNvaW5zID0gZGVkdXBlZENvaW5zO1xuICAgIGlmICghY29pbnMuaW5jbHVkZXMoXCJVU0RUXCIpKSBjb2lucyA9IFtcIlVTRFRcIiwgLi4uY29pbnNdO1xuXG4gICAgLy8gLS0tLS0tLS0gYXZhaWxhYmlsaXR5IGZpbHRlclxuICAgIGNvbnN0IGF2YWlsYWJpbGl0eTogUGFpckF2YWlsYWJpbGl0eVNuYXBzaG90ID0gYXdhaXQgcmVzb2x2ZVBhaXJBdmFpbGFiaWxpdHkoY29pbnMpO1xuICAgIGNvbnN0IGFsbG93ZWRTeW1ib2xzID0gYXZhaWxhYmlsaXR5LnNldDtcblxuICAgIC8vIC0tLS0tLS0tIG5vcm1hbGl6ZSBpZF9wY3QgZ3JpZCArIGJhbGFuY2VzXG4gICAgY29uc3QgaWRQY3RHcmlkID0gZW5zdXJlSWRQY3RHcmlkKGlkUGN0R3JpZFJhdywgY29pbnMpO1xuICAgIGNvbnN0IHsgYmFsYW5jZXMsIHNvdXJjZTogYmFsYW5jZVNvdXJjZSB9ID0gYXdhaXQgcmVhZEJhbGFuY2VzRnJvbUxlZGdlcihjb2lucyk7XG5cbiAgICAvLyAtLS0tLS0tLSBkaXZpc29yIChrKVxuICAgIGNvbnN0IGtQYXJhbSA9IE51bWJlcih1cmwuc2VhcmNoUGFyYW1zLmdldChcImtcIikpO1xuICAgIGNvbnN0IGRpdmlzb3IgPSBOdW1iZXIuaXNGaW5pdGUoa1BhcmFtKSAmJiBrUGFyYW0gPiAwXG4gICAgICA/IE1hdGguZmxvb3Ioa1BhcmFtKVxuICAgICAgOiBNYXRoLm1heCgxLCBjb2lucy5sZW5ndGggLSAxKTtcblxuICAgIC8vID09PT09PT09IE5FVzogbW9vZCBub3JtYWxpemF0aW9uICYgY29lZmZpY2llbnQgKGFuY2hvcmVkKSA9PT09PT09PVxuICAgIC8vIFF1ZXJ5IG92ZXJyaWRlcyAob3B0aW9uYWwpIGZvciB0ZXN0aW5nOlxuICAgIGNvbnN0IHFfZ2ZtRGVsdGFQY3QgPSB0b051bSh1cmwuc2VhcmNoUGFyYW1zLmdldChcImdmbURlbHRhUGN0XCIpKTsgLy8gZS5nLiAwLjAxIGZvciArMSVcbiAgICBjb25zdCBxX3RlbmRlbmN5UmF3ID0gdG9OdW0odXJsLnNlYXJjaFBhcmFtcy5nZXQoXCJ0ZW5kZW5jeVJhd1wiKSk7XG4gICAgY29uc3QgcV9zd2FwUmF3ICAgICA9IHRvTnVtKHVybC5zZWFyY2hQYXJhbXMuZ2V0KFwic3dhcFJhd1wiKSk7XG5cbiAgICBjb25zdCByZWZzOiBNb29kUmVmZXJlbnRpYWxzID0ge1xuICAgICAgZ2ZtU2NhbGU6IHRvTnVtKHVybC5zZWFyY2hQYXJhbXMuZ2V0KFwiZ2ZtU2NhbGVcIikpID8/IDIwLCAvLyArMSUg4oaSIDEuMlxuICAgICAgdnRNdTogdG9OdW0odXJsLnNlYXJjaFBhcmFtcy5nZXQoXCJ2dE11XCIpKSA/PyAwLFxuICAgICAgdnRTaWdtYTogdG9OdW0odXJsLnNlYXJjaFBhcmFtcy5nZXQoXCJ2dFNpZ21hXCIpKSA/PyAwLjAyLFxuICAgICAgdnNNdTogdG9OdW0odXJsLnNlYXJjaFBhcmFtcy5nZXQoXCJ2c011XCIpKSA/PyAwLFxuICAgICAgdnNTaWdtYTogdG9OdW0odXJsLnNlYXJjaFBhcmFtcy5nZXQoXCJ2c1NpZ21hXCIpKSA/PyAwLjA1LFxuICAgICAgdnNBbHBoYTogdG9OdW0odXJsLnNlYXJjaFBhcmFtcy5nZXQoXCJ2c0FscGhhXCIpKSA/PyAwLjc1LFxuICAgIH07XG5cbiAgICAvLyBJZiBxdWVyeSBwcm92aWRlcyByYXcgbW9vZCBpbnB1dHMsIHVzZSB0aGVtOyBlbHNlIGZhbGwgYmFjayB0byBuZXV0cmFsIChvciB3aXJlIHlvdXIgbWV0cmljcyBoZXJlKVxuICAgIGNvbnN0IGhhdmVSYXcgPVxuICAgICAgcV9nZm1EZWx0YVBjdCAhPSBudWxsIHx8IHFfdGVuZGVuY3lSYXcgIT0gbnVsbCB8fCBxX3N3YXBSYXcgIT0gbnVsbDtcblxuICAgIGNvbnN0IG1vb2RJbnB1dHMgPSBoYXZlUmF3XG4gICAgICA/IG5vcm1hbGl6ZU1vb2RJbnB1dHMoXG4gICAgICAgICAge1xuICAgICAgICAgICAgZ2ZtRGVsdGFQY3Q6IHFfZ2ZtRGVsdGFQY3QgPz8gMCxcbiAgICAgICAgICAgIHRlbmRlbmN5UmF3OiBxX3RlbmRlbmN5UmF3ID8/IDAsXG4gICAgICAgICAgICBzd2FwUmF3OiBxX3N3YXBSYXcgPz8gMCxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHJlZnNcbiAgICAgICAgKVxuICAgICAgOiAvLyBUT0RPOiBwbHVnIHJlYWwgc2VydmVyIG1ldHJpY3MgLT4gbm9ybWFsaXplTW9vZElucHV0cyhyYXcsIHJlZnMpXG4gICAgICAgIHsgdlRlbmRlbmN5OiAwLjgsIEdGTTogMS4wLCB2U3dhcDogMCB9O1xuXG4gICAgY29uc3QgeyBjb2VmZjogbW9vZENvZWZmLCBidWNrZXRzIH0gPSBjb21wdXRlTW9vZENvZWZmVjEobW9vZElucHV0cyk7XG4gICAgY29uc3QgbW9vZFVVSUQgPSBtb29kVVVJREZyb21CdWNrZXRzKGJ1Y2tldHMpO1xuICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICAgIC8vIC0tLS0tLS0tIGJ1aWxkIE1FQSB3ZWlnaHRzIChsZWdhY3kgZnVuY3Rpb24gdW50b3VjaGVkKVxuICAgIGNvbnN0IGdyaWQgPSBidWlsZE1lYUF1eCh7XG4gICAgICBjb2lucyxcbiAgICAgIGlkUGN0OiBpZFBjdEdyaWQsXG4gICAgICBiYWxhbmNlcyxcbiAgICAgIGs6IGRpdmlzb3IsXG4gICAgICBydWxlczogREVGQVVMVF9USUVSX1JVTEVTLFxuICAgIH0pO1xuXG4gICAgLy8gQXBwbHkgbW9vZCBzY2FsaW5nIG5vbi1kZXN0cnVjdGl2ZWx5IChrZWVwIGxlZ2FjeSBiZWhhdmlvciBpbnRhY3QpXG4gICAgZm9yIChjb25zdCBiYXNlIG9mIGNvaW5zKSB7XG4gICAgICBmb3IgKGNvbnN0IHF1b3RlIG9mIGNvaW5zKSB7XG4gICAgICAgIGlmIChxdW90ZSA9PT0gYmFzZSkgY29udGludWU7XG4gICAgICAgIGNvbnN0IHYgPSBncmlkPy5bYmFzZV0/LltxdW90ZV07XG4gICAgICAgIGlmICh2ICE9IG51bGwpIGdyaWRbYmFzZV1bcXVvdGVdID0gTnVtYmVyKHYpICogbW9vZENvZWZmO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIC0tLS0tLS0tIG1hc2sgdW5hdmFpbGFibGUgc3ltYm9scy9wYWlyc1xuICAgIGlmIChhbGxvd2VkU3ltYm9scy5zaXplKSB7XG4gICAgICBtYXNrVW5hdmFpbGFibGVNYXRyaXgoZ3JpZCwgYWxsb3dlZFN5bWJvbHMpO1xuICAgICAgbWFza1VuYXZhaWxhYmxlTWF0cml4KGlkUGN0R3JpZCwgYWxsb3dlZFN5bWJvbHMpO1xuICAgIH1cblxuICAgIC8vIC0tLS0tLS0tIHJlc3BvbnNlXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAge1xuICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgdHNfbXM6IHRzTXMsXG4gICAgICAgIGNvaW5zLFxuICAgICAgICBrOiBkaXZpc29yLFxuICAgICAgICBncmlkLFxuICAgICAgICBpZF9wY3Q6IGlkUGN0R3JpZCxcbiAgICAgICAgYmFsYW5jZXMsXG4gICAgICAgIG1vb2Q6IHtcbiAgICAgICAgICBjb2VmZjogbW9vZENvZWZmLFxuICAgICAgICAgIHV1aWQ6IG1vb2RVVUlELFxuICAgICAgICAgIC8vIGVjaG8gaW5wdXRzL3JlZnMgZm9yIHRyYW5zcGFyZW5jeSAoaGVscGZ1bCB3aGVuIHRlc3RpbmcgdmlhIHF1ZXJ5KVxuICAgICAgICAgIGlucHV0czogbW9vZElucHV0cyxcbiAgICAgICAgICByZWZzLFxuICAgICAgICB9LFxuICAgICAgICBzb3VyY2VzOiB7XG4gICAgICAgICAgY29pbnM6IGNvaW5zU291cmNlLFxuICAgICAgICAgIGlkX3BjdDogaWRQY3RTb3VyY2UsXG4gICAgICAgICAgYmFsYW5jZXM6IGJhbGFuY2VTb3VyY2UsXG4gICAgICAgIH0sXG4gICAgICAgIGF2YWlsYWJpbGl0eToge1xuICAgICAgICAgIHN5bWJvbHM6IGF2YWlsYWJpbGl0eS5zeW1ib2xzLFxuICAgICAgICAgIHBhaXJzOiBhdmFpbGFiaWxpdHkucGFpcnMsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgeyBoZWFkZXJzOiBDQUNIRV9IRUFERVJTIH0sXG4gICAgKTtcbiAgfSBjYXRjaCAoZXJyOiB1bmtub3duKSB7XG4gICAgY29uc3QgbWVzc2FnZSA9IGVyciBpbnN0YW5jZW9mIEVycm9yID8gZXJyLm1lc3NhZ2UgOiBTdHJpbmcoZXJyKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IG9rOiBmYWxzZSwgZXJyb3I6IG1lc3NhZ2UgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAsIGhlYWRlcnM6IENBQ0hFX0hFQURFUlMgfSxcbiAgICApO1xuICB9XG59XG5cbi8vIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCBoZWxwZXJzICh1bmNoYW5nZWQgKyBzbWFsbCBhZGRpdGlvbnMpXG5cbmZ1bmN0aW9uIHRvTnVtKHg6IHN0cmluZyB8IG51bGwpOiBudW1iZXIgfCBudWxsIHtcbiAgaWYgKHggPT0gbnVsbCkgcmV0dXJuIG51bGw7XG4gIGNvbnN0IG4gPSBOdW1iZXIoeCk7XG4gIHJldHVybiBOdW1iZXIuaXNGaW5pdGUobikgPyBuIDogbnVsbDtcbn1cblxuZnVuY3Rpb24gbm9ybWFsaXplQ29pblN5bWJvbChyYXc6IHN0cmluZyB8IG51bGwgfCB1bmRlZmluZWQpOiBzdHJpbmcgfCBudWxsIHtcbiAgaWYgKHJhdyA9PSBudWxsKSByZXR1cm4gbnVsbDtcbiAgY29uc3QgdHJpbW1lZCA9IFN0cmluZyhyYXcpLnRyaW0oKS50b1VwcGVyQ2FzZSgpO1xuICByZXR1cm4gdHJpbW1lZCA/IHRyaW1tZWQgOiBudWxsO1xufVxuXG5mdW5jdGlvbiBkZWR1cGVDb2lucyhsaXN0OiBBcnJheTxzdHJpbmc+KTogc3RyaW5nW10ge1xuICBjb25zdCBzZWVuID0gbmV3IFNldDxzdHJpbmc+KCk7XG4gIGNvbnN0IG91dDogc3RyaW5nW10gPSBbXTtcbiAgZm9yIChjb25zdCBpdGVtIG9mIGxpc3QpIHtcbiAgICBjb25zdCBub3JtID0gbm9ybWFsaXplQ29pblN5bWJvbChpdGVtKTtcbiAgICBpZiAoIW5vcm0gfHwgc2Vlbi5oYXMobm9ybSkpIGNvbnRpbnVlO1xuICAgIHNlZW4uYWRkKG5vcm0pO1xuICAgIG91dC5wdXNoKG5vcm0pO1xuICB9XG4gIHJldHVybiBvdXQ7XG59XG5cbmZ1bmN0aW9uIGVtcHR5QmFsYW5jZXMoY29pbnM6IHN0cmluZ1tdKTogQmFsYW5jZXNNYXAge1xuICBjb25zdCBvdXQ6IEJhbGFuY2VzTWFwID0ge307XG4gIGZvciAoY29uc3QgY29pbiBvZiBjb2lucykgb3V0W2NvaW5dID0gMDtcbiAgcmV0dXJuIG91dDtcbn1cblxuZnVuY3Rpb24gY29pbnNGcm9tR3JpZChncmlkOiBJZFBjdEdyaWQpOiBzdHJpbmdbXSB7XG4gIGNvbnN0IHNldCA9IG5ldyBTZXQ8c3RyaW5nPigpO1xuICBmb3IgKGNvbnN0IGJhc2Ugb2YgT2JqZWN0LmtleXMoZ3JpZCA/PyB7fSkpIHtcbiAgICBpZiAoYmFzZSkgc2V0LmFkZChiYXNlKTtcbiAgICBjb25zdCByb3cgPSBncmlkPy5bYmFzZV0gPz8ge307XG4gICAgZm9yIChjb25zdCBxdW90ZSBvZiBPYmplY3Qua2V5cyhyb3cpKSB7XG4gICAgICBpZiAocXVvdGUpIHNldC5hZGQocXVvdGUpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gQXJyYXkuZnJvbShzZXQpO1xufVxuXG5mdW5jdGlvbiBlbnN1cmVJZFBjdEdyaWQoZ3JpZDogSWRQY3RHcmlkLCBjb2luczogc3RyaW5nW10pOiBJZFBjdEdyaWQge1xuICBmb3IgKGNvbnN0IGJhc2Ugb2YgY29pbnMpIHtcbiAgICBpZiAoIWdyaWRbYmFzZV0pIGdyaWRbYmFzZV0gPSB7fTtcbiAgICBmb3IgKGNvbnN0IHF1b3RlIG9mIGNvaW5zKSB7XG4gICAgICBpZiAoYmFzZSA9PT0gcXVvdGUpIHtcbiAgICAgICAgZ3JpZFtiYXNlXVtxdW90ZV0gPSBudWxsO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHJhdyA9IE51bWJlcihncmlkW2Jhc2VdW3F1b3RlXSk7XG4gICAgICBncmlkW2Jhc2VdW3F1b3RlXSA9IE51bWJlci5pc0Zpbml0ZShyYXcpID8gcmF3IDogMDtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGdyaWQ7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHJlc29sdmVDb2lucyh1cmw6IFVSTCk6IFByb21pc2U8eyBjb2luczogc3RyaW5nW107IHNvdXJjZTogc3RyaW5nIH0+IHtcbiAgY29uc3QgY29pbnNQYXJhbSA9IHVybC5zZWFyY2hQYXJhbXMuZ2V0KFwiY29pbnNcIik7XG4gIGlmIChjb2luc1BhcmFtKSB7XG4gICAgY29uc3QgdG9rZW5zID0gY29pbnNQYXJhbVxuICAgICAgLnNwbGl0KC9bLFxcc10rLylcbiAgICAgIC5tYXAoKHRva2VuKSA9PiB0b2tlbi50cmltKCkudG9VcHBlckNhc2UoKSlcbiAgICAgIC5maWx0ZXIoQm9vbGVhbik7XG4gICAgY29uc3QgY29pbnMgPSBkZWR1cGVDb2lucyh0b2tlbnMpO1xuICAgIGlmIChjb2lucy5sZW5ndGgpIHJldHVybiB7IGNvaW5zLCBzb3VyY2U6IFwicXVlcnlcIiB9O1xuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBzZXR0aW5nc0NvaW5zID0gYXdhaXQgcmVzb2x2ZUNvaW5zRnJvbVNldHRpbmdzKCk7XG4gICAgY29uc3QgY29pbnMgPSBkZWR1cGVDb2lucyhzZXR0aW5nc0NvaW5zKTtcbiAgICBpZiAoY29pbnMubGVuZ3RoKSByZXR1cm4geyBjb2lucywgc291cmNlOiBcInNldHRpbmdzXCIgfTtcbiAgfSBjYXRjaCB7XG4gICAgLy8gaWdub3JlIHBhcnNlIGVycm9ycyBmcm9tIGNvb2tpZXMvc2Vzc2lvblxuICB9XG5cbiAgcmV0dXJuIHsgY29pbnM6IFsuLi5ERUZBVUxUX0NPSU5TXSwgc291cmNlOiBcImZhbGxiYWNrXCIgfTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gcmVhZEJhbGFuY2VzRnJvbUxlZGdlcihjb2luczogc3RyaW5nW10pOiBQcm9taXNlPEJhbGFuY2VSZWFkUmVzdWx0PiB7XG4gIGlmICghY29pbnMubGVuZ3RoKSByZXR1cm4geyBiYWxhbmNlczoge30sIHNvdXJjZTogXCJlbXB0eVwiIH07XG5cbiAgY29uc3QgdGFyZ2V0cyA9IGNvaW5zLm1hcCgoY29pbikgPT4gY29pbi50b1VwcGVyQ2FzZSgpKTtcbiAgY29uc3QgemVyb3MgPSBlbXB0eUJhbGFuY2VzKHRhcmdldHMpO1xuXG4gIHRyeSB7XG4gICAgY29uc3QgeyByb3dzIH0gPSBhd2FpdCBkYi5xdWVyeTx7IGFzc2V0OiBzdHJpbmc7IGFtb3VudDogc3RyaW5nIHwgbnVtYmVyIH0+KFxuICAgICAgYFNFTEVDVCBhc3NldCwgYW1vdW50XG4gICAgICAgICBGUk9NIHdhbGxldF9iYWxhbmNlc19sYXRlc3RcbiAgICAgICAgV0hFUkUgYXNzZXQgPSBBTlkoJDE6OnRleHRbXSlgLFxuICAgICAgW3RhcmdldHNdLFxuICAgICk7XG4gICAgaWYgKHJvd3M/Lmxlbmd0aCkge1xuICAgICAgY29uc3QgYmFsYW5jZXMgPSB7IC4uLnplcm9zIH07XG4gICAgICBmb3IgKGNvbnN0IHJvdyBvZiByb3dzKSB7XG4gICAgICAgIGNvbnN0IGFzc2V0ID0gbm9ybWFsaXplQ29pblN5bWJvbChyb3cuYXNzZXQpO1xuICAgICAgICBpZiAoIWFzc2V0KSBjb250aW51ZTtcbiAgICAgICAgY29uc3QgYW1vdW50ID0gTnVtYmVyKHJvdy5hbW91bnQpO1xuICAgICAgICBiYWxhbmNlc1thc3NldF0gPSBOdW1iZXIuaXNGaW5pdGUoYW1vdW50KSA/IGFtb3VudCA6IDA7XG4gICAgICB9XG4gICAgICByZXR1cm4geyBiYWxhbmNlcywgc291cmNlOiBcIndhbGxldF9iYWxhbmNlc19sYXRlc3RcIiB9O1xuICAgIH1cbiAgfSBjYXRjaCB7XG4gICAgLy8gcHJlZmVycmVkIHZpZXcgbWF5IG5vdCBleGlzdDsgZmFsbCB0aHJvdWdoXG4gIH1cblxuICB0cnkge1xuICAgIGNvbnN0IHsgcm93cyB9ID0gYXdhaXQgZGIucXVlcnk8eyBhc3NldDogc3RyaW5nOyBhbW91bnQ6IHN0cmluZyB8IG51bWJlciB9PihcbiAgICAgIGBTRUxFQ1QgRElTVElOQ1QgT04gKGFzc2V0KSBhc3NldCwgYW1vdW50XG4gICAgICAgICBGUk9NIGJhbGFuY2VzXG4gICAgICAgIFdIRVJFIGFzc2V0ID0gQU5ZKCQxOjp0ZXh0W10pXG4gICAgICAgIE9SREVSIEJZIGFzc2V0LCB0c19lcG9jaF9tcyBERVNDYCxcbiAgICAgIFt0YXJnZXRzXSxcbiAgICApO1xuICAgIGlmIChyb3dzPy5sZW5ndGgpIHtcbiAgICAgIGNvbnN0IGJhbGFuY2VzID0geyAuLi56ZXJvcyB9O1xuICAgICAgZm9yIChjb25zdCByb3cgb2Ygcm93cykge1xuICAgICAgICBjb25zdCBhc3NldCA9IG5vcm1hbGl6ZUNvaW5TeW1ib2wocm93LmFzc2V0KTtcbiAgICAgICAgaWYgKCFhc3NldCkgY29udGludWU7XG4gICAgICAgIGNvbnN0IGFtb3VudCA9IE51bWJlcihyb3cuYW1vdW50KTtcbiAgICAgICAgYmFsYW5jZXNbYXNzZXRdID0gTnVtYmVyLmlzRmluaXRlKGFtb3VudCkgPyBhbW91bnQgOiAwO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHsgYmFsYW5jZXMsIHNvdXJjZTogXCJiYWxhbmNlc1wiIH07XG4gICAgfVxuICB9IGNhdGNoIHtcbiAgICAvLyBvcHRpb25hbCBoaXN0b3JpY2FsIHRhYmxlOyBmYWxsIHRocm91Z2hcbiAgfVxuXG4gIHJldHVybiB7IGJhbGFuY2VzOiB6ZXJvcywgc291cmNlOiBcImZhbGxiYWNrOnplcm9cIiB9O1xufVxuXG5hc3luYyBmdW5jdGlvbiByZWFkSWRQY3RHcmlkKGNvaW5zOiBzdHJpbmdbXSwgdHNNczogbnVtYmVyKTogUHJvbWlzZTxJZFBjdFJlYWRSZXN1bHQ+IHtcbiAgY29uc3QgdGFyZ2V0cyA9IGNvaW5zLm1hcCgoY29pbikgPT4gY29pbi50b1VwcGVyQ2FzZSgpKTtcbiAgY29uc3QgYmFzZUdyaWQ6IElkUGN0R3JpZCA9IHt9O1xuICBmb3IgKGNvbnN0IGJhc2Ugb2YgdGFyZ2V0cykge1xuICAgIGJhc2VHcmlkW2Jhc2VdID0ge307XG4gICAgZm9yIChjb25zdCBxdW90ZSBvZiB0YXJnZXRzKSBiYXNlR3JpZFtiYXNlXVtxdW90ZV0gPSBiYXNlID09PSBxdW90ZSA/IG51bGwgOiAwO1xuICB9XG5cbiAgaWYgKCF0YXJnZXRzLmxlbmd0aCkgcmV0dXJuIHsgZ3JpZDogYmFzZUdyaWQsIHNvdXJjZTogXCJlbXB0eVwiIH07XG5cbiAgaWYgKE51bWJlci5pc0Zpbml0ZSh0c01zKSkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IHJvd3MgfSA9IGF3YWl0IGRiLnF1ZXJ5PHsgYmFzZTogc3RyaW5nOyBxdW90ZTogc3RyaW5nOyBpZF9wY3Q6IG51bWJlciB9PihcbiAgICAgICAgYFNFTEVDVCBESVNUSU5DVCBPTiAoYmFzZSwgcXVvdGUpIGJhc2UsIHF1b3RlLCBpZF9wY3RcbiAgICAgICAgICAgRlJPTSBpZF9wY3RfcGFpcnNcbiAgICAgICAgICBXSEVSRSB0c19lcG9jaF9tcyA8PSAkMVxuICAgICAgICAgICAgQU5EIGJhc2UgPSBBTlkoJDI6OnRleHRbXSlcbiAgICAgICAgICAgIEFORCBxdW90ZSA9IEFOWSgkMjo6dGV4dFtdKVxuICAgICAgICAgIE9SREVSIEJZIGJhc2UsIHF1b3RlLCB0c19lcG9jaF9tcyBERVNDYCxcbiAgICAgICAgW3RzTXMsIHRhcmdldHNdLFxuICAgICAgKTtcbiAgICAgIGlmIChyb3dzPy5sZW5ndGgpIHtcbiAgICAgICAgZm9yIChjb25zdCByb3cgb2Ygcm93cykge1xuICAgICAgICAgIGNvbnN0IGJhc2UgPSBub3JtYWxpemVDb2luU3ltYm9sKHJvdy5iYXNlKTtcbiAgICAgICAgICBjb25zdCBxdW90ZSA9IG5vcm1hbGl6ZUNvaW5TeW1ib2wocm93LnF1b3RlKTtcbiAgICAgICAgICBpZiAoIWJhc2UgfHwgIXF1b3RlIHx8IGJhc2UgPT09IHF1b3RlKSBjb250aW51ZTtcbiAgICAgICAgICBjb25zdCBpZHAgPSBOdW1iZXIocm93LmlkX3BjdCk7XG4gICAgICAgICAgaWYgKCFiYXNlR3JpZFtiYXNlXSkgYmFzZUdyaWRbYmFzZV0gPSB7fTtcbiAgICAgICAgICBiYXNlR3JpZFtiYXNlXVtxdW90ZV0gPSBOdW1iZXIuaXNGaW5pdGUoaWRwKSA/IGlkcCA6IDA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgZ3JpZDogZW5zdXJlSWRQY3RHcmlkKGJhc2VHcmlkLCB0YXJnZXRzKSwgc291cmNlOiBcImlkX3BjdF9wYWlyc1wiIH07XG4gICAgICB9XG4gICAgfSBjYXRjaCB7XG4gICAgICAvLyBmYWxsIGJhY2sgdG8gbGF0ZXN0IHZpZXdcbiAgICB9XG4gIH1cblxuICB0cnkge1xuICAgIGNvbnN0IHsgcm93cyB9ID0gYXdhaXQgZGIucXVlcnk8eyBiYXNlOiBzdHJpbmc7IHF1b3RlOiBzdHJpbmc7IGlkX3BjdDogbnVtYmVyIH0+KFxuICAgICAgYFNFTEVDVCBiYXNlLCBxdW90ZSwgaWRfcGN0XG4gICAgICAgICBGUk9NIGlkX3BjdF9sYXRlc3RcbiAgICAgICAgV0hFUkUgYmFzZSA9IEFOWSgkMTo6dGV4dFtdKVxuICAgICAgICAgIEFORCBxdW90ZSA9IEFOWSgkMTo6dGV4dFtdKWAsXG4gICAgICBbdGFyZ2V0c10sXG4gICAgKTtcbiAgICBpZiAocm93cz8ubGVuZ3RoKSB7XG4gICAgICBmb3IgKGNvbnN0IHJvdyBvZiByb3dzKSB7XG4gICAgICAgIGNvbnN0IGJhc2UgPSBub3JtYWxpemVDb2luU3ltYm9sKHJvdy5iYXNlKTtcbiAgICAgICAgY29uc3QgcXVvdGUgPSBub3JtYWxpemVDb2luU3ltYm9sKHJvdy5xdW90ZSk7XG4gICAgICAgIGlmICghYmFzZSB8fCAhcXVvdGUgfHwgYmFzZSA9PT0gcXVvdGUpIGNvbnRpbnVlO1xuICAgICAgICBjb25zdCBpZHAgPSBOdW1iZXIocm93LmlkX3BjdCk7XG4gICAgICAgIGlmICghYmFzZUdyaWRbYmFzZV0pIGJhc2VHcmlkW2Jhc2VdID0ge307XG4gICAgICAgIGJhc2VHcmlkW2Jhc2VdW3F1b3RlXSA9IE51bWJlci5pc0Zpbml0ZShpZHApID8gaWRwIDogMDtcbiAgICAgIH1cbiAgICAgIHJldHVybiB7IGdyaWQ6IGVuc3VyZUlkUGN0R3JpZChiYXNlR3JpZCwgdGFyZ2V0cyksIHNvdXJjZTogXCJpZF9wY3RfbGF0ZXN0XCIgfTtcbiAgICB9XG4gIH0gY2F0Y2gge1xuICAgIC8vIGZhbGwgdGhyb3VnaCB0byBtZXRyaWNzIHRhYmxlXG4gIH1cblxuICBjb25zdCBtZXRyaWNLZXlzOiBzdHJpbmdbXSA9IFtdO1xuICBmb3IgKGNvbnN0IGJhc2Ugb2YgdGFyZ2V0cykge1xuICAgIGZvciAoY29uc3QgcXVvdGUgb2YgdGFyZ2V0cykge1xuICAgICAgaWYgKGJhc2UgPT09IHF1b3RlKSBjb250aW51ZTtcbiAgICAgIG1ldHJpY0tleXMucHVzaChgaWRfcGN0OiR7YmFzZX18JHtxdW90ZX1gKTtcbiAgICB9XG4gIH1cblxuICBpZiAobWV0cmljS2V5cy5sZW5ndGgpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyByb3dzIH0gPSBhd2FpdCBkYi5xdWVyeTx7IG1ldHJpY19rZXk6IHN0cmluZzsgdmFsdWU6IG51bWJlciB9PihcbiAgICAgICAgYFNFTEVDVCBESVNUSU5DVCBPTiAobWV0cmljX2tleSkgbWV0cmljX2tleSwgdmFsdWVcbiAgICAgICAgICAgRlJPTSBtZXRyaWNzXG4gICAgICAgICAgV0hFUkUgbWV0cmljX2tleSA9IEFOWSgkMTo6dGV4dFtdKVxuICAgICAgICAgIE9SREVSIEJZIG1ldHJpY19rZXksIHRzX2Vwb2NoX21zIERFU0NgLFxuICAgICAgICBbbWV0cmljS2V5c10sXG4gICAgICApO1xuICAgICAgaWYgKHJvd3M/Lmxlbmd0aCkge1xuICAgICAgICBmb3IgKGNvbnN0IHJvdyBvZiByb3dzKSB7XG4gICAgICAgICAgY29uc3Qga2V5ID0gU3RyaW5nKHJvdy5tZXRyaWNfa2V5ID8/IFwiXCIpO1xuICAgICAgICAgIGNvbnN0IFssIHBheWxvYWRdID0ga2V5LnNwbGl0KFwiaWRfcGN0OlwiKTtcbiAgICAgICAgICBpZiAoIXBheWxvYWQpIGNvbnRpbnVlO1xuICAgICAgICAgIGNvbnN0IFtiYXNlUmF3LCBxdW90ZVJhd10gPSBwYXlsb2FkLnNwbGl0KFwifFwiKTtcbiAgICAgICAgICBjb25zdCBiYXNlID0gbm9ybWFsaXplQ29pblN5bWJvbChiYXNlUmF3KTtcbiAgICAgICAgICBjb25zdCBxdW90ZSA9IG5vcm1hbGl6ZUNvaW5TeW1ib2wocXVvdGVSYXcpO1xuICAgICAgICAgIGlmICghYmFzZSB8fCAhcXVvdGUgfHwgYmFzZSA9PT0gcXVvdGUpIGNvbnRpbnVlO1xuICAgICAgICAgIGlmICghYmFzZUdyaWRbYmFzZV0pIGJhc2VHcmlkW2Jhc2VdID0ge307XG4gICAgICAgICAgY29uc3QgaWRwID0gTnVtYmVyKHJvdy52YWx1ZSk7XG4gICAgICAgICAgYmFzZUdyaWRbYmFzZV1bcXVvdGVdID0gTnVtYmVyLmlzRmluaXRlKGlkcCkgPyBpZHAgOiAwO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IGdyaWQ6IGVuc3VyZUlkUGN0R3JpZChiYXNlR3JpZCwgdGFyZ2V0cyksIHNvdXJjZTogXCJtZXRyaWNzXCIgfTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIHtcbiAgICAgIC8vIGlnbm9yZSBhbmQgZmFsbCBiYWNrIHRvIHplcm9zXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHsgZ3JpZDogZW5zdXJlSWRQY3RHcmlkKGJhc2VHcmlkLCB0YXJnZXRzKSwgc291cmNlOiBcImZhbGxiYWNrOnplcm9cIiB9O1xufVxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImRiIiwiYnVpbGRNZWFBdXgiLCJERUZBVUxUX1RJRVJfUlVMRVMiLCJyZXNvbHZlUGFpckF2YWlsYWJpbGl0eSIsIm1hc2tVbmF2YWlsYWJsZU1hdHJpeCIsInJlc29sdmVDb2luc0Zyb21TZXR0aW5ncyIsIm5vcm1hbGl6ZU1vb2RJbnB1dHMiLCJjb21wdXRlTW9vZENvZWZmVjEiLCJtb29kVVVJREZyb21CdWNrZXRzIiwiZHluYW1pYyIsInJldmFsaWRhdGUiLCJDQUNIRV9IRUFERVJTIiwiREVGQVVMVF9DT0lOUyIsIkdFVCIsInJlcSIsInVybCIsIlVSTCIsInRzUGFyYW0iLCJOdW1iZXIiLCJzZWFyY2hQYXJhbXMiLCJnZXQiLCJ0c01zIiwiaXNGaW5pdGUiLCJEYXRlIiwibm93IiwiY29pbnMiLCJpbml0aWFsQ29pbnMiLCJzb3VyY2UiLCJjb2luc1NvdXJjZSIsInJlc29sdmVDb2lucyIsImdyaWQiLCJpZFBjdEdyaWRSYXciLCJpZFBjdFNvdXJjZSIsInJlYWRJZFBjdEdyaWQiLCJkZWR1cGVkQ29pbnMiLCJkZWR1cGVDb2lucyIsImNvaW5zRnJvbUdyaWQiLCJsZW5ndGgiLCJqc29uIiwib2siLCJrIiwiaGVhZGVycyIsImluY2x1ZGVzIiwiYXZhaWxhYmlsaXR5IiwiYWxsb3dlZFN5bWJvbHMiLCJzZXQiLCJpZFBjdEdyaWQiLCJlbnN1cmVJZFBjdEdyaWQiLCJiYWxhbmNlcyIsImJhbGFuY2VTb3VyY2UiLCJyZWFkQmFsYW5jZXNGcm9tTGVkZ2VyIiwia1BhcmFtIiwiZGl2aXNvciIsIk1hdGgiLCJmbG9vciIsIm1heCIsInFfZ2ZtRGVsdGFQY3QiLCJ0b051bSIsInFfdGVuZGVuY3lSYXciLCJxX3N3YXBSYXciLCJyZWZzIiwiZ2ZtU2NhbGUiLCJ2dE11IiwidnRTaWdtYSIsInZzTXUiLCJ2c1NpZ21hIiwidnNBbHBoYSIsImhhdmVSYXciLCJtb29kSW5wdXRzIiwiZ2ZtRGVsdGFQY3QiLCJ0ZW5kZW5jeVJhdyIsInN3YXBSYXciLCJ2VGVuZGVuY3kiLCJHRk0iLCJ2U3dhcCIsImNvZWZmIiwibW9vZENvZWZmIiwiYnVja2V0cyIsIm1vb2RVVUlEIiwiaWRQY3QiLCJydWxlcyIsImJhc2UiLCJxdW90ZSIsInYiLCJzaXplIiwidHNfbXMiLCJpZF9wY3QiLCJtb29kIiwidXVpZCIsImlucHV0cyIsInNvdXJjZXMiLCJzeW1ib2xzIiwicGFpcnMiLCJlcnIiLCJtZXNzYWdlIiwiRXJyb3IiLCJTdHJpbmciLCJlcnJvciIsInN0YXR1cyIsIngiLCJuIiwibm9ybWFsaXplQ29pblN5bWJvbCIsInJhdyIsInRyaW1tZWQiLCJ0cmltIiwidG9VcHBlckNhc2UiLCJsaXN0Iiwic2VlbiIsIlNldCIsIm91dCIsIml0ZW0iLCJub3JtIiwiaGFzIiwiYWRkIiwicHVzaCIsImVtcHR5QmFsYW5jZXMiLCJjb2luIiwiT2JqZWN0Iiwia2V5cyIsInJvdyIsIkFycmF5IiwiZnJvbSIsImNvaW5zUGFyYW0iLCJ0b2tlbnMiLCJzcGxpdCIsIm1hcCIsInRva2VuIiwiZmlsdGVyIiwiQm9vbGVhbiIsInNldHRpbmdzQ29pbnMiLCJ0YXJnZXRzIiwiemVyb3MiLCJyb3dzIiwicXVlcnkiLCJhc3NldCIsImFtb3VudCIsImJhc2VHcmlkIiwiaWRwIiwibWV0cmljS2V5cyIsImtleSIsIm1ldHJpY19rZXkiLCJwYXlsb2FkIiwiYmFzZVJhdyIsInF1b3RlUmF3IiwidmFsdWUiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/moo-aux/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/core/db/db.ts":
/*!***************************!*\
  !*** ./src/core/db/db.ts ***!
  \***************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   clearOpeningCache: () => (/* binding */ clearOpeningCache),\n/* harmony export */   commitMatrixGrid: () => (/* binding */ commitMatrixGrid),\n/* harmony export */   countRowsAt: () => (/* binding */ countRowsAt),\n/* harmony export */   db: () => (/* reexport safe */ _pool_server__WEBPACK_IMPORTED_MODULE_0__.db),\n/* harmony export */   ensureOpening: () => (/* binding */ ensureOpening),\n/* harmony export */   getLatestByType: () => (/* binding */ getLatestByType),\n/* harmony export */   getLatestTsForType: () => (/* binding */ getLatestTsForType),\n/* harmony export */   getMatrixStageTableIdent: () => (/* binding */ getMatrixStageTableIdent),\n/* harmony export */   getNearestTsAtOrBefore: () => (/* binding */ getNearestTsAtOrBefore),\n/* harmony export */   getOpeningFromDb: () => (/* binding */ getOpeningFromDb),\n/* harmony export */   getPool: () => (/* reexport safe */ _pool_server__WEBPACK_IMPORTED_MODULE_0__.getPool),\n/* harmony export */   getPrevSnapshotByType: () => (/* binding */ getPrevSnapshotByType),\n/* harmony export */   getPrevValue: () => (/* binding */ getPrevValue),\n/* harmony export */   getSnapshotByType: () => (/* binding */ getSnapshotByType),\n/* harmony export */   persistLiveMatricesSlice: () => (/* binding */ persistLiveMatricesSlice),\n/* harmony export */   query: () => (/* reexport safe */ _pool_server__WEBPACK_IMPORTED_MODULE_0__.query),\n/* harmony export */   runDbTool: () => (/* binding */ runDbTool),\n/* harmony export */   stageMatrixGrid: () => (/* binding */ stageMatrixGrid),\n/* harmony export */   upsertMatrixRows: () => (/* binding */ upsertMatrixRows),\n/* harmony export */   withClient: () => (/* reexport safe */ _pool_server__WEBPACK_IMPORTED_MODULE_0__.withClient)\n/* harmony export */ });\n/* harmony import */ var _pool_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./pool_server */ \"(rsc)/./src/core/db/pool_server.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pool_server__WEBPACK_IMPORTED_MODULE_0__]);\n_pool_server__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n// src/core/db/db.ts\n\n\n/** ------- Dynamics matrices (kept signatures) ------- */ // Optional env override; defaults to our canonical table\nconst RAW_TABLE = process.env.MATRIX_TABLE || \"matrices.dyn_values\";\n// Prevent SQL injection on identifier\nfunction asIdent(name) {\n    const parts = String(name).split(\".\").filter(Boolean);\n    if (!parts.length) throw new Error(`Invalid table identifier: ${name}`);\n    return parts.map((part)=>{\n        if (!/^[A-Za-z_][A-Za-z0-9_]*$/.test(part)) {\n            throw new Error(`Invalid table identifier: ${name}`);\n        }\n        return `\"${part}\"`;\n    }).join(\".\");\n}\nconst TABLE = asIdent(RAW_TABLE);\nconst RAW_STAGE_TABLE = process.env.MATRIX_STAGE_TABLE || \"matrices.dyn_values_stage\";\nconst RAW_COMMIT_TABLE = process.env.MATRIX_COMMIT_TABLE || process.env.MATRIX_TABLE || \"matrices.dyn_values\";\nconst STAGE_TABLE_CANDIDATES = Array.from(new Set([\n    process.env.MATRIX_STAGE_TABLE,\n    \"matrices.dyn_values_stage\",\n    \"public.dyn_matrix_values_stage\"\n].filter(Boolean)));\nconst MATRIX_TABLE_CANDIDATES = Array.from(new Set([\n    process.env.MATRIX_COMMIT_TABLE,\n    process.env.MATRIX_TABLE,\n    \"matrices.dyn_values\",\n    \"public.dyn_matrix_values\"\n].filter(Boolean)));\nfunction splitQualifiedName(name) {\n    const parts = String(name).split(\".\");\n    if (parts.length === 1) return {\n        schema: \"public\",\n        relation: parts[0]\n    };\n    const relation = parts.pop();\n    return {\n        schema: parts.join(\".\"),\n        relation\n    };\n}\nasync function ensureMatrixTables(client) {\n    await client.query(`CREATE SCHEMA IF NOT EXISTS matrices`);\n    await client.query(`\n    DO $$\n    BEGIN\n      IF EXISTS (\n        SELECT 1\n        FROM pg_class c\n        JOIN pg_namespace n ON n.oid = c.relnamespace\n        WHERE n.nspname = 'matrices'\n          AND c.relname = 'dyn_values'\n          AND c.relkind IN ('v','m')\n      ) THEN\n        EXECUTE 'DROP VIEW IF EXISTS matrices.dyn_values CASCADE';\n      END IF;\n      IF EXISTS (\n        SELECT 1\n        FROM pg_class c\n        JOIN pg_namespace n ON n.oid = c.relnamespace\n        WHERE n.nspname = 'matrices'\n          AND c.relname = 'dyn_values_stage'\n          AND c.relkind IN ('v','m')\n      ) THEN\n        EXECUTE 'DROP VIEW IF EXISTS matrices.dyn_values_stage CASCADE';\n      END IF;\n    END\n    $$;\n  `);\n    await client.query(`\n    CREATE TABLE IF NOT EXISTS matrices.dyn_values (\n      ts_ms        bigint           NOT NULL,\n      matrix_type  text             NOT NULL CHECK (matrix_type IN ('benchmark','delta','pct24h','id_pct','pct_drv','ref','pct_ref')),\n      base         text             NOT NULL,\n      quote        text             NOT NULL,\n      value        double precision NOT NULL,\n      meta         jsonb            NOT NULL DEFAULT '{}'::jsonb,\n      created_at   timestamptz      NOT NULL DEFAULT now(),\n      PRIMARY KEY (ts_ms, matrix_type, base, quote)\n    )\n  `);\n    await client.query(`\n    CREATE INDEX IF NOT EXISTS idx_matrices_dyn_values_pair\n      ON matrices.dyn_values (matrix_type, base, quote, ts_ms DESC)\n  `);\n    await client.query(`\n    CREATE TABLE IF NOT EXISTS matrices.dyn_values_stage (\n      ts_ms         bigint           NOT NULL,\n      matrix_type   text             NOT NULL,\n      base          text             NOT NULL,\n      quote         text             NOT NULL,\n      value         double precision NOT NULL,\n      meta          jsonb            NOT NULL DEFAULT '{}'::jsonb,\n      app_session_id text,\n      created_at    timestamptz      NOT NULL DEFAULT now(),\n      PRIMARY KEY (ts_ms, matrix_type, base, quote)\n    )\n  `);\n}\nasync function findExistingTable(client, candidates) {\n    for (const raw of candidates){\n        const { schema, relation } = splitQualifiedName(raw);\n        const { rows } = await client.query(`\n        SELECT c.relkind AS kind\n          FROM pg_class c\n          JOIN pg_namespace n ON n.oid = c.relnamespace\n         WHERE n.nspname = $1 AND c.relname = $2\n      `, [\n            schema,\n            relation\n        ]);\n        const kind = rows[0]?.kind;\n        if (kind && (kind === \"r\" || kind === \"p\")) {\n            return {\n                raw,\n                ident: asIdent(raw),\n                kind\n            };\n        }\n    }\n    return null;\n}\nlet cachedStageInfo = null;\nlet cachedMatrixInfo = null;\nasync function ensureStageInfo(client) {\n    if (cachedStageInfo) return cachedStageInfo;\n    let info = await findExistingTable(client, [\n        RAW_STAGE_TABLE,\n        ...STAGE_TABLE_CANDIDATES\n    ]) ?? await findExistingTable(client, STAGE_TABLE_CANDIDATES);\n    if (!info) {\n        await ensureMatrixTables(client);\n        info = await findExistingTable(client, [\n            RAW_STAGE_TABLE,\n            ...STAGE_TABLE_CANDIDATES\n        ]) ?? await findExistingTable(client, STAGE_TABLE_CANDIDATES);\n        if (!info) {\n            throw new Error(`Matrix stage table not found. Checked: ${[\n                RAW_STAGE_TABLE,\n                ...STAGE_TABLE_CANDIDATES\n            ].filter(Boolean).join(\", \")}`);\n        }\n    }\n    cachedStageInfo = info;\n    return info;\n}\nasync function ensureMatrixInfo(client) {\n    if (cachedMatrixInfo) return cachedMatrixInfo;\n    let info = await findExistingTable(client, [\n        RAW_COMMIT_TABLE,\n        ...MATRIX_TABLE_CANDIDATES\n    ]) ?? await findExistingTable(client, MATRIX_TABLE_CANDIDATES);\n    if (!info) {\n        await ensureMatrixTables(client);\n        info = await findExistingTable(client, [\n            RAW_COMMIT_TABLE,\n            ...MATRIX_TABLE_CANDIDATES\n        ]) ?? await findExistingTable(client, MATRIX_TABLE_CANDIDATES);\n        if (!info) {\n            throw new Error(`Matrix values table not found. Checked: ${[\n                RAW_COMMIT_TABLE,\n                ...MATRIX_TABLE_CANDIDATES\n            ].filter(Boolean).join(\", \")}`);\n        }\n    }\n    if (!info) {\n        throw new Error(`Matrix values table not found. Checked: ${[\n            RAW_COMMIT_TABLE,\n            ...MATRIX_TABLE_CANDIDATES\n        ].filter(Boolean).join(\", \")}`);\n    }\n    cachedMatrixInfo = info;\n    return info;\n}\nfunction dedupeUpper(xs) {\n    if (!xs?.length) return [];\n    const out = [];\n    const seen = new Set();\n    for (const x of xs){\n        const up = String(x ?? \"\").trim().toUpperCase();\n        if (!up || seen.has(up)) continue;\n        seen.add(up);\n        out.push(up);\n    }\n    return out;\n}\nasync function getMatrixStageTableIdent(client) {\n    if (cachedStageInfo) return cachedStageInfo.ident;\n    const useClient = client ?? await _pool_server__WEBPACK_IMPORTED_MODULE_0__.db.connect();\n    const release = !client;\n    try {\n        const info = await ensureStageInfo(useClient);\n        return info.ident;\n    } finally{\n        if (release) useClient.release();\n    }\n}\nasync function getMatrixValuesTableIdent(client) {\n    const info = await ensureMatrixInfo(client);\n    return info.ident;\n}\n/** Bulk upsert directly into main table (bypasses stage/commit) */ async function upsertMatrixRows(rows) {\n    if (!rows.length) return;\n    const client = await _pool_server__WEBPACK_IMPORTED_MODULE_0__.db.connect();\n    try {\n        const values = [];\n        const chunks = rows.map((r, i)=>{\n            const j = i * 6;\n            values.push(r.ts_ms, r.matrix_type, r.base, r.quote, r.value, JSON.stringify(r.meta ?? {}));\n            return `($${j + 1}, $${j + 2}, $${j + 3}, $${j + 4}, $${j + 5}, $${j + 6})`;\n        }).join(\",\");\n        const sql = `\n      INSERT INTO ${TABLE} (ts_ms, matrix_type, base, quote, value, meta)\n      VALUES ${chunks}\n      ON CONFLICT (ts_ms, matrix_type, base, quote)\n      DO UPDATE SET value = EXCLUDED.value, meta = EXCLUDED.meta;\n    `;\n        await client.query(sql, values);\n    } finally{\n        client.release();\n    }\n}\n/** Snapshots & lookups */ async function getLatestByType(matrix_type, coins) {\n    const client = await _pool_server__WEBPACK_IMPORTED_MODULE_0__.db.connect();\n    try {\n        const { rows } = await client.query(`SELECT ts_ms FROM ${TABLE} WHERE matrix_type=$1 ORDER BY ts_ms DESC LIMIT 1`, [\n            matrix_type\n        ]);\n        if (!rows.length) return {\n            ts_ms: null,\n            values: []\n        };\n        const ts_ms = Number(rows[0].ts_ms);\n        const { rows: vals } = await client.query(`SELECT base, quote, value FROM ${TABLE}\n       WHERE matrix_type=$1 AND ts_ms=$2 AND base = ANY($3) AND quote = ANY($3)`, [\n            matrix_type,\n            ts_ms,\n            coins\n        ]);\n        return {\n            ts_ms,\n            values: vals\n        };\n    } finally{\n        client.release();\n    }\n}\nasync function getPrevValue(matrix_type, base, quote, beforeTs) {\n    const { rows } = await _pool_server__WEBPACK_IMPORTED_MODULE_0__.db.query(`SELECT value FROM ${TABLE}\n     WHERE matrix_type=$1 AND base=$2 AND quote=$3 AND ts_ms < $4\n     ORDER BY ts_ms DESC LIMIT 1`, [\n        matrix_type,\n        base,\n        quote,\n        beforeTs\n    ]);\n    return rows.length ? Number(rows[0].value) : null;\n}\nasync function getLatestTsForType(matrix_type) {\n    const { rows } = await _pool_server__WEBPACK_IMPORTED_MODULE_0__.db.query(`SELECT MAX(ts_ms) AS ts_ms FROM ${TABLE} WHERE matrix_type=$1`, [\n        matrix_type\n    ]);\n    const v = rows[0]?.ts_ms;\n    return v == null ? null : Number(v);\n}\nasync function getNearestTsAtOrBefore(matrix_type, ts_ms) {\n    const { rows } = await _pool_server__WEBPACK_IMPORTED_MODULE_0__.db.query(`SELECT ts_ms FROM ${TABLE}\n     WHERE matrix_type=$1 AND ts_ms <= $2\n     ORDER BY ts_ms DESC LIMIT 1`, [\n        matrix_type,\n        ts_ms\n    ]);\n    const v = rows[0]?.ts_ms;\n    return v == null ? null : Number(v);\n}\nasync function getSnapshotByType(matrix_type, ts_ms, coins) {\n    const { rows } = await _pool_server__WEBPACK_IMPORTED_MODULE_0__.db.query(`SELECT base, quote, value FROM ${TABLE}\n     WHERE matrix_type=$1 AND ts_ms=$2 AND base = ANY($3) AND quote = ANY($3)`, [\n        matrix_type,\n        ts_ms,\n        coins\n    ]);\n    return rows;\n}\nasync function getPrevSnapshotByType(matrix_type, beforeTs, coins) {\n    const { rows } = await _pool_server__WEBPACK_IMPORTED_MODULE_0__.db.query(`SELECT DISTINCT ON (base, quote) base, quote, value\n       FROM ${TABLE}\n      WHERE matrix_type=$1\n        AND ts_ms < $2\n        AND base  = ANY($3)\n        AND quote = ANY($3)\n   ORDER BY base, quote, ts_ms DESC`, [\n        matrix_type,\n        beforeTs,\n        coins\n    ]);\n    return rows;\n}\nasync function countRowsAt(matrix_type, ts_ms) {\n    const { rows } = await _pool_server__WEBPACK_IMPORTED_MODULE_0__.db.query(`SELECT count(*)::int AS n FROM ${TABLE} WHERE matrix_type=$1 AND ts_ms=$2`, [\n        matrix_type,\n        ts_ms\n    ]);\n    return rows[0]?.n ?? 0;\n}\nconst openingCache = new Map();\nconst keyStr = (k)=>`${k.base}:${k.quote ?? \"USDT\"}:${k.window ?? \"1h\"}:${k.appSessionId ?? \"global\"}`;\n/** Read last opening for a (base,quote,window,session) from STR-AUX; fallback to compat view */ async function getOpeningFromDb(k) {\n    // Source of truth: strategy_aux.str_aux_session with opening_stamp = TRUE\n    const q1 = `\n    SELECT opening_ts AS ts, opening_price AS price\n      FROM strategy_aux.str_aux_session\n     WHERE pair_base=$1 AND pair_quote=$2 AND window_key=$3\n       AND ($4::text IS NULL OR app_session_id=$4)\n       AND opening_stamp = TRUE\n  ORDER BY opening_ts DESC\n     LIMIT 1\n  `;\n    const r1 = await _pool_server__WEBPACK_IMPORTED_MODULE_0__.db.query(q1, [\n        k.base,\n        k.quote ?? \"USDT\",\n        k.window ?? \"1h\",\n        k.appSessionId ?? null\n    ]);\n    if (r1.rows.length) {\n        return {\n            price: Number(r1.rows[0].price),\n            ts: Number(r1.rows[0].ts)\n        };\n    }\n    // Compatibility view (kept for older code paths)\n    const q2 = `SELECT session_ts AS ts, opening_price AS price\n                FROM session_openings\n            ORDER BY session_ts DESC\n               LIMIT 1`;\n    const r2 = await _pool_server__WEBPACK_IMPORTED_MODULE_0__.db.query(q2);\n    if (r2.rows.length) {\n        return {\n            price: Number(r2.rows[0].price),\n            ts: Number(r2.rows[0].ts)\n        };\n    }\n    return null;\n}\n/**\r\n * Ensure an opening exists + cache it for this process.\r\n * If you pass openingTs/openingPrice, we try to upsert via the SQL function `upsert_str_aux_opening` (if present).\r\n */ async function ensureOpening(k, opts = {}) {\n    const ck = keyStr(k);\n    const hit = openingCache.get(ck);\n    if (hit) return hit;\n    // If given explicit opening, try to persist (no-op if the function doesn't exist).\n    if (opts.openingPrice != null && opts.openingTs != null) {\n        try {\n            await _pool_server__WEBPACK_IMPORTED_MODULE_0__.db.query(`SELECT upsert_str_aux_opening($1,$2,$3,$4,$5,$6,$7)`, [\n                k.base,\n                k.quote ?? \"USDT\",\n                k.window ?? \"1h\",\n                k.appSessionId ?? \"global\",\n                opts.openingTs,\n                opts.openingPrice,\n                `idem:${k.base}:${k.quote ?? \"USDT\"}:${k.window ?? \"1h\"}:${k.appSessionId ?? \"global\"}:${opts.openingTs}`\n            ]);\n        } catch  {}\n    }\n    const row = await getOpeningFromDb(k);\n    if (row) {\n        openingCache.set(ck, row);\n        return row;\n    }\n    return null;\n}\nfunction clearOpeningCache(k) {\n    if (!k) return openingCache.clear();\n    openingCache.delete(keyStr(k));\n}\n/** Internal: iterate off-diagonal cells that have finite numbers */ function* cellsOf(coins, values) {\n    for (const b of coins){\n        for (const q of coins){\n            if (b === q) continue;\n            const v = values?.[b]?.[q];\n            if (v == null || Number.isNaN(Number(v))) continue;\n            yield {\n                base: b,\n                quote: q,\n                value: Number(v)\n            };\n        }\n    }\n}\n/** Stage all cells for a (matrix_type, ts_ms). Overwrites on conflict in STAGE. */ async function stageMatrixGrid(opts) {\n    const { appSessionId, matrixType, tsMs, coins, values, meta, client: external } = opts;\n    const client = external ?? await _pool_server__WEBPACK_IMPORTED_MODULE_0__.db.connect();\n    const release = !external;\n    try {\n        const rows = Array.from(cellsOf(coins, values));\n        if (!rows.length) return {\n            ok: true,\n            staged: 0\n        };\n        const metaJson = JSON.stringify(meta ?? {});\n        const stageInfo = await ensureStageInfo(client);\n        const text = `\n      INSERT INTO ${stageInfo.ident}\n        (ts_ms, matrix_type, base, quote, value, meta, app_session_id)\n      VALUES ${rows.map((_, i)=>`($1,$2,$${i * 3 + 3},$${i * 3 + 4},$${i * 3 + 5},$${rows.length * 3 + 3},$${rows.length * 3 + 4})`).join(\",\")}\n      ON CONFLICT (ts_ms, matrix_type, base, quote)\n      DO UPDATE SET value = EXCLUDED.value, meta = EXCLUDED.meta, app_session_id = EXCLUDED.app_session_id\n    `;\n        const params = [\n            tsMs,\n            matrixType\n        ];\n        for (const r of rows)params.push(r.base, r.quote, r.value);\n        params.push(metaJson, appSessionId);\n        await client.query(text, params);\n        return {\n            ok: true,\n            staged: rows.length\n        };\n    } finally{\n        if (release) client.release();\n    }\n}\n/** Publish staged rows into main table + cycle_document + ledger (see DDL) */ async function commitMatrixGrid(opts) {\n    const { matrixType, tsMs, coins, client: external } = opts;\n    const client = external ?? await _pool_server__WEBPACK_IMPORTED_MODULE_0__.db.connect();\n    const release = !external;\n    const manageTx = !external;\n    try {\n        if (manageTx) await client.query(\"BEGIN\");\n        const stageInfo = await ensureStageInfo(client);\n        const matrixTable = await getMatrixValuesTableIdent(client);\n        const stageRows = await client.query(`SELECT base, quote\n         FROM ${stageInfo.ident}\n        WHERE ts_ms = $1 AND matrix_type = $2`, [\n            tsMs,\n            matrixType\n        ]);\n        const stagedCells = stageRows.rowCount ?? stageRows.rows.length;\n        const coinsFromStage = new Set();\n        for (const row of stageRows.rows){\n            const base = String(row.base ?? \"\").toUpperCase();\n            const quote = String(row.quote ?? \"\").toUpperCase();\n            if (base) coinsFromStage.add(base);\n            if (quote) coinsFromStage.add(quote);\n        }\n        const eligibleCoins = coins?.length && dedupeUpper(coins).length ? dedupeUpper(coins) : Array.from(coinsFromStage);\n        const expectedCells = eligibleCoins.length * Math.max(eligibleCoins.length - 1, 0);\n        await client.query(`\n      INSERT INTO ${matrixTable}\n        (ts_ms, matrix_type, base, quote, value, meta)\n      SELECT ts_ms, matrix_type, base, quote, value, meta\n        FROM ${stageInfo.ident}\n       WHERE ts_ms = $1 AND matrix_type = $2\n      ON CONFLICT (ts_ms, matrix_type, base, quote)\n      DO UPDATE SET value = EXCLUDED.value, meta = EXCLUDED.meta\n    `, [\n            tsMs,\n            matrixType\n        ]);\n        const stagedPairs = new Set(stageRows.rows.map((row)=>{\n            const base = String(row.base ?? \"\").toUpperCase();\n            const quote = String(row.quote ?? \"\").toUpperCase();\n            if (!base || !quote || base === quote) return null;\n            return `${base}${quote}`;\n        }).filter(Boolean));\n        let missingCount = 0;\n        for (const base of eligibleCoins){\n            for (const quote of eligibleCoins){\n                if (base === quote) continue;\n                if (!stagedPairs.has(`${base}${quote}`)) missingCount += 1;\n            }\n        }\n        if (manageTx) await client.query(\"COMMIT\");\n        return {\n            ok: true,\n            matrix_type: matrixType,\n            ts_ms: tsMs,\n            expected_cells: expectedCells,\n            staged_cells: stagedCells,\n            missing_count: missingCount,\n            complete: missingCount === 0 && stagedCells === expectedCells\n        };\n    } catch (err) {\n        if (manageTx) await client.query(\"ROLLBACK\");\n        throw err;\n    } finally{\n        if (release) client.release();\n    }\n}\n/** Convenience: read prev benchmark grid for a coin set (paired map) */ async function mapPrevBenchmark(beforeTs, coins) {\n    const prev = await getPrevSnapshotByType(\"benchmark\", beforeTs, coins);\n    const m = new Map();\n    for (const r of prev)m.set(`${r.base}/${r.quote}`, Number(r.value));\n    return m;\n}\n/**\r\n * Persist the current live slices for the active coin-universe:\r\n *  - benchmark (full NN)\r\n *  - pct24h   (as-is from live)\r\n *  - id_pct   (derived vs prev benchmark so pct_drv has history on next tick)\r\n *\r\n * All three use the SAME ts_ms to keep slices aligned.\r\n */ async function persistLiveMatricesSlice(opts) {\n    const { appSessionId, coins, tsMs, benchmark, pct24h, idemPrefix } = opts;\n    // 1) stage+commit benchmark\n    await stageMatrixGrid({\n        appSessionId,\n        matrixType: \"benchmark\",\n        tsMs,\n        coins,\n        values: benchmark,\n        meta: {\n            source: \"live\"\n        }\n    });\n    await commitMatrixGrid({\n        appSessionId,\n        matrixType: \"benchmark\",\n        tsMs,\n        coins,\n        idem: `${idemPrefix ?? \"benchmark\"}:${tsMs}`\n    });\n    // 2) stage+commit pct24h (optional)\n    if (pct24h) {\n        await stageMatrixGrid({\n            appSessionId,\n            matrixType: \"pct24h\",\n            tsMs,\n            coins,\n            values: pct24h,\n            meta: {\n                source: \"live\"\n            }\n        });\n        await commitMatrixGrid({\n            appSessionId,\n            matrixType: \"pct24h\",\n            tsMs,\n            coins,\n            idem: `${idemPrefix ?? \"pct24h\"}:${tsMs}`\n        });\n    }\n    // 3) derive id_pct vs prev(benchmark) and persist\n    const prevMap = await mapPrevBenchmark(tsMs, coins);\n    const idObj = {};\n    for (const b of coins){\n        idObj[b] = {};\n        for (const q of coins){\n            if (b === q) continue;\n            const now = benchmark?.[b]?.[q];\n            const prev = prevMap.get(`${b}/${q}`);\n            if (now == null || prev == null || Math.abs(prev) < 1e-300) {\n                idObj[b][q] = null;\n            } else {\n                idObj[b][q] = (Number(now) - prev) / prev; // id_pct = (bm_new - bm_prev)/bm_prev\n            }\n        }\n    }\n    await stageMatrixGrid({\n        appSessionId,\n        matrixType: \"id_pct\",\n        tsMs,\n        coins,\n        values: idObj,\n        meta: {\n            source: \"derived@db\",\n            base: \"prev(benchmark)\"\n        }\n    });\n    await commitMatrixGrid({\n        appSessionId,\n        matrixType: \"id_pct\",\n        tsMs,\n        coins,\n        idem: `${idemPrefix ?? \"id_pct\"}:${tsMs}`\n    });\n}\nconst BASE_STEP = {\n    name: \"BASE DDLs\",\n    files: [\n        \"00_extensions.sql\",\n        \"01_settings.sql\",\n        \"02_market.sql\",\n        \"03_docs.sql\",\n        \"04_matrices.sql\",\n        \"05_str_aux.sql\",\n        \"06_cin_aux_core.sql\",\n        \"07_cin_aux_runtime.sql\",\n        \"08_cin_aux_functions.sql\",\n        \"09_ops.sql\",\n        \"09_ingest.sql\",\n        \"10_helpers.sql\",\n        \"11_views_latest.sql\"\n    ]\n};\nconst PATCH_STEP = {\n    name: \"PATCH SET v1\",\n    files: [\n        \"01_settings_patches.sql\",\n        \"02_market_patches.sql\",\n        \"03_docs_patches.sql\",\n        \"04_matrices_patches.sql\",\n        \"05_str_aux_patches.sql\",\n        \"06_cin_aux_core_patches.sql\",\n        \"07_cin_aux_runtime_patches.sql\",\n        \"08_cin_aux_functions_patches.sql\",\n        \"09_mea_dynamics_patches.sql\",\n        \"10_ops_patches.sql\",\n        \"11_remove_bootstrap.sql\"\n    ]\n};\nconst SEED_STEP = {\n    name: \"SEEDS\",\n    files: [\n        \"01_seed.sql\",\n        \"02_seed_jobs.sql\"\n    ]\n};\nconst VERIFY_STEP = {\n    name: \"VERIFY\",\n    files: [\n        \"03_verify.sql\"\n    ]\n};\nasync function spawnCommand(cmd, args, env) {\n    const { spawn } = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! node:child_process */ \"node:child_process\", 23));\n    return new Promise((resolve, reject)=>{\n        const child = spawn(cmd, args, {\n            stdio: \"inherit\",\n            env\n        });\n        child.on(\"error\", reject);\n        child.on(\"exit\", (code)=>code === 0 ? resolve() : reject(new Error(`${cmd} exited with ${code}`)));\n    });\n}\nasync function runDbTool(argv = typeof process !== \"undefined\" ? process.argv.slice(2) : [], opts = {}) {\n    const [{ resolve, join }, fs, dotenv] = await Promise.all([\n        Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! node:path */ \"node:path\", 23)),\n        Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! node:fs */ \"node:fs\", 23)),\n        __webpack_require__.e(/*! import() */ \"vendor-chunks/dotenv@17.2.2\").then(__webpack_require__.t.bind(__webpack_require__, /*! dotenv */ \"(rsc)/./node_modules/.pnpm/dotenv@17.2.2/node_modules/dotenv/lib/main.js\", 23))\n    ]);\n    const ROOT = resolve(process.cwd(), opts.root ?? \"db\");\n    const ENV_FILE = join(ROOT, \".env.db\");\n    if (fs.existsSync(ENV_FILE)) {\n        dotenv.config({\n            path: ENV_FILE\n        });\n    }\n    const pg = {\n        host: process.env.PGHOST ?? \"localhost\",\n        port: String(process.env.PGPORT ?? \"5432\"),\n        db: process.env.PGDATABASE ?? \"postgres\",\n        user: process.env.PGUSER ?? \"postgres\",\n        pass: process.env.PGPASSWORD ?? \"\"\n    };\n    const fileExists = (file)=>fs.existsSync(join(ROOT, file));\n    async function ensurePsql() {\n        await spawnCommand(\"psql\", [\n            \"--version\"\n        ]);\n    }\n    async function execSql(file) {\n        if (!fileExists(file)) return;\n        const full = join(ROOT, file);\n        await spawnCommand(\"psql\", [\n            \"-X\",\n            \"-v\",\n            \"ON_ERROR_STOP=1\",\n            \"-h\",\n            pg.host,\n            \"-p\",\n            pg.port,\n            \"-U\",\n            pg.user,\n            \"-d\",\n            pg.db,\n            \"-f\",\n            full\n        ], {\n            ...process.env,\n            PGPASSWORD: pg.pass\n        });\n    }\n    async function runStep(step) {\n        console.log(`\\n=== ${step.name} ===`);\n        for (const file of step.files){\n            if (!fileExists(file)) continue;\n            console.log(`-> ${file}`);\n            await execSql(file);\n        }\n    }\n    async function ensureDb() {\n        const sql = `DO $$\n     BEGIN\n       IF NOT EXISTS (SELECT 1 FROM pg_database WHERE datname = '${pg.db}') THEN\n         EXECUTE 'CREATE DATABASE ${pg.db}';\n       END IF;\n     END$$;`;\n        await spawnCommand(\"psql\", [\n            \"-X\",\n            \"-v\",\n            \"ON_ERROR_STOP=1\",\n            \"-h\",\n            pg.host,\n            \"-p\",\n            pg.port,\n            \"-U\",\n            pg.user,\n            \"-d\",\n            \"postgres\",\n            \"-c\",\n            sql\n        ], {\n            ...process.env,\n            PGPASSWORD: pg.pass\n        });\n    }\n    function usage() {\n        console.log(`\nUsage:\n  pnpm db:apply     # base DDLs + patches\n  pnpm db:seed      # seeds (universe/timing/session/jobs)\n  pnpm db:verify    # quick checks\n  pnpm db:all       # ensure DB, apply, seed, verify\n  pnpm db:psql      # open interactive psql to PGDATABASE\n\nENV: read from db/.env.db (PGHOST, PGPORT, PGDATABASE, PGUSER, PGPASSWORD)\n`.trim());\n    }\n    const [cmd = \"\"] = argv;\n    await ensurePsql();\n    if (cmd === \"apply\") {\n        await runStep(BASE_STEP);\n        await runStep(PATCH_STEP);\n        console.log(\"[ok] apply complete\");\n        return;\n    }\n    if (cmd === \"seed\") {\n        await runStep(SEED_STEP);\n        console.log(\"[ok] seed complete\");\n        return;\n    }\n    if (cmd === \"verify\") {\n        await runStep(VERIFY_STEP);\n        console.log(\"[ok] verify complete\");\n        return;\n    }\n    if (cmd === \"all\") {\n        await ensureDb();\n        await runStep(BASE_STEP);\n        await runStep(PATCH_STEP);\n        await runStep(SEED_STEP);\n        await runStep(VERIFY_STEP);\n        console.log(\"[ok] all done\");\n        return;\n    }\n    if (cmd === \"psql\") {\n        await spawnCommand(\"psql\", [\n            \"-h\",\n            pg.host,\n            \"-p\",\n            pg.port,\n            \"-U\",\n            pg.user,\n            \"-d\",\n            pg.db\n        ], {\n            ...process.env,\n            PGPASSWORD: pg.pass\n        });\n        return;\n    }\n    usage();\n    throw new Error(`Unknown db command \"${cmd}\"`);\n}\nasync function maybeRunDbToolFromCli() {\n    if (typeof process === \"undefined\" || !process.argv?.[1]) return;\n    try {\n        const { pathToFileURL } = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! node:url */ \"node:url\", 23));\n        if (\"file:///H:/Users/Gus/source/repo/dynamics/dynamics-b/cryptopi-dynamics/src/core/db/db.ts\" !== pathToFileURL(process.argv[1]).href) return;\n    } catch  {\n        return;\n    }\n    try {\n        await runDbTool(process.argv.slice(2));\n    } catch (err) {\n        console.error(err);\n        process.exitCode = 1;\n    }\n}\nvoid maybeRunDbToolFromCli();\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UUFBUUMsR0FBRyxDQUFDO1FBQ1o7SUFDRjtJQUVBLElBQUl6QyxRQUFRLFFBQVE7UUFDbEIsTUFBTUQsYUFDSixRQUNBO1lBQUM7WUFBTXdCLEdBQUdDLElBQUk7WUFBRTtZQUFNRCxHQUFHRyxJQUFJO1lBQUU7WUFBTUgsR0FBR00sSUFBSTtZQUFFO1lBQU1OLEdBQUdoTSxFQUFFO1NBQUMsRUFDMUQ7WUFBRSxHQUFHSyxRQUFRQyxHQUFHO1lBQUVtTSxZQUFZVCxHQUFHUSxJQUFJO1FBQUM7UUFFeEM7SUFDRjtJQUVBWTtJQUNBLE1BQU0sSUFBSXBNLE1BQU0sQ0FBQyxvQkFBb0IsRUFBRXlKLElBQUksQ0FBQyxDQUFDO0FBQy9DO0FBRUEsZUFBZTRDO0lBQ2IsSUFBSSxPQUFPaE4sWUFBWSxlQUFlLENBQUNBLFFBQVErSyxJQUFJLEVBQUUsQ0FBQyxFQUFFLEVBQUU7SUFDMUQsSUFBSTtRQUNGLE1BQU0sRUFBRWtDLGFBQWEsRUFBRSxHQUFHLE1BQU0sc0hBQWtCO1FBQ2xELElBQUksMEZBQWUsS0FBS0EsY0FBY2pOLFFBQVErSyxJQUFJLENBQUMsRUFBRSxFQUFHb0MsSUFBSSxFQUFFO0lBQ2hFLEVBQUUsT0FBTTtRQUNOO0lBQ0Y7SUFFQSxJQUFJO1FBQ0YsTUFBTXJDLFVBQVU5SyxRQUFRK0ssSUFBSSxDQUFDQyxLQUFLLENBQUM7SUFDckMsRUFBRSxPQUFPaEMsS0FBSztRQUNaNEQsUUFBUVEsS0FBSyxDQUFDcEU7UUFDZGhKLFFBQVFxTixRQUFRLEdBQUc7SUFDckI7QUFDRjtBQUVBLEtBQUtMIiwic291cmNlcyI6WyJIOlxcVXNlcnNcXEd1c1xcc291cmNlXFxyZXBvXFxkeW5hbWljc1xcZHluYW1pY3MtYlxcY3J5cHRvcGktZHluYW1pY3NcXHNyY1xcY29yZVxcZGJcXGRiLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9jb3JlL2RiL2RiLnRzXHJcbmltcG9ydCB0eXBlIHsgUG9vbENsaWVudCwgUXVlcnlSZXN1bHQsIFF1ZXJ5UmVzdWx0Um93IH0gZnJvbSBcInBnXCI7XHJcbmltcG9ydCB7IGRiLCBnZXRQb29sLCBxdWVyeSwgd2l0aENsaWVudCB9IGZyb20gXCIuL3Bvb2xfc2VydmVyXCI7XHJcblxyXG5leHBvcnQgeyBkYiwgZ2V0UG9vbCwgcXVlcnksIHdpdGhDbGllbnQgfSBmcm9tIFwiLi9wb29sX3NlcnZlclwiO1xyXG5cclxuLyoqIC0tLS0tLS0gRHluYW1pY3MgbWF0cmljZXMgKGtlcHQgc2lnbmF0dXJlcykgLS0tLS0tLSAqL1xyXG4vLyBPcHRpb25hbCBlbnYgb3ZlcnJpZGU7IGRlZmF1bHRzIHRvIG91ciBjYW5vbmljYWwgdGFibGVcbmNvbnN0IFJBV19UQUJMRSA9IHByb2Nlc3MuZW52Lk1BVFJJWF9UQUJMRSB8fCBcIm1hdHJpY2VzLmR5bl92YWx1ZXNcIjtcblxuLy8gUHJldmVudCBTUUwgaW5qZWN0aW9uIG9uIGlkZW50aWZpZXJcbmZ1bmN0aW9uIGFzSWRlbnQobmFtZTogc3RyaW5nKSB7XG4gIGNvbnN0IHBhcnRzID0gU3RyaW5nKG5hbWUpLnNwbGl0KFwiLlwiKS5maWx0ZXIoQm9vbGVhbik7XG4gIGlmICghcGFydHMubGVuZ3RoKSB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgdGFibGUgaWRlbnRpZmllcjogJHtuYW1lfWApO1xuICByZXR1cm4gcGFydHMubWFwKChwYXJ0KSA9PiB7XG4gICAgaWYgKCEvXltBLVphLXpfXVtBLVphLXowLTlfXSokLy50ZXN0KHBhcnQpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgdGFibGUgaWRlbnRpZmllcjogJHtuYW1lfWApO1xuICAgIH1cbiAgICByZXR1cm4gYFwiJHtwYXJ0fVwiYDtcbiAgfSkuam9pbihcIi5cIik7XG59XG5jb25zdCBUQUJMRSA9IGFzSWRlbnQoUkFXX1RBQkxFKTtcblxuY29uc3QgUkFXX1NUQUdFX1RBQkxFID1cbiAgcHJvY2Vzcy5lbnYuTUFUUklYX1NUQUdFX1RBQkxFIHx8IFwibWF0cmljZXMuZHluX3ZhbHVlc19zdGFnZVwiO1xuY29uc3QgUkFXX0NPTU1JVF9UQUJMRSA9XG4gIHByb2Nlc3MuZW52Lk1BVFJJWF9DT01NSVRfVEFCTEUgfHxcbiAgcHJvY2Vzcy5lbnYuTUFUUklYX1RBQkxFIHx8XG4gIFwibWF0cmljZXMuZHluX3ZhbHVlc1wiO1xuXG5jb25zdCBTVEFHRV9UQUJMRV9DQU5ESURBVEVTID0gQXJyYXkuZnJvbShcbiAgbmV3IFNldChcbiAgICBbXG4gICAgICBwcm9jZXNzLmVudi5NQVRSSVhfU1RBR0VfVEFCTEUsXG4gICAgICBcIm1hdHJpY2VzLmR5bl92YWx1ZXNfc3RhZ2VcIixcbiAgICAgIFwicHVibGljLmR5bl9tYXRyaXhfdmFsdWVzX3N0YWdlXCIsXG4gICAgXS5maWx0ZXIoQm9vbGVhbikgYXMgc3RyaW5nW11cbiAgKVxuKTtcblxuY29uc3QgTUFUUklYX1RBQkxFX0NBTkRJREFURVMgPSBBcnJheS5mcm9tKFxuICBuZXcgU2V0KFxuICAgIFtcbiAgICAgIHByb2Nlc3MuZW52Lk1BVFJJWF9DT01NSVRfVEFCTEUsXG4gICAgICBwcm9jZXNzLmVudi5NQVRSSVhfVEFCTEUsXG4gICAgICBcIm1hdHJpY2VzLmR5bl92YWx1ZXNcIixcbiAgICAgIFwicHVibGljLmR5bl9tYXRyaXhfdmFsdWVzXCIsXG4gICAgXS5maWx0ZXIoQm9vbGVhbikgYXMgc3RyaW5nW11cbiAgKVxuKTtcblxudHlwZSBSZWxhdGlvbkluZm8gPSB7IHJhdzogc3RyaW5nOyBpZGVudDogc3RyaW5nOyBraW5kOiBzdHJpbmcgfTtcblxuZnVuY3Rpb24gc3BsaXRRdWFsaWZpZWROYW1lKG5hbWU6IHN0cmluZyk6IHsgc2NoZW1hOiBzdHJpbmc7IHJlbGF0aW9uOiBzdHJpbmcgfSB7XG4gIGNvbnN0IHBhcnRzID0gU3RyaW5nKG5hbWUpLnNwbGl0KFwiLlwiKTtcbiAgaWYgKHBhcnRzLmxlbmd0aCA9PT0gMSkgcmV0dXJuIHsgc2NoZW1hOiBcInB1YmxpY1wiLCByZWxhdGlvbjogcGFydHNbMF0hIH07XG4gIGNvbnN0IHJlbGF0aW9uID0gcGFydHMucG9wKCkhO1xuICByZXR1cm4geyBzY2hlbWE6IHBhcnRzLmpvaW4oXCIuXCIpLCByZWxhdGlvbiB9O1xufVxuXG5hc3luYyBmdW5jdGlvbiBlbnN1cmVNYXRyaXhUYWJsZXMoY2xpZW50OiBQb29sQ2xpZW50KSB7XG4gIGF3YWl0IGNsaWVudC5xdWVyeShgQ1JFQVRFIFNDSEVNQSBJRiBOT1QgRVhJU1RTIG1hdHJpY2VzYCk7XG4gIGF3YWl0IGNsaWVudC5xdWVyeShgXG4gICAgRE8gJCRcbiAgICBCRUdJTlxuICAgICAgSUYgRVhJU1RTIChcbiAgICAgICAgU0VMRUNUIDFcbiAgICAgICAgRlJPTSBwZ19jbGFzcyBjXG4gICAgICAgIEpPSU4gcGdfbmFtZXNwYWNlIG4gT04gbi5vaWQgPSBjLnJlbG5hbWVzcGFjZVxuICAgICAgICBXSEVSRSBuLm5zcG5hbWUgPSAnbWF0cmljZXMnXG4gICAgICAgICAgQU5EIGMucmVsbmFtZSA9ICdkeW5fdmFsdWVzJ1xuICAgICAgICAgIEFORCBjLnJlbGtpbmQgSU4gKCd2JywnbScpXG4gICAgICApIFRIRU5cbiAgICAgICAgRVhFQ1VURSAnRFJPUCBWSUVXIElGIEVYSVNUUyBtYXRyaWNlcy5keW5fdmFsdWVzIENBU0NBREUnO1xuICAgICAgRU5EIElGO1xuICAgICAgSUYgRVhJU1RTIChcbiAgICAgICAgU0VMRUNUIDFcbiAgICAgICAgRlJPTSBwZ19jbGFzcyBjXG4gICAgICAgIEpPSU4gcGdfbmFtZXNwYWNlIG4gT04gbi5vaWQgPSBjLnJlbG5hbWVzcGFjZVxuICAgICAgICBXSEVSRSBuLm5zcG5hbWUgPSAnbWF0cmljZXMnXG4gICAgICAgICAgQU5EIGMucmVsbmFtZSA9ICdkeW5fdmFsdWVzX3N0YWdlJ1xuICAgICAgICAgIEFORCBjLnJlbGtpbmQgSU4gKCd2JywnbScpXG4gICAgICApIFRIRU5cbiAgICAgICAgRVhFQ1VURSAnRFJPUCBWSUVXIElGIEVYSVNUUyBtYXRyaWNlcy5keW5fdmFsdWVzX3N0YWdlIENBU0NBREUnO1xuICAgICAgRU5EIElGO1xuICAgIEVORFxuICAgICQkO1xuICBgKTtcbiAgYXdhaXQgY2xpZW50LnF1ZXJ5KGBcbiAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBtYXRyaWNlcy5keW5fdmFsdWVzIChcbiAgICAgIHRzX21zICAgICAgICBiaWdpbnQgICAgICAgICAgIE5PVCBOVUxMLFxuICAgICAgbWF0cml4X3R5cGUgIHRleHQgICAgICAgICAgICAgTk9UIE5VTEwgQ0hFQ0sgKG1hdHJpeF90eXBlIElOICgnYmVuY2htYXJrJywnZGVsdGEnLCdwY3QyNGgnLCdpZF9wY3QnLCdwY3RfZHJ2JywncmVmJywncGN0X3JlZicpKSxcbiAgICAgIGJhc2UgICAgICAgICB0ZXh0ICAgICAgICAgICAgIE5PVCBOVUxMLFxuICAgICAgcXVvdGUgICAgICAgIHRleHQgICAgICAgICAgICAgTk9UIE5VTEwsXG4gICAgICB2YWx1ZSAgICAgICAgZG91YmxlIHByZWNpc2lvbiBOT1QgTlVMTCxcbiAgICAgIG1ldGEgICAgICAgICBqc29uYiAgICAgICAgICAgIE5PVCBOVUxMIERFRkFVTFQgJ3t9Jzo6anNvbmIsXG4gICAgICBjcmVhdGVkX2F0ICAgdGltZXN0YW1wdHogICAgICBOT1QgTlVMTCBERUZBVUxUIG5vdygpLFxuICAgICAgUFJJTUFSWSBLRVkgKHRzX21zLCBtYXRyaXhfdHlwZSwgYmFzZSwgcXVvdGUpXG4gICAgKVxuICBgKTtcbiAgYXdhaXQgY2xpZW50LnF1ZXJ5KGBcbiAgICBDUkVBVEUgSU5ERVggSUYgTk9UIEVYSVNUUyBpZHhfbWF0cmljZXNfZHluX3ZhbHVlc19wYWlyXG4gICAgICBPTiBtYXRyaWNlcy5keW5fdmFsdWVzIChtYXRyaXhfdHlwZSwgYmFzZSwgcXVvdGUsIHRzX21zIERFU0MpXG4gIGApO1xuICBhd2FpdCBjbGllbnQucXVlcnkoYFxuICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIG1hdHJpY2VzLmR5bl92YWx1ZXNfc3RhZ2UgKFxuICAgICAgdHNfbXMgICAgICAgICBiaWdpbnQgICAgICAgICAgIE5PVCBOVUxMLFxuICAgICAgbWF0cml4X3R5cGUgICB0ZXh0ICAgICAgICAgICAgIE5PVCBOVUxMLFxuICAgICAgYmFzZSAgICAgICAgICB0ZXh0ICAgICAgICAgICAgIE5PVCBOVUxMLFxuICAgICAgcXVvdGUgICAgICAgICB0ZXh0ICAgICAgICAgICAgIE5PVCBOVUxMLFxuICAgICAgdmFsdWUgICAgICAgICBkb3VibGUgcHJlY2lzaW9uIE5PVCBOVUxMLFxuICAgICAgbWV0YSAgICAgICAgICBqc29uYiAgICAgICAgICAgIE5PVCBOVUxMIERFRkFVTFQgJ3t9Jzo6anNvbmIsXG4gICAgICBhcHBfc2Vzc2lvbl9pZCB0ZXh0LFxuICAgICAgY3JlYXRlZF9hdCAgICB0aW1lc3RhbXB0eiAgICAgIE5PVCBOVUxMIERFRkFVTFQgbm93KCksXG4gICAgICBQUklNQVJZIEtFWSAodHNfbXMsIG1hdHJpeF90eXBlLCBiYXNlLCBxdW90ZSlcbiAgICApXG4gIGApO1xufVxuXG5hc3luYyBmdW5jdGlvbiBmaW5kRXhpc3RpbmdUYWJsZShcbiAgY2xpZW50OiBQb29sQ2xpZW50LFxuICBjYW5kaWRhdGVzOiBzdHJpbmdbXVxuKTogUHJvbWlzZTxSZWxhdGlvbkluZm8gfCBudWxsPiB7XG4gIGZvciAoY29uc3QgcmF3IG9mIGNhbmRpZGF0ZXMpIHtcbiAgICBjb25zdCB7IHNjaGVtYSwgcmVsYXRpb24gfSA9IHNwbGl0UXVhbGlmaWVkTmFtZShyYXcpO1xuICAgIGNvbnN0IHsgcm93cyB9ID0gYXdhaXQgY2xpZW50LnF1ZXJ5PHsga2luZD86IHN0cmluZyB9PihcbiAgICAgIGBcbiAgICAgICAgU0VMRUNUIGMucmVsa2luZCBBUyBraW5kXG4gICAgICAgICAgRlJPTSBwZ19jbGFzcyBjXG4gICAgICAgICAgSk9JTiBwZ19uYW1lc3BhY2UgbiBPTiBuLm9pZCA9IGMucmVsbmFtZXNwYWNlXG4gICAgICAgICBXSEVSRSBuLm5zcG5hbWUgPSAkMSBBTkQgYy5yZWxuYW1lID0gJDJcbiAgICAgIGAsXG4gICAgICBbc2NoZW1hLCByZWxhdGlvbl1cbiAgICApO1xuICAgIGNvbnN0IGtpbmQgPSByb3dzWzBdPy5raW5kO1xuICAgIGlmIChraW5kICYmIChraW5kID09PSBcInJcIiB8fCBraW5kID09PSBcInBcIikpIHtcbiAgICAgIHJldHVybiB7IHJhdywgaWRlbnQ6IGFzSWRlbnQocmF3KSwga2luZCB9O1xuICAgIH1cbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxubGV0IGNhY2hlZFN0YWdlSW5mbzogUmVsYXRpb25JbmZvIHwgbnVsbCA9IG51bGw7XG5sZXQgY2FjaGVkTWF0cml4SW5mbzogUmVsYXRpb25JbmZvIHwgbnVsbCA9IG51bGw7XG5cbmFzeW5jIGZ1bmN0aW9uIGVuc3VyZVN0YWdlSW5mbyhjbGllbnQ6IFBvb2xDbGllbnQpOiBQcm9taXNlPFJlbGF0aW9uSW5mbz4ge1xuICBpZiAoY2FjaGVkU3RhZ2VJbmZvKSByZXR1cm4gY2FjaGVkU3RhZ2VJbmZvO1xuICBsZXQgaW5mbyA9XG4gICAgKGF3YWl0IGZpbmRFeGlzdGluZ1RhYmxlKGNsaWVudCwgW1JBV19TVEFHRV9UQUJMRSwgLi4uU1RBR0VfVEFCTEVfQ0FORElEQVRFU10pKSA/P1xuICAgIChhd2FpdCBmaW5kRXhpc3RpbmdUYWJsZShjbGllbnQsIFNUQUdFX1RBQkxFX0NBTkRJREFURVMpKTtcbiAgaWYgKCFpbmZvKSB7XG4gICAgYXdhaXQgZW5zdXJlTWF0cml4VGFibGVzKGNsaWVudCk7XG4gICAgaW5mbyA9XG4gICAgICAoYXdhaXQgZmluZEV4aXN0aW5nVGFibGUoY2xpZW50LCBbUkFXX1NUQUdFX1RBQkxFLCAuLi5TVEFHRV9UQUJMRV9DQU5ESURBVEVTXSkpID8/XG4gICAgICAoYXdhaXQgZmluZEV4aXN0aW5nVGFibGUoY2xpZW50LCBTVEFHRV9UQUJMRV9DQU5ESURBVEVTKSk7XG4gICAgaWYgKCFpbmZvKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIGBNYXRyaXggc3RhZ2UgdGFibGUgbm90IGZvdW5kLiBDaGVja2VkOiAke1tcbiAgICAgICAgICBSQVdfU1RBR0VfVEFCTEUsXG4gICAgICAgICAgLi4uU1RBR0VfVEFCTEVfQ0FORElEQVRFUyxcbiAgICAgICAgXVxuICAgICAgICAgIC5maWx0ZXIoQm9vbGVhbilcbiAgICAgICAgICAuam9pbihcIiwgXCIpfWBcbiAgICAgICk7XG4gICAgfVxuICB9XG4gIGNhY2hlZFN0YWdlSW5mbyA9IGluZm87XG4gIHJldHVybiBpbmZvO1xufVxuXG5hc3luYyBmdW5jdGlvbiBlbnN1cmVNYXRyaXhJbmZvKGNsaWVudDogUG9vbENsaWVudCk6IFByb21pc2U8UmVsYXRpb25JbmZvPiB7XG4gIGlmIChjYWNoZWRNYXRyaXhJbmZvKSByZXR1cm4gY2FjaGVkTWF0cml4SW5mbztcbiAgbGV0IGluZm8gPVxuICAgIChhd2FpdCBmaW5kRXhpc3RpbmdUYWJsZShjbGllbnQsIFtSQVdfQ09NTUlUX1RBQkxFLCAuLi5NQVRSSVhfVEFCTEVfQ0FORElEQVRFU10pKSA/P1xuICAgIChhd2FpdCBmaW5kRXhpc3RpbmdUYWJsZShjbGllbnQsIE1BVFJJWF9UQUJMRV9DQU5ESURBVEVTKSk7XG4gIGlmICghaW5mbykge1xuICAgIGF3YWl0IGVuc3VyZU1hdHJpeFRhYmxlcyhjbGllbnQpO1xuICAgIGluZm8gPVxuICAgICAgKGF3YWl0IGZpbmRFeGlzdGluZ1RhYmxlKGNsaWVudCwgW1JBV19DT01NSVRfVEFCTEUsIC4uLk1BVFJJWF9UQUJMRV9DQU5ESURBVEVTXSkpID8/XG4gICAgICAoYXdhaXQgZmluZEV4aXN0aW5nVGFibGUoY2xpZW50LCBNQVRSSVhfVEFCTEVfQ0FORElEQVRFUykpO1xuICAgIGlmICghaW5mbykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBgTWF0cml4IHZhbHVlcyB0YWJsZSBub3QgZm91bmQuIENoZWNrZWQ6ICR7W1xuICAgICAgICAgIFJBV19DT01NSVRfVEFCTEUsXG4gICAgICAgICAgLi4uTUFUUklYX1RBQkxFX0NBTkRJREFURVMsXG4gICAgICAgIF1cbiAgICAgICAgICAuZmlsdGVyKEJvb2xlYW4pXG4gICAgICAgICAgLmpvaW4oXCIsIFwiKX1gXG4gICAgICApO1xuICAgIH1cbiAgfVxuICBpZiAoIWluZm8pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICBgTWF0cml4IHZhbHVlcyB0YWJsZSBub3QgZm91bmQuIENoZWNrZWQ6ICR7W1xuICAgICAgICBSQVdfQ09NTUlUX1RBQkxFLFxuICAgICAgICAuLi5NQVRSSVhfVEFCTEVfQ0FORElEQVRFUyxcbiAgICAgIF1cbiAgICAgICAgLmZpbHRlcihCb29sZWFuKVxuICAgICAgICAuam9pbihcIiwgXCIpfWBcbiAgICApO1xuICB9XG4gIGNhY2hlZE1hdHJpeEluZm8gPSBpbmZvO1xuICByZXR1cm4gaW5mbztcbn1cblxuZnVuY3Rpb24gZGVkdXBlVXBwZXIoeHM6IHJlYWRvbmx5IHN0cmluZ1tdIHwgdW5kZWZpbmVkIHwgbnVsbCk6IHN0cmluZ1tdIHtcbiAgaWYgKCF4cz8ubGVuZ3RoKSByZXR1cm4gW107XG4gIGNvbnN0IG91dDogc3RyaW5nW10gPSBbXTtcbiAgY29uc3Qgc2VlbiA9IG5ldyBTZXQ8c3RyaW5nPigpO1xuICBmb3IgKGNvbnN0IHggb2YgeHMpIHtcbiAgICBjb25zdCB1cCA9IFN0cmluZyh4ID8/IFwiXCIpLnRyaW0oKS50b1VwcGVyQ2FzZSgpO1xuICAgIGlmICghdXAgfHwgc2Vlbi5oYXModXApKSBjb250aW51ZTtcbiAgICBzZWVuLmFkZCh1cCk7XG4gICAgb3V0LnB1c2godXApO1xuICB9XG4gIHJldHVybiBvdXQ7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRNYXRyaXhTdGFnZVRhYmxlSWRlbnQoXG4gIGNsaWVudD86IFBvb2xDbGllbnRcbik6IFByb21pc2U8c3RyaW5nPiB7XG4gIGlmIChjYWNoZWRTdGFnZUluZm8pIHJldHVybiBjYWNoZWRTdGFnZUluZm8uaWRlbnQ7XG4gIGNvbnN0IHVzZUNsaWVudCA9IGNsaWVudCA/PyAoYXdhaXQgZGIuY29ubmVjdCgpKTtcbiAgY29uc3QgcmVsZWFzZSA9ICFjbGllbnQ7XG4gIHRyeSB7XG4gICAgY29uc3QgaW5mbyA9IGF3YWl0IGVuc3VyZVN0YWdlSW5mbyh1c2VDbGllbnQpO1xuICAgIHJldHVybiBpbmZvLmlkZW50O1xuICB9IGZpbmFsbHkge1xuICAgIGlmIChyZWxlYXNlKSB1c2VDbGllbnQucmVsZWFzZSgpO1xuICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGdldE1hdHJpeFZhbHVlc1RhYmxlSWRlbnQoXG4gIGNsaWVudDogUG9vbENsaWVudFxuKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgY29uc3QgaW5mbyA9IGF3YWl0IGVuc3VyZU1hdHJpeEluZm8oY2xpZW50KTtcbiAgcmV0dXJuIGluZm8uaWRlbnQ7XG59XG5cclxuLyoqIE1hdHJpeCB0eXBlIHVuaW9uIChhbGlnbnMgd2l0aCBEREwpICovXHJcbmV4cG9ydCB0eXBlIE1hdHJpeFR5cGUgPSBcImJlbmNobWFya1wiIHwgXCJkZWx0YVwiIHwgXCJwY3QyNGhcIiB8IFwiaWRfcGN0XCIgfCBcInBjdF9kcnZcIiB8IFwicmVmXCIgfCBcInBjdF9yZWZcIjtcclxuXHJcbi8qKiBCdWxrIHVwc2VydCBkaXJlY3RseSBpbnRvIG1haW4gdGFibGUgKGJ5cGFzc2VzIHN0YWdlL2NvbW1pdCkgKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwc2VydE1hdHJpeFJvd3Mocm93czoge1xyXG4gIHRzX21zOiBudW1iZXI7XHJcbiAgbWF0cml4X3R5cGU6IE1hdHJpeFR5cGU7XHJcbiAgYmFzZTogc3RyaW5nOyBxdW90ZTogc3RyaW5nOyB2YWx1ZTogbnVtYmVyO1xyXG4gIG1ldGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xyXG59W10pIHtcclxuICBpZiAoIXJvd3MubGVuZ3RoKSByZXR1cm47XHJcbiAgY29uc3QgY2xpZW50ID0gYXdhaXQgZGIuY29ubmVjdCgpO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB2YWx1ZXM6IGFueVtdID0gW107XHJcbiAgICBjb25zdCBjaHVua3MgPSByb3dzLm1hcCgociwgaSkgPT4ge1xyXG4gICAgICBjb25zdCBqID0gaSAqIDY7XHJcbiAgICAgIHZhbHVlcy5wdXNoKHIudHNfbXMsIHIubWF0cml4X3R5cGUsIHIuYmFzZSwgci5xdW90ZSwgci52YWx1ZSwgSlNPTi5zdHJpbmdpZnkoci5tZXRhID8/IHt9KSk7XHJcbiAgICAgIHJldHVybiBgKCQke2orMX0sICQke2orMn0sICQke2orM30sICQke2orNH0sICQke2orNX0sICQke2orNn0pYDtcclxuICAgIH0pLmpvaW4oXCIsXCIpO1xyXG5cclxuICAgIGNvbnN0IHNxbCA9IGBcclxuICAgICAgSU5TRVJUIElOVE8gJHtUQUJMRX0gKHRzX21zLCBtYXRyaXhfdHlwZSwgYmFzZSwgcXVvdGUsIHZhbHVlLCBtZXRhKVxyXG4gICAgICBWQUxVRVMgJHtjaHVua3N9XHJcbiAgICAgIE9OIENPTkZMSUNUICh0c19tcywgbWF0cml4X3R5cGUsIGJhc2UsIHF1b3RlKVxyXG4gICAgICBETyBVUERBVEUgU0VUIHZhbHVlID0gRVhDTFVERUQudmFsdWUsIG1ldGEgPSBFWENMVURFRC5tZXRhO1xyXG4gICAgYDtcclxuICAgIGF3YWl0IGNsaWVudC5xdWVyeShzcWwsIHZhbHVlcyk7XHJcbiAgfSBmaW5hbGx5IHtcclxuICAgIGNsaWVudC5yZWxlYXNlKCk7XHJcbiAgfVxyXG59XHJcblxyXG4vKiogU25hcHNob3RzICYgbG9va3VwcyAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0TGF0ZXN0QnlUeXBlKG1hdHJpeF90eXBlOiBzdHJpbmcsIGNvaW5zOiBzdHJpbmdbXSkge1xyXG4gIGNvbnN0IGNsaWVudCA9IGF3YWl0IGRiLmNvbm5lY3QoKTtcclxuICB0cnkge1xyXG4gICAgY29uc3QgeyByb3dzIH0gPSBhd2FpdCBjbGllbnQucXVlcnkoXHJcbiAgICAgIGBTRUxFQ1QgdHNfbXMgRlJPTSAke1RBQkxFfSBXSEVSRSBtYXRyaXhfdHlwZT0kMSBPUkRFUiBCWSB0c19tcyBERVNDIExJTUlUIDFgLFxyXG4gICAgICBbbWF0cml4X3R5cGVdXHJcbiAgICApO1xyXG4gICAgaWYgKCFyb3dzLmxlbmd0aCkgcmV0dXJuIHsgdHNfbXM6IG51bGwsIHZhbHVlczogW10gYXMgYW55W10gfTtcclxuICAgIGNvbnN0IHRzX21zID0gTnVtYmVyKHJvd3NbMF0udHNfbXMpO1xyXG4gICAgY29uc3QgeyByb3dzOiB2YWxzIH0gPSBhd2FpdCBjbGllbnQucXVlcnkoXHJcbiAgICAgIGBTRUxFQ1QgYmFzZSwgcXVvdGUsIHZhbHVlIEZST00gJHtUQUJMRX1cclxuICAgICAgIFdIRVJFIG1hdHJpeF90eXBlPSQxIEFORCB0c19tcz0kMiBBTkQgYmFzZSA9IEFOWSgkMykgQU5EIHF1b3RlID0gQU5ZKCQzKWAsXHJcbiAgICAgIFttYXRyaXhfdHlwZSwgdHNfbXMsIGNvaW5zXVxyXG4gICAgKTtcclxuICAgIHJldHVybiB7IHRzX21zLCB2YWx1ZXM6IHZhbHMgfTtcclxuICB9IGZpbmFsbHkgeyBjbGllbnQucmVsZWFzZSgpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcmV2VmFsdWUobWF0cml4X3R5cGU6IHN0cmluZywgYmFzZTogc3RyaW5nLCBxdW90ZTogc3RyaW5nLCBiZWZvcmVUczogbnVtYmVyKSB7XHJcbiAgY29uc3QgeyByb3dzIH0gPSBhd2FpdCBkYi5xdWVyeShcclxuICAgIGBTRUxFQ1QgdmFsdWUgRlJPTSAke1RBQkxFfVxyXG4gICAgIFdIRVJFIG1hdHJpeF90eXBlPSQxIEFORCBiYXNlPSQyIEFORCBxdW90ZT0kMyBBTkQgdHNfbXMgPCAkNFxyXG4gICAgIE9SREVSIEJZIHRzX21zIERFU0MgTElNSVQgMWAsXHJcbiAgICBbbWF0cml4X3R5cGUsIGJhc2UsIHF1b3RlLCBiZWZvcmVUc11cclxuICApO1xyXG4gIHJldHVybiByb3dzLmxlbmd0aCA/IE51bWJlcihyb3dzWzBdLnZhbHVlKSA6IG51bGw7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRMYXRlc3RUc0ZvclR5cGUobWF0cml4X3R5cGU6IHN0cmluZykge1xyXG4gIGNvbnN0IHsgcm93cyB9ID0gYXdhaXQgZGIucXVlcnkoXHJcbiAgICBgU0VMRUNUIE1BWCh0c19tcykgQVMgdHNfbXMgRlJPTSAke1RBQkxFfSBXSEVSRSBtYXRyaXhfdHlwZT0kMWAsXHJcbiAgICBbbWF0cml4X3R5cGVdXHJcbiAgKTtcclxuICBjb25zdCB2ID0gcm93c1swXT8udHNfbXM7XHJcbiAgcmV0dXJuIHYgPT0gbnVsbCA/IG51bGwgOiBOdW1iZXIodik7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXROZWFyZXN0VHNBdE9yQmVmb3JlKG1hdHJpeF90eXBlOiBzdHJpbmcsIHRzX21zOiBudW1iZXIpIHtcclxuICBjb25zdCB7IHJvd3MgfSA9IGF3YWl0IGRiLnF1ZXJ5KFxyXG4gICAgYFNFTEVDVCB0c19tcyBGUk9NICR7VEFCTEV9XHJcbiAgICAgV0hFUkUgbWF0cml4X3R5cGU9JDEgQU5EIHRzX21zIDw9ICQyXHJcbiAgICAgT1JERVIgQlkgdHNfbXMgREVTQyBMSU1JVCAxYCxcclxuICAgIFttYXRyaXhfdHlwZSwgdHNfbXNdXHJcbiAgKTtcclxuICBjb25zdCB2ID0gcm93c1swXT8udHNfbXM7XHJcbiAgcmV0dXJuIHYgPT0gbnVsbCA/IG51bGwgOiBOdW1iZXIodik7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTbmFwc2hvdEJ5VHlwZShtYXRyaXhfdHlwZTogc3RyaW5nLCB0c19tczogbnVtYmVyLCBjb2luczogc3RyaW5nW10pIHtcclxuICBjb25zdCB7IHJvd3MgfSA9IGF3YWl0IGRiLnF1ZXJ5KFxyXG4gICAgYFNFTEVDVCBiYXNlLCBxdW90ZSwgdmFsdWUgRlJPTSAke1RBQkxFfVxyXG4gICAgIFdIRVJFIG1hdHJpeF90eXBlPSQxIEFORCB0c19tcz0kMiBBTkQgYmFzZSA9IEFOWSgkMykgQU5EIHF1b3RlID0gQU5ZKCQzKWAsXHJcbiAgICBbbWF0cml4X3R5cGUsIHRzX21zLCBjb2luc11cclxuICApO1xyXG4gIHJldHVybiByb3dzIGFzIHsgYmFzZTpzdHJpbmc7IHF1b3RlOnN0cmluZzsgdmFsdWU6bnVtYmVyIH1bXTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByZXZTbmFwc2hvdEJ5VHlwZShtYXRyaXhfdHlwZTogc3RyaW5nLCBiZWZvcmVUczogbnVtYmVyLCBjb2luczogc3RyaW5nW10pIHtcclxuICBjb25zdCB7IHJvd3MgfSA9IGF3YWl0IGRiLnF1ZXJ5KFxyXG4gICAgYFNFTEVDVCBESVNUSU5DVCBPTiAoYmFzZSwgcXVvdGUpIGJhc2UsIHF1b3RlLCB2YWx1ZVxyXG4gICAgICAgRlJPTSAke1RBQkxFfVxyXG4gICAgICBXSEVSRSBtYXRyaXhfdHlwZT0kMVxyXG4gICAgICAgIEFORCB0c19tcyA8ICQyXHJcbiAgICAgICAgQU5EIGJhc2UgID0gQU5ZKCQzKVxyXG4gICAgICAgIEFORCBxdW90ZSA9IEFOWSgkMylcclxuICAgT1JERVIgQlkgYmFzZSwgcXVvdGUsIHRzX21zIERFU0NgLFxyXG4gICAgW21hdHJpeF90eXBlLCBiZWZvcmVUcywgY29pbnNdXHJcbiAgKTtcclxuICByZXR1cm4gcm93cyBhcyB7IGJhc2U6IHN0cmluZzsgcXVvdGU6IHN0cmluZzsgdmFsdWU6IG51bWJlciB9W107XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjb3VudFJvd3NBdChtYXRyaXhfdHlwZTogc3RyaW5nLCB0c19tczogbnVtYmVyKSB7XHJcbiAgY29uc3QgeyByb3dzIH0gPSBhd2FpdCBkYi5xdWVyeShcclxuICAgIGBTRUxFQ1QgY291bnQoKik6OmludCBBUyBuIEZST00gJHtUQUJMRX0gV0hFUkUgbWF0cml4X3R5cGU9JDEgQU5EIHRzX21zPSQyYCxcclxuICAgIFttYXRyaXhfdHlwZSwgdHNfbXNdXHJcbiAgKTtcclxuICByZXR1cm4gcm93c1swXT8ubiA/PyAwO1xyXG59XHJcblxyXG5cclxuLy8g4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAIE9wZW5pbmcgaGVscGVycyAoREIgKyBjYWNoZSkg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAXHJcbnR5cGUgT3BlbmluZ0tleSA9IHsgYmFzZTogc3RyaW5nOyBxdW90ZT86IHN0cmluZzsgd2luZG93Pzogc3RyaW5nOyBhcHBTZXNzaW9uSWQ/OiBzdHJpbmcgfTtcclxuY29uc3Qgb3BlbmluZ0NhY2hlID0gbmV3IE1hcDxzdHJpbmcsIHsgcHJpY2U6IG51bWJlcjsgdHM6IG51bWJlciB9PigpO1xyXG5jb25zdCBrZXlTdHIgPSAoazogT3BlbmluZ0tleSkgPT5cclxuICBgJHtrLmJhc2V9OiR7ay5xdW90ZSA/PyBcIlVTRFRcIn06JHtrLndpbmRvdyA/PyBcIjFoXCJ9OiR7ay5hcHBTZXNzaW9uSWQgPz8gXCJnbG9iYWxcIn1gO1xyXG5cclxuLyoqIFJlYWQgbGFzdCBvcGVuaW5nIGZvciBhIChiYXNlLHF1b3RlLHdpbmRvdyxzZXNzaW9uKSBmcm9tIFNUUi1BVVg7IGZhbGxiYWNrIHRvIGNvbXBhdCB2aWV3ICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRPcGVuaW5nRnJvbURiKFxyXG4gIGs6IE9wZW5pbmdLZXlcclxuKTogUHJvbWlzZTx7IHByaWNlOiBudW1iZXI7IHRzOiBudW1iZXIgfSB8IG51bGw+IHtcclxuICAvLyBTb3VyY2Ugb2YgdHJ1dGg6IHN0cmF0ZWd5X2F1eC5zdHJfYXV4X3Nlc3Npb24gd2l0aCBvcGVuaW5nX3N0YW1wID0gVFJVRVxyXG4gIGNvbnN0IHExID0gYFxyXG4gICAgU0VMRUNUIG9wZW5pbmdfdHMgQVMgdHMsIG9wZW5pbmdfcHJpY2UgQVMgcHJpY2VcclxuICAgICAgRlJPTSBzdHJhdGVneV9hdXguc3RyX2F1eF9zZXNzaW9uXHJcbiAgICAgV0hFUkUgcGFpcl9iYXNlPSQxIEFORCBwYWlyX3F1b3RlPSQyIEFORCB3aW5kb3dfa2V5PSQzXHJcbiAgICAgICBBTkQgKCQ0Ojp0ZXh0IElTIE5VTEwgT1IgYXBwX3Nlc3Npb25faWQ9JDQpXHJcbiAgICAgICBBTkQgb3BlbmluZ19zdGFtcCA9IFRSVUVcclxuICBPUkRFUiBCWSBvcGVuaW5nX3RzIERFU0NcclxuICAgICBMSU1JVCAxXHJcbiAgYDtcclxuICBjb25zdCByMSA9IGF3YWl0IGRiLnF1ZXJ5KHExLCBbay5iYXNlLCBrLnF1b3RlID8/IFwiVVNEVFwiLCBrLndpbmRvdyA/PyBcIjFoXCIsIGsuYXBwU2Vzc2lvbklkID8/IG51bGxdKTtcclxuICBpZiAocjEucm93cy5sZW5ndGgpIHtcclxuICAgIHJldHVybiB7IHByaWNlOiBOdW1iZXIocjEucm93c1swXS5wcmljZSksIHRzOiBOdW1iZXIocjEucm93c1swXS50cykgfTtcclxuICB9XHJcblxyXG4gIC8vIENvbXBhdGliaWxpdHkgdmlldyAoa2VwdCBmb3Igb2xkZXIgY29kZSBwYXRocylcclxuICBjb25zdCBxMiA9IGBTRUxFQ1Qgc2Vzc2lvbl90cyBBUyB0cywgb3BlbmluZ19wcmljZSBBUyBwcmljZVxyXG4gICAgICAgICAgICAgICAgRlJPTSBzZXNzaW9uX29wZW5pbmdzXHJcbiAgICAgICAgICAgIE9SREVSIEJZIHNlc3Npb25fdHMgREVTQ1xyXG4gICAgICAgICAgICAgICBMSU1JVCAxYDtcclxuICBjb25zdCByMiA9IGF3YWl0IGRiLnF1ZXJ5KHEyKTtcclxuICBpZiAocjIucm93cy5sZW5ndGgpIHtcclxuICAgIHJldHVybiB7IHByaWNlOiBOdW1iZXIocjIucm93c1swXS5wcmljZSksIHRzOiBOdW1iZXIocjIucm93c1swXS50cykgfTtcclxuICB9XHJcbiAgcmV0dXJuIG51bGw7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBFbnN1cmUgYW4gb3BlbmluZyBleGlzdHMgKyBjYWNoZSBpdCBmb3IgdGhpcyBwcm9jZXNzLlxyXG4gKiBJZiB5b3UgcGFzcyBvcGVuaW5nVHMvb3BlbmluZ1ByaWNlLCB3ZSB0cnkgdG8gdXBzZXJ0IHZpYSB0aGUgU1FMIGZ1bmN0aW9uIGB1cHNlcnRfc3RyX2F1eF9vcGVuaW5nYCAoaWYgcHJlc2VudCkuXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZW5zdXJlT3BlbmluZyhcclxuICBrOiBPcGVuaW5nS2V5LFxyXG4gIG9wdHM6IHsgb3BlbmluZ1RzPzogbnVtYmVyOyBvcGVuaW5nUHJpY2U/OiBudW1iZXI7IGV0YVBjdD86IG51bWJlcjsgZXBzU2hpZnRQY3Q/OiBudW1iZXI7IEs/OiBudW1iZXIgfSA9IHt9XHJcbikge1xyXG4gIGNvbnN0IGNrID0ga2V5U3RyKGspO1xyXG4gIGNvbnN0IGhpdCA9IG9wZW5pbmdDYWNoZS5nZXQoY2spO1xyXG4gIGlmIChoaXQpIHJldHVybiBoaXQ7XHJcblxyXG4gIC8vIElmIGdpdmVuIGV4cGxpY2l0IG9wZW5pbmcsIHRyeSB0byBwZXJzaXN0IChuby1vcCBpZiB0aGUgZnVuY3Rpb24gZG9lc24ndCBleGlzdCkuXHJcbiAgaWYgKG9wdHMub3BlbmluZ1ByaWNlICE9IG51bGwgJiYgb3B0cy5vcGVuaW5nVHMgIT0gbnVsbCkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgYXdhaXQgZGIucXVlcnkoXHJcbiAgICAgICAgYFNFTEVDVCB1cHNlcnRfc3RyX2F1eF9vcGVuaW5nKCQxLCQyLCQzLCQ0LCQ1LCQ2LCQ3KWAsXHJcbiAgICAgICAgW1xyXG4gICAgICAgICAgay5iYXNlLCBrLnF1b3RlID8/IFwiVVNEVFwiLCBrLndpbmRvdyA/PyBcIjFoXCIsIGsuYXBwU2Vzc2lvbklkID8/IFwiZ2xvYmFsXCIsXHJcbiAgICAgICAgICBvcHRzLm9wZW5pbmdUcywgb3B0cy5vcGVuaW5nUHJpY2UsXHJcbiAgICAgICAgICBgaWRlbToke2suYmFzZX06JHtrLnF1b3RlID8/IFwiVVNEVFwifToke2sud2luZG93ID8/IFwiMWhcIn06JHtrLmFwcFNlc3Npb25JZCA/PyBcImdsb2JhbFwifToke29wdHMub3BlbmluZ1RzfWBcclxuICAgICAgICBdXHJcbiAgICAgICk7XHJcbiAgICB9IGNhdGNoIHsgLyogZnVuY3Rpb24gbWF5IG5vdCBleGlzdCB5ZXQ7IGl0J3MgZmluZSAqLyB9XHJcbiAgfVxyXG5cclxuICBjb25zdCByb3cgPSBhd2FpdCBnZXRPcGVuaW5nRnJvbURiKGspO1xyXG4gIGlmIChyb3cpIHtcclxuICAgIG9wZW5pbmdDYWNoZS5zZXQoY2ssIHJvdyk7XHJcbiAgICByZXR1cm4gcm93O1xyXG4gIH1cclxuICByZXR1cm4gbnVsbDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyT3BlbmluZ0NhY2hlKGs/OiBPcGVuaW5nS2V5KSB7XHJcbiAgaWYgKCFrKSByZXR1cm4gb3BlbmluZ0NhY2hlLmNsZWFyKCk7XHJcbiAgb3BlbmluZ0NhY2hlLmRlbGV0ZShrZXlTdHIoaykpO1xyXG59XHJcblxyXG5cclxuLy8g4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAIE1hdHJpY2VzIFNUQUdFL0NPTU1JVCBoZWxwZXJzIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgFxyXG4vKiogR3JpZCBvYmplY3Qgc2hhcGUgdXNlZCBhY3Jvc3MgZmVhdHVyZXMgKEJBU0UgLT4gUVVPVEUgLT4gdmFsdWV8bnVsbCkgKi9cclxuZXhwb3J0IHR5cGUgTWF0cml4R3JpZE9iamVjdCA9IFJlY29yZDxzdHJpbmcsIFJlY29yZDxzdHJpbmcsIG51bWJlciB8IG51bGw+PjtcclxuXHJcbi8qKiBJbnRlcm5hbDogaXRlcmF0ZSBvZmYtZGlhZ29uYWwgY2VsbHMgdGhhdCBoYXZlIGZpbml0ZSBudW1iZXJzICovXHJcbmZ1bmN0aW9uKiBjZWxsc09mKGNvaW5zOiBzdHJpbmdbXSwgdmFsdWVzOiBNYXRyaXhHcmlkT2JqZWN0KSB7XHJcbiAgZm9yIChjb25zdCBiIG9mIGNvaW5zKSB7XHJcbiAgICBmb3IgKGNvbnN0IHEgb2YgY29pbnMpIHtcclxuICAgICAgaWYgKGIgPT09IHEpIGNvbnRpbnVlO1xyXG4gICAgICBjb25zdCB2ID0gdmFsdWVzPy5bYl0/LltxXTtcclxuICAgICAgaWYgKHYgPT0gbnVsbCB8fCBOdW1iZXIuaXNOYU4oTnVtYmVyKHYpKSkgY29udGludWU7XHJcbiAgICAgIHlpZWxkIHsgYmFzZTogYiwgcXVvdGU6IHEsIHZhbHVlOiBOdW1iZXIodikgfTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbi8qKiBTdGFnZSBhbGwgY2VsbHMgZm9yIGEgKG1hdHJpeF90eXBlLCB0c19tcykuIE92ZXJ3cml0ZXMgb24gY29uZmxpY3QgaW4gU1RBR0UuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzdGFnZU1hdHJpeEdyaWQob3B0czoge1xuICBhcHBTZXNzaW9uSWQ6IHN0cmluZztcbiAgbWF0cml4VHlwZTogTWF0cml4VHlwZTtcbiAgdHNNczogbnVtYmVyO1xuICBjb2luczogc3RyaW5nW107XG4gIHZhbHVlczogTWF0cml4R3JpZE9iamVjdDtcbiAgbWV0YT86IGFueTtcbiAgY2xpZW50PzogUG9vbENsaWVudDtcbn0pIHtcbiAgY29uc3QgeyBhcHBTZXNzaW9uSWQsIG1hdHJpeFR5cGUsIHRzTXMsIGNvaW5zLCB2YWx1ZXMsIG1ldGEsIGNsaWVudDogZXh0ZXJuYWwgfSA9XG4gICAgb3B0cztcbiAgY29uc3QgY2xpZW50ID0gZXh0ZXJuYWwgPz8gKGF3YWl0IGRiLmNvbm5lY3QoKSk7XG4gIGNvbnN0IHJlbGVhc2UgPSAhZXh0ZXJuYWw7XG4gIHRyeSB7XG4gICAgY29uc3Qgcm93cyA9IEFycmF5LmZyb20oY2VsbHNPZihjb2lucywgdmFsdWVzKSk7XG4gICAgaWYgKCFyb3dzLmxlbmd0aCkgcmV0dXJuIHsgb2s6IHRydWUsIHN0YWdlZDogMCB9O1xuXG4gICAgY29uc3QgbWV0YUpzb24gPSBKU09OLnN0cmluZ2lmeShtZXRhID8/IHt9KTtcbiAgICBjb25zdCBzdGFnZUluZm8gPSBhd2FpdCBlbnN1cmVTdGFnZUluZm8oY2xpZW50KTtcbiAgICBjb25zdCB0ZXh0ID0gYFxuICAgICAgSU5TRVJUIElOVE8gJHtzdGFnZUluZm8uaWRlbnR9XG4gICAgICAgICh0c19tcywgbWF0cml4X3R5cGUsIGJhc2UsIHF1b3RlLCB2YWx1ZSwgbWV0YSwgYXBwX3Nlc3Npb25faWQpXG4gICAgICBWQUxVRVMgJHtyb3dzXG4gICAgICAgIC5tYXAoXG4gICAgICAgICAgKF8sIGkpID0+XG4gICAgICAgICAgICBgKCQxLCQyLCQke2kgKiAzICsgM30sJCR7aSAqIDMgKyA0fSwkJHtpICogMyArIDV9LCQke1xuICAgICAgICAgICAgICByb3dzLmxlbmd0aCAqIDMgKyAzXG4gICAgICAgICAgICB9LCQke3Jvd3MubGVuZ3RoICogMyArIDR9KWBcbiAgICAgICAgKVxuICAgICAgICAuam9pbihcIixcIil9XG4gICAgICBPTiBDT05GTElDVCAodHNfbXMsIG1hdHJpeF90eXBlLCBiYXNlLCBxdW90ZSlcbiAgICAgIERPIFVQREFURSBTRVQgdmFsdWUgPSBFWENMVURFRC52YWx1ZSwgbWV0YSA9IEVYQ0xVREVELm1ldGEsIGFwcF9zZXNzaW9uX2lkID0gRVhDTFVERUQuYXBwX3Nlc3Npb25faWRcbiAgICBgO1xuICAgIGNvbnN0IHBhcmFtczogYW55W10gPSBbdHNNcywgbWF0cml4VHlwZV07XG4gICAgZm9yIChjb25zdCByIG9mIHJvd3MpIHBhcmFtcy5wdXNoKHIuYmFzZSwgci5xdW90ZSwgci52YWx1ZSk7XG4gICAgcGFyYW1zLnB1c2gobWV0YUpzb24sIGFwcFNlc3Npb25JZCk7XG4gICAgYXdhaXQgY2xpZW50LnF1ZXJ5KHRleHQsIHBhcmFtcyk7XG4gICAgcmV0dXJuIHsgb2s6IHRydWUsIHN0YWdlZDogcm93cy5sZW5ndGggfTtcbiAgfSBmaW5hbGx5IHtcbiAgICBpZiAocmVsZWFzZSkgY2xpZW50LnJlbGVhc2UoKTtcbiAgfVxufVxuXG4vKiogUHVibGlzaCBzdGFnZWQgcm93cyBpbnRvIG1haW4gdGFibGUgKyBjeWNsZV9kb2N1bWVudCArIGxlZGdlciAoc2VlIERETCkgKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjb21taXRNYXRyaXhHcmlkKG9wdHM6IHtcbiAgYXBwU2Vzc2lvbklkOiBzdHJpbmc7XG4gIG1hdHJpeFR5cGU6IE1hdHJpeFR5cGU7XG4gIHRzTXM6IG51bWJlcjtcbiAgY29pbnM/OiBzdHJpbmdbXTtcbiAgaWRlbT86IHN0cmluZyB8IG51bGw7XG4gIGNsaWVudD86IFBvb2xDbGllbnQ7XG59KSB7XG4gIGNvbnN0IHsgbWF0cml4VHlwZSwgdHNNcywgY29pbnMsIGNsaWVudDogZXh0ZXJuYWwgfSA9IG9wdHM7XG4gIGNvbnN0IGNsaWVudCA9IGV4dGVybmFsID8/IChhd2FpdCBkYi5jb25uZWN0KCkpO1xuICBjb25zdCByZWxlYXNlID0gIWV4dGVybmFsO1xuICBjb25zdCBtYW5hZ2VUeCA9ICFleHRlcm5hbDtcbiAgdHJ5IHtcbiAgICBpZiAobWFuYWdlVHgpIGF3YWl0IGNsaWVudC5xdWVyeShcIkJFR0lOXCIpO1xuXG4gICAgY29uc3Qgc3RhZ2VJbmZvID0gYXdhaXQgZW5zdXJlU3RhZ2VJbmZvKGNsaWVudCk7XG4gICAgY29uc3QgbWF0cml4VGFibGUgPSBhd2FpdCBnZXRNYXRyaXhWYWx1ZXNUYWJsZUlkZW50KGNsaWVudCk7XG5cbiAgICBjb25zdCBzdGFnZVJvd3MgPSBhd2FpdCBjbGllbnQucXVlcnk8eyBiYXNlOiBzdHJpbmc7IHF1b3RlOiBzdHJpbmcgfT4oXG4gICAgICBgU0VMRUNUIGJhc2UsIHF1b3RlXG4gICAgICAgICBGUk9NICR7c3RhZ2VJbmZvLmlkZW50fVxuICAgICAgICBXSEVSRSB0c19tcyA9ICQxIEFORCBtYXRyaXhfdHlwZSA9ICQyYCxcbiAgICAgIFt0c01zLCBtYXRyaXhUeXBlXVxuICAgICk7XG5cbiAgICBjb25zdCBzdGFnZWRDZWxscyA9IHN0YWdlUm93cy5yb3dDb3VudCA/PyBzdGFnZVJvd3Mucm93cy5sZW5ndGg7XG5cbiAgICBjb25zdCBjb2luc0Zyb21TdGFnZSA9IG5ldyBTZXQ8c3RyaW5nPigpO1xuICAgIGZvciAoY29uc3Qgcm93IG9mIHN0YWdlUm93cy5yb3dzKSB7XG4gICAgICBjb25zdCBiYXNlID0gU3RyaW5nKHJvdy5iYXNlID8/IFwiXCIpLnRvVXBwZXJDYXNlKCk7XG4gICAgICBjb25zdCBxdW90ZSA9IFN0cmluZyhyb3cucXVvdGUgPz8gXCJcIikudG9VcHBlckNhc2UoKTtcbiAgICAgIGlmIChiYXNlKSBjb2luc0Zyb21TdGFnZS5hZGQoYmFzZSk7XG4gICAgICBpZiAocXVvdGUpIGNvaW5zRnJvbVN0YWdlLmFkZChxdW90ZSk7XG4gICAgfVxuXG4gICAgY29uc3QgZWxpZ2libGVDb2lucyA9XG4gICAgICBjb2lucz8ubGVuZ3RoICYmIGRlZHVwZVVwcGVyKGNvaW5zKS5sZW5ndGhcbiAgICAgICAgPyBkZWR1cGVVcHBlcihjb2lucylcbiAgICAgICAgOiBBcnJheS5mcm9tKGNvaW5zRnJvbVN0YWdlKTtcblxuICAgIGNvbnN0IGV4cGVjdGVkQ2VsbHMgPVxuICAgICAgZWxpZ2libGVDb2lucy5sZW5ndGggKiBNYXRoLm1heChlbGlnaWJsZUNvaW5zLmxlbmd0aCAtIDEsIDApO1xuXG4gICAgYXdhaXQgY2xpZW50LnF1ZXJ5KFxuICAgICAgYFxuICAgICAgSU5TRVJUIElOVE8gJHttYXRyaXhUYWJsZX1cbiAgICAgICAgKHRzX21zLCBtYXRyaXhfdHlwZSwgYmFzZSwgcXVvdGUsIHZhbHVlLCBtZXRhKVxuICAgICAgU0VMRUNUIHRzX21zLCBtYXRyaXhfdHlwZSwgYmFzZSwgcXVvdGUsIHZhbHVlLCBtZXRhXG4gICAgICAgIEZST00gJHtzdGFnZUluZm8uaWRlbnR9XG4gICAgICAgV0hFUkUgdHNfbXMgPSAkMSBBTkQgbWF0cml4X3R5cGUgPSAkMlxuICAgICAgT04gQ09ORkxJQ1QgKHRzX21zLCBtYXRyaXhfdHlwZSwgYmFzZSwgcXVvdGUpXG4gICAgICBETyBVUERBVEUgU0VUIHZhbHVlID0gRVhDTFVERUQudmFsdWUsIG1ldGEgPSBFWENMVURFRC5tZXRhXG4gICAgYCxcbiAgICAgIFt0c01zLCBtYXRyaXhUeXBlXVxuICAgICk7XG5cbiAgICBjb25zdCBzdGFnZWRQYWlycyA9IG5ldyBTZXQoXG4gICAgICBzdGFnZVJvd3Mucm93c1xuICAgICAgICAubWFwKChyb3cpID0+IHtcbiAgICAgICAgICBjb25zdCBiYXNlID0gU3RyaW5nKHJvdy5iYXNlID8/IFwiXCIpLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgICAgY29uc3QgcXVvdGUgPSBTdHJpbmcocm93LnF1b3RlID8/IFwiXCIpLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgICAgaWYgKCFiYXNlIHx8ICFxdW90ZSB8fCBiYXNlID09PSBxdW90ZSkgcmV0dXJuIG51bGw7XG4gICAgICAgICAgcmV0dXJuIGAke2Jhc2V94oaSJHtxdW90ZX1gO1xuICAgICAgICB9KVxuICAgICAgICAuZmlsdGVyKEJvb2xlYW4pIGFzIHN0cmluZ1tdXG4gICAgKTtcblxuICAgIGxldCBtaXNzaW5nQ291bnQgPSAwO1xuICAgIGZvciAoY29uc3QgYmFzZSBvZiBlbGlnaWJsZUNvaW5zKSB7XG4gICAgICBmb3IgKGNvbnN0IHF1b3RlIG9mIGVsaWdpYmxlQ29pbnMpIHtcbiAgICAgICAgaWYgKGJhc2UgPT09IHF1b3RlKSBjb250aW51ZTtcbiAgICAgICAgaWYgKCFzdGFnZWRQYWlycy5oYXMoYCR7YmFzZX3ihpIke3F1b3RlfWApKSBtaXNzaW5nQ291bnQgKz0gMTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAobWFuYWdlVHgpIGF3YWl0IGNsaWVudC5xdWVyeShcIkNPTU1JVFwiKTtcblxuICAgIHJldHVybiB7XG4gICAgICBvazogdHJ1ZSxcbiAgICAgIG1hdHJpeF90eXBlOiBtYXRyaXhUeXBlLFxuICAgICAgdHNfbXM6IHRzTXMsXG4gICAgICBleHBlY3RlZF9jZWxsczogZXhwZWN0ZWRDZWxscyxcbiAgICAgIHN0YWdlZF9jZWxsczogc3RhZ2VkQ2VsbHMsXG4gICAgICBtaXNzaW5nX2NvdW50OiBtaXNzaW5nQ291bnQsXG4gICAgICBjb21wbGV0ZTogbWlzc2luZ0NvdW50ID09PSAwICYmIHN0YWdlZENlbGxzID09PSBleHBlY3RlZENlbGxzLFxuICAgIH07XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGlmIChtYW5hZ2VUeCkgYXdhaXQgY2xpZW50LnF1ZXJ5KFwiUk9MTEJBQ0tcIik7XG4gICAgdGhyb3cgZXJyO1xuICB9IGZpbmFsbHkge1xuICAgIGlmIChyZWxlYXNlKSBjbGllbnQucmVsZWFzZSgpO1xuICB9XG59XG5cclxuLyoqIENvbnZlbmllbmNlOiByZWFkIHByZXYgYmVuY2htYXJrIGdyaWQgZm9yIGEgY29pbiBzZXQgKHBhaXJlZCBtYXApICovXHJcbmFzeW5jIGZ1bmN0aW9uIG1hcFByZXZCZW5jaG1hcmsoYmVmb3JlVHM6IG51bWJlciwgY29pbnM6IHN0cmluZ1tdKSB7XHJcbiAgY29uc3QgcHJldiA9IGF3YWl0IGdldFByZXZTbmFwc2hvdEJ5VHlwZShcImJlbmNobWFya1wiLCBiZWZvcmVUcywgY29pbnMpO1xyXG4gIGNvbnN0IG0gPSBuZXcgTWFwPHN0cmluZywgbnVtYmVyPigpO1xyXG4gIGZvciAoY29uc3QgciBvZiBwcmV2KSBtLnNldChgJHtyLmJhc2V9LyR7ci5xdW90ZX1gLCBOdW1iZXIoci52YWx1ZSkpO1xyXG4gIHJldHVybiBtO1xyXG59XHJcblxyXG4vKipcclxuICogUGVyc2lzdCB0aGUgY3VycmVudCBsaXZlIHNsaWNlcyBmb3IgdGhlIGFjdGl2ZSBjb2luLXVuaXZlcnNlOlxyXG4gKiAgLSBiZW5jaG1hcmsgKGZ1bGwgTsOXTilcclxuICogIC0gcGN0MjRoICAgKGFzLWlzIGZyb20gbGl2ZSlcclxuICogIC0gaWRfcGN0ICAgKGRlcml2ZWQgdnMgcHJldiBiZW5jaG1hcmsgc28gcGN0X2RydiBoYXMgaGlzdG9yeSBvbiBuZXh0IHRpY2spXHJcbiAqXHJcbiAqIEFsbCB0aHJlZSB1c2UgdGhlIFNBTUUgdHNfbXMgdG8ga2VlcCBzbGljZXMgYWxpZ25lZC5cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwZXJzaXN0TGl2ZU1hdHJpY2VzU2xpY2Uob3B0czoge1xuICBhcHBTZXNzaW9uSWQ6IHN0cmluZztcbiAgY29pbnM6IHN0cmluZ1tdO1xuICB0c01zOiBudW1iZXI7XG4gIGJlbmNobWFyazogTWF0cml4R3JpZE9iamVjdDtcbiAgcGN0MjRoPzogTWF0cml4R3JpZE9iamVjdDtcclxuICBpZGVtUHJlZml4Pzogc3RyaW5nO1xyXG59KSB7XHJcbiAgY29uc3QgeyBhcHBTZXNzaW9uSWQsIGNvaW5zLCB0c01zLCBiZW5jaG1hcmssIHBjdDI0aCwgaWRlbVByZWZpeCB9ID0gb3B0cztcclxuXHJcbiAgLy8gMSkgc3RhZ2UrY29tbWl0IGJlbmNobWFya1xyXG4gIGF3YWl0IHN0YWdlTWF0cml4R3JpZCh7XHJcbiAgICBhcHBTZXNzaW9uSWQsXHJcbiAgICBtYXRyaXhUeXBlOiBcImJlbmNobWFya1wiLFxyXG4gICAgdHNNcyxcclxuICAgIGNvaW5zLFxyXG4gICAgdmFsdWVzOiBiZW5jaG1hcmssXHJcbiAgICBtZXRhOiB7IHNvdXJjZTogXCJsaXZlXCIgfVxyXG4gIH0pO1xyXG4gIGF3YWl0IGNvbW1pdE1hdHJpeEdyaWQoe1xyXG4gICAgYXBwU2Vzc2lvbklkLFxyXG4gICAgbWF0cml4VHlwZTogXCJiZW5jaG1hcmtcIixcclxuICAgIHRzTXMsXHJcbiAgICBjb2lucyxcclxuICAgIGlkZW06IGAke2lkZW1QcmVmaXggPz8gXCJiZW5jaG1hcmtcIn06JHt0c01zfWBcclxuICB9KTtcclxuXHJcbiAgLy8gMikgc3RhZ2UrY29tbWl0IHBjdDI0aCAob3B0aW9uYWwpXHJcbiAgaWYgKHBjdDI0aCkge1xyXG4gICAgYXdhaXQgc3RhZ2VNYXRyaXhHcmlkKHtcclxuICAgICAgYXBwU2Vzc2lvbklkLFxyXG4gICAgICBtYXRyaXhUeXBlOiBcInBjdDI0aFwiLFxyXG4gICAgICB0c01zLFxyXG4gICAgICBjb2lucyxcclxuICAgICAgdmFsdWVzOiBwY3QyNGgsXHJcbiAgICAgIG1ldGE6IHsgc291cmNlOiBcImxpdmVcIiB9XHJcbiAgICB9KTtcclxuICAgIGF3YWl0IGNvbW1pdE1hdHJpeEdyaWQoe1xyXG4gICAgICBhcHBTZXNzaW9uSWQsXHJcbiAgICAgIG1hdHJpeFR5cGU6IFwicGN0MjRoXCIsXHJcbiAgICAgIHRzTXMsXHJcbiAgICAgIGNvaW5zLFxyXG4gICAgICBpZGVtOiBgJHtpZGVtUHJlZml4ID8/IFwicGN0MjRoXCJ9OiR7dHNNc31gXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIDMpIGRlcml2ZSBpZF9wY3QgdnMgcHJldihiZW5jaG1hcmspIGFuZCBwZXJzaXN0XHJcbiAgY29uc3QgcHJldk1hcCA9IGF3YWl0IG1hcFByZXZCZW5jaG1hcmsodHNNcywgY29pbnMpO1xyXG4gIGNvbnN0IGlkT2JqOiBNYXRyaXhHcmlkT2JqZWN0ID0ge307XHJcbiAgZm9yIChjb25zdCBiIG9mIGNvaW5zKSB7XHJcbiAgICBpZE9ialtiXSA9IHt9IGFzIFJlY29yZDxzdHJpbmcsIG51bWJlciB8IG51bGw+O1xyXG4gICAgZm9yIChjb25zdCBxIG9mIGNvaW5zKSB7XHJcbiAgICAgIGlmIChiID09PSBxKSBjb250aW51ZTtcclxuICAgICAgY29uc3Qgbm93ID0gYmVuY2htYXJrPy5bYl0/LltxXTtcclxuICAgICAgY29uc3QgcHJldiA9IHByZXZNYXAuZ2V0KGAke2J9LyR7cX1gKTtcclxuICAgICAgaWYgKG5vdyA9PSBudWxsIHx8IHByZXYgPT0gbnVsbCB8fCBNYXRoLmFicyhwcmV2KSA8IDFlLTMwMCkge1xyXG4gICAgICAgIGlkT2JqW2JdW3FdID0gbnVsbDtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpZE9ialtiXVtxXSA9IChOdW1iZXIobm93KSAtIHByZXYpIC8gcHJldjsgLy8gaWRfcGN0ID0gKGJtX25ldyAtIGJtX3ByZXYpL2JtX3ByZXZcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuICBhd2FpdCBzdGFnZU1hdHJpeEdyaWQoe1xyXG4gICAgYXBwU2Vzc2lvbklkLFxyXG4gICAgbWF0cml4VHlwZTogXCJpZF9wY3RcIixcclxuICAgIHRzTXMsXHJcbiAgICBjb2lucyxcclxuICAgIHZhbHVlczogaWRPYmosXHJcbiAgICBtZXRhOiB7IHNvdXJjZTogXCJkZXJpdmVkQGRiXCIsIGJhc2U6IFwicHJldihiZW5jaG1hcmspXCIgfVxyXG4gIH0pO1xyXG4gIGF3YWl0IGNvbW1pdE1hdHJpeEdyaWQoe1xuICAgIGFwcFNlc3Npb25JZCxcbiAgICBtYXRyaXhUeXBlOiBcImlkX3BjdFwiLFxuICAgIHRzTXMsXG4gICAgY29pbnMsXG4gICAgaWRlbTogYCR7aWRlbVByZWZpeCA/PyBcImlkX3BjdFwifToke3RzTXN9YFxuICB9KTtcbn1cblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICAgICAgICAgICAgICAgICAgQ0xJIHV0aWxpdGllcyAoZm9ybWVyIGRiLm10cykgICAgICAgICAgICAgICAgICAgICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxudHlwZSBTdGVwID0geyBuYW1lOiBzdHJpbmc7IGZpbGVzOiBzdHJpbmdbXSB9O1xuXG5jb25zdCBCQVNFX1NURVA6IFN0ZXAgPSB7XG4gIG5hbWU6IFwiQkFTRSBERExzXCIsXG4gIGZpbGVzOiBbXG4gICAgXCIwMF9leHRlbnNpb25zLnNxbFwiLFxuICAgIFwiMDFfc2V0dGluZ3Muc3FsXCIsXG4gICAgXCIwMl9tYXJrZXQuc3FsXCIsXG4gICAgXCIwM19kb2NzLnNxbFwiLFxuICAgIFwiMDRfbWF0cmljZXMuc3FsXCIsXG4gICAgXCIwNV9zdHJfYXV4LnNxbFwiLFxuICAgIFwiMDZfY2luX2F1eF9jb3JlLnNxbFwiLFxuICAgIFwiMDdfY2luX2F1eF9ydW50aW1lLnNxbFwiLFxuICAgIFwiMDhfY2luX2F1eF9mdW5jdGlvbnMuc3FsXCIsXG4gICAgXCIwOV9vcHMuc3FsXCIsXG4gICAgXCIwOV9pbmdlc3Quc3FsXCIsXG4gICAgXCIxMF9oZWxwZXJzLnNxbFwiLFxuICAgIFwiMTFfdmlld3NfbGF0ZXN0LnNxbFwiLFxuICBdLFxufTtcblxuY29uc3QgUEFUQ0hfU1RFUDogU3RlcCA9IHtcbiAgbmFtZTogXCJQQVRDSCBTRVQgdjFcIixcbiAgZmlsZXM6IFtcbiAgICBcIjAxX3NldHRpbmdzX3BhdGNoZXMuc3FsXCIsXG4gICAgXCIwMl9tYXJrZXRfcGF0Y2hlcy5zcWxcIixcbiAgICBcIjAzX2RvY3NfcGF0Y2hlcy5zcWxcIixcbiAgICBcIjA0X21hdHJpY2VzX3BhdGNoZXMuc3FsXCIsXG4gICAgXCIwNV9zdHJfYXV4X3BhdGNoZXMuc3FsXCIsXG4gICAgXCIwNl9jaW5fYXV4X2NvcmVfcGF0Y2hlcy5zcWxcIixcbiAgICBcIjA3X2Npbl9hdXhfcnVudGltZV9wYXRjaGVzLnNxbFwiLFxuICAgIFwiMDhfY2luX2F1eF9mdW5jdGlvbnNfcGF0Y2hlcy5zcWxcIixcbiAgICBcIjA5X21lYV9keW5hbWljc19wYXRjaGVzLnNxbFwiLFxuICAgIFwiMTBfb3BzX3BhdGNoZXMuc3FsXCIsXG4gICAgXCIxMV9yZW1vdmVfYm9vdHN0cmFwLnNxbFwiLFxuICBdLFxufTtcblxuY29uc3QgU0VFRF9TVEVQOiBTdGVwID0geyBuYW1lOiBcIlNFRURTXCIsIGZpbGVzOiBbXCIwMV9zZWVkLnNxbFwiLCBcIjAyX3NlZWRfam9icy5zcWxcIl0gfTtcbmNvbnN0IFZFUklGWV9TVEVQOiBTdGVwID0geyBuYW1lOiBcIlZFUklGWVwiLCBmaWxlczogW1wiMDNfdmVyaWZ5LnNxbFwiXSB9O1xuXG5hc3luYyBmdW5jdGlvbiBzcGF3bkNvbW1hbmQoY21kOiBzdHJpbmcsIGFyZ3M6IHN0cmluZ1tdLCBlbnY/OiBOb2RlSlMuUHJvY2Vzc0Vudikge1xuICBjb25zdCB7IHNwYXduIH0gPSBhd2FpdCBpbXBvcnQoXCJub2RlOmNoaWxkX3Byb2Nlc3NcIik7XG4gIHJldHVybiBuZXcgUHJvbWlzZTx2b2lkPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgY29uc3QgY2hpbGQgPSBzcGF3bihjbWQsIGFyZ3MsIHsgc3RkaW86IFwiaW5oZXJpdFwiLCBlbnYgfSk7XG4gICAgY2hpbGQub24oXCJlcnJvclwiLCByZWplY3QpO1xuICAgIGNoaWxkLm9uKFwiZXhpdFwiLCAoY29kZSkgPT4gKGNvZGUgPT09IDAgPyByZXNvbHZlKCkgOiByZWplY3QobmV3IEVycm9yKGAke2NtZH0gZXhpdGVkIHdpdGggJHtjb2RlfWApKSkpO1xuICB9KTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJ1bkRiVG9vbChcbiAgYXJndjogc3RyaW5nW10gPSB0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIiA/IHByb2Nlc3MuYXJndi5zbGljZSgyKSA6IFtdLFxuICBvcHRzOiB7IHJvb3Q/OiBzdHJpbmcgfSA9IHt9LFxuKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IFt7IHJlc29sdmUsIGpvaW4gfSwgZnMsIGRvdGVudl0gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgaW1wb3J0KFwibm9kZTpwYXRoXCIpLFxuICAgIGltcG9ydChcIm5vZGU6ZnNcIiksXG4gICAgaW1wb3J0KFwiZG90ZW52XCIpLFxuICBdKTtcblxuICBjb25zdCBST09UID0gcmVzb2x2ZShwcm9jZXNzLmN3ZCgpLCBvcHRzLnJvb3QgPz8gXCJkYlwiKTtcbiAgY29uc3QgRU5WX0ZJTEUgPSBqb2luKFJPT1QsIFwiLmVudi5kYlwiKTtcbiAgaWYgKGZzLmV4aXN0c1N5bmMoRU5WX0ZJTEUpKSB7XG4gICAgZG90ZW52LmNvbmZpZyh7IHBhdGg6IEVOVl9GSUxFIH0pO1xuICB9XG5cbiAgY29uc3QgcGcgPSB7XG4gICAgaG9zdDogcHJvY2Vzcy5lbnYuUEdIT1NUID8/IFwibG9jYWxob3N0XCIsXG4gICAgcG9ydDogU3RyaW5nKHByb2Nlc3MuZW52LlBHUE9SVCA/PyBcIjU0MzJcIiksXG4gICAgZGI6IHByb2Nlc3MuZW52LlBHREFUQUJBU0UgPz8gXCJwb3N0Z3Jlc1wiLFxuICAgIHVzZXI6IHByb2Nlc3MuZW52LlBHVVNFUiA/PyBcInBvc3RncmVzXCIsXG4gICAgcGFzczogcHJvY2Vzcy5lbnYuUEdQQVNTV09SRCA/PyBcIlwiLFxuICB9O1xuXG4gIGNvbnN0IGZpbGVFeGlzdHMgPSAoZmlsZTogc3RyaW5nKSA9PiBmcy5leGlzdHNTeW5jKGpvaW4oUk9PVCwgZmlsZSkpO1xuXG4gIGFzeW5jIGZ1bmN0aW9uIGVuc3VyZVBzcWwoKSB7XG4gICAgYXdhaXQgc3Bhd25Db21tYW5kKFwicHNxbFwiLCBbXCItLXZlcnNpb25cIl0pO1xuICB9XG5cbiAgYXN5bmMgZnVuY3Rpb24gZXhlY1NxbChmaWxlOiBzdHJpbmcpIHtcbiAgICBpZiAoIWZpbGVFeGlzdHMoZmlsZSkpIHJldHVybjtcbiAgICBjb25zdCBmdWxsID0gam9pbihST09ULCBmaWxlKTtcbiAgICBhd2FpdCBzcGF3bkNvbW1hbmQoXG4gICAgICBcInBzcWxcIixcbiAgICAgIFtcbiAgICAgICAgXCItWFwiLFxuICAgICAgICBcIi12XCIsXG4gICAgICAgIFwiT05fRVJST1JfU1RPUD0xXCIsXG4gICAgICAgIFwiLWhcIixcbiAgICAgICAgcGcuaG9zdCxcbiAgICAgICAgXCItcFwiLFxuICAgICAgICBwZy5wb3J0LFxuICAgICAgICBcIi1VXCIsXG4gICAgICAgIHBnLnVzZXIsXG4gICAgICAgIFwiLWRcIixcbiAgICAgICAgcGcuZGIsXG4gICAgICAgIFwiLWZcIixcbiAgICAgICAgZnVsbCxcbiAgICAgIF0sXG4gICAgICB7IC4uLnByb2Nlc3MuZW52LCBQR1BBU1NXT1JEOiBwZy5wYXNzIH0sXG4gICAgKTtcbiAgfVxuXG4gIGFzeW5jIGZ1bmN0aW9uIHJ1blN0ZXAoc3RlcDogU3RlcCkge1xuICAgIGNvbnNvbGUubG9nKGBcXG49PT0gJHtzdGVwLm5hbWV9ID09PWApO1xuICAgIGZvciAoY29uc3QgZmlsZSBvZiBzdGVwLmZpbGVzKSB7XG4gICAgICBpZiAoIWZpbGVFeGlzdHMoZmlsZSkpIGNvbnRpbnVlO1xuICAgICAgY29uc29sZS5sb2coYC0+ICR7ZmlsZX1gKTtcbiAgICAgIGF3YWl0IGV4ZWNTcWwoZmlsZSk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZnVuY3Rpb24gZW5zdXJlRGIoKSB7XG4gICAgY29uc3Qgc3FsID0gYERPICQkXG4gICAgIEJFR0lOXG4gICAgICAgSUYgTk9UIEVYSVNUUyAoU0VMRUNUIDEgRlJPTSBwZ19kYXRhYmFzZSBXSEVSRSBkYXRuYW1lID0gJyR7cGcuZGJ9JykgVEhFTlxuICAgICAgICAgRVhFQ1VURSAnQ1JFQVRFIERBVEFCQVNFICR7cGcuZGJ9JztcbiAgICAgICBFTkQgSUY7XG4gICAgIEVORCQkO2A7XG4gICAgYXdhaXQgc3Bhd25Db21tYW5kKFxuICAgICAgXCJwc3FsXCIsXG4gICAgICBbXG4gICAgICAgIFwiLVhcIixcbiAgICAgICAgXCItdlwiLFxuICAgICAgICBcIk9OX0VSUk9SX1NUT1A9MVwiLFxuICAgICAgICBcIi1oXCIsXG4gICAgICAgIHBnLmhvc3QsXG4gICAgICAgIFwiLXBcIixcbiAgICAgICAgcGcucG9ydCxcbiAgICAgICAgXCItVVwiLFxuICAgICAgICBwZy51c2VyLFxuICAgICAgICBcIi1kXCIsXG4gICAgICAgIFwicG9zdGdyZXNcIixcbiAgICAgICAgXCItY1wiLFxuICAgICAgICBzcWwsXG4gICAgICBdLFxuICAgICAgeyAuLi5wcm9jZXNzLmVudiwgUEdQQVNTV09SRDogcGcucGFzcyB9LFxuICAgICk7XG4gIH1cblxuICBmdW5jdGlvbiB1c2FnZSgpIHtcbiAgICBjb25zb2xlLmxvZyhgXG5Vc2FnZTpcbiAgcG5wbSBkYjphcHBseSAgICAgIyBiYXNlIERETHMgKyBwYXRjaGVzXG4gIHBucG0gZGI6c2VlZCAgICAgICMgc2VlZHMgKHVuaXZlcnNlL3RpbWluZy9zZXNzaW9uL2pvYnMpXG4gIHBucG0gZGI6dmVyaWZ5ICAgICMgcXVpY2sgY2hlY2tzXG4gIHBucG0gZGI6YWxsICAgICAgICMgZW5zdXJlIERCLCBhcHBseSwgc2VlZCwgdmVyaWZ5XG4gIHBucG0gZGI6cHNxbCAgICAgICMgb3BlbiBpbnRlcmFjdGl2ZSBwc3FsIHRvIFBHREFUQUJBU0VcblxuRU5WOiByZWFkIGZyb20gZGIvLmVudi5kYiAoUEdIT1NULCBQR1BPUlQsIFBHREFUQUJBU0UsIFBHVVNFUiwgUEdQQVNTV09SRClcbmAudHJpbSgpKTtcbiAgfVxuXG4gIGNvbnN0IFtjbWQgPSBcIlwiXSA9IGFyZ3Y7XG4gIGF3YWl0IGVuc3VyZVBzcWwoKTtcblxuICBpZiAoY21kID09PSBcImFwcGx5XCIpIHtcbiAgICBhd2FpdCBydW5TdGVwKEJBU0VfU1RFUCk7XG4gICAgYXdhaXQgcnVuU3RlcChQQVRDSF9TVEVQKTtcbiAgICBjb25zb2xlLmxvZyhcIltva10gYXBwbHkgY29tcGxldGVcIik7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKGNtZCA9PT0gXCJzZWVkXCIpIHtcbiAgICBhd2FpdCBydW5TdGVwKFNFRURfU1RFUCk7XG4gICAgY29uc29sZS5sb2coXCJbb2tdIHNlZWQgY29tcGxldGVcIik7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKGNtZCA9PT0gXCJ2ZXJpZnlcIikge1xuICAgIGF3YWl0IHJ1blN0ZXAoVkVSSUZZX1NURVApO1xuICAgIGNvbnNvbGUubG9nKFwiW29rXSB2ZXJpZnkgY29tcGxldGVcIik7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKGNtZCA9PT0gXCJhbGxcIikge1xuICAgIGF3YWl0IGVuc3VyZURiKCk7XG4gICAgYXdhaXQgcnVuU3RlcChCQVNFX1NURVApO1xuICAgIGF3YWl0IHJ1blN0ZXAoUEFUQ0hfU1RFUCk7XG4gICAgYXdhaXQgcnVuU3RlcChTRUVEX1NURVApO1xuICAgIGF3YWl0IHJ1blN0ZXAoVkVSSUZZX1NURVApO1xuICAgIGNvbnNvbGUubG9nKFwiW29rXSBhbGwgZG9uZVwiKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoY21kID09PSBcInBzcWxcIikge1xuICAgIGF3YWl0IHNwYXduQ29tbWFuZChcbiAgICAgIFwicHNxbFwiLFxuICAgICAgW1wiLWhcIiwgcGcuaG9zdCwgXCItcFwiLCBwZy5wb3J0LCBcIi1VXCIsIHBnLnVzZXIsIFwiLWRcIiwgcGcuZGJdLFxuICAgICAgeyAuLi5wcm9jZXNzLmVudiwgUEdQQVNTV09SRDogcGcucGFzcyB9LFxuICAgICk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdXNhZ2UoKTtcbiAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIGRiIGNvbW1hbmQgXCIke2NtZH1cImApO1xufVxuXG5hc3luYyBmdW5jdGlvbiBtYXliZVJ1bkRiVG9vbEZyb21DbGkoKSB7XG4gIGlmICh0eXBlb2YgcHJvY2VzcyA9PT0gXCJ1bmRlZmluZWRcIiB8fCAhcHJvY2Vzcy5hcmd2Py5bMV0pIHJldHVybjtcbiAgdHJ5IHtcbiAgICBjb25zdCB7IHBhdGhUb0ZpbGVVUkwgfSA9IGF3YWl0IGltcG9ydChcIm5vZGU6dXJsXCIpO1xuICAgIGlmIChpbXBvcnQubWV0YS51cmwgIT09IHBhdGhUb0ZpbGVVUkwocHJvY2Vzcy5hcmd2WzFdISkuaHJlZikgcmV0dXJuO1xuICB9IGNhdGNoIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB0cnkge1xuICAgIGF3YWl0IHJ1bkRiVG9vbChwcm9jZXNzLmFyZ3Yuc2xpY2UoMikpO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgcHJvY2Vzcy5leGl0Q29kZSA9IDE7XG4gIH1cbn1cblxudm9pZCBtYXliZVJ1bkRiVG9vbEZyb21DbGkoKTtcbiJdLCJuYW1lcyI6WyJkYiIsImdldFBvb2wiLCJxdWVyeSIsIndpdGhDbGllbnQiLCJSQVdfVEFCTEUiLCJwcm9jZXNzIiwiZW52IiwiTUFUUklYX1RBQkxFIiwiYXNJZGVudCIsIm5hbWUiLCJwYXJ0cyIsIlN0cmluZyIsInNwbGl0IiwiZmlsdGVyIiwiQm9vbGVhbiIsImxlbmd0aCIsIkVycm9yIiwibWFwIiwicGFydCIsInRlc3QiLCJqb2luIiwiVEFCTEUiLCJSQVdfU1RBR0VfVEFCTEUiLCJNQVRSSVhfU1RBR0VfVEFCTEUiLCJSQVdfQ09NTUlUX1RBQkxFIiwiTUFUUklYX0NPTU1JVF9UQUJMRSIsIlNUQUdFX1RBQkxFX0NBTkRJREFURVMiLCJBcnJheSIsImZyb20iLCJTZXQiLCJNQVRSSVhfVEFCTEVfQ0FORElEQVRFUyIsInNwbGl0UXVhbGlmaWVkTmFtZSIsInNjaGVtYSIsInJlbGF0aW9uIiwicG9wIiwiZW5zdXJlTWF0cml4VGFibGVzIiwiY2xpZW50IiwiZmluZEV4aXN0aW5nVGFibGUiLCJjYW5kaWRhdGVzIiwicmF3Iiwicm93cyIsImtpbmQiLCJpZGVudCIsImNhY2hlZFN0YWdlSW5mbyIsImNhY2hlZE1hdHJpeEluZm8iLCJlbnN1cmVTdGFnZUluZm8iLCJpbmZvIiwiZW5zdXJlTWF0cml4SW5mbyIsImRlZHVwZVVwcGVyIiwieHMiLCJvdXQiLCJzZWVuIiwieCIsInVwIiwidHJpbSIsInRvVXBwZXJDYXNlIiwiaGFzIiwiYWRkIiwicHVzaCIsImdldE1hdHJpeFN0YWdlVGFibGVJZGVudCIsInVzZUNsaWVudCIsImNvbm5lY3QiLCJyZWxlYXNlIiwiZ2V0TWF0cml4VmFsdWVzVGFibGVJZGVudCIsInVwc2VydE1hdHJpeFJvd3MiLCJ2YWx1ZXMiLCJjaHVua3MiLCJyIiwiaSIsImoiLCJ0c19tcyIsIm1hdHJpeF90eXBlIiwiYmFzZSIsInF1b3RlIiwidmFsdWUiLCJKU09OIiwic3RyaW5naWZ5IiwibWV0YSIsInNxbCIsImdldExhdGVzdEJ5VHlwZSIsImNvaW5zIiwiTnVtYmVyIiwidmFscyIsImdldFByZXZWYWx1ZSIsImJlZm9yZVRzIiwiZ2V0TGF0ZXN0VHNGb3JUeXBlIiwidiIsImdldE5lYXJlc3RUc0F0T3JCZWZvcmUiLCJnZXRTbmFwc2hvdEJ5VHlwZSIsImdldFByZXZTbmFwc2hvdEJ5VHlwZSIsImNvdW50Um93c0F0IiwibiIsIm9wZW5pbmdDYWNoZSIsIk1hcCIsImtleVN0ciIsImsiLCJ3aW5kb3ciLCJhcHBTZXNzaW9uSWQiLCJnZXRPcGVuaW5nRnJvbURiIiwicTEiLCJyMSIsInByaWNlIiwidHMiLCJxMiIsInIyIiwiZW5zdXJlT3BlbmluZyIsIm9wdHMiLCJjayIsImhpdCIsImdldCIsIm9wZW5pbmdQcmljZSIsIm9wZW5pbmdUcyIsInJvdyIsInNldCIsImNsZWFyT3BlbmluZ0NhY2hlIiwiY2xlYXIiLCJkZWxldGUiLCJjZWxsc09mIiwiYiIsInEiLCJpc05hTiIsInN0YWdlTWF0cml4R3JpZCIsIm1hdHJpeFR5cGUiLCJ0c01zIiwiZXh0ZXJuYWwiLCJvayIsInN0YWdlZCIsIm1ldGFKc29uIiwic3RhZ2VJbmZvIiwidGV4dCIsIl8iLCJwYXJhbXMiLCJjb21taXRNYXRyaXhHcmlkIiwibWFuYWdlVHgiLCJtYXRyaXhUYWJsZSIsInN0YWdlUm93cyIsInN0YWdlZENlbGxzIiwicm93Q291bnQiLCJjb2luc0Zyb21TdGFnZSIsImVsaWdpYmxlQ29pbnMiLCJleHBlY3RlZENlbGxzIiwiTWF0aCIsIm1heCIsInN0YWdlZFBhaXJzIiwibWlzc2luZ0NvdW50IiwiZXhwZWN0ZWRfY2VsbHMiLCJzdGFnZWRfY2VsbHMiLCJtaXNzaW5nX2NvdW50IiwiY29tcGxldGUiLCJlcnIiLCJtYXBQcmV2QmVuY2htYXJrIiwicHJldiIsIm0iLCJwZXJzaXN0TGl2ZU1hdHJpY2VzU2xpY2UiLCJiZW5jaG1hcmsiLCJwY3QyNGgiLCJpZGVtUHJlZml4Iiwic291cmNlIiwiaWRlbSIsInByZXZNYXAiLCJpZE9iaiIsIm5vdyIsImFicyIsIkJBU0VfU1RFUCIsImZpbGVzIiwiUEFUQ0hfU1RFUCIsIlNFRURfU1RFUCIsIlZFUklGWV9TVEVQIiwic3Bhd25Db21tYW5kIiwiY21kIiwiYXJncyIsInNwYXduIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJjaGlsZCIsInN0ZGlvIiwib24iLCJjb2RlIiwicnVuRGJUb29sIiwiYXJndiIsInNsaWNlIiwiZnMiLCJkb3RlbnYiLCJhbGwiLCJST09UIiwiY3dkIiwicm9vdCIsIkVOVl9GSUxFIiwiZXhpc3RzU3luYyIsImNvbmZpZyIsInBhdGgiLCJwZyIsImhvc3QiLCJQR0hPU1QiLCJwb3J0IiwiUEdQT1JUIiwiUEdEQVRBQkFTRSIsInVzZXIiLCJQR1VTRVIiLCJwYXNzIiwiUEdQQVNTV09SRCIsImZpbGVFeGlzdHMiLCJmaWxlIiwiZW5zdXJlUHNxbCIsImV4ZWNTcWwiLCJmdWxsIiwicnVuU3RlcCIsInN0ZXAiLCJjb25zb2xlIiwibG9nIiwiZW5zdXJlRGIiLCJ1c2FnZSIsIm1heWJlUnVuRGJUb29sRnJvbUNsaSIsInBhdGhUb0ZpbGVVUkwiLCJ1cmwiLCJocmVmIiwiZXJyb3IiLCJleGl0Q29kZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/core/db/db.ts\n");

/***/ }),

/***/ "(rsc)/./src/core/db/pool_server.ts":
/*!************************************!*\
  !*** ./src/core/db/pool_server.ts ***!
  \************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DEFAULT_SEARCH_PATH: () => (/* binding */ DEFAULT_SEARCH_PATH),\n/* harmony export */   TABLES: () => (/* binding */ TABLES),\n/* harmony export */   appendAppLedger: () => (/* binding */ appendAppLedger),\n/* harmony export */   appendTransferLedger: () => (/* binding */ appendTransferLedger),\n/* harmony export */   db: () => (/* binding */ db),\n/* harmony export */   getAppLedgerSince: () => (/* binding */ getAppLedgerSince),\n/* harmony export */   getDb: () => (/* binding */ getDb),\n/* harmony export */   getPool: () => (/* binding */ getPool),\n/* harmony export */   listTransferLegs: () => (/* binding */ listTransferLegs),\n/* harmony export */   query: () => (/* binding */ query),\n/* harmony export */   serverDb: () => (/* binding */ serverDb),\n/* harmony export */   withClient: () => (/* binding */ withClient)\n/* harmony export */ });\n/* harmony import */ var pg__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pg */ \"pg\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([pg__WEBPACK_IMPORTED_MODULE_0__]);\npg__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n/**\n * Unified PG pool + convenience helpers + lightweight ledgers.\n * This replaces the old pool/server/ledger trio with a single source of truth.\n */ /*  Environment helpers  */ function asBool(v, fallback = false) {\n    if (v == null) return fallback;\n    const s = String(v).trim().toLowerCase();\n    return s === \"1\" || s === \"true\" || s === \"yes\" || s === \"on\";\n}\n/*  Pool configuration  */ const useUrl = !!process.env.DATABASE_URL;\nconst baseConfig = useUrl ? {\n    connectionString: String(process.env.DATABASE_URL)\n} : {\n    host: String(process.env.PGHOST ?? \"localhost\"),\n    port: Number(process.env.PGPORT ?? 1026),\n    user: String(process.env.PGUSER ?? \"postgres\"),\n    password: String(process.env.PGPASSWORD ?? \"gus\"),\n    database: String(process.env.PGDATABASE ?? \"cryptopie\")\n};\nconst poolConfig = {\n    ...baseConfig,\n    max: Number(process.env.DB_POOL_MAX ?? process.env.PGPOOL_MAX ?? 10),\n    idleTimeoutMillis: Number(process.env.DB_IDLE_MS ?? 45000),\n    connectionTimeoutMillis: Number(process.env.DB_CONN_TIMEOUT_MS ?? 5000),\n    ssl: asBool(process.env.DB_SSL ?? process.env.PGSSL) ? {\n        rejectUnauthorized: false\n    } : undefined\n};\nconst SESSION_STATEMENT_TIMEOUT = Number(process.env.DB_STATEMENT_TIMEOUT_MS ?? 15000);\nconst SESSION_IDLE_TX_TIMEOUT = Number(process.env.DB_IDLE_TX_TIMEOUT_MS ?? 15000);\nconst SESSION_TZ = String(process.env.DB_TIMEZONE ?? \"UTC\").replace(/'/g, \"''\");\nconst DEFAULT_SEARCH_PATH = [\n    \"settings\",\n    \"market\",\n    \"docs\",\n    \"matrices\",\n    \"str_aux\",\n    \"cin_aux\",\n    \"mea_dynamics\",\n    \"ingest\",\n    \"ops\",\n    \"public\"\n].join(\", \");\nfunction ensurePool() {\n    if (!global.__core_pg_pool__) {\n        const pool = new pg__WEBPACK_IMPORTED_MODULE_0__.Pool(poolConfig);\n        pool.on(\"connect\", (client)=>{\n            const bootstrap = [\n                `SET statement_timeout = ${SESSION_STATEMENT_TIMEOUT}`,\n                `SET idle_in_transaction_session_timeout = ${SESSION_IDLE_TX_TIMEOUT}`,\n                `SET TIME ZONE '${SESSION_TZ}'`,\n                `SET search_path = ${DEFAULT_SEARCH_PATH}`\n            ];\n            for (const statement of bootstrap){\n                void client.query(statement).catch(()=>{\n                /* ignore bootstrap failures so the pool stays usable */ });\n            }\n        });\n        global.__core_pg_pool__ = pool;\n    }\n    return global.__core_pg_pool__;\n}\nfunction getPool() {\n    return ensurePool();\n}\nfunction getDb() {\n    return ensurePool();\n}\n/*  Query helpers  */ async function withClient(fn) {\n    const client = await ensurePool().connect();\n    try {\n        return await fn(client);\n    } finally{\n        client.release();\n    }\n}\nasync function query(text, params) {\n    return ensurePool().query(text, params);\n}\nconst db = ensurePool();\nconst serverDb = {\n    query (text, params) {\n        return ensurePool().query(text, params);\n    }\n};\n/*  Table constants  */ const TABLES = {\n    matrices: process.env.MATRIX_TABLE || \"matrices.dyn_values\",\n    matricesStage: process.env.MATRIX_STAGE_TABLE || \"matrices.dyn_values_stage\",\n    ledger: process.env.APP_LEDGER_TABLE || \"ops.app_ledger\",\n    transfers: process.env.TRANSFER_LEDGER_TABLE || \"ops.transfer_ledger\"\n};\n/** Safe insert; ignores missing table or duplicate key. */ async function appendAppLedger(e) {\n    const sql = `\n    INSERT INTO ${TABLES.ledger}\n      (topic, event, payload, session_id, idempotency_key, ts_epoch_ms)\n    VALUES ($1,$2,$3,$4,$5,$6)\n    ON CONFLICT (idempotency_key) DO NOTHING\n  `;\n    try {\n        await query(sql, [\n            e.topic,\n            e.event,\n            e.payload ?? null,\n            e.session_id ?? null,\n            e.idempotency_key ?? null,\n            e.ts_epoch_ms\n        ]);\n    } catch (err) {\n        if (err?.code === \"42P01\") {\n            console.warn(\"appendAppLedger: ledger table missing (ops.app_ledger). Skipping log.\");\n            return;\n        }\n        throw err;\n    }\n}\nasync function getAppLedgerSince(sinceMs, topic) {\n    try {\n        const { rows } = await query(`SELECT * FROM ${TABLES.ledger}\n        WHERE ts_epoch_ms >= $1\n          AND ($2::text IS NULL OR topic = $2)\n     ORDER BY ts_epoch_ms ASC`, [\n            sinceMs,\n            topic ?? null\n        ]);\n        return rows;\n    } catch (err) {\n        if (err?.code === \"42P01\") {\n            console.warn(\"getAppLedgerSince: ledger table missing (ops.app_ledger).\");\n            return [];\n        }\n        throw err;\n    }\n}\n/*  Transfer ledger helpers  */ async function appendTransferLedger(row) {\n    const q = `\n    INSERT INTO ${TABLES.transfers} (\n      app_session_id, cycle_ts, leg_seq, route_id, intent_id,\n      from_symbol, to_symbol, qty_from, qty_to,\n      price_from_usdt, price_to_usdt, fee_usdt, exec_ts, tx_id\n    )\n    VALUES (\n      $1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,COALESCE($12,0),$13,$14\n    )\n    ON CONFLICT (app_session_id, cycle_ts, leg_seq) DO NOTHING\n  `;\n    try {\n        await query(q, [\n            row.app_session_id,\n            row.cycle_ts,\n            row.leg_seq,\n            row.route_id ?? null,\n            row.intent_id ?? null,\n            row.from_symbol,\n            row.to_symbol,\n            row.qty_from,\n            row.qty_to,\n            row.price_from_usdt,\n            row.price_to_usdt,\n            row.fee_usdt ?? 0,\n            row.exec_ts,\n            row.tx_id ?? null\n        ]);\n    } catch (err) {\n        if (err?.code === \"42P01\") {\n            console.warn(\"appendTransferLedger: transfer_ledger table missing (ops.transfer_ledger).\");\n            return;\n        }\n        throw err;\n    }\n}\nasync function listTransferLegs(app_session_id, opts) {\n    const { rows } = await query(`SELECT * FROM ${TABLES.transfers}\n      WHERE app_session_id = $1\n        AND ($2::bigint IS NULL OR cycle_ts < $2)\n   ORDER BY cycle_ts DESC, leg_seq DESC\n      LIMIT $3`, [\n        app_session_id,\n        opts?.before ?? null,\n        opts?.limit ?? 200\n    ]);\n    return rows;\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixDQUFDLEVBQ1g7UUFBQ3FCO1FBQWdCZSxNQUFNQyxVQUFVO1FBQU1ELE1BQU1FLFNBQVM7S0FBSTtJQUU1RCxPQUFPckI7QUFDVCIsInNvdXJjZXMiOlsiSDpcXFVzZXJzXFxHdXNcXHNvdXJjZVxccmVwb1xcZHluYW1pY3NcXGR5bmFtaWNzLWJcXGNyeXB0b3BpLWR5bmFtaWNzXFxzcmNcXGNvcmVcXGRiXFxwb29sX3NlcnZlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQb29sLCB0eXBlIFBvb2xDbGllbnQsIHR5cGUgUXVlcnlSZXN1bHQsIHR5cGUgUXVlcnlSZXN1bHRSb3cgfSBmcm9tIFwicGdcIjtcblxuLyoqXG4gKiBVbmlmaWVkIFBHIHBvb2wgKyBjb252ZW5pZW5jZSBoZWxwZXJzICsgbGlnaHR3ZWlnaHQgbGVkZ2Vycy5cbiAqIFRoaXMgcmVwbGFjZXMgdGhlIG9sZCBwb29sL3NlcnZlci9sZWRnZXIgdHJpbyB3aXRoIGEgc2luZ2xlIHNvdXJjZSBvZiB0cnV0aC5cbiAqL1xuXG4vKiDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAgRW52aXJvbm1lbnQgaGVscGVycyDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAgKi9cbmZ1bmN0aW9uIGFzQm9vbCh2OiB1bmtub3duLCBmYWxsYmFjayA9IGZhbHNlKTogYm9vbGVhbiB7XG4gIGlmICh2ID09IG51bGwpIHJldHVybiBmYWxsYmFjaztcbiAgY29uc3QgcyA9IFN0cmluZyh2KS50cmltKCkudG9Mb3dlckNhc2UoKTtcbiAgcmV0dXJuIHMgPT09IFwiMVwiIHx8IHMgPT09IFwidHJ1ZVwiIHx8IHMgPT09IFwieWVzXCIgfHwgcyA9PT0gXCJvblwiO1xufVxuXG4vKiDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAgUG9vbCBjb25maWd1cmF0aW9uIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCAqL1xuY29uc3QgdXNlVXJsID0gISFwcm9jZXNzLmVudi5EQVRBQkFTRV9VUkw7XG5jb25zdCBiYXNlQ29uZmlnID0gdXNlVXJsXG4gID8geyBjb25uZWN0aW9uU3RyaW5nOiBTdHJpbmcocHJvY2Vzcy5lbnYuREFUQUJBU0VfVVJMKSB9XG4gIDoge1xuICAgICAgaG9zdDogU3RyaW5nKHByb2Nlc3MuZW52LlBHSE9TVCA/PyBcImxvY2FsaG9zdFwiKSxcbiAgICAgIHBvcnQ6IE51bWJlcihwcm9jZXNzLmVudi5QR1BPUlQgPz8gMTAyNiksXG4gICAgICB1c2VyOiBTdHJpbmcocHJvY2Vzcy5lbnYuUEdVU0VSID8/IFwicG9zdGdyZXNcIiksXG4gICAgICBwYXNzd29yZDogU3RyaW5nKHByb2Nlc3MuZW52LlBHUEFTU1dPUkQgPz8gXCJndXNcIiksXG4gICAgICBkYXRhYmFzZTogU3RyaW5nKHByb2Nlc3MuZW52LlBHREFUQUJBU0UgPz8gXCJjcnlwdG9waWVcIiksXG4gICAgfTtcblxuY29uc3QgcG9vbENvbmZpZyA9IHtcbiAgLi4uYmFzZUNvbmZpZyxcbiAgbWF4OiBOdW1iZXIocHJvY2Vzcy5lbnYuREJfUE9PTF9NQVggPz8gcHJvY2Vzcy5lbnYuUEdQT09MX01BWCA/PyAxMCksXG4gIGlkbGVUaW1lb3V0TWlsbGlzOiBOdW1iZXIocHJvY2Vzcy5lbnYuREJfSURMRV9NUyA/PyA0NV8wMDApLFxuICBjb25uZWN0aW9uVGltZW91dE1pbGxpczogTnVtYmVyKHByb2Nlc3MuZW52LkRCX0NPTk5fVElNRU9VVF9NUyA/PyA1XzAwMCksXG4gIHNzbDogYXNCb29sKHByb2Nlc3MuZW52LkRCX1NTTCA/PyBwcm9jZXNzLmVudi5QR1NTTClcbiAgICA/IHsgcmVqZWN0VW5hdXRob3JpemVkOiBmYWxzZSBhcyBjb25zdCB9XG4gICAgOiB1bmRlZmluZWQsXG59O1xuXG5jb25zdCBTRVNTSU9OX1NUQVRFTUVOVF9USU1FT1VUID0gTnVtYmVyKHByb2Nlc3MuZW52LkRCX1NUQVRFTUVOVF9USU1FT1VUX01TID8/IDE1XzAwMCk7XG5jb25zdCBTRVNTSU9OX0lETEVfVFhfVElNRU9VVCA9IE51bWJlcihwcm9jZXNzLmVudi5EQl9JRExFX1RYX1RJTUVPVVRfTVMgPz8gMTVfMDAwKTtcbmNvbnN0IFNFU1NJT05fVFogPSBTdHJpbmcocHJvY2Vzcy5lbnYuREJfVElNRVpPTkUgPz8gXCJVVENcIikucmVwbGFjZSgvJy9nLCBcIicnXCIpO1xuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VBUkNIX1BBVEggPSBbXG4gIFwic2V0dGluZ3NcIixcbiAgXCJtYXJrZXRcIixcbiAgXCJkb2NzXCIsXG4gIFwibWF0cmljZXNcIixcbiAgXCJzdHJfYXV4XCIsXG4gIFwiY2luX2F1eFwiLFxuICBcIm1lYV9keW5hbWljc1wiLFxuICBcImluZ2VzdFwiLFxuICBcIm9wc1wiLFxuICBcInB1YmxpY1wiLFxuXS5qb2luKFwiLCBcIik7XG5cbi8qIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCBQb29sIHNpbmdsZXRvbiDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAgKi9cbmRlY2xhcmUgZ2xvYmFsIHtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXZhclxuICB2YXIgX19jb3JlX3BnX3Bvb2xfXzogUG9vbCB8IHVuZGVmaW5lZDtcbn1cblxuZnVuY3Rpb24gZW5zdXJlUG9vbCgpOiBQb29sIHtcbiAgaWYgKCFnbG9iYWwuX19jb3JlX3BnX3Bvb2xfXykge1xuICAgIGNvbnN0IHBvb2wgPSBuZXcgUG9vbChwb29sQ29uZmlnIGFzIGFueSk7XG4gICAgcG9vbC5vbihcImNvbm5lY3RcIiwgKGNsaWVudDogUG9vbENsaWVudCkgPT4ge1xuICAgICAgY29uc3QgYm9vdHN0cmFwID0gW1xuICAgICAgICBgU0VUIHN0YXRlbWVudF90aW1lb3V0ID0gJHtTRVNTSU9OX1NUQVRFTUVOVF9USU1FT1VUfWAsXG4gICAgICAgIGBTRVQgaWRsZV9pbl90cmFuc2FjdGlvbl9zZXNzaW9uX3RpbWVvdXQgPSAke1NFU1NJT05fSURMRV9UWF9USU1FT1VUfWAsXG4gICAgICAgIGBTRVQgVElNRSBaT05FICcke1NFU1NJT05fVFp9J2AsXG4gICAgICAgIGBTRVQgc2VhcmNoX3BhdGggPSAke0RFRkFVTFRfU0VBUkNIX1BBVEh9YCxcbiAgICAgIF07XG4gICAgICBmb3IgKGNvbnN0IHN0YXRlbWVudCBvZiBib290c3RyYXApIHtcbiAgICAgICAgdm9pZCBjbGllbnQucXVlcnkoc3RhdGVtZW50KS5jYXRjaCgoKSA9PiB7XG4gICAgICAgICAgLyogaWdub3JlIGJvb3RzdHJhcCBmYWlsdXJlcyBzbyB0aGUgcG9vbCBzdGF5cyB1c2FibGUgKi9cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgZ2xvYmFsLl9fY29yZV9wZ19wb29sX18gPSBwb29sO1xuICB9XG4gIHJldHVybiBnbG9iYWwuX19jb3JlX3BnX3Bvb2xfXyE7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRQb29sKCk6IFBvb2wge1xuICByZXR1cm4gZW5zdXJlUG9vbCgpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGdldERiKCk6IFBvb2wge1xuICByZXR1cm4gZW5zdXJlUG9vbCgpO1xufVxuXG4vKiDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAgUXVlcnkgaGVscGVycyDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAgKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB3aXRoQ2xpZW50PFQ+KGZuOiAoY2xpZW50OiBQb29sQ2xpZW50KSA9PiBQcm9taXNlPFQ+KTogUHJvbWlzZTxUPiB7XG4gIGNvbnN0IGNsaWVudCA9IGF3YWl0IGVuc3VyZVBvb2woKS5jb25uZWN0KCk7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGF3YWl0IGZuKGNsaWVudCk7XG4gIH0gZmluYWxseSB7XG4gICAgY2xpZW50LnJlbGVhc2UoKTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcXVlcnk8VCBleHRlbmRzIFF1ZXJ5UmVzdWx0Um93ID0gUXVlcnlSZXN1bHRSb3c+KFxuICB0ZXh0OiBzdHJpbmcsXG4gIHBhcmFtcz86IGFueVtdLFxuKTogUHJvbWlzZTxRdWVyeVJlc3VsdDxUPj4ge1xuICByZXR1cm4gZW5zdXJlUG9vbCgpLnF1ZXJ5PFQ+KHRleHQsIHBhcmFtcyk7XG59XG5cbmV4cG9ydCBjb25zdCBkYjogUG9vbCA9IGVuc3VyZVBvb2woKTtcbmV4cG9ydCBjb25zdCBzZXJ2ZXJEYiA9IHtcbiAgcXVlcnk8VCA9IGFueT4odGV4dDogc3RyaW5nLCBwYXJhbXM/OiBhbnlbXSkge1xuICAgIHJldHVybiBlbnN1cmVQb29sKCkucXVlcnk8VD4odGV4dCwgcGFyYW1zKTtcbiAgfSxcbn07XG5cbi8qIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCBUYWJsZSBjb25zdGFudHMg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAICovXG5leHBvcnQgY29uc3QgVEFCTEVTID0ge1xuICBtYXRyaWNlczogcHJvY2Vzcy5lbnYuTUFUUklYX1RBQkxFIHx8IFwibWF0cmljZXMuZHluX3ZhbHVlc1wiLFxuICBtYXRyaWNlc1N0YWdlOiBwcm9jZXNzLmVudi5NQVRSSVhfU1RBR0VfVEFCTEUgfHwgXCJtYXRyaWNlcy5keW5fdmFsdWVzX3N0YWdlXCIsXG4gIGxlZGdlcjogcHJvY2Vzcy5lbnYuQVBQX0xFREdFUl9UQUJMRSB8fCBcIm9wcy5hcHBfbGVkZ2VyXCIsXG4gIHRyYW5zZmVyczogcHJvY2Vzcy5lbnYuVFJBTlNGRVJfTEVER0VSX1RBQkxFIHx8IFwib3BzLnRyYW5zZmVyX2xlZGdlclwiLFxufSBhcyBjb25zdDtcblxuLyog4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAIExlZGdlciBoZWxwZXJzIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCAqL1xuZXhwb3J0IHR5cGUgQXBwTGVkZ2VyRXZlbnQgPSB7XG4gIHRvcGljOiBzdHJpbmc7ICAgICAgICAgICAgICAvLyBlLmcuIFwicGlwZWxpbmVcIlxuICBldmVudDogc3RyaW5nOyAgICAgICAgICAgICAgLy8gZS5nLiBcImR5bl9tYXRyaXhfdXBzZXJ0XCJcbiAgcGF5bG9hZD86IHVua25vd247XG4gIHNlc3Npb25faWQ/OiBzdHJpbmc7XG4gIGlkZW1wb3RlbmN5X2tleT86IHN0cmluZztcbiAgdHNfZXBvY2hfbXM6IG51bWJlcjtcbn07XG5cbi8qKiBTYWZlIGluc2VydDsgaWdub3JlcyBtaXNzaW5nIHRhYmxlIG9yIGR1cGxpY2F0ZSBrZXkuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXBwZW5kQXBwTGVkZ2VyKGU6IEFwcExlZGdlckV2ZW50KTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IHNxbCA9IGBcbiAgICBJTlNFUlQgSU5UTyAke1RBQkxFUy5sZWRnZXJ9XG4gICAgICAodG9waWMsIGV2ZW50LCBwYXlsb2FkLCBzZXNzaW9uX2lkLCBpZGVtcG90ZW5jeV9rZXksIHRzX2Vwb2NoX21zKVxuICAgIFZBTFVFUyAoJDEsJDIsJDMsJDQsJDUsJDYpXG4gICAgT04gQ09ORkxJQ1QgKGlkZW1wb3RlbmN5X2tleSkgRE8gTk9USElOR1xuICBgO1xuICB0cnkge1xuICAgIGF3YWl0IHF1ZXJ5KHNxbCwgW1xuICAgICAgZS50b3BpYyxcbiAgICAgIGUuZXZlbnQsXG4gICAgICBlLnBheWxvYWQgPz8gbnVsbCxcbiAgICAgIGUuc2Vzc2lvbl9pZCA/PyBudWxsLFxuICAgICAgZS5pZGVtcG90ZW5jeV9rZXkgPz8gbnVsbCxcbiAgICAgIGUudHNfZXBvY2hfbXMsXG4gICAgXSk7XG4gIH0gY2F0Y2ggKGVycjogYW55KSB7XG4gICAgaWYgKGVycj8uY29kZSA9PT0gXCI0MlAwMVwiKSB7XG4gICAgICBjb25zb2xlLndhcm4oXCJhcHBlbmRBcHBMZWRnZXI6IGxlZGdlciB0YWJsZSBtaXNzaW5nIChvcHMuYXBwX2xlZGdlcikuIFNraXBwaW5nIGxvZy5cIik7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRocm93IGVycjtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QXBwTGVkZ2VyU2luY2Uoc2luY2VNczogbnVtYmVyLCB0b3BpYz86IHN0cmluZykge1xuICB0cnkge1xuICAgIGNvbnN0IHsgcm93cyB9ID0gYXdhaXQgcXVlcnkoXG4gICAgICBgU0VMRUNUICogRlJPTSAke1RBQkxFUy5sZWRnZXJ9XG4gICAgICAgIFdIRVJFIHRzX2Vwb2NoX21zID49ICQxXG4gICAgICAgICAgQU5EICgkMjo6dGV4dCBJUyBOVUxMIE9SIHRvcGljID0gJDIpXG4gICAgIE9SREVSIEJZIHRzX2Vwb2NoX21zIEFTQ2AsXG4gICAgICBbc2luY2VNcywgdG9waWMgPz8gbnVsbF0sXG4gICAgKTtcbiAgICByZXR1cm4gcm93cztcbiAgfSBjYXRjaCAoZXJyOiBhbnkpIHtcbiAgICBpZiAoZXJyPy5jb2RlID09PSBcIjQyUDAxXCIpIHtcbiAgICAgIGNvbnNvbGUud2FybihcImdldEFwcExlZGdlclNpbmNlOiBsZWRnZXIgdGFibGUgbWlzc2luZyAob3BzLmFwcF9sZWRnZXIpLlwiKTtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gICAgdGhyb3cgZXJyO1xuICB9XG59XG5cbi8qIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCBUcmFuc2ZlciBsZWRnZXIgaGVscGVycyDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAgKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhcHBlbmRUcmFuc2ZlckxlZGdlcihyb3c6IHtcbiAgYXBwX3Nlc3Npb25faWQ6IHN0cmluZztcbiAgY3ljbGVfdHM6IG51bWJlcjtcbiAgbGVnX3NlcTogbnVtYmVyO1xuICByb3V0ZV9pZD86IHN0cmluZyB8IG51bGw7XG4gIGludGVudF9pZD86IHN0cmluZyB8IG51bGw7XG4gIGZyb21fc3ltYm9sOiBzdHJpbmc7XG4gIHRvX3N5bWJvbDogc3RyaW5nO1xuICBxdHlfZnJvbTogbnVtYmVyO1xuICBxdHlfdG86IG51bWJlcjtcbiAgcHJpY2VfZnJvbV91c2R0OiBudW1iZXI7XG4gIHByaWNlX3RvX3VzZHQ6IG51bWJlcjtcbiAgZmVlX3VzZHQ/OiBudW1iZXI7XG4gIGV4ZWNfdHM6IG51bWJlcjtcbiAgdHhfaWQ/OiBzdHJpbmcgfCBudWxsO1xufSk6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCBxID0gYFxuICAgIElOU0VSVCBJTlRPICR7VEFCTEVTLnRyYW5zZmVyc30gKFxuICAgICAgYXBwX3Nlc3Npb25faWQsIGN5Y2xlX3RzLCBsZWdfc2VxLCByb3V0ZV9pZCwgaW50ZW50X2lkLFxuICAgICAgZnJvbV9zeW1ib2wsIHRvX3N5bWJvbCwgcXR5X2Zyb20sIHF0eV90byxcbiAgICAgIHByaWNlX2Zyb21fdXNkdCwgcHJpY2VfdG9fdXNkdCwgZmVlX3VzZHQsIGV4ZWNfdHMsIHR4X2lkXG4gICAgKVxuICAgIFZBTFVFUyAoXG4gICAgICAkMSwkMiwkMywkNCwkNSwkNiwkNywkOCwkOSwkMTAsJDExLENPQUxFU0NFKCQxMiwwKSwkMTMsJDE0XG4gICAgKVxuICAgIE9OIENPTkZMSUNUIChhcHBfc2Vzc2lvbl9pZCwgY3ljbGVfdHMsIGxlZ19zZXEpIERPIE5PVEhJTkdcbiAgYDtcbiAgdHJ5IHtcbiAgICBhd2FpdCBxdWVyeShxLCBbXG4gICAgICByb3cuYXBwX3Nlc3Npb25faWQsXG4gICAgICByb3cuY3ljbGVfdHMsXG4gICAgICByb3cubGVnX3NlcSxcbiAgICAgIHJvdy5yb3V0ZV9pZCA/PyBudWxsLFxuICAgICAgcm93LmludGVudF9pZCA/PyBudWxsLFxuICAgICAgcm93LmZyb21fc3ltYm9sLFxuICAgICAgcm93LnRvX3N5bWJvbCxcbiAgICAgIHJvdy5xdHlfZnJvbSxcbiAgICAgIHJvdy5xdHlfdG8sXG4gICAgICByb3cucHJpY2VfZnJvbV91c2R0LFxuICAgICAgcm93LnByaWNlX3RvX3VzZHQsXG4gICAgICByb3cuZmVlX3VzZHQgPz8gMCxcbiAgICAgIHJvdy5leGVjX3RzLFxuICAgICAgcm93LnR4X2lkID8/IG51bGwsXG4gICAgXSk7XG4gIH0gY2F0Y2ggKGVycjogYW55KSB7XG4gICAgaWYgKGVycj8uY29kZSA9PT0gXCI0MlAwMVwiKSB7XG4gICAgICBjb25zb2xlLndhcm4oXCJhcHBlbmRUcmFuc2ZlckxlZGdlcjogdHJhbnNmZXJfbGVkZ2VyIHRhYmxlIG1pc3NpbmcgKG9wcy50cmFuc2Zlcl9sZWRnZXIpLlwiKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhyb3cgZXJyO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsaXN0VHJhbnNmZXJMZWdzKFxuICBhcHBfc2Vzc2lvbl9pZDogc3RyaW5nLFxuICBvcHRzPzogeyBiZWZvcmU/OiBudW1iZXI7IGxpbWl0PzogbnVtYmVyIH0sXG4pIHtcbiAgY29uc3QgeyByb3dzIH0gPSBhd2FpdCBxdWVyeShcbiAgICBgU0VMRUNUICogRlJPTSAke1RBQkxFUy50cmFuc2ZlcnN9XG4gICAgICBXSEVSRSBhcHBfc2Vzc2lvbl9pZCA9ICQxXG4gICAgICAgIEFORCAoJDI6OmJpZ2ludCBJUyBOVUxMIE9SIGN5Y2xlX3RzIDwgJDIpXG4gICBPUkRFUiBCWSBjeWNsZV90cyBERVNDLCBsZWdfc2VxIERFU0NcbiAgICAgIExJTUlUICQzYCxcbiAgICBbYXBwX3Nlc3Npb25faWQsIG9wdHM/LmJlZm9yZSA/PyBudWxsLCBvcHRzPy5saW1pdCA/PyAyMDBdLFxuICApO1xuICByZXR1cm4gcm93cztcbn1cblxuZXhwb3J0IHR5cGUgeyBQb29sLCBQb29sQ2xpZW50LCBRdWVyeVJlc3VsdCwgUXVlcnlSZXN1bHRSb3cgfTtcbiJdLCJuYW1lcyI6WyJQb29sIiwiYXNCb29sIiwidiIsImZhbGxiYWNrIiwicyIsIlN0cmluZyIsInRyaW0iLCJ0b0xvd2VyQ2FzZSIsInVzZVVybCIsInByb2Nlc3MiLCJlbnYiLCJEQVRBQkFTRV9VUkwiLCJiYXNlQ29uZmlnIiwiY29ubmVjdGlvblN0cmluZyIsImhvc3QiLCJQR0hPU1QiLCJwb3J0IiwiTnVtYmVyIiwiUEdQT1JUIiwidXNlciIsIlBHVVNFUiIsInBhc3N3b3JkIiwiUEdQQVNTV09SRCIsImRhdGFiYXNlIiwiUEdEQVRBQkFTRSIsInBvb2xDb25maWciLCJtYXgiLCJEQl9QT09MX01BWCIsIlBHUE9PTF9NQVgiLCJpZGxlVGltZW91dE1pbGxpcyIsIkRCX0lETEVfTVMiLCJjb25uZWN0aW9uVGltZW91dE1pbGxpcyIsIkRCX0NPTk5fVElNRU9VVF9NUyIsInNzbCIsIkRCX1NTTCIsIlBHU1NMIiwicmVqZWN0VW5hdXRob3JpemVkIiwidW5kZWZpbmVkIiwiU0VTU0lPTl9TVEFURU1FTlRfVElNRU9VVCIsIkRCX1NUQVRFTUVOVF9USU1FT1VUX01TIiwiU0VTU0lPTl9JRExFX1RYX1RJTUVPVVQiLCJEQl9JRExFX1RYX1RJTUVPVVRfTVMiLCJTRVNTSU9OX1RaIiwiREJfVElNRVpPTkUiLCJyZXBsYWNlIiwiREVGQVVMVF9TRUFSQ0hfUEFUSCIsImpvaW4iLCJlbnN1cmVQb29sIiwiZ2xvYmFsIiwiX19jb3JlX3BnX3Bvb2xfXyIsInBvb2wiLCJvbiIsImNsaWVudCIsImJvb3RzdHJhcCIsInN0YXRlbWVudCIsInF1ZXJ5IiwiY2F0Y2giLCJnZXRQb29sIiwiZ2V0RGIiLCJ3aXRoQ2xpZW50IiwiZm4iLCJjb25uZWN0IiwicmVsZWFzZSIsInRleHQiLCJwYXJhbXMiLCJkYiIsInNlcnZlckRiIiwiVEFCTEVTIiwibWF0cmljZXMiLCJNQVRSSVhfVEFCTEUiLCJtYXRyaWNlc1N0YWdlIiwiTUFUUklYX1NUQUdFX1RBQkxFIiwibGVkZ2VyIiwiQVBQX0xFREdFUl9UQUJMRSIsInRyYW5zZmVycyIsIlRSQU5TRkVSX0xFREdFUl9UQUJMRSIsImFwcGVuZEFwcExlZGdlciIsImUiLCJzcWwiLCJ0b3BpYyIsImV2ZW50IiwicGF5bG9hZCIsInNlc3Npb25faWQiLCJpZGVtcG90ZW5jeV9rZXkiLCJ0c19lcG9jaF9tcyIsImVyciIsImNvZGUiLCJjb25zb2xlIiwid2FybiIsImdldEFwcExlZGdlclNpbmNlIiwic2luY2VNcyIsInJvd3MiLCJhcHBlbmRUcmFuc2ZlckxlZGdlciIsInJvdyIsInEiLCJhcHBfc2Vzc2lvbl9pZCIsImN5Y2xlX3RzIiwibGVnX3NlcSIsInJvdXRlX2lkIiwiaW50ZW50X2lkIiwiZnJvbV9zeW1ib2wiLCJ0b19zeW1ib2wiLCJxdHlfZnJvbSIsInF0eV90byIsInByaWNlX2Zyb21fdXNkdCIsInByaWNlX3RvX3VzZHQiLCJmZWVfdXNkdCIsImV4ZWNfdHMiLCJ0eF9pZCIsImxpc3RUcmFuc2ZlckxlZ3MiLCJvcHRzIiwiYmVmb3JlIiwibGltaXQiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/core/db/pool_server.ts\n");

/***/ }),

/***/ "(rsc)/./src/core/features/moo-aux/grid.ts":
/*!*******************************************!*\
  !*** ./src/core/features/moo-aux/grid.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   buildMeaAux: () => (/* binding */ buildMeaAux),\n/* harmony export */   pickTierName: () => (/* binding */ pickTierName),\n/* harmony export */   toRenderableRows: () => (/* binding */ toRenderableRows)\n/* harmony export */ });\n/* harmony import */ var _tiers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./tiers */ \"(rsc)/./src/core/features/moo-aux/tiers.ts\");\n// PATCH: src/core/features/moo-aux/grid.ts\n\nfunction pickTierName(idp, rules = _tiers__WEBPACK_IMPORTED_MODULE_0__.DEFAULT_TIER_RULES) {\n    const a = Math.abs(Number(idp || 0));\n    const r = rules.find((r)=>a >= r.minAbs && (r.maxAbs == null || a <= r.maxAbs));\n    return r?.name;\n}\nfunction buildMeaAux(params) {\n    const { coins, idPct, balances, coverage, rules = _tiers__WEBPACK_IMPORTED_MODULE_0__.DEFAULT_TIER_RULES } = params;\n    const k = Math.max(1, params.k ?? coins.length - 1);\n    const mood = Number.isFinite(params.moodCoeff ?? 1) ? params.moodCoeff : 1;\n    const out = {};\n    for (const base of coins){\n        const avail = balances[base] ?? 0;\n        const row = {};\n        for (const quote of coins){\n            if (quote === base) {\n                row[quote] = null;\n                continue;\n            }\n            if (coverage && coverage[base] && coverage[base][quote] === false) {\n                row[quote] = null;\n                continue;\n            }\n            const idp = idPct?.[base]?.[quote];\n            const w = (0,_tiers__WEBPACK_IMPORTED_MODULE_0__.getTierWeighting)(Number(idp ?? 0), rules); // legacy bin weight\n            const cell = avail * (1 / k) * w * mood; // APPLY mood here\n            row[quote] = Number.isFinite(cell) ? cell : 0;\n        }\n        out[base] = row;\n    }\n    return out;\n}\n// ...rest unchanged...\nfunction toRenderableRows(mea) {\n// keeps your existing shape (no change needed)\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvY29yZS9mZWF0dXJlcy9tb28tYXV4L2dyaWQudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBLDJDQUEyQztBQUVvQjtBQU94RCxTQUFTRSxhQUFhQyxHQUFXLEVBQUVDLFFBQW9CSixzREFBa0I7SUFDOUUsTUFBTUssSUFBSUMsS0FBS0MsR0FBRyxDQUFDQyxPQUFPTCxPQUFPO0lBQ2pDLE1BQU1NLElBQUlMLE1BQU1NLElBQUksQ0FBQ0QsQ0FBQUEsSUFBS0osS0FBS0ksRUFBRUUsTUFBTSxJQUFLRixDQUFBQSxFQUFFRyxNQUFNLElBQUksUUFBUVAsS0FBS0ksRUFBRUcsTUFBTTtJQUM3RSxPQUFPSCxHQUFHSTtBQUNaO0FBRU8sU0FBU0MsWUFBWUMsTUFRM0I7SUFDQyxNQUFNLEVBQUVDLEtBQUssRUFBRUMsS0FBSyxFQUFFQyxRQUFRLEVBQUVDLFFBQVEsRUFBRWYsUUFBUUosc0RBQWtCLEVBQUUsR0FBR2U7SUFDekUsTUFBTUssSUFBSWQsS0FBS2UsR0FBRyxDQUFDLEdBQUdOLE9BQU9LLENBQUMsSUFBSUosTUFBTU0sTUFBTSxHQUFHO0lBQ2pELE1BQU1DLE9BQU9mLE9BQU9nQixRQUFRLENBQUNULE9BQU9VLFNBQVMsSUFBSSxLQUFNVixPQUFPVSxTQUFTLEdBQWM7SUFFckYsTUFBTUMsTUFBa0IsQ0FBQztJQUN6QixLQUFLLE1BQU1DLFFBQVFYLE1BQU87UUFDeEIsTUFBTVksUUFBUVYsUUFBUSxDQUFDUyxLQUFLLElBQUk7UUFDaEMsTUFBTUUsTUFBcUMsQ0FBQztRQUM1QyxLQUFLLE1BQU1DLFNBQVNkLE1BQU87WUFDekIsSUFBSWMsVUFBVUgsTUFBTTtnQkFBRUUsR0FBRyxDQUFDQyxNQUFNLEdBQUc7Z0JBQU07WUFBVTtZQUNuRCxJQUFJWCxZQUFZQSxRQUFRLENBQUNRLEtBQUssSUFBSVIsUUFBUSxDQUFDUSxLQUFLLENBQUNHLE1BQU0sS0FBSyxPQUFPO2dCQUFFRCxHQUFHLENBQUNDLE1BQU0sR0FBRztnQkFBTTtZQUFVO1lBRWxHLE1BQU0zQixNQUFNYyxPQUFPLENBQUNVLEtBQUssRUFBRSxDQUFDRyxNQUFNO1lBQ2xDLE1BQU1DLElBQUk5Qix3REFBZ0JBLENBQUNPLE9BQU9MLE9BQU8sSUFBSUMsUUFBUSxvQkFBb0I7WUFDekUsTUFBTTRCLE9BQU9KLFFBQVMsS0FBSVIsQ0FBQUEsSUFBS1csSUFBSVIsTUFBTSxrQkFBa0I7WUFDM0RNLEdBQUcsQ0FBQ0MsTUFBTSxHQUFHdEIsT0FBT2dCLFFBQVEsQ0FBQ1EsUUFBUUEsT0FBTztRQUM5QztRQUNBTixHQUFHLENBQUNDLEtBQUssR0FBR0U7SUFDZDtJQUNBLE9BQU9IO0FBQ1Q7QUFFQSx1QkFBdUI7QUFFaEIsU0FBU08saUJBQWlCQyxHQUs5QjtBQUNELCtDQUErQztBQUNqRCIsInNvdXJjZXMiOlsiSDpcXFVzZXJzXFxHdXNcXHNvdXJjZVxccmVwb1xcZHluYW1pY3NcXGR5bmFtaWNzLWJcXGNyeXB0b3BpLWR5bmFtaWNzXFxzcmNcXGNvcmVcXGZlYXR1cmVzXFxtb28tYXV4XFxncmlkLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFBBVENIOiBzcmMvY29yZS9mZWF0dXJlcy9tb28tYXV4L2dyaWQudHNcclxuaW1wb3J0IHR5cGUgeyBUaWVyUnVsZSB9IGZyb20gXCIuL3RpZXJzXCI7XHJcbmltcG9ydCB7IERFRkFVTFRfVElFUl9SVUxFUywgZ2V0VGllcldlaWdodGluZyB9IGZyb20gXCIuL3RpZXJzXCI7XHJcblxyXG5leHBvcnQgdHlwZSBJZFBjdEdyaWQgPSBSZWNvcmQ8c3RyaW5nLCBSZWNvcmQ8c3RyaW5nLCBudW1iZXIgfCBudWxsPj47XHJcbmV4cG9ydCB0eXBlIEJhbGFuY2VzTWFwID0gUmVjb3JkPHN0cmluZywgbnVtYmVyPjtcclxuZXhwb3J0IHR5cGUgTWVhQXV4R3JpZCA9IFJlY29yZDxzdHJpbmcsIFJlY29yZDxzdHJpbmcsIG51bWJlciB8IG51bGw+PjtcclxuZXhwb3J0IHR5cGUgTWVhUGFpciA9IHsgYmFzZTogc3RyaW5nOyBxdW90ZTogc3RyaW5nOyB2YWx1ZTogbnVtYmVyOyBmcm96ZW4/OiBib29sZWFuIH07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcGlja1RpZXJOYW1lKGlkcDogbnVtYmVyLCBydWxlczogVGllclJ1bGVbXSA9IERFRkFVTFRfVElFUl9SVUxFUyk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XHJcbiAgY29uc3QgYSA9IE1hdGguYWJzKE51bWJlcihpZHAgfHwgMCkpO1xyXG4gIGNvbnN0IHIgPSBydWxlcy5maW5kKHIgPT4gYSA+PSByLm1pbkFicyAmJiAoci5tYXhBYnMgPT0gbnVsbCB8fCBhIDw9IHIubWF4QWJzKSk7XHJcbiAgcmV0dXJuIHI/Lm5hbWU7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBidWlsZE1lYUF1eChwYXJhbXM6IHtcclxuICBjb2luczogc3RyaW5nW107XHJcbiAgaWRQY3Q6IElkUGN0R3JpZDtcclxuICBiYWxhbmNlczogQmFsYW5jZXNNYXA7XHJcbiAgaz86IG51bWJlcjtcclxuICBydWxlcz86IFRpZXJSdWxlW107XHJcbiAgY292ZXJhZ2U/OiBSZWNvcmQ8c3RyaW5nLCBSZWNvcmQ8c3RyaW5nLCBib29sZWFuPj47XHJcbiAgbW9vZENvZWZmPzogbnVtYmVyOyAvLyBORVdcclxufSk6IE1lYUF1eEdyaWQge1xyXG4gIGNvbnN0IHsgY29pbnMsIGlkUGN0LCBiYWxhbmNlcywgY292ZXJhZ2UsIHJ1bGVzID0gREVGQVVMVF9USUVSX1JVTEVTIH0gPSBwYXJhbXM7XHJcbiAgY29uc3QgayA9IE1hdGgubWF4KDEsIHBhcmFtcy5rID8/IGNvaW5zLmxlbmd0aCAtIDEpO1xyXG4gIGNvbnN0IG1vb2QgPSBOdW1iZXIuaXNGaW5pdGUocGFyYW1zLm1vb2RDb2VmZiA/PyAxKSA/IChwYXJhbXMubW9vZENvZWZmIGFzIG51bWJlcikgOiAxO1xyXG5cclxuICBjb25zdCBvdXQ6IE1lYUF1eEdyaWQgPSB7fTtcclxuICBmb3IgKGNvbnN0IGJhc2Ugb2YgY29pbnMpIHtcclxuICAgIGNvbnN0IGF2YWlsID0gYmFsYW5jZXNbYmFzZV0gPz8gMDtcclxuICAgIGNvbnN0IHJvdzogUmVjb3JkPHN0cmluZywgbnVtYmVyIHwgbnVsbD4gPSB7fTtcclxuICAgIGZvciAoY29uc3QgcXVvdGUgb2YgY29pbnMpIHtcclxuICAgICAgaWYgKHF1b3RlID09PSBiYXNlKSB7IHJvd1txdW90ZV0gPSBudWxsOyBjb250aW51ZTsgfVxyXG4gICAgICBpZiAoY292ZXJhZ2UgJiYgY292ZXJhZ2VbYmFzZV0gJiYgY292ZXJhZ2VbYmFzZV1bcXVvdGVdID09PSBmYWxzZSkgeyByb3dbcXVvdGVdID0gbnVsbDsgY29udGludWU7IH1cclxuXHJcbiAgICAgIGNvbnN0IGlkcCA9IGlkUGN0Py5bYmFzZV0/LltxdW90ZV07XHJcbiAgICAgIGNvbnN0IHcgPSBnZXRUaWVyV2VpZ2h0aW5nKE51bWJlcihpZHAgPz8gMCksIHJ1bGVzKTsgLy8gbGVnYWN5IGJpbiB3ZWlnaHRcclxuICAgICAgY29uc3QgY2VsbCA9IGF2YWlsICogKDEgLyBrKSAqIHcgKiBtb29kOyAvLyBBUFBMWSBtb29kIGhlcmVcclxuICAgICAgcm93W3F1b3RlXSA9IE51bWJlci5pc0Zpbml0ZShjZWxsKSA/IGNlbGwgOiAwO1xyXG4gICAgfVxyXG4gICAgb3V0W2Jhc2VdID0gcm93O1xyXG4gIH1cclxuICByZXR1cm4gb3V0O1xyXG59XHJcblxyXG4vLyAuLi5yZXN0IHVuY2hhbmdlZC4uLlxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHRvUmVuZGVyYWJsZVJvd3MobWVhOiBSZWNvcmQ8c3RyaW5nLCBSZWNvcmQ8c3RyaW5nLCB7XHJcbiAgaWRfcGN0OiBudW1iZXI7XHJcbiAgd2VpZ2h0OiBudW1iZXI7XHJcbiAgdGllck5hbWU/OiBzdHJpbmc7XHJcbiAgaXNOdWxsPzogYm9vbGVhbjtcclxufT4+KXtcclxuICAvLyBrZWVwcyB5b3VyIGV4aXN0aW5nIHNoYXBlIChubyBjaGFuZ2UgbmVlZGVkKVxyXG59XHJcblxyXG4iXSwibmFtZXMiOlsiREVGQVVMVF9USUVSX1JVTEVTIiwiZ2V0VGllcldlaWdodGluZyIsInBpY2tUaWVyTmFtZSIsImlkcCIsInJ1bGVzIiwiYSIsIk1hdGgiLCJhYnMiLCJOdW1iZXIiLCJyIiwiZmluZCIsIm1pbkFicyIsIm1heEFicyIsIm5hbWUiLCJidWlsZE1lYUF1eCIsInBhcmFtcyIsImNvaW5zIiwiaWRQY3QiLCJiYWxhbmNlcyIsImNvdmVyYWdlIiwiayIsIm1heCIsImxlbmd0aCIsIm1vb2QiLCJpc0Zpbml0ZSIsIm1vb2RDb2VmZiIsIm91dCIsImJhc2UiLCJhdmFpbCIsInJvdyIsInF1b3RlIiwidyIsImNlbGwiLCJ0b1JlbmRlcmFibGVSb3dzIiwibWVhIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/core/features/moo-aux/grid.ts\n");

/***/ }),

/***/ "(rsc)/./src/core/features/moo-aux/measures.ts":
/*!***********************************************!*\
  !*** ./src/core/features/moo-aux/measures.ts ***!
  \***********************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   assembleMoodInputs: () => (/* binding */ assembleMoodInputs),\n/* harmony export */   buildMeaAux: () => (/* reexport safe */ _grid__WEBPACK_IMPORTED_MODULE_1__.buildMeaAux),\n/* harmony export */   buildMeaAuxForCycle: () => (/* reexport safe */ _grid__WEBPACK_IMPORTED_MODULE_1__.buildMeaAuxForCycle),\n/* harmony export */   computeMoodCoeffUsingCurrentMetrics: () => (/* binding */ computeMoodCoeffUsingCurrentMetrics),\n/* harmony export */   getManyMetrics: () => (/* binding */ getManyMetrics),\n/* harmony export */   getMetric: () => (/* binding */ getMetric),\n/* harmony export */   saveMoodObservation: () => (/* binding */ saveMoodObservation),\n/* harmony export */   toRenderableRows: () => (/* reexport safe */ _grid__WEBPACK_IMPORTED_MODULE_1__.toRenderableRows)\n/* harmony export */ });\n/* harmony import */ var _core_db_db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/core/db/db */ \"(rsc)/./src/core/db/db.ts\");\n/* harmony import */ var _grid__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./grid */ \"(rsc)/./src/core/features/moo-aux/grid.ts\");\n/* harmony import */ var _mood_formula__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./mood-formula */ \"(rsc)/./src/core/features/moo-aux/mood-formula.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_core_db_db__WEBPACK_IMPORTED_MODULE_0__]);\n_core_db_db__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n// src/core/features/moo-aux/measures.ts\n\n\n/** ---------- retrieval: generic metric fetchers ---------- */ async function getMetric(metricKey, ts_ms) {\n    try {\n        const { rows } = await _core_db_db__WEBPACK_IMPORTED_MODULE_0__.db.query(`SELECT value FROM metrics\n       WHERE metric_key=$1 AND ts_epoch_ms <= $2\n       ORDER BY ts_epoch_ms DESC\n       LIMIT 1`, [\n            metricKey,\n            ts_ms\n        ]);\n        return rows.length ? Number(rows[0].value) : null;\n    } catch  {\n        return null;\n    }\n}\nasync function getManyMetrics(keys, ts_ms) {\n    const out = {};\n    await Promise.all(keys.map(async (k)=>{\n        out[k] = await getMetric(k, ts_ms);\n    }));\n    return out;\n}\nasync function assembleMoodInputs(ts_ms) {\n    const keys = [\n        \"GFMdelta\",\n        \"vSwap\",\n        \"Inertia\",\n        \"Disruption\",\n        \"Amp\",\n        \"Volt\",\n        \"id_pct:global\"\n    ];\n    const got = await getManyMetrics(keys, ts_ms);\n    return {\n        GFMdelta: got[\"GFMdelta\"],\n        vSwap: got[\"vSwap\"],\n        Inertia: got[\"Inertia\"],\n        Disrupt: got[\"Disruption\"],\n        Amp: got[\"Amp\"],\n        Volt: got[\"Volt\"],\n        id_pct: got[\"id_pct:global\"]\n    };\n}\n/** ---------- register (persist) ---------- */ async function saveMoodObservation(appSessionId, ts_ms, moodLabel, weight, payload) {\n    try {\n        await _core_db_db__WEBPACK_IMPORTED_MODULE_0__.db.query(`INSERT INTO mea_mood_observations (app_session_id, ts_ms, mn_label, weight, payload)\n       VALUES ($1,$2,$3,$4,$5)\n       ON CONFLICT (app_session_id, ts_ms) DO UPDATE\n       SET mn_label=EXCLUDED.mn_label, weight=EXCLUDED.weight, payload=EXCLUDED.payload`, [\n            appSessionId,\n            ts_ms,\n            moodLabel,\n            weight ?? null,\n            JSON.stringify(payload ?? null)\n        ]);\n    } catch  {}\n}\n// PATCH: src/core/features/moo-aux/measures.ts\n\nasync function computeMoodCoeffUsingCurrentMetrics(ts_ms) {\n    const m = await assembleMoodInputs(ts_ms); // already exists\n    const { coeff, buckets } = (0,_mood_formula__WEBPACK_IMPORTED_MODULE_2__.computeMoodCoeffV1)({\n        vTendency: m.Inertia ?? m.id_pct ?? 0,\n        GFM: (m.GFMdelta ?? 0) + 1,\n        vSwap: m.vSwap ?? 0\n    });\n    return {\n        coeff,\n        buckets\n    };\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvY29yZS9mZWF0dXJlcy9tb28tYXV4L21lYXN1cmVzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsd0NBQXdDO0FBQ047QUFFMEM7QUFHNUUsNkRBQTZELEdBQ3RELGVBQWVJLFVBQVVDLFNBQWlCLEVBQUVDLEtBQWE7SUFDOUQsSUFBSTtRQUNGLE1BQU0sRUFBRUMsSUFBSSxFQUFFLEdBQUcsTUFBTVAsMkNBQUVBLENBQUNRLEtBQUssQ0FDN0IsQ0FBQzs7O2NBR08sQ0FBQyxFQUNUO1lBQUNIO1lBQVdDO1NBQU07UUFFcEIsT0FBT0MsS0FBS0UsTUFBTSxHQUFHQyxPQUFPSCxJQUFJLENBQUMsRUFBRSxDQUFDSSxLQUFLLElBQUk7SUFDL0MsRUFBRSxPQUFNO1FBQUUsT0FBTztJQUFNO0FBQ3pCO0FBRU8sZUFBZUMsZUFBZUMsSUFBYyxFQUFFUCxLQUFhO0lBQ2hFLE1BQU1RLE1BQXFDLENBQUM7SUFDNUMsTUFBTUMsUUFBUUMsR0FBRyxDQUFDSCxLQUFLSSxHQUFHLENBQUMsT0FBT0M7UUFBUUosR0FBRyxDQUFDSSxFQUFFLEdBQUcsTUFBTWQsVUFBVWMsR0FBR1o7SUFBUTtJQUM5RSxPQUFPUTtBQUNUO0FBYU8sZUFBZUssbUJBQW1CYixLQUFhO0lBQ3BELE1BQU1PLE9BQU87UUFBQztRQUFXO1FBQVE7UUFBVTtRQUFhO1FBQU07UUFBTztLQUFnQjtJQUNyRixNQUFNTyxNQUFPLE1BQU1SLGVBQWVDLE1BQU1QO0lBQ3hDLE9BQU87UUFDTGUsVUFBVUQsR0FBRyxDQUFDLFdBQVc7UUFDekJFLE9BQVVGLEdBQUcsQ0FBQyxRQUFRO1FBQ3RCRyxTQUFVSCxHQUFHLENBQUMsVUFBVTtRQUN4QkksU0FBVUosR0FBRyxDQUFDLGFBQWE7UUFDM0JLLEtBQVVMLEdBQUcsQ0FBQyxNQUFNO1FBQ3BCTSxNQUFVTixHQUFHLENBQUMsT0FBTztRQUNyQk8sUUFBVVAsR0FBRyxDQUFDLGdCQUFnQjtJQUNoQztBQUNGO0FBRUEsNkNBQTZDLEdBQ3RDLGVBQWVRLG9CQUFvQkMsWUFBb0IsRUFBRXZCLEtBQWEsRUFBRXdCLFNBQWlCLEVBQUVDLE1BQXFCLEVBQUVDLE9BQWdCO0lBQ3ZJLElBQUk7UUFDRixNQUFNaEMsMkNBQUVBLENBQUNRLEtBQUssQ0FDWixDQUFDOzs7dUZBR2dGLENBQUMsRUFDbEY7WUFBQ3FCO1lBQWN2QjtZQUFPd0I7WUFBV0MsVUFBVTtZQUFNRSxLQUFLQyxTQUFTLENBQUNGLFdBQVc7U0FBTTtJQUVyRixFQUFFLE9BQU0sQ0FBdUI7QUFDakM7QUFFQSwrQ0FBK0M7QUFDSztBQUU3QyxlQUFlSSxvQ0FBb0M5QixLQUFhO0lBR3JFLE1BQU0rQixJQUFJLE1BQU1sQixtQkFBbUJiLFFBQVEsaUJBQWlCO0lBQzVELE1BQU0sRUFBRWdDLEtBQUssRUFBRUMsT0FBTyxFQUFFLEdBQUdKLGlFQUFrQkEsQ0FBQztRQUM1Q0ssV0FBV0gsRUFBRWQsT0FBTyxJQUFJYyxFQUFFVixNQUFNLElBQUk7UUFDcENjLEtBQUssQ0FBQ0osRUFBRWhCLFFBQVEsSUFBSSxLQUFLO1FBQ3pCQyxPQUFPZSxFQUFFZixLQUFLLElBQUk7SUFDcEI7SUFDQSxPQUFPO1FBQUVnQjtRQUFPQztJQUFRO0FBQzFCIiwic291cmNlcyI6WyJIOlxcVXNlcnNcXEd1c1xcc291cmNlXFxyZXBvXFxkeW5hbWljc1xcZHluYW1pY3MtYlxcY3J5cHRvcGktZHluYW1pY3NcXHNyY1xcY29yZVxcZmVhdHVyZXNcXG1vby1hdXhcXG1lYXN1cmVzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9jb3JlL2ZlYXR1cmVzL21vby1hdXgvbWVhc3VyZXMudHNcclxuaW1wb3J0IHsgZGIgfSBmcm9tIFwiQC9jb3JlL2RiL2RiXCI7XHJcblxyXG5leHBvcnQgeyBidWlsZE1lYUF1eCwgYnVpbGRNZWFBdXhGb3JDeWNsZSwgdG9SZW5kZXJhYmxlUm93cyB9IGZyb20gXCIuL2dyaWRcIjtcclxuZXhwb3J0IHR5cGUgeyBJZFBjdEdyaWQsIEJhbGFuY2VzTWFwLCBNZWFBdXhHcmlkLCBNZWFQYWlyLCBNZWFSb3cgfSBmcm9tIFwiLi9ncmlkXCI7XHJcblxyXG4vKiogLS0tLS0tLS0tLSByZXRyaWV2YWw6IGdlbmVyaWMgbWV0cmljIGZldGNoZXJzIC0tLS0tLS0tLS0gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldE1ldHJpYyhtZXRyaWNLZXk6IHN0cmluZywgdHNfbXM6IG51bWJlcik6IFByb21pc2U8bnVtYmVyIHwgbnVsbD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB7IHJvd3MgfSA9IGF3YWl0IGRiLnF1ZXJ5PHsgdmFsdWU6IG51bWJlciB9PihcclxuICAgICAgYFNFTEVDVCB2YWx1ZSBGUk9NIG1ldHJpY3NcclxuICAgICAgIFdIRVJFIG1ldHJpY19rZXk9JDEgQU5EIHRzX2Vwb2NoX21zIDw9ICQyXHJcbiAgICAgICBPUkRFUiBCWSB0c19lcG9jaF9tcyBERVNDXHJcbiAgICAgICBMSU1JVCAxYCxcclxuICAgICAgW21ldHJpY0tleSwgdHNfbXNdXHJcbiAgICApO1xyXG4gICAgcmV0dXJuIHJvd3MubGVuZ3RoID8gTnVtYmVyKHJvd3NbMF0udmFsdWUpIDogbnVsbDtcclxuICB9IGNhdGNoIHsgcmV0dXJuIG51bGw7IH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldE1hbnlNZXRyaWNzKGtleXM6IHN0cmluZ1tdLCB0c19tczogbnVtYmVyKTogUHJvbWlzZTxSZWNvcmQ8c3RyaW5nLCBudW1iZXIgfCBudWxsPj4ge1xyXG4gIGNvbnN0IG91dDogUmVjb3JkPHN0cmluZywgbnVtYmVyIHwgbnVsbD4gPSB7fTtcclxuICBhd2FpdCBQcm9taXNlLmFsbChrZXlzLm1hcChhc3luYyAoaykgPT4geyBvdXRba10gPSBhd2FpdCBnZXRNZXRyaWMoaywgdHNfbXMpOyB9KSk7XHJcbiAgcmV0dXJuIG91dDtcclxufVxyXG5cclxuLyoqIC0tLS0tLS0tLS0gY2FsYzogYXNzZW1ibGUgbW9vZCBpbnB1dHMgLS0tLS0tLS0tLSAqL1xyXG5leHBvcnQgdHlwZSBNb29kSW5wdXRzID0ge1xyXG4gIEdGTWRlbHRhOiBudW1iZXIgfCBudWxsO1xyXG4gIHZTd2FwOiAgICBudW1iZXIgfCBudWxsO1xyXG4gIEluZXJ0aWE6ICBudW1iZXIgfCBudWxsO1xyXG4gIERpc3J1cHQ6ICBudW1iZXIgfCBudWxsO1xyXG4gIEFtcDogICAgICBudW1iZXIgfCBudWxsO1xyXG4gIFZvbHQ6ICAgICBudW1iZXIgfCBudWxsO1xyXG4gIGlkX3BjdD86ICBudW1iZXIgfCBudWxsO1xyXG59O1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFzc2VtYmxlTW9vZElucHV0cyh0c19tczogbnVtYmVyKTogUHJvbWlzZTxNb29kSW5wdXRzPiB7XHJcbiAgY29uc3Qga2V5cyA9IFtcIkdGTWRlbHRhXCIsXCJ2U3dhcFwiLFwiSW5lcnRpYVwiLFwiRGlzcnVwdGlvblwiLFwiQW1wXCIsXCJWb2x0XCIsXCJpZF9wY3Q6Z2xvYmFsXCJdO1xyXG4gIGNvbnN0IGdvdCAgPSBhd2FpdCBnZXRNYW55TWV0cmljcyhrZXlzLCB0c19tcyk7XHJcbiAgcmV0dXJuIHtcclxuICAgIEdGTWRlbHRhOiBnb3RbXCJHRk1kZWx0YVwiXSxcclxuICAgIHZTd2FwOiAgICBnb3RbXCJ2U3dhcFwiXSxcclxuICAgIEluZXJ0aWE6ICBnb3RbXCJJbmVydGlhXCJdLFxyXG4gICAgRGlzcnVwdDogIGdvdFtcIkRpc3J1cHRpb25cIl0sXHJcbiAgICBBbXA6ICAgICAgZ290W1wiQW1wXCJdLFxyXG4gICAgVm9sdDogICAgIGdvdFtcIlZvbHRcIl0sXHJcbiAgICBpZF9wY3Q6ICAgZ290W1wiaWRfcGN0Omdsb2JhbFwiXSxcclxuICB9O1xyXG59XHJcblxyXG4vKiogLS0tLS0tLS0tLSByZWdpc3RlciAocGVyc2lzdCkgLS0tLS0tLS0tLSAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2F2ZU1vb2RPYnNlcnZhdGlvbihhcHBTZXNzaW9uSWQ6IHN0cmluZywgdHNfbXM6IG51bWJlciwgbW9vZExhYmVsOiBzdHJpbmcsIHdlaWdodDogbnVtYmVyIHwgbnVsbCwgcGF5bG9hZDogdW5rbm93bikge1xyXG4gIHRyeSB7XHJcbiAgICBhd2FpdCBkYi5xdWVyeShcclxuICAgICAgYElOU0VSVCBJTlRPIG1lYV9tb29kX29ic2VydmF0aW9ucyAoYXBwX3Nlc3Npb25faWQsIHRzX21zLCBtbl9sYWJlbCwgd2VpZ2h0LCBwYXlsb2FkKVxyXG4gICAgICAgVkFMVUVTICgkMSwkMiwkMywkNCwkNSlcclxuICAgICAgIE9OIENPTkZMSUNUIChhcHBfc2Vzc2lvbl9pZCwgdHNfbXMpIERPIFVQREFURVxyXG4gICAgICAgU0VUIG1uX2xhYmVsPUVYQ0xVREVELm1uX2xhYmVsLCB3ZWlnaHQ9RVhDTFVERUQud2VpZ2h0LCBwYXlsb2FkPUVYQ0xVREVELnBheWxvYWRgLFxyXG4gICAgICBbYXBwU2Vzc2lvbklkLCB0c19tcywgbW9vZExhYmVsLCB3ZWlnaHQgPz8gbnVsbCwgSlNPTi5zdHJpbmdpZnkocGF5bG9hZCA/PyBudWxsKV1cclxuICAgICk7XHJcbiAgfSBjYXRjaCB7IC8qIG9wdGlvbmFsIHRhYmxlICovIH1cclxufVxyXG5cclxuLy8gUEFUQ0g6IHNyYy9jb3JlL2ZlYXR1cmVzL21vby1hdXgvbWVhc3VyZXMudHNcclxuaW1wb3J0IHsgY29tcHV0ZU1vb2RDb2VmZlYxIH0gZnJvbSBcIi4vbW9vZC1mb3JtdWxhXCI7XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY29tcHV0ZU1vb2RDb2VmZlVzaW5nQ3VycmVudE1ldHJpY3ModHNfbXM6IG51bWJlcik6IFByb21pc2U8e1xyXG4gIGNvZWZmOiBudW1iZXI7IGJ1Y2tldHM6IHsgdlRlbmRlbmN5SWR4OiBudW1iZXI7IEdGTUlkeDogbnVtYmVyOyB2U3dhcElkeDogbnVtYmVyIH07XHJcbn0+IHtcclxuICBjb25zdCBtID0gYXdhaXQgYXNzZW1ibGVNb29kSW5wdXRzKHRzX21zKTsgLy8gYWxyZWFkeSBleGlzdHNcclxuICBjb25zdCB7IGNvZWZmLCBidWNrZXRzIH0gPSBjb21wdXRlTW9vZENvZWZmVjEoe1xyXG4gICAgdlRlbmRlbmN5OiBtLkluZXJ0aWEgPz8gbS5pZF9wY3QgPz8gMCwgLy8gaWYgeW91IG1hcCB2VGVuZGVuY3kgZWxzZXdoZXJlLCBhZGp1c3QgaGVyZVxyXG4gICAgR0ZNOiAobS5HRk1kZWx0YSA/PyAwKSArIDEsICAgICAgICAgICAgLy8gaWYgeW91ciBHRk1kZWx0YSBpcyBkZWx0YSB2cyAxLjAsIHNoaWZ0IGludG8gWzAuOC4uMS4yXVxyXG4gICAgdlN3YXA6IG0udlN3YXAgPz8gMCxcclxuICB9KTtcclxuICByZXR1cm4geyBjb2VmZiwgYnVja2V0cyB9O1xyXG59XHJcblxyXG4iXSwibmFtZXMiOlsiZGIiLCJidWlsZE1lYUF1eCIsImJ1aWxkTWVhQXV4Rm9yQ3ljbGUiLCJ0b1JlbmRlcmFibGVSb3dzIiwiZ2V0TWV0cmljIiwibWV0cmljS2V5IiwidHNfbXMiLCJyb3dzIiwicXVlcnkiLCJsZW5ndGgiLCJOdW1iZXIiLCJ2YWx1ZSIsImdldE1hbnlNZXRyaWNzIiwia2V5cyIsIm91dCIsIlByb21pc2UiLCJhbGwiLCJtYXAiLCJrIiwiYXNzZW1ibGVNb29kSW5wdXRzIiwiZ290IiwiR0ZNZGVsdGEiLCJ2U3dhcCIsIkluZXJ0aWEiLCJEaXNydXB0IiwiQW1wIiwiVm9sdCIsImlkX3BjdCIsInNhdmVNb29kT2JzZXJ2YXRpb24iLCJhcHBTZXNzaW9uSWQiLCJtb29kTGFiZWwiLCJ3ZWlnaHQiLCJwYXlsb2FkIiwiSlNPTiIsInN0cmluZ2lmeSIsImNvbXB1dGVNb29kQ29lZmZWMSIsImNvbXB1dGVNb29kQ29lZmZVc2luZ0N1cnJlbnRNZXRyaWNzIiwibSIsImNvZWZmIiwiYnVja2V0cyIsInZUZW5kZW5jeSIsIkdGTSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/core/features/moo-aux/measures.ts\n");

/***/ }),

/***/ "(rsc)/./src/core/features/moo-aux/mood-formula.ts":
/*!***************************************************!*\
  !*** ./src/core/features/moo-aux/mood-formula.ts ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   clamp: () => (/* binding */ clamp),\n/* harmony export */   computeMoodCoeffV1: () => (/* binding */ computeMoodCoeffV1)\n/* harmony export */ });\n// Implements: mood = (vTendency / GFM) + vSwap\n// with vTendency in [0.4..1.2], GFM in [0.8..1.2], vSwap in [0.5..+0.5] (signed)\n// plus 6 up/down niches for vTendency, 4 up/down for GFM, 6 up/down for vSwap.\nfunction clamp(x, lo, hi) {\n    return Math.min(Math.max(x, lo), hi);\n}\nfunction binSigned(x, boundaries, upCount, downCount) {\n    // boundaries are non-negative increasing, applied to abs(x)\n    const a = Math.abs(x);\n    let idx = 0;\n    while(idx < boundaries.length && a > boundaries[idx])idx++;\n    // idx  [0..boundaries.length] maps to 0..N-1 inside each side\n    if (x >= 0) return Math.min(idx, upCount - 1);\n    // shift to \"down\" band space\n    return upCount + Math.min(idx, downCount - 1);\n}\n// --- bucket specs (tuneable, deterministic) ---\nconst V_TEND_MIN = 0.4, V_TEND_MAX = 1.2; // foundational range\nconst GFM_MIN = 0.8, GFM_MAX = 1.2;\nconst V_SWAP_MAX = 0.5; // magnitude cap\n// Build equal-width cut points for convenience:\nfunction eqCuts(min, max, parts) {\n    const step = (max - min) / parts;\n    return Array.from({\n        length: parts - 1\n    }, (_, i)=>min + step * (i + 1));\n}\nconst vTendCuts = eqCuts(0, V_TEND_MAX, 6); // absolute buckets, zero handled by sign\nconst gfmCuts = eqCuts(0, GFM_MAX, 4);\nconst vSwapCuts = eqCuts(0, V_SWAP_MAX, 6);\n// Signed clamps\nfunction clampRanges(i) {\n    const vTendency = i.vTendency ?? 0;\n    const GFM = i.GFM ?? 1; // neutral if missing\n    const vSwap = i.vSwap ?? 0;\n    const vTendencyClamped = Math.sign(vTendency) * clamp(Math.abs(vTendency), 0, V_TEND_MAX);\n    const GFMClamped = clamp(GFM, GFM_MIN, GFM_MAX);\n    const vSwapClamped = Math.sign(vSwap) * clamp(Math.abs(vSwap), 0, V_SWAP_MAX);\n    return {\n        vTendencyClamped,\n        GFMClamped,\n        vSwapClamped\n    };\n}\nfunction computeMoodCoeffV1(i) {\n    const { vTendencyClamped, GFMClamped, vSwapClamped } = clampRanges(i);\n    // your formula:\n    // mood = (vTendency / GFM) + vSwap\n    // Then softly clamp to a sane engine range [0.2 .. 2.0]\n    let coeff = (vTendencyClamped || 0) / (GFMClamped || 1) + (vSwapClamped || 0);\n    coeff = clamp(coeff, 0.2, 2.0);\n    // resolve niches\n    const vTendencyIdx = binSigned(vTendencyClamped, vTendCuts, 6, 6);\n    const GFMIdx = binSigned(GFMClamped - 1 /* center around 1.0 */ , gfmCuts, 4, 4);\n    const vSwapIdx = binSigned(vSwapClamped, vSwapCuts, 6, 6);\n    const buckets = {\n        vTendencyIdx,\n        GFMIdx,\n        vSwapIdx\n    };\n    return {\n        coeff,\n        buckets\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvY29yZS9mZWF0dXJlcy9tb28tYXV4L21vb2QtZm9ybXVsYS50cyIsIm1hcHBpbmdzIjoiOzs7OztBQUFBLCtDQUErQztBQUMvQyxrRkFBa0Y7QUFDbEYsa0ZBQWtGO0FBYzNFLFNBQVNBLE1BQU1DLENBQVMsRUFBRUMsRUFBVSxFQUFFQyxFQUFVO0lBQ3JELE9BQU9DLEtBQUtDLEdBQUcsQ0FBQ0QsS0FBS0UsR0FBRyxDQUFDTCxHQUFHQyxLQUFLQztBQUNuQztBQUVBLFNBQVNJLFVBQ1BOLENBQVMsRUFDVE8sVUFBb0IsRUFDcEJDLE9BQWUsRUFDZkMsU0FBaUI7SUFFakIsNERBQTREO0lBQzVELE1BQU1DLElBQUlQLEtBQUtRLEdBQUcsQ0FBQ1g7SUFDbkIsSUFBSVksTUFBTTtJQUNWLE1BQU9BLE1BQU1MLFdBQVdNLE1BQU0sSUFBSUgsSUFBSUgsVUFBVSxDQUFDSyxJQUFJLENBQUVBO0lBQ3ZELCtEQUErRDtJQUMvRCxJQUFJWixLQUFLLEdBQUcsT0FBT0csS0FBS0MsR0FBRyxDQUFDUSxLQUFLSixVQUFVO0lBQzNDLDZCQUE2QjtJQUM3QixPQUFPQSxVQUFVTCxLQUFLQyxHQUFHLENBQUNRLEtBQUtILFlBQVk7QUFDN0M7QUFFQSxpREFBaUQ7QUFDakQsTUFBTUssYUFBYSxLQUFLQyxhQUFhLEtBQUsscUJBQXFCO0FBQy9ELE1BQU1DLFVBQVUsS0FBS0MsVUFBVTtBQUMvQixNQUFNQyxhQUFhLEtBQUssZ0JBQWdCO0FBRXhDLGdEQUFnRDtBQUNoRCxTQUFTQyxPQUFPZixHQUFXLEVBQUVDLEdBQVcsRUFBRWUsS0FBYTtJQUNyRCxNQUFNQyxPQUFPLENBQUNoQixNQUFNRCxHQUFFLElBQUtnQjtJQUMzQixPQUFPRSxNQUFNQyxJQUFJLENBQUM7UUFBRVYsUUFBUU8sUUFBUTtJQUFFLEdBQUcsQ0FBQ0ksR0FBR0MsSUFBTXJCLE1BQU1pQixPQUFRSSxDQUFBQSxJQUFJO0FBQ3ZFO0FBQ0EsTUFBTUMsWUFBWVAsT0FBTyxHQUFHSixZQUFZLElBQUkseUNBQXlDO0FBQ3JGLE1BQU1ZLFVBQVlSLE9BQU8sR0FBR0YsU0FBUztBQUNyQyxNQUFNVyxZQUFZVCxPQUFPLEdBQUdELFlBQVk7QUFFeEMsZ0JBQWdCO0FBQ2hCLFNBQVNXLFlBQVlKLENBQW9CO0lBQ3ZDLE1BQU1LLFlBQVlMLEVBQUVLLFNBQVMsSUFBSTtJQUNqQyxNQUFNQyxNQUFZTixFQUFFTSxHQUFHLElBQUksR0FBRyxxQkFBcUI7SUFDbkQsTUFBTUMsUUFBWVAsRUFBRU8sS0FBSyxJQUFJO0lBRTdCLE1BQU1DLG1CQUFtQjlCLEtBQUsrQixJQUFJLENBQUNKLGFBQWEvQixNQUFNSSxLQUFLUSxHQUFHLENBQUNtQixZQUFZLEdBQUdmO0lBQzlFLE1BQU1vQixhQUFtQnBDLE1BQU1nQyxLQUFLZixTQUFTQztJQUM3QyxNQUFNbUIsZUFBbUJqQyxLQUFLK0IsSUFBSSxDQUFDRixTQUFTakMsTUFBTUksS0FBS1EsR0FBRyxDQUFDcUIsUUFBUSxHQUFHZDtJQUN0RSxPQUFPO1FBQUVlO1FBQWtCRTtRQUFZQztJQUFhO0FBQ3REO0FBRU8sU0FBU0MsbUJBQW1CWixDQUFvQjtJQUNyRCxNQUFNLEVBQUVRLGdCQUFnQixFQUFFRSxVQUFVLEVBQUVDLFlBQVksRUFBRSxHQUFHUCxZQUFZSjtJQUVuRSxnQkFBZ0I7SUFDaEIsbUNBQW1DO0lBQ25DLHdEQUF3RDtJQUN4RCxJQUFJYSxRQUFRLENBQUdMLG9CQUFvQixLQUFNRSxDQUFBQSxjQUFjLEtBQVFDLENBQUFBLGdCQUFnQjtJQUMvRUUsUUFBUXZDLE1BQU11QyxPQUFPLEtBQUs7SUFFMUIsbUJBQW1CO0lBQ25CLE1BQU1DLGVBQWVqQyxVQUFVMkIsa0JBQWtCUCxXQUFXLEdBQUc7SUFDL0QsTUFBTWMsU0FBZWxDLFVBQVU2QixhQUFhLEVBQUUscUJBQXFCLEtBQUlSLFNBQVMsR0FBRztJQUNuRixNQUFNYyxXQUFlbkMsVUFBVThCLGNBQWNSLFdBQVcsR0FBRztJQUUzRCxNQUFNYyxVQUF1QjtRQUFFSDtRQUFjQztRQUFRQztJQUFTO0lBQzlELE9BQU87UUFBRUg7UUFBT0k7SUFBUTtBQUMxQiIsInNvdXJjZXMiOlsiSDpcXFVzZXJzXFxHdXNcXHNvdXJjZVxccmVwb1xcZHluYW1pY3NcXGR5bmFtaWNzLWJcXGNyeXB0b3BpLWR5bmFtaWNzXFxzcmNcXGNvcmVcXGZlYXR1cmVzXFxtb28tYXV4XFxtb29kLWZvcm11bGEudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gSW1wbGVtZW50czogbW9vZCA9ICh2VGVuZGVuY3kgLyBHRk0pICsgdlN3YXBcclxuLy8gd2l0aCB2VGVuZGVuY3kgaW4gWzAuNC4uMS4yXSwgR0ZNIGluIFswLjguLjEuMl0sIHZTd2FwIGluIFviiJIwLjUuLiswLjVdIChzaWduZWQpXHJcbi8vIHBsdXMgNsOXIHVwL2Rvd24gbmljaGVzIGZvciB2VGVuZGVuY3ksIDTDlyB1cC9kb3duIGZvciBHRk0sIDbDlyB1cC9kb3duIGZvciB2U3dhcC5cclxuXHJcbmV4cG9ydCB0eXBlIE1vb2RGb3JtdWxhSW5wdXRzID0ge1xyXG4gIHZUZW5kZW5jeTogbnVtYmVyIHwgbnVsbDsgLy8gdHJlbmQgaW50ZW5zaXR5IChzaWduZWQ7IGZvdW5kYXRpb25hbClcclxuICBHRk06IG51bWJlciB8IG51bGw7ICAgICAgIC8vIGdsb2JhbCBmbG93IG1vbWVudHVtIGZhY3RvciAo4omlMCBpZGVhbGx5KVxyXG4gIHZTd2FwOiBudW1iZXIgfCBudWxsOyAgICAgLy8gc3dhcCB2ZWxvY2l0eSAoc2lnbmVkKVxyXG59O1xyXG5cclxuZXhwb3J0IHR5cGUgTW9vZEJ1Y2tldHMgPSB7XHJcbiAgdlRlbmRlbmN5SWR4OiBudW1iZXI7IC8vIDAuLjUgKHVwKSwgNi4uMTEgKGRvd24pXHJcbiAgR0ZNSWR4OiBudW1iZXI7ICAgICAgIC8vIDAuLjMgKHVwKSwgNC4uNyAoZG93bilcclxuICB2U3dhcElkeDogbnVtYmVyOyAgICAgLy8gMC4uNSAodXApLCA2Li4xMSAoZG93bilcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjbGFtcCh4OiBudW1iZXIsIGxvOiBudW1iZXIsIGhpOiBudW1iZXIpIHtcclxuICByZXR1cm4gTWF0aC5taW4oTWF0aC5tYXgoeCwgbG8pLCBoaSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGJpblNpZ25lZChcclxuICB4OiBudW1iZXIsXHJcbiAgYm91bmRhcmllczogbnVtYmVyW10sXHJcbiAgdXBDb3VudDogbnVtYmVyLFxyXG4gIGRvd25Db3VudDogbnVtYmVyXHJcbikge1xyXG4gIC8vIGJvdW5kYXJpZXMgYXJlIG5vbi1uZWdhdGl2ZSBpbmNyZWFzaW5nLCBhcHBsaWVkIHRvIGFicyh4KVxyXG4gIGNvbnN0IGEgPSBNYXRoLmFicyh4KTtcclxuICBsZXQgaWR4ID0gMDtcclxuICB3aGlsZSAoaWR4IDwgYm91bmRhcmllcy5sZW5ndGggJiYgYSA+IGJvdW5kYXJpZXNbaWR4XSkgaWR4Kys7XHJcbiAgLy8gaWR4IOKIiCBbMC4uYm91bmRhcmllcy5sZW5ndGhdIG1hcHMgdG8gMC4uTi0xIGluc2lkZSBlYWNoIHNpZGVcclxuICBpZiAoeCA+PSAwKSByZXR1cm4gTWF0aC5taW4oaWR4LCB1cENvdW50IC0gMSk7XHJcbiAgLy8gc2hpZnQgdG8gXCJkb3duXCIgYmFuZCBzcGFjZVxyXG4gIHJldHVybiB1cENvdW50ICsgTWF0aC5taW4oaWR4LCBkb3duQ291bnQgLSAxKTtcclxufVxyXG5cclxuLy8gLS0tIGJ1Y2tldCBzcGVjcyAodHVuZWFibGUsIGRldGVybWluaXN0aWMpIC0tLVxyXG5jb25zdCBWX1RFTkRfTUlOID0gMC40LCBWX1RFTkRfTUFYID0gMS4yOyAvLyBmb3VuZGF0aW9uYWwgcmFuZ2VcclxuY29uc3QgR0ZNX01JTiA9IDAuOCwgR0ZNX01BWCA9IDEuMjtcclxuY29uc3QgVl9TV0FQX01BWCA9IDAuNTsgLy8gbWFnbml0dWRlIGNhcFxyXG5cclxuLy8gQnVpbGQgZXF1YWwtd2lkdGggY3V0IHBvaW50cyBmb3IgY29udmVuaWVuY2U6XHJcbmZ1bmN0aW9uIGVxQ3V0cyhtaW46IG51bWJlciwgbWF4OiBudW1iZXIsIHBhcnRzOiBudW1iZXIpIHtcclxuICBjb25zdCBzdGVwID0gKG1heCAtIG1pbikgLyBwYXJ0cztcclxuICByZXR1cm4gQXJyYXkuZnJvbSh7IGxlbmd0aDogcGFydHMgLSAxIH0sIChfLCBpKSA9PiBtaW4gKyBzdGVwICogKGkgKyAxKSk7XHJcbn1cclxuY29uc3QgdlRlbmRDdXRzID0gZXFDdXRzKDAsIFZfVEVORF9NQVgsIDYpOyAvLyBhYnNvbHV0ZSBidWNrZXRzLCB6ZXJvIGhhbmRsZWQgYnkgc2lnblxyXG5jb25zdCBnZm1DdXRzICAgPSBlcUN1dHMoMCwgR0ZNX01BWCwgNCk7XHJcbmNvbnN0IHZTd2FwQ3V0cyA9IGVxQ3V0cygwLCBWX1NXQVBfTUFYLCA2KTtcclxuXHJcbi8vIFNpZ25lZCBjbGFtcHNcclxuZnVuY3Rpb24gY2xhbXBSYW5nZXMoaTogTW9vZEZvcm11bGFJbnB1dHMpIHtcclxuICBjb25zdCB2VGVuZGVuY3kgPSBpLnZUZW5kZW5jeSA/PyAwO1xyXG4gIGNvbnN0IEdGTSAgICAgICA9IGkuR0ZNID8/IDE7IC8vIG5ldXRyYWwgaWYgbWlzc2luZ1xyXG4gIGNvbnN0IHZTd2FwICAgICA9IGkudlN3YXAgPz8gMDtcclxuXHJcbiAgY29uc3QgdlRlbmRlbmN5Q2xhbXBlZCA9IE1hdGguc2lnbih2VGVuZGVuY3kpICogY2xhbXAoTWF0aC5hYnModlRlbmRlbmN5KSwgMCwgVl9URU5EX01BWCk7XHJcbiAgY29uc3QgR0ZNQ2xhbXBlZCAgICAgICA9IGNsYW1wKEdGTSwgR0ZNX01JTiwgR0ZNX01BWCk7XHJcbiAgY29uc3QgdlN3YXBDbGFtcGVkICAgICA9IE1hdGguc2lnbih2U3dhcCkgKiBjbGFtcChNYXRoLmFicyh2U3dhcCksIDAsIFZfU1dBUF9NQVgpO1xyXG4gIHJldHVybiB7IHZUZW5kZW5jeUNsYW1wZWQsIEdGTUNsYW1wZWQsIHZTd2FwQ2xhbXBlZCB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY29tcHV0ZU1vb2RDb2VmZlYxKGk6IE1vb2RGb3JtdWxhSW5wdXRzKSB7XHJcbiAgY29uc3QgeyB2VGVuZGVuY3lDbGFtcGVkLCBHRk1DbGFtcGVkLCB2U3dhcENsYW1wZWQgfSA9IGNsYW1wUmFuZ2VzKGkpO1xyXG5cclxuICAvLyB5b3VyIGZvcm11bGE6XHJcbiAgLy8gbW9vZCA9ICh2VGVuZGVuY3kgLyBHRk0pICsgdlN3YXBcclxuICAvLyBUaGVuIHNvZnRseSBjbGFtcCB0byBhIHNhbmUgZW5naW5lIHJhbmdlIFswLjIgLi4gMi4wXVxyXG4gIGxldCBjb2VmZiA9ICggKHZUZW5kZW5jeUNsYW1wZWQgfHwgMCkgLyAoR0ZNQ2xhbXBlZCB8fCAxKSApICsgKHZTd2FwQ2xhbXBlZCB8fCAwKTtcclxuICBjb2VmZiA9IGNsYW1wKGNvZWZmLCAwLjIsIDIuMCk7XHJcblxyXG4gIC8vIHJlc29sdmUg4oCcbmljaGVz4oCdXHJcbiAgY29uc3QgdlRlbmRlbmN5SWR4ID0gYmluU2lnbmVkKHZUZW5kZW5jeUNsYW1wZWQsIHZUZW5kQ3V0cywgNiwgNik7XHJcbiAgY29uc3QgR0ZNSWR4ICAgICAgID0gYmluU2lnbmVkKEdGTUNsYW1wZWQgLSAxIC8qIGNlbnRlciBhcm91bmQgMS4wICovLCBnZm1DdXRzLCA0LCA0KTtcclxuICBjb25zdCB2U3dhcElkeCAgICAgPSBiaW5TaWduZWQodlN3YXBDbGFtcGVkLCB2U3dhcEN1dHMsIDYsIDYpO1xyXG5cclxuICBjb25zdCBidWNrZXRzOiBNb29kQnVja2V0cyA9IHsgdlRlbmRlbmN5SWR4LCBHRk1JZHgsIHZTd2FwSWR4IH07XHJcbiAgcmV0dXJuIHsgY29lZmYsIGJ1Y2tldHMgfTtcclxufVxyXG4iXSwibmFtZXMiOlsiY2xhbXAiLCJ4IiwibG8iLCJoaSIsIk1hdGgiLCJtaW4iLCJtYXgiLCJiaW5TaWduZWQiLCJib3VuZGFyaWVzIiwidXBDb3VudCIsImRvd25Db3VudCIsImEiLCJhYnMiLCJpZHgiLCJsZW5ndGgiLCJWX1RFTkRfTUlOIiwiVl9URU5EX01BWCIsIkdGTV9NSU4iLCJHRk1fTUFYIiwiVl9TV0FQX01BWCIsImVxQ3V0cyIsInBhcnRzIiwic3RlcCIsIkFycmF5IiwiZnJvbSIsIl8iLCJpIiwidlRlbmRDdXRzIiwiZ2ZtQ3V0cyIsInZTd2FwQ3V0cyIsImNsYW1wUmFuZ2VzIiwidlRlbmRlbmN5IiwiR0ZNIiwidlN3YXAiLCJ2VGVuZGVuY3lDbGFtcGVkIiwic2lnbiIsIkdGTUNsYW1wZWQiLCJ2U3dhcENsYW1wZWQiLCJjb21wdXRlTW9vZENvZWZmVjEiLCJjb2VmZiIsInZUZW5kZW5jeUlkeCIsIkdGTUlkeCIsInZTd2FwSWR4IiwiYnVja2V0cyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/core/features/moo-aux/mood-formula.ts\n");

/***/ }),

/***/ "(rsc)/./src/core/features/moo-aux/tiers.ts":
/*!********************************************!*\
  !*** ./src/core/features/moo-aux/tiers.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DEFAULT_TIER_RULES: () => (/* binding */ DEFAULT_TIER_RULES),\n/* harmony export */   MOOD_CLASS_ROWS: () => (/* binding */ MOOD_CLASS_ROWS),\n/* harmony export */   MOOD_CLASS_WEIGHTS: () => (/* binding */ MOOD_CLASS_WEIGHTS),\n/* harmony export */   getTierWeighting: () => (/* binding */ getTierWeighting)\n/* harmony export */ });\n// src/core/features/moo-aux/tiers.ts\n/** ---------- legacy MEA bins (id_pct  weight) ---------- */ // default bins (tune freely)\nconst DEFAULT_TIER_RULES = [\n    {\n        key: \"alpha\",\n        name: \"Alpha\",\n        minAbs: 0.00016,\n        maxAbs: 0.00032,\n        weight: 0.15\n    },\n    {\n        key: \"beta\",\n        name: \"Beta\",\n        minAbs: 0.00033,\n        maxAbs: 0.00045,\n        weight: 0.55\n    },\n    {\n        key: \"gamma\",\n        name: \"Gamma\",\n        minAbs: 0.00046,\n        maxAbs: 0.00076,\n        weight: 1.15\n    },\n    {\n        key: \"delta\",\n        name: \"Delta\",\n        minAbs: 0.00077,\n        maxAbs: 0.00120,\n        weight: 0.65\n    },\n    {\n        key: \"epsilon\",\n        name: \"Epsilon\",\n        minAbs: 0.00121,\n        maxAbs: null,\n        weight: 0.50\n    }\n];\nfunction getTierWeighting(id_pct, rules = DEFAULT_TIER_RULES) {\n    const a = Math.abs(Number(id_pct || 0));\n    const r = rules.find((r)=>a >= r.minAbs && (r.maxAbs == null || a <= r.maxAbs));\n    return r ? r.weight : 0;\n}\n/**\r\n * Base per-mood weights (mirror of engine presets).\r\n * These are normalized inside the engines at runtime; keep relative shape here.\r\n */ const MOOD_CLASS_WEIGHTS = {\n    std: {\n        vTendency: 0.28,\n        vSwap: 0.22,\n        Volt: 0.16,\n        Inertia: 0.14,\n        Amp: 0.10,\n        Disruption: 0.10\n    },\n    trl: {\n        vTendency: 0.40,\n        vSwap: 0.25,\n        Inertia: 0.18,\n        Volt: 0.07,\n        Amp: 0.05,\n        Disruption: 0.05\n    },\n    rev: {\n        vSwap: 0.34,\n        Disruption: 0.20,\n        Amp: 0.16,\n        vTendency: 0.16,\n        Volt: 0.08,\n        Inertia: 0.06\n    },\n    inj: {\n        GFMdelta: 0.38,\n        vSwap: 0.22,\n        Volt: 0.18,\n        Disruption: 0.12,\n        Inertia: 0.05,\n        Amp: 0.05\n    },\n    drn: {\n        GFMdelta: 0.36,\n        Volt: 0.22,\n        vSwap: 0.16,\n        Disruption: 0.12,\n        Inertia: 0.08,\n        Amp: 0.06\n    },\n    wnd: {\n        Inertia: 0.36,\n        Volt: 0.18,\n        Amp: 0.10,\n        vSwap: 0.12,\n        vTendency: 0.14,\n        Disruption: 0.10\n    },\n    emg: {\n        Disruption: 0.30,\n        Volt: 0.26,\n        vSwap: 0.20,\n        vTendency: 0.12,\n        Amp: 0.07,\n        Inertia: 0.05\n    },\n    stb: {\n        Inertia: 0.44,\n        vTendency: 0.18,\n        vSwap: 0.16,\n        Volt: 0.08,\n        Amp: 0.06,\n        Disruption: 0.08\n    },\n    flo: {\n        Amp: 0.30,\n        vSwap: 0.28,\n        Volt: 0.16,\n        vTendency: 0.12,\n        Disruption: 0.08,\n        Inertia: 0.06\n    }\n};\nconst MOOD_CLASS_ROWS = Object.keys(MOOD_CLASS_WEIGHTS).map((mn)=>({\n        mn,\n        weights: MOOD_CLASS_WEIGHTS[mn],\n        intervals: DEFAULT_TIER_RULES\n    }));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvY29yZS9mZWF0dXJlcy9tb28tYXV4L3RpZXJzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQSxxQ0FBcUM7QUFFckMsNERBQTRELEdBUzVELDZCQUE2QjtBQUN0QixNQUFNQSxxQkFBaUM7SUFDNUM7UUFBRUMsS0FBSztRQUFXQyxNQUFNO1FBQVdDLFFBQVE7UUFBU0MsUUFBUTtRQUFTQyxRQUFRO0lBQUs7SUFDbEY7UUFBRUosS0FBSztRQUFXQyxNQUFNO1FBQVdDLFFBQVE7UUFBU0MsUUFBUTtRQUFTQyxRQUFRO0lBQUs7SUFDbEY7UUFBRUosS0FBSztRQUFXQyxNQUFNO1FBQVdDLFFBQVE7UUFBU0MsUUFBUTtRQUFTQyxRQUFRO0lBQUs7SUFDbEY7UUFBRUosS0FBSztRQUFXQyxNQUFNO1FBQVdDLFFBQVE7UUFBU0MsUUFBUTtRQUFTQyxRQUFRO0lBQUs7SUFDbEY7UUFBRUosS0FBSztRQUFXQyxNQUFNO1FBQVdDLFFBQVE7UUFBU0MsUUFBUTtRQUFVQyxRQUFRO0lBQUs7Q0FDcEYsQ0FBQztBQUVLLFNBQVNDLGlCQUFpQkMsTUFBYyxFQUFFQyxRQUFvQlIsa0JBQWtCO0lBQ3JGLE1BQU1TLElBQUlDLEtBQUtDLEdBQUcsQ0FBQ0MsT0FBT0wsVUFBVTtJQUNwQyxNQUFNTSxJQUFJTCxNQUFNTSxJQUFJLENBQUNELENBQUFBLElBQUtKLEtBQUtJLEVBQUVWLE1BQU0sSUFBS1UsQ0FBQUEsRUFBRVQsTUFBTSxJQUFJLFFBQVFLLEtBQUtJLEVBQUVULE1BQU07SUFDN0UsT0FBT1MsSUFBSUEsRUFBRVIsTUFBTSxHQUFHO0FBQ3hCO0FBU0E7OztDQUdDLEdBQ00sTUFBTVUscUJBQXFFO0lBQ2hGQyxLQUFJO1FBQUVDLFdBQVU7UUFBTUMsT0FBTTtRQUFNQyxNQUFLO1FBQU1DLFNBQVE7UUFBTUMsS0FBSTtRQUFNQyxZQUFXO0lBQUs7SUFDckZDLEtBQUk7UUFBRU4sV0FBVTtRQUFNQyxPQUFNO1FBQU1FLFNBQVE7UUFBTUQsTUFBSztRQUFNRSxLQUFJO1FBQU1DLFlBQVc7SUFBSztJQUNyRkUsS0FBSTtRQUFFTixPQUFNO1FBQU1JLFlBQVc7UUFBTUQsS0FBSTtRQUFNSixXQUFVO1FBQU1FLE1BQUs7UUFBTUMsU0FBUTtJQUFLO0lBQ3JGSyxLQUFJO1FBQUVDLFVBQVM7UUFBTVIsT0FBTTtRQUFNQyxNQUFLO1FBQU1HLFlBQVc7UUFBTUYsU0FBUTtRQUFNQyxLQUFJO0lBQUs7SUFDcEZNLEtBQUk7UUFBRUQsVUFBUztRQUFNUCxNQUFLO1FBQU1ELE9BQU07UUFBTUksWUFBVztRQUFNRixTQUFRO1FBQU1DLEtBQUk7SUFBSztJQUNwRk8sS0FBSTtRQUFFUixTQUFRO1FBQU1ELE1BQUs7UUFBTUUsS0FBSTtRQUFNSCxPQUFNO1FBQU1ELFdBQVU7UUFBTUssWUFBVztJQUFLO0lBQ3JGTyxLQUFJO1FBQUVQLFlBQVc7UUFBTUgsTUFBSztRQUFNRCxPQUFNO1FBQU1ELFdBQVU7UUFBTUksS0FBSTtRQUFNRCxTQUFRO0lBQUs7SUFDckZVLEtBQUk7UUFBRVYsU0FBUTtRQUFNSCxXQUFVO1FBQU1DLE9BQU07UUFBTUMsTUFBSztRQUFNRSxLQUFJO1FBQU1DLFlBQVc7SUFBSztJQUNyRlMsS0FBSTtRQUFFVixLQUFJO1FBQU1ILE9BQU07UUFBTUMsTUFBSztRQUFNRixXQUFVO1FBQU1LLFlBQVc7UUFBTUYsU0FBUTtJQUFLO0FBQ3ZGLEVBQUU7QUFZSyxNQUFNWSxrQkFBa0MsT0FBUUUsSUFBSSxDQUFDbkIsb0JBQTZCb0IsR0FBRyxDQUFDQyxDQUFBQSxLQUFPO1FBQ2xHQTtRQUNBQyxTQUFTdEIsa0JBQWtCLENBQUNxQixHQUFHO1FBQy9CRSxXQUFXdEM7SUFDYixJQUFJIiwic291cmNlcyI6WyJIOlxcVXNlcnNcXEd1c1xcc291cmNlXFxyZXBvXFxkeW5hbWljc1xcZHluYW1pY3MtYlxcY3J5cHRvcGktZHluYW1pY3NcXHNyY1xcY29yZVxcZmVhdHVyZXNcXG1vby1hdXhcXHRpZXJzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9jb3JlL2ZlYXR1cmVzL21vby1hdXgvdGllcnMudHNcclxuXHJcbi8qKiAtLS0tLS0tLS0tIGxlZ2FjeSBNRUEgYmlucyAoaWRfcGN0IOKGkiB3ZWlnaHQpIC0tLS0tLS0tLS0gKi9cclxuZXhwb3J0IHR5cGUgVGllclJ1bGUgPSB7XHJcbiAgbWluQWJzOiBudW1iZXI7ICAgICAgICAgICAgICAgIC8vIGluY2x1c2l2ZVxyXG4gIG1heEFiczogbnVtYmVyIHwgbnVsbDsgICAgICAgICAvLyBpbmNsdXNpdmUgd2hlbiBudW1iZXI7IG51bGwgPT4gK+KInlxyXG4gIHdlaWdodDogbnVtYmVyOyAgICAgICAgICAgICAgICAvLyB1bnNpZ25lZCBiaW4gd2VpZ2h0XHJcbiAgbmFtZTogc3RyaW5nOyAgICAgICAgICAgICAgICAgIC8vIFwiQWxwaGFcIiB8IC4uLlxyXG4gIGtleTogXCJhbHBoYVwifFwiYmV0YVwifFwiZ2FtbWFcInxcImRlbHRhXCJ8XCJlcHNpbG9uXCI7XHJcbn07XHJcblxyXG4vLyBkZWZhdWx0IGJpbnMgKHR1bmUgZnJlZWx5KVxyXG5leHBvcnQgY29uc3QgREVGQVVMVF9USUVSX1JVTEVTOiBUaWVyUnVsZVtdID0gW1xyXG4gIHsga2V5OiBcImFscGhhXCIsICAgbmFtZTogXCJBbHBoYVwiLCAgIG1pbkFiczogMC4wMDAxNiwgbWF4QWJzOiAwLjAwMDMyLCB3ZWlnaHQ6IDAuMTUgfSxcclxuICB7IGtleTogXCJiZXRhXCIsICAgIG5hbWU6IFwiQmV0YVwiLCAgICBtaW5BYnM6IDAuMDAwMzMsIG1heEFiczogMC4wMDA0NSwgd2VpZ2h0OiAwLjU1IH0sXHJcbiAgeyBrZXk6IFwiZ2FtbWFcIiwgICBuYW1lOiBcIkdhbW1hXCIsICAgbWluQWJzOiAwLjAwMDQ2LCBtYXhBYnM6IDAuMDAwNzYsIHdlaWdodDogMS4xNSB9LFxyXG4gIHsga2V5OiBcImRlbHRhXCIsICAgbmFtZTogXCJEZWx0YVwiLCAgIG1pbkFiczogMC4wMDA3NywgbWF4QWJzOiAwLjAwMTIwLCB3ZWlnaHQ6IDAuNjUgfSxcclxuICB7IGtleTogXCJlcHNpbG9uXCIsIG5hbWU6IFwiRXBzaWxvblwiLCBtaW5BYnM6IDAuMDAxMjEsIG1heEFiczogbnVsbCwgICAgIHdlaWdodDogMC41MCB9LFxyXG5dO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFRpZXJXZWlnaHRpbmcoaWRfcGN0OiBudW1iZXIsIHJ1bGVzOiBUaWVyUnVsZVtdID0gREVGQVVMVF9USUVSX1JVTEVTKTogbnVtYmVyIHtcclxuICBjb25zdCBhID0gTWF0aC5hYnMoTnVtYmVyKGlkX3BjdCB8fCAwKSk7XHJcbiAgY29uc3QgciA9IHJ1bGVzLmZpbmQociA9PiBhID49IHIubWluQWJzICYmIChyLm1heEFicyA9PSBudWxsIHx8IGEgPD0gci5tYXhBYnMpKTtcclxuICByZXR1cm4gciA/IHIud2VpZ2h0IDogMDtcclxufVxyXG5cclxuLyoqIC0tLS0tLS0tLS0gbW9vZCBjbGFzc2VzIChlbmdpbmUtYWxpZ25lZCkgLS0tLS0tLS0tLSAqL1xyXG5cclxuZXhwb3J0IHR5cGUgTW4gPSBcImlualwifFwiZHJuXCJ8XCJ0cmxcInxcInJldlwifFwid25kXCJ8XCJlbWdcInxcInN0ZFwifFwic3RiXCJ8XCJmbG9cIjtcclxuZXhwb3J0IHR5cGUgTWV0cmljS2V5ID1cclxuICB8IFwiR0ZNZGVsdGFcIiB8IFwidlN3YXBcIiB8IFwidlRlbmRlbmN5XCJcclxuICB8IFwiVm9sdFwiIHwgXCJJbmVydGlhXCIgfCBcIkRpc3J1cHRpb25cIiB8IFwiQW1wXCIgfCBcIk1FQVwiO1xyXG5cclxuLyoqXHJcbiAqIEJhc2UgcGVyLW1vb2Qgd2VpZ2h0cyAobWlycm9yIG9mIGVuZ2luZSBwcmVzZXRzKS5cclxuICogVGhlc2UgYXJlIG5vcm1hbGl6ZWQgaW5zaWRlIHRoZSBlbmdpbmVzIGF0IHJ1bnRpbWU7IGtlZXAgcmVsYXRpdmUgc2hhcGUgaGVyZS5cclxuICovXHJcbmV4cG9ydCBjb25zdCBNT09EX0NMQVNTX1dFSUdIVFM6IFJlY29yZDxNbiwgUGFydGlhbDxSZWNvcmQ8TWV0cmljS2V5LCBudW1iZXI+Pj4gPSB7XHJcbiAgc3RkOnsgdlRlbmRlbmN5OjAuMjgsIHZTd2FwOjAuMjIsIFZvbHQ6MC4xNiwgSW5lcnRpYTowLjE0LCBBbXA6MC4xMCwgRGlzcnVwdGlvbjowLjEwIH0sXHJcbiAgdHJsOnsgdlRlbmRlbmN5OjAuNDAsIHZTd2FwOjAuMjUsIEluZXJ0aWE6MC4xOCwgVm9sdDowLjA3LCBBbXA6MC4wNSwgRGlzcnVwdGlvbjowLjA1IH0sXHJcbiAgcmV2OnsgdlN3YXA6MC4zNCwgRGlzcnVwdGlvbjowLjIwLCBBbXA6MC4xNiwgdlRlbmRlbmN5OjAuMTYsIFZvbHQ6MC4wOCwgSW5lcnRpYTowLjA2IH0sXHJcbiAgaW5qOnsgR0ZNZGVsdGE6MC4zOCwgdlN3YXA6MC4yMiwgVm9sdDowLjE4LCBEaXNydXB0aW9uOjAuMTIsIEluZXJ0aWE6MC4wNSwgQW1wOjAuMDUgfSxcclxuICBkcm46eyBHRk1kZWx0YTowLjM2LCBWb2x0OjAuMjIsIHZTd2FwOjAuMTYsIERpc3J1cHRpb246MC4xMiwgSW5lcnRpYTowLjA4LCBBbXA6MC4wNiB9LFxyXG4gIHduZDp7IEluZXJ0aWE6MC4zNiwgVm9sdDowLjE4LCBBbXA6MC4xMCwgdlN3YXA6MC4xMiwgdlRlbmRlbmN5OjAuMTQsIERpc3J1cHRpb246MC4xMCB9LFxyXG4gIGVtZzp7IERpc3J1cHRpb246MC4zMCwgVm9sdDowLjI2LCB2U3dhcDowLjIwLCB2VGVuZGVuY3k6MC4xMiwgQW1wOjAuMDcsIEluZXJ0aWE6MC4wNSB9LFxyXG4gIHN0Yjp7IEluZXJ0aWE6MC40NCwgdlRlbmRlbmN5OjAuMTgsIHZTd2FwOjAuMTYsIFZvbHQ6MC4wOCwgQW1wOjAuMDYsIERpc3J1cHRpb246MC4wOCB9LFxyXG4gIGZsbzp7IEFtcDowLjMwLCB2U3dhcDowLjI4LCBWb2x0OjAuMTYsIHZUZW5kZW5jeTowLjEyLCBEaXNydXB0aW9uOjAuMDgsIEluZXJ0aWE6MC4wNiB9LFxyXG59O1xyXG5cclxuLyoqXHJcbiAqIE9wdGlvbmFsOiBwZXItbW9vZCDigJxpbnRlcnZhbCBsaW5lc+KAnSB5b3Ugd2FudCB0byBkaXNwbGF5IGluIFVJIG9yIHVzZSBmb3IgcmFuayBndWlkYW5jZS5cclxuICogRm9yIG5vdyB3ZSByZXVzZSB0aGUgaWRfcGN0IERFRkFVTFRfVElFUl9SVUxFUyBhcyB0aGUgcmVmZXJlbmNlIGxpbmUuXHJcbiAqL1xyXG5leHBvcnQgdHlwZSBNb29kQ2xhc3NSb3cgPSB7XHJcbiAgbW46IE1uO1xyXG4gIHdlaWdodHM6IFBhcnRpYWw8UmVjb3JkPE1ldHJpY0tleSwgbnVtYmVyPj47XHJcbiAgaW50ZXJ2YWxzOiBUaWVyUnVsZVtdOyAgICAgICAgICAvLyByZWZlcmVuY2UgYmFuZHMgYXR0YWNoZWQgdG8gdGhpcyBtb29kIHJvd1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IE1PT0RfQ0xBU1NfUk9XUzogTW9vZENsYXNzUm93W10gPSAoT2JqZWN0LmtleXMoTU9PRF9DTEFTU19XRUlHSFRTKSBhcyBNbltdKS5tYXAobW4gPT4gKHtcclxuICBtbixcclxuICB3ZWlnaHRzOiBNT09EX0NMQVNTX1dFSUdIVFNbbW5dLFxyXG4gIGludGVydmFsczogREVGQVVMVF9USUVSX1JVTEVTLFxyXG59KSk7XHJcblxyXG4iXSwibmFtZXMiOlsiREVGQVVMVF9USUVSX1JVTEVTIiwia2V5IiwibmFtZSIsIm1pbkFicyIsIm1heEFicyIsIndlaWdodCIsImdldFRpZXJXZWlnaHRpbmciLCJpZF9wY3QiLCJydWxlcyIsImEiLCJNYXRoIiwiYWJzIiwiTnVtYmVyIiwiciIsImZpbmQiLCJNT09EX0NMQVNTX1dFSUdIVFMiLCJzdGQiLCJ2VGVuZGVuY3kiLCJ2U3dhcCIsIlZvbHQiLCJJbmVydGlhIiwiQW1wIiwiRGlzcnVwdGlvbiIsInRybCIsInJldiIsImluaiIsIkdGTWRlbHRhIiwiZHJuIiwid25kIiwiZW1nIiwic3RiIiwiZmxvIiwiTU9PRF9DTEFTU19ST1dTIiwiT2JqZWN0Iiwia2V5cyIsIm1hcCIsIm1uIiwid2VpZ2h0cyIsImludGVydmFscyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/core/features/moo-aux/tiers.ts\n");

/***/ }),

/***/ "(rsc)/./src/core/sources/binanceClient.ts":
/*!*******************************************!*\
  !*** ./src/core/sources/binanceClient.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   fetchJson: () => (/* binding */ fetchJson)\n/* harmony export */ });\n// src/core/sources/binanceClient.ts\n// Lightweight helper for Binance public REST calls used across the pipeline.\nconst DEFAULT_BASE = process.env.BINANCE_BASE_URL?.trim() || \"https://api.binance.com\";\nfunction buildUrl(path, query) {\n    const url = path.startsWith(\"http\") ? new URL(path) : new URL(path, DEFAULT_BASE);\n    if (query) {\n        for (const [key, value] of Object.entries(query)){\n            if (value === undefined || value === null) continue;\n            url.searchParams.set(key, String(value));\n        }\n    }\n    return url;\n}\nasync function fetchJson(path, query, init) {\n    const url = buildUrl(path, query);\n    const response = await fetch(url.toString(), {\n        method: \"GET\",\n        headers: {\n            Accept: \"application/json\",\n            ...init?.headers ?? {}\n        },\n        ...init\n    });\n    if (!response.ok) {\n        const text = await response.text().catch(()=>\"<no-body>\");\n        throw new Error(`binance ${url.pathname} -> ${response.status} ${text}`);\n    }\n    return await response.json();\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvY29yZS9zb3VyY2VzL2JpbmFuY2VDbGllbnQudHMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBLG9DQUFvQztBQUNwQyw2RUFBNkU7QUFFN0UsTUFBTUEsZUFBZUMsUUFBUUMsR0FBRyxDQUFDQyxnQkFBZ0IsRUFBRUMsVUFBVTtBQUU3RCxTQUFTQyxTQUFTQyxJQUFZLEVBQUVDLEtBQW1EO0lBQ2pGLE1BQU1DLE1BQU1GLEtBQUtHLFVBQVUsQ0FBQyxVQUFVLElBQUlDLElBQUlKLFFBQVEsSUFBSUksSUFBSUosTUFBTU47SUFDcEUsSUFBSU8sT0FBTztRQUNULEtBQUssTUFBTSxDQUFDSSxLQUFLQyxNQUFNLElBQUlDLE9BQU9DLE9BQU8sQ0FBQ1AsT0FBUTtZQUNoRCxJQUFJSyxVQUFVRyxhQUFhSCxVQUFVLE1BQU07WUFDM0NKLElBQUlRLFlBQVksQ0FBQ0MsR0FBRyxDQUFDTixLQUFLTyxPQUFPTjtRQUNuQztJQUNGO0lBQ0EsT0FBT0o7QUFDVDtBQUVPLGVBQWVXLFVBQ3BCYixJQUFZLEVBQ1pDLEtBQW1ELEVBQ25EYSxJQUFrQjtJQUVsQixNQUFNWixNQUFNSCxTQUFTQyxNQUFNQztJQUMzQixNQUFNYyxXQUFXLE1BQU1DLE1BQU1kLElBQUllLFFBQVEsSUFBSTtRQUMzQ0MsUUFBUTtRQUNSQyxTQUFTO1lBQUVDLFFBQVE7WUFBb0IsR0FBSU4sTUFBTUssV0FBVyxDQUFDLENBQUM7UUFBRTtRQUNoRSxHQUFHTCxJQUFJO0lBQ1Q7SUFFQSxJQUFJLENBQUNDLFNBQVNNLEVBQUUsRUFBRTtRQUNoQixNQUFNQyxPQUFPLE1BQU1QLFNBQVNPLElBQUksR0FBR0MsS0FBSyxDQUFDLElBQU07UUFDL0MsTUFBTSxJQUFJQyxNQUFNLENBQUMsUUFBUSxFQUFFdEIsSUFBSXVCLFFBQVEsQ0FBQyxJQUFJLEVBQUVWLFNBQVNXLE1BQU0sQ0FBQyxDQUFDLEVBQUVKLE1BQU07SUFDekU7SUFFQSxPQUFRLE1BQU1QLFNBQVNZLElBQUk7QUFDN0IiLCJzb3VyY2VzIjpbIkg6XFxVc2Vyc1xcR3VzXFxzb3VyY2VcXHJlcG9cXGR5bmFtaWNzXFxkeW5hbWljcy1iXFxjcnlwdG9waS1keW5hbWljc1xcc3JjXFxjb3JlXFxzb3VyY2VzXFxiaW5hbmNlQ2xpZW50LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9jb3JlL3NvdXJjZXMvYmluYW5jZUNsaWVudC50c1xuLy8gTGlnaHR3ZWlnaHQgaGVscGVyIGZvciBCaW5hbmNlIHB1YmxpYyBSRVNUIGNhbGxzIHVzZWQgYWNyb3NzIHRoZSBwaXBlbGluZS5cblxuY29uc3QgREVGQVVMVF9CQVNFID0gcHJvY2Vzcy5lbnYuQklOQU5DRV9CQVNFX1VSTD8udHJpbSgpIHx8IFwiaHR0cHM6Ly9hcGkuYmluYW5jZS5jb21cIjtcblxuZnVuY3Rpb24gYnVpbGRVcmwocGF0aDogc3RyaW5nLCBxdWVyeT86IFJlY29yZDxzdHJpbmcsIHN0cmluZyB8IG51bWJlciB8IHVuZGVmaW5lZD4pIHtcbiAgY29uc3QgdXJsID0gcGF0aC5zdGFydHNXaXRoKFwiaHR0cFwiKSA/IG5ldyBVUkwocGF0aCkgOiBuZXcgVVJMKHBhdGgsIERFRkFVTFRfQkFTRSk7XG4gIGlmIChxdWVyeSkge1xuICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHF1ZXJ5KSkge1xuICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09IG51bGwpIGNvbnRpbnVlO1xuICAgICAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoa2V5LCBTdHJpbmcodmFsdWUpKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHVybDtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZldGNoSnNvbjxUID0gdW5rbm93bj4oXG4gIHBhdGg6IHN0cmluZyxcbiAgcXVlcnk/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmcgfCBudW1iZXIgfCB1bmRlZmluZWQ+LFxuICBpbml0PzogUmVxdWVzdEluaXQsXG4pOiBQcm9taXNlPFQ+IHtcbiAgY29uc3QgdXJsID0gYnVpbGRVcmwocGF0aCwgcXVlcnkpO1xuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybC50b1N0cmluZygpLCB7XG4gICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgIGhlYWRlcnM6IHsgQWNjZXB0OiBcImFwcGxpY2F0aW9uL2pzb25cIiwgLi4uKGluaXQ/LmhlYWRlcnMgPz8ge30pIH0sXG4gICAgLi4uaW5pdCxcbiAgfSk7XG5cbiAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgIGNvbnN0IHRleHQgPSBhd2FpdCByZXNwb25zZS50ZXh0KCkuY2F0Y2goKCkgPT4gXCI8bm8tYm9keT5cIik7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBiaW5hbmNlICR7dXJsLnBhdGhuYW1lfSAtPiAke3Jlc3BvbnNlLnN0YXR1c30gJHt0ZXh0fWApO1xuICB9XG5cbiAgcmV0dXJuIChhd2FpdCByZXNwb25zZS5qc29uKCkpIGFzIFQ7XG59XHJcbiJdLCJuYW1lcyI6WyJERUZBVUxUX0JBU0UiLCJwcm9jZXNzIiwiZW52IiwiQklOQU5DRV9CQVNFX1VSTCIsInRyaW0iLCJidWlsZFVybCIsInBhdGgiLCJxdWVyeSIsInVybCIsInN0YXJ0c1dpdGgiLCJVUkwiLCJrZXkiLCJ2YWx1ZSIsIk9iamVjdCIsImVudHJpZXMiLCJ1bmRlZmluZWQiLCJzZWFyY2hQYXJhbXMiLCJzZXQiLCJTdHJpbmciLCJmZXRjaEpzb24iLCJpbml0IiwicmVzcG9uc2UiLCJmZXRjaCIsInRvU3RyaW5nIiwibWV0aG9kIiwiaGVhZGVycyIsIkFjY2VwdCIsIm9rIiwidGV4dCIsImNhdGNoIiwiRXJyb3IiLCJwYXRobmFtZSIsInN0YXR1cyIsImpzb24iXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/core/sources/binanceClient.ts\n");

/***/ }),

/***/ "(rsc)/./src/core/sources/pairs.ts":
/*!***********************************!*\
  !*** ./src/core/sources/pairs.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   buildValidPairsFromCoins: () => (/* binding */ buildValidPairsFromCoins),\n/* harmony export */   fetchTradableSymbols: () => (/* binding */ fetchTradableSymbols),\n/* harmony export */   parseSymbol: () => (/* binding */ parseSymbol),\n/* harmony export */   validatePair: () => (/* binding */ validatePair)\n/* harmony export */ });\n/* harmony import */ var _core_sources_binanceClient__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/core/sources/binanceClient */ \"(rsc)/./src/core/sources/binanceClient.ts\");\n// src/core/sources/pairs.ts\n// Discover & validate Binance trading pairs for a given coin universe.\n// Uses public /api/v3/exchangeInfo endpoint (no API key).\n\n// light in-memory cache (to keep network low for UIs switching panels)\nlet symbolCacheAt = 0;\nlet cachedSymbols = null;\nconst SYMBOL_TTL_MS = 60000; // 60s\nasync function fetchTradableSymbols() {\n    const now = Date.now();\n    if (cachedSymbols && now - symbolCacheAt < SYMBOL_TTL_MS) {\n        return cachedSymbols.filter((s)=>s.status === \"TRADING\");\n    }\n    const info = await (0,_core_sources_binanceClient__WEBPACK_IMPORTED_MODULE_0__.fetchJson)(\"/api/v3/exchangeInfo\");\n    const list = Array.isArray(info.symbols) ? info.symbols : [];\n    cachedSymbols = list.map((entry)=>({\n            symbol: String(entry.symbol ?? \"\"),\n            base: String(entry.baseAsset ?? \"\"),\n            quote: String(entry.quoteAsset ?? \"\"),\n            status: String(entry.status ?? \"\")\n        }));\n    symbolCacheAt = now;\n    return cachedSymbols.filter((s)=>s.status === \"TRADING\");\n}\n/** From a coin list, build all directionally valid pairs that Binance lists. */ async function buildValidPairsFromCoins(coins) {\n    const tradables = await fetchTradableSymbols();\n    const map = new Map();\n    for (const s of tradables)map.set(`${s.base}|${s.quote}`, s);\n    const seen = new Set();\n    const out = [];\n    for (const base of coins){\n        for (const quote of coins){\n            if (!base || !quote || base === quote) continue;\n            const key = `${base.toUpperCase()}|${quote.toUpperCase()}`;\n            const hit = map.get(key);\n            if (hit && !seen.has(hit.symbol)) {\n                seen.add(hit.symbol);\n                out.push({\n                    symbol: hit.symbol,\n                    base: hit.base,\n                    quote: hit.quote\n                });\n            }\n        }\n    }\n    return out;\n}\n/** Validate a requested base/quote; returns the Binance symbol or null. */ async function validatePair(base, quote) {\n    const tradables = await fetchTradableSymbols();\n    const found = tradables.find((s)=>s.base.toUpperCase() === base.toUpperCase() && s.quote.toUpperCase() === quote.toUpperCase());\n    return found ? found.symbol : null;\n}\n/** Validate a requested symbol (e.g., \"ETHBTC\"); returns {base, quote} or null. */ async function parseSymbol(symbol) {\n    const tradables = await fetchTradableSymbols();\n    const normalized = String(symbol || \"\").toUpperCase();\n    const hit = tradables.find((s)=>s.symbol.toUpperCase() === normalized);\n    return hit ? {\n        base: hit.base,\n        quote: hit.quote\n    } : null;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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T0FBT1U7SUFDN0QsT0FBT1QsTUFBTTtRQUFFZCxNQUFNYyxJQUFJZCxJQUFJO1FBQUVFLE9BQU9ZLElBQUlaLEtBQUs7SUFBQyxJQUFJO0FBQ3REIiwic291cmNlcyI6WyJIOlxcVXNlcnNcXEd1c1xcc291cmNlXFxyZXBvXFxkeW5hbWljc1xcZHluYW1pY3MtYlxcY3J5cHRvcGktZHluYW1pY3NcXHNyY1xcY29yZVxcc291cmNlc1xccGFpcnMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL2NvcmUvc291cmNlcy9wYWlycy50c1xyXG4vLyBEaXNjb3ZlciAmIHZhbGlkYXRlIEJpbmFuY2UgdHJhZGluZyBwYWlycyBmb3IgYSBnaXZlbiBjb2luIHVuaXZlcnNlLlxyXG4vLyBVc2VzIHB1YmxpYyAvYXBpL3YzL2V4Y2hhbmdlSW5mbyBlbmRwb2ludCAobm8gQVBJIGtleSkuXHJcblxyXG5pbXBvcnQgeyBmZXRjaEpzb24gfSBmcm9tIFwiQC9jb3JlL3NvdXJjZXMvYmluYW5jZUNsaWVudFwiO1xyXG5cclxudHlwZSBFeGNoYW5nZUluZm9TeW1ib2wgPSB7XHJcbiAgc3ltYm9sPzogc3RyaW5nO1xyXG4gIGJhc2VBc3NldD86IHN0cmluZztcclxuICBxdW90ZUFzc2V0Pzogc3RyaW5nO1xyXG4gIHN0YXR1cz86IHN0cmluZztcclxufTtcclxuXHJcbnR5cGUgRXhjaGFuZ2VJbmZvUmVzcG9uc2UgPSB7XHJcbiAgc3ltYm9scz86IEV4Y2hhbmdlSW5mb1N5bWJvbFtdO1xyXG59O1xyXG5cclxuLy8gbGlnaHQgaW4tbWVtb3J5IGNhY2hlICh0byBrZWVwIG5ldHdvcmsgbG93IGZvciBVSXMgc3dpdGNoaW5nIHBhbmVscylcclxubGV0IHN5bWJvbENhY2hlQXQgPSAwO1xyXG5sZXQgY2FjaGVkU3ltYm9sczogQXJyYXk8eyBzeW1ib2w6IHN0cmluZzsgYmFzZTogc3RyaW5nOyBxdW90ZTogc3RyaW5nOyBzdGF0dXM6IHN0cmluZyB9PiB8IG51bGwgPSBudWxsO1xyXG5jb25zdCBTWU1CT0xfVFRMX01TID0gNjBfMDAwOyAvLyA2MHNcclxuXHJcbmV4cG9ydCB0eXBlIFRyYWRhYmxlU3ltYm9sID0geyBzeW1ib2w6IHN0cmluZzsgYmFzZTogc3RyaW5nOyBxdW90ZTogc3RyaW5nIH07XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZmV0Y2hUcmFkYWJsZVN5bWJvbHMoKTogUHJvbWlzZTxUcmFkYWJsZVN5bWJvbFtdPiB7XHJcbiAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcclxuICBpZiAoY2FjaGVkU3ltYm9scyAmJiBub3cgLSBzeW1ib2xDYWNoZUF0IDwgU1lNQk9MX1RUTF9NUykge1xyXG4gICAgcmV0dXJuIGNhY2hlZFN5bWJvbHMuZmlsdGVyKChzKSA9PiBzLnN0YXR1cyA9PT0gXCJUUkFESU5HXCIpO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgaW5mbyA9IGF3YWl0IGZldGNoSnNvbjxFeGNoYW5nZUluZm9SZXNwb25zZT4oXCIvYXBpL3YzL2V4Y2hhbmdlSW5mb1wiKTtcclxuICBjb25zdCBsaXN0ID0gQXJyYXkuaXNBcnJheShpbmZvLnN5bWJvbHMpID8gaW5mby5zeW1ib2xzIDogW107XHJcbiAgY2FjaGVkU3ltYm9scyA9IGxpc3QubWFwKChlbnRyeSkgPT4gKHtcclxuICAgIHN5bWJvbDogU3RyaW5nKGVudHJ5LnN5bWJvbCA/PyBcIlwiKSxcclxuICAgIGJhc2U6IFN0cmluZyhlbnRyeS5iYXNlQXNzZXQgPz8gXCJcIiksXHJcbiAgICBxdW90ZTogU3RyaW5nKGVudHJ5LnF1b3RlQXNzZXQgPz8gXCJcIiksXHJcbiAgICBzdGF0dXM6IFN0cmluZyhlbnRyeS5zdGF0dXMgPz8gXCJcIiksXHJcbiAgfSkpO1xyXG4gIHN5bWJvbENhY2hlQXQgPSBub3c7XHJcbiAgcmV0dXJuIGNhY2hlZFN5bWJvbHMuZmlsdGVyKChzKSA9PiBzLnN0YXR1cyA9PT0gXCJUUkFESU5HXCIpO1xyXG59XHJcblxyXG4vKiogRnJvbSBhIGNvaW4gbGlzdCwgYnVpbGQgYWxsIGRpcmVjdGlvbmFsbHkgdmFsaWQgcGFpcnMgdGhhdCBCaW5hbmNlIGxpc3RzLiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYnVpbGRWYWxpZFBhaXJzRnJvbUNvaW5zKGNvaW5zOiBzdHJpbmdbXSk6IFByb21pc2U8VHJhZGFibGVTeW1ib2xbXT4ge1xyXG4gIGNvbnN0IHRyYWRhYmxlcyA9IGF3YWl0IGZldGNoVHJhZGFibGVTeW1ib2xzKCk7XHJcbiAgY29uc3QgbWFwID0gbmV3IE1hcDxzdHJpbmcsIFRyYWRhYmxlU3ltYm9sPigpO1xyXG4gIGZvciAoY29uc3QgcyBvZiB0cmFkYWJsZXMpIG1hcC5zZXQoYCR7cy5iYXNlfXwke3MucXVvdGV9YCwgcyk7XHJcblxyXG4gIGNvbnN0IHNlZW4gPSBuZXcgU2V0PHN0cmluZz4oKTtcclxuICBjb25zdCBvdXQ6IFRyYWRhYmxlU3ltYm9sW10gPSBbXTtcclxuICBmb3IgKGNvbnN0IGJhc2Ugb2YgY29pbnMpIHtcclxuICAgIGZvciAoY29uc3QgcXVvdGUgb2YgY29pbnMpIHtcclxuICAgICAgaWYgKCFiYXNlIHx8ICFxdW90ZSB8fCBiYXNlID09PSBxdW90ZSkgY29udGludWU7XHJcbiAgICAgIGNvbnN0IGtleSA9IGAke2Jhc2UudG9VcHBlckNhc2UoKX18JHtxdW90ZS50b1VwcGVyQ2FzZSgpfWA7XHJcbiAgICAgIGNvbnN0IGhpdCA9IG1hcC5nZXQoa2V5KTtcclxuICAgICAgaWYgKGhpdCAmJiAhc2Vlbi5oYXMoaGl0LnN5bWJvbCkpIHtcclxuICAgICAgICBzZWVuLmFkZChoaXQuc3ltYm9sKTtcclxuICAgICAgICBvdXQucHVzaCh7IHN5bWJvbDogaGl0LnN5bWJvbCwgYmFzZTogaGl0LmJhc2UsIHF1b3RlOiBoaXQucXVvdGUgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbiAgcmV0dXJuIG91dDtcclxufVxyXG5cclxuLyoqIFZhbGlkYXRlIGEgcmVxdWVzdGVkIGJhc2UvcXVvdGU7IHJldHVybnMgdGhlIEJpbmFuY2Ugc3ltYm9sIG9yIG51bGwuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB2YWxpZGF0ZVBhaXIoYmFzZTogc3RyaW5nLCBxdW90ZTogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XHJcbiAgY29uc3QgdHJhZGFibGVzID0gYXdhaXQgZmV0Y2hUcmFkYWJsZVN5bWJvbHMoKTtcclxuICBjb25zdCBmb3VuZCA9IHRyYWRhYmxlcy5maW5kKFxyXG4gICAgKHMpID0+IHMuYmFzZS50b1VwcGVyQ2FzZSgpID09PSBiYXNlLnRvVXBwZXJDYXNlKCkgJiYgcy5xdW90ZS50b1VwcGVyQ2FzZSgpID09PSBxdW90ZS50b1VwcGVyQ2FzZSgpXHJcbiAgKTtcclxuICByZXR1cm4gZm91bmQgPyBmb3VuZC5zeW1ib2wgOiBudWxsO1xyXG59XHJcblxyXG4vKiogVmFsaWRhdGUgYSByZXF1ZXN0ZWQgc3ltYm9sIChlLmcuLCBcIkVUSEJUQ1wiKTsgcmV0dXJucyB7YmFzZSwgcXVvdGV9IG9yIG51bGwuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwYXJzZVN5bWJvbChzeW1ib2w6IHN0cmluZyk6IFByb21pc2U8eyBiYXNlOiBzdHJpbmc7IHF1b3RlOiBzdHJpbmcgfSB8IG51bGw+IHtcclxuICBjb25zdCB0cmFkYWJsZXMgPSBhd2FpdCBmZXRjaFRyYWRhYmxlU3ltYm9scygpO1xyXG4gIGNvbnN0IG5vcm1hbGl6ZWQgPSBTdHJpbmcoc3ltYm9sIHx8IFwiXCIpLnRvVXBwZXJDYXNlKCk7XHJcbiAgY29uc3QgaGl0ID0gdHJhZGFibGVzLmZpbmQoKHMpID0+IHMuc3ltYm9sLnRvVXBwZXJDYXNlKCkgPT09IG5vcm1hbGl6ZWQpO1xyXG4gIHJldHVybiBoaXQgPyB7IGJhc2U6IGhpdC5iYXNlLCBxdW90ZTogaGl0LnF1b3RlIH0gOiBudWxsO1xyXG59XHJcblxyXG4iXSwibmFtZXMiOlsiZmV0Y2hKc29uIiwic3ltYm9sQ2FjaGVBdCIsImNhY2hlZFN5bWJvbHMiLCJTWU1CT0xfVFRMX01TIiwiZmV0Y2hUcmFkYWJsZVN5bWJvbHMiLCJub3ciLCJEYXRlIiwiZmlsdGVyIiwicyIsInN0YXR1cyIsImluZm8iLCJsaXN0IiwiQXJyYXkiLCJpc0FycmF5Iiwic3ltYm9scyIsIm1hcCIsImVudHJ5Iiwic3ltYm9sIiwiU3RyaW5nIiwiYmFzZSIsImJhc2VBc3NldCIsInF1b3RlIiwicXVvdGVBc3NldCIsImJ1aWxkVmFsaWRQYWlyc0Zyb21Db2lucyIsImNvaW5zIiwidHJhZGFibGVzIiwiTWFwIiwic2V0Iiwic2VlbiIsIlNldCIsIm91dCIsImtleSIsInRvVXBwZXJDYXNlIiwiaGl0IiwiZ2V0IiwiaGFzIiwiYWRkIiwicHVzaCIsInZhbGlkYXRlUGFpciIsImZvdW5kIiwiZmluZCIsInBhcnNlU3ltYm9sIiwibm9ybWFsaXplZCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/core/sources/pairs.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/markets/availability.ts":
/*!*****************************************!*\
  !*** ./src/lib/markets/availability.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   maskUnavailableMatrix: () => (/* binding */ maskUnavailableMatrix),\n/* harmony export */   resolvePairAvailability: () => (/* binding */ resolvePairAvailability)\n/* harmony export */ });\n/* harmony import */ var _core_sources_pairs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/core/sources/pairs */ \"(rsc)/./src/core/sources/pairs.ts\");\n// src/lib/markets/availability.ts\n// Resolve tradable symbol availability and helper utilities to align UI matrices.\n\nconst normalizeCoins = (coins)=>{\n    const out = [];\n    const seen = new Set();\n    for (const coin of coins ?? []){\n        const normalized = String(coin ?? \"\").trim().toUpperCase();\n        if (!normalized || seen.has(normalized)) continue;\n        seen.add(normalized);\n        out.push(normalized);\n    }\n    return out;\n};\nasync function resolvePairAvailability(coins) {\n    const normalized = normalizeCoins(coins);\n    if (!normalized.length) {\n        return {\n            pairs: [],\n            symbols: [],\n            set: new Set()\n        };\n    }\n    const pairs = await (0,_core_sources_pairs__WEBPACK_IMPORTED_MODULE_0__.buildValidPairsFromCoins)(normalized);\n    const symbols = pairs.map((entry)=>String(entry.symbol ?? \"\").toUpperCase());\n    const set = new Set(symbols);\n    return {\n        pairs,\n        symbols,\n        set\n    };\n}\nconst upper = (value)=>String(value ?? \"\").toUpperCase();\nfunction maskUnavailableMatrix(matrix, allowed, replacement = null) {\n    if (!matrix || !allowed.size) return;\n    for (const [baseKey, row] of Object.entries(matrix)){\n        if (!row || typeof row !== \"object\") continue;\n        const base = upper(baseKey);\n        for (const quoteKey of Object.keys(row)){\n            const quote = upper(quoteKey);\n            if (base === quote) continue;\n            const symbol = `${base}${quote}`;\n            if (!allowed.has(symbol)) {\n                row[quoteKey] = replacement;\n            }\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL21hcmtldHMvYXZhaWxhYmlsaXR5LnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLGtDQUFrQztBQUNsQyxrRkFBa0Y7QUFFRztBQUVyRixNQUFNQyxpQkFBaUIsQ0FBQ0M7SUFDdEIsTUFBTUMsTUFBZ0IsRUFBRTtJQUN4QixNQUFNQyxPQUFPLElBQUlDO0lBQ2pCLEtBQUssTUFBTUMsUUFBUUosU0FBUyxFQUFFLENBQUU7UUFDOUIsTUFBTUssYUFBYUMsT0FBT0YsUUFBUSxJQUFJRyxJQUFJLEdBQUdDLFdBQVc7UUFDeEQsSUFBSSxDQUFDSCxjQUFjSCxLQUFLTyxHQUFHLENBQUNKLGFBQWE7UUFDekNILEtBQUtRLEdBQUcsQ0FBQ0w7UUFDVEosSUFBSVUsSUFBSSxDQUFDTjtJQUNYO0lBQ0EsT0FBT0o7QUFDVDtBQVFPLGVBQWVXLHdCQUNwQlosS0FBd0I7SUFFeEIsTUFBTUssYUFBYU4sZUFBZUM7SUFDbEMsSUFBSSxDQUFDSyxXQUFXUSxNQUFNLEVBQUU7UUFDdEIsT0FBTztZQUFFQyxPQUFPLEVBQUU7WUFBRUMsU0FBUyxFQUFFO1lBQUVDLEtBQUssSUFBSWI7UUFBYztJQUMxRDtJQUVBLE1BQU1XLFFBQVEsTUFBTWhCLDZFQUF3QkEsQ0FBQ087SUFDN0MsTUFBTVUsVUFBVUQsTUFBTUcsR0FBRyxDQUFDLENBQUNDLFFBQVVaLE9BQU9ZLE1BQU1DLE1BQU0sSUFBSSxJQUFJWCxXQUFXO0lBQzNFLE1BQU1RLE1BQU0sSUFBSWIsSUFBSVk7SUFDcEIsT0FBTztRQUFFRDtRQUFPQztRQUFTQztJQUFJO0FBQy9CO0FBRUEsTUFBTUksUUFBUSxDQUFDQyxRQUFrQmYsT0FBT2UsU0FBUyxJQUFJYixXQUFXO0FBRXpELFNBQVNjLHNCQUNkQyxNQUEyRCxFQUMzREMsT0FBb0IsRUFDcEJDLGNBQXVCLElBQUk7SUFFM0IsSUFBSSxDQUFDRixVQUFVLENBQUNDLFFBQVFFLElBQUksRUFBRTtJQUU5QixLQUFLLE1BQU0sQ0FBQ0MsU0FBU0MsSUFBSSxJQUFJQyxPQUFPQyxPQUFPLENBQUNQLFFBQVM7UUFDbkQsSUFBSSxDQUFDSyxPQUFPLE9BQU9BLFFBQVEsVUFBVTtRQUNyQyxNQUFNRyxPQUFPWCxNQUFNTztRQUNuQixLQUFLLE1BQU1LLFlBQVlILE9BQU9JLElBQUksQ0FBQ0wsS0FBTTtZQUN2QyxNQUFNTSxRQUFRZCxNQUFNWTtZQUNwQixJQUFJRCxTQUFTRyxPQUFPO1lBQ3BCLE1BQU1mLFNBQVMsR0FBR1ksT0FBT0csT0FBTztZQUNoQyxJQUFJLENBQUNWLFFBQVFmLEdBQUcsQ0FBQ1UsU0FBUztnQkFDdkJTLEdBQStCLENBQUNJLFNBQVMsR0FBR1A7WUFDL0M7UUFDRjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIkg6XFxVc2Vyc1xcR3VzXFxzb3VyY2VcXHJlcG9cXGR5bmFtaWNzXFxkeW5hbWljcy1iXFxjcnlwdG9waS1keW5hbWljc1xcc3JjXFxsaWJcXG1hcmtldHNcXGF2YWlsYWJpbGl0eS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvbGliL21hcmtldHMvYXZhaWxhYmlsaXR5LnRzXG4vLyBSZXNvbHZlIHRyYWRhYmxlIHN5bWJvbCBhdmFpbGFiaWxpdHkgYW5kIGhlbHBlciB1dGlsaXRpZXMgdG8gYWxpZ24gVUkgbWF0cmljZXMuXG5cbmltcG9ydCB7IGJ1aWxkVmFsaWRQYWlyc0Zyb21Db2lucywgdHlwZSBUcmFkYWJsZVN5bWJvbCB9IGZyb20gXCJAL2NvcmUvc291cmNlcy9wYWlyc1wiO1xuXG5jb25zdCBub3JtYWxpemVDb2lucyA9IChjb2luczogcmVhZG9ubHkgc3RyaW5nW10pOiBzdHJpbmdbXSA9PiB7XG4gIGNvbnN0IG91dDogc3RyaW5nW10gPSBbXTtcbiAgY29uc3Qgc2VlbiA9IG5ldyBTZXQ8c3RyaW5nPigpO1xuICBmb3IgKGNvbnN0IGNvaW4gb2YgY29pbnMgPz8gW10pIHtcbiAgICBjb25zdCBub3JtYWxpemVkID0gU3RyaW5nKGNvaW4gPz8gXCJcIikudHJpbSgpLnRvVXBwZXJDYXNlKCk7XG4gICAgaWYgKCFub3JtYWxpemVkIHx8IHNlZW4uaGFzKG5vcm1hbGl6ZWQpKSBjb250aW51ZTtcbiAgICBzZWVuLmFkZChub3JtYWxpemVkKTtcbiAgICBvdXQucHVzaChub3JtYWxpemVkKTtcbiAgfVxuICByZXR1cm4gb3V0O1xufTtcblxuZXhwb3J0IHR5cGUgUGFpckF2YWlsYWJpbGl0eVNuYXBzaG90ID0ge1xuICBwYWlyczogVHJhZGFibGVTeW1ib2xbXTtcbiAgc3ltYm9sczogc3RyaW5nW107XG4gIHNldDogU2V0PHN0cmluZz47XG59O1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVzb2x2ZVBhaXJBdmFpbGFiaWxpdHkoXG4gIGNvaW5zOiByZWFkb25seSBzdHJpbmdbXVxuKTogUHJvbWlzZTxQYWlyQXZhaWxhYmlsaXR5U25hcHNob3Q+IHtcbiAgY29uc3Qgbm9ybWFsaXplZCA9IG5vcm1hbGl6ZUNvaW5zKGNvaW5zKTtcbiAgaWYgKCFub3JtYWxpemVkLmxlbmd0aCkge1xuICAgIHJldHVybiB7IHBhaXJzOiBbXSwgc3ltYm9sczogW10sIHNldDogbmV3IFNldDxzdHJpbmc+KCkgfTtcbiAgfVxuXG4gIGNvbnN0IHBhaXJzID0gYXdhaXQgYnVpbGRWYWxpZFBhaXJzRnJvbUNvaW5zKG5vcm1hbGl6ZWQpO1xuICBjb25zdCBzeW1ib2xzID0gcGFpcnMubWFwKChlbnRyeSkgPT4gU3RyaW5nKGVudHJ5LnN5bWJvbCA/PyBcIlwiKS50b1VwcGVyQ2FzZSgpKTtcbiAgY29uc3Qgc2V0ID0gbmV3IFNldChzeW1ib2xzKTtcbiAgcmV0dXJuIHsgcGFpcnMsIHN5bWJvbHMsIHNldCB9O1xufVxuXG5jb25zdCB1cHBlciA9ICh2YWx1ZTogc3RyaW5nKSA9PiBTdHJpbmcodmFsdWUgPz8gXCJcIikudG9VcHBlckNhc2UoKTtcblxuZXhwb3J0IGZ1bmN0aW9uIG1hc2tVbmF2YWlsYWJsZU1hdHJpeChcbiAgbWF0cml4OiBSZWNvcmQ8c3RyaW5nLCBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPj4gfCB1bmRlZmluZWQsXG4gIGFsbG93ZWQ6IFNldDxzdHJpbmc+LFxuICByZXBsYWNlbWVudDogdW5rbm93biA9IG51bGxcbikge1xuICBpZiAoIW1hdHJpeCB8fCAhYWxsb3dlZC5zaXplKSByZXR1cm47XG5cbiAgZm9yIChjb25zdCBbYmFzZUtleSwgcm93XSBvZiBPYmplY3QuZW50cmllcyhtYXRyaXgpKSB7XG4gICAgaWYgKCFyb3cgfHwgdHlwZW9mIHJvdyAhPT0gXCJvYmplY3RcIikgY29udGludWU7XG4gICAgY29uc3QgYmFzZSA9IHVwcGVyKGJhc2VLZXkpO1xuICAgIGZvciAoY29uc3QgcXVvdGVLZXkgb2YgT2JqZWN0LmtleXMocm93KSkge1xuICAgICAgY29uc3QgcXVvdGUgPSB1cHBlcihxdW90ZUtleSk7XG4gICAgICBpZiAoYmFzZSA9PT0gcXVvdGUpIGNvbnRpbnVlO1xuICAgICAgY29uc3Qgc3ltYm9sID0gYCR7YmFzZX0ke3F1b3RlfWA7XG4gICAgICBpZiAoIWFsbG93ZWQuaGFzKHN5bWJvbCkpIHtcbiAgICAgICAgKHJvdyBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPilbcXVvdGVLZXldID0gcmVwbGFjZW1lbnQ7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cbiJdLCJuYW1lcyI6WyJidWlsZFZhbGlkUGFpcnNGcm9tQ29pbnMiLCJub3JtYWxpemVDb2lucyIsImNvaW5zIiwib3V0Iiwic2VlbiIsIlNldCIsImNvaW4iLCJub3JtYWxpemVkIiwiU3RyaW5nIiwidHJpbSIsInRvVXBwZXJDYXNlIiwiaGFzIiwiYWRkIiwicHVzaCIsInJlc29sdmVQYWlyQXZhaWxhYmlsaXR5IiwibGVuZ3RoIiwicGFpcnMiLCJzeW1ib2xzIiwic2V0IiwibWFwIiwiZW50cnkiLCJzeW1ib2wiLCJ1cHBlciIsInZhbHVlIiwibWFza1VuYXZhaWxhYmxlTWF0cml4IiwibWF0cml4IiwiYWxsb3dlZCIsInJlcGxhY2VtZW50Iiwic2l6ZSIsImJhc2VLZXkiLCJyb3ciLCJPYmplY3QiLCJlbnRyaWVzIiwiYmFzZSIsInF1b3RlS2V5Iiwia2V5cyIsInF1b3RlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/markets/availability.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/markets/pairs.ts":
/*!**********************************!*\
  !*** ./src/lib/markets/pairs.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   crossPairsFromCoins: () => (/* binding */ crossPairsFromCoins),\n/* harmony export */   dedupeCoins: () => (/* binding */ dedupeCoins),\n/* harmony export */   normalizeCoin: () => (/* binding */ normalizeCoin),\n/* harmony export */   pairsFromSettings: () => (/* binding */ pairsFromSettings),\n/* harmony export */   usdtLegsFromCoins: () => (/* binding */ usdtLegsFromCoins)\n/* harmony export */ });\n// src/lib/markets/pairs.ts\n// Shared, deterministic pair helpers used by both UI and API.\nconst QUOTE_SUFFIXES = [\n    \"USDT\",\n    \"USDC\",\n    \"FDUSD\",\n    \"TUSD\",\n    \"BUSD\"\n];\n/**\n * Normalizes a token symbol:\n * - Uppercase\n * - Remove non A-Z characters\n * - Strip known quote suffixes so cross combos never double-append quotes\n */ const normalizeCoin = (c)=>{\n    const upper = String(c || \"\").toUpperCase().replace(/[^A-Z]/g, \"\");\n    if (!upper) return \"\";\n    for (const suffix of QUOTE_SUFFIXES){\n        if (upper === suffix) return upper;\n        if (upper.endsWith(suffix) && upper.length > suffix.length) {\n            return upper.slice(0, -suffix.length);\n        }\n    }\n    return upper;\n};\nfunction dedupeCoins(bases) {\n    return Array.from(new Set((bases ?? []).map(normalizeCoin))).filter(Boolean);\n}\nfunction usdtLegsFromCoins(bases) {\n    const uniq = dedupeCoins(bases).filter((c)=>c && c !== \"USDT\");\n    return uniq.map((b)=>`${b}USDT`);\n}\n// Ordered permutations A->B (A !== B). No verification here.\nfunction crossPairsFromCoins(bases) {\n    const coins = dedupeCoins(bases).filter((c)=>c && c !== \"USDT\");\n    const out = [];\n    for(let i = 0; i < coins.length; i++){\n        for(let j = 0; j < coins.length; j++){\n            if (i === j) continue;\n            out.push(`${coins[i]}${coins[j]}`);\n        }\n    }\n    return out;\n}\n/**\n * Async builder with optional preview verification.\n * - If `verify` is provided, we filter USDT + cross by it.\n * - If not, we return only USDT legs (no synthetic crosses on the client).\n */ async function pairsFromSettings(bases, opts) {\n    const preferVerifiedUsdt = opts?.preferVerifiedUsdt ?? true;\n    const usdtCand = usdtLegsFromCoins(bases);\n    const crossCand = crossPairsFromCoins(bases);\n    if (!opts?.verify) {\n        return {\n            usdt: usdtCand,\n            cross: [],\n            all: usdtCand.slice()\n        };\n    }\n    const verified = await opts.verify([\n        ...usdtCand,\n        ...crossCand\n    ]);\n    const has = (s)=>verified.has(s.toUpperCase());\n    const usdt = verified.size && preferVerifiedUsdt ? usdtCand.filter(has) : usdtCand;\n    const cross = crossCand.filter(has);\n    const all = Array.from(new Set([\n        ...usdt,\n        ...cross\n    ]));\n    return {\n        usdt,\n        cross,\n        all\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL21hcmtldHMvcGFpcnMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQSwyQkFBMkI7QUFDM0IsOERBQThEO0FBSTlELE1BQU1BLGlCQUFpQjtJQUFDO0lBQVE7SUFBUTtJQUFTO0lBQVE7Q0FBTztBQUVoRTs7Ozs7Q0FLQyxHQUNNLE1BQU1DLGdCQUFnQixDQUFDQztJQUM1QixNQUFNQyxRQUFRQyxPQUFPRixLQUFLLElBQUlHLFdBQVcsR0FBR0MsT0FBTyxDQUFDLFdBQVc7SUFDL0QsSUFBSSxDQUFDSCxPQUFPLE9BQU87SUFDbkIsS0FBSyxNQUFNSSxVQUFVUCxlQUFnQjtRQUNuQyxJQUFJRyxVQUFVSSxRQUFRLE9BQU9KO1FBQzdCLElBQUlBLE1BQU1LLFFBQVEsQ0FBQ0QsV0FBV0osTUFBTU0sTUFBTSxHQUFHRixPQUFPRSxNQUFNLEVBQUU7WUFDMUQsT0FBT04sTUFBTU8sS0FBSyxDQUFDLEdBQUcsQ0FBQ0gsT0FBT0UsTUFBTTtRQUN0QztJQUNGO0lBQ0EsT0FBT047QUFDVCxFQUFFO0FBRUssU0FBU1EsWUFBWUMsS0FBZTtJQUN6QyxPQUFPQyxNQUFNQyxJQUFJLENBQUMsSUFBSUMsSUFBSSxDQUFDSCxTQUFTLEVBQUUsRUFBRUksR0FBRyxDQUFDZixpQkFBaUJnQixNQUFNLENBQUNDO0FBQ3RFO0FBRU8sU0FBU0Msa0JBQWtCUCxLQUFlO0lBQy9DLE1BQU1RLE9BQU9ULFlBQVlDLE9BQU9LLE1BQU0sQ0FBQyxDQUFDZixJQUFNQSxLQUFLQSxNQUFNO0lBQ3pELE9BQU9rQixLQUFLSixHQUFHLENBQUMsQ0FBQ0ssSUFBTSxHQUFHQSxFQUFFLElBQUksQ0FBQztBQUNuQztBQUVBLDZEQUE2RDtBQUN0RCxTQUFTQyxvQkFBb0JWLEtBQWU7SUFDakQsTUFBTVcsUUFBUVosWUFBWUMsT0FBT0ssTUFBTSxDQUFDLENBQUNmLElBQU1BLEtBQUtBLE1BQU07SUFDMUQsTUFBTXNCLE1BQWdCLEVBQUU7SUFDeEIsSUFBSyxJQUFJQyxJQUFJLEdBQUdBLElBQUlGLE1BQU1kLE1BQU0sRUFBRWdCLElBQUs7UUFDckMsSUFBSyxJQUFJQyxJQUFJLEdBQUdBLElBQUlILE1BQU1kLE1BQU0sRUFBRWlCLElBQUs7WUFDckMsSUFBSUQsTUFBTUMsR0FBRztZQUNiRixJQUFJRyxJQUFJLENBQUMsR0FBR0osS0FBSyxDQUFDRSxFQUFFLEdBQUdGLEtBQUssQ0FBQ0csRUFBRSxFQUFFO1FBQ25DO0lBQ0Y7SUFDQSxPQUFPRjtBQUNUO0FBRUE7Ozs7Q0FJQyxHQUNNLGVBQWVJLGtCQUNwQmhCLEtBQWUsRUFDZmlCLElBR0M7SUFFRCxNQUFNQyxxQkFBcUJELE1BQU1DLHNCQUFzQjtJQUV2RCxNQUFNQyxXQUFXWixrQkFBa0JQO0lBQ25DLE1BQU1vQixZQUFZVixvQkFBb0JWO0lBRXRDLElBQUksQ0FBQ2lCLE1BQU1JLFFBQVE7UUFDakIsT0FBTztZQUFFQyxNQUFNSDtZQUFVSSxPQUFPLEVBQUU7WUFBRUMsS0FBS0wsU0FBU3JCLEtBQUs7UUFBRztJQUM1RDtJQUVBLE1BQU0yQixXQUFXLE1BQU1SLEtBQUtJLE1BQU0sQ0FBQztXQUFJRjtXQUFhQztLQUFVO0lBQzlELE1BQU1NLE1BQU0sQ0FBQ0MsSUFBY0YsU0FBU0MsR0FBRyxDQUFDQyxFQUFFbEMsV0FBVztJQUVyRCxNQUFNNkIsT0FDSkcsU0FBU0csSUFBSSxJQUFJVixxQkFBcUJDLFNBQVNkLE1BQU0sQ0FBQ3FCLE9BQU9QO0lBQy9ELE1BQU1JLFFBQVFILFVBQVVmLE1BQU0sQ0FBQ3FCO0lBQy9CLE1BQU1GLE1BQU12QixNQUFNQyxJQUFJLENBQUMsSUFBSUMsSUFBSTtXQUFJbUI7V0FBU0M7S0FBTTtJQUNsRCxPQUFPO1FBQUVEO1FBQU1DO1FBQU9DO0lBQUk7QUFDNUIiLCJzb3VyY2VzIjpbIkg6XFxVc2Vyc1xcR3VzXFxzb3VyY2VcXHJlcG9cXGR5bmFtaWNzXFxkeW5hbWljcy1iXFxjcnlwdG9waS1keW5hbWljc1xcc3JjXFxsaWJcXG1hcmtldHNcXHBhaXJzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9saWIvbWFya2V0cy9wYWlycy50c1xuLy8gU2hhcmVkLCBkZXRlcm1pbmlzdGljIHBhaXIgaGVscGVycyB1c2VkIGJ5IGJvdGggVUkgYW5kIEFQSS5cblxuZXhwb3J0IHR5cGUgUGFpckF2YWlsYWJpbGl0eSA9IHsgdXNkdDogc3RyaW5nW107IGNyb3NzOiBzdHJpbmdbXTsgYWxsOiBzdHJpbmdbXSB9O1xuXG5jb25zdCBRVU9URV9TVUZGSVhFUyA9IFtcIlVTRFRcIiwgXCJVU0RDXCIsIFwiRkRVU0RcIiwgXCJUVVNEXCIsIFwiQlVTRFwiXSBhcyBjb25zdDtcblxuLyoqXG4gKiBOb3JtYWxpemVzIGEgdG9rZW4gc3ltYm9sOlxuICogLSBVcHBlcmNhc2VcbiAqIC0gUmVtb3ZlIG5vbiBBLVogY2hhcmFjdGVyc1xuICogLSBTdHJpcCBrbm93biBxdW90ZSBzdWZmaXhlcyBzbyBjcm9zcyBjb21ib3MgbmV2ZXIgZG91YmxlLWFwcGVuZCBxdW90ZXNcbiAqL1xuZXhwb3J0IGNvbnN0IG5vcm1hbGl6ZUNvaW4gPSAoYzogc3RyaW5nKTogc3RyaW5nID0+IHtcbiAgY29uc3QgdXBwZXIgPSBTdHJpbmcoYyB8fCBcIlwiKS50b1VwcGVyQ2FzZSgpLnJlcGxhY2UoL1teQS1aXS9nLCBcIlwiKTtcbiAgaWYgKCF1cHBlcikgcmV0dXJuIFwiXCI7XG4gIGZvciAoY29uc3Qgc3VmZml4IG9mIFFVT1RFX1NVRkZJWEVTKSB7XG4gICAgaWYgKHVwcGVyID09PSBzdWZmaXgpIHJldHVybiB1cHBlcjtcbiAgICBpZiAodXBwZXIuZW5kc1dpdGgoc3VmZml4KSAmJiB1cHBlci5sZW5ndGggPiBzdWZmaXgubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gdXBwZXIuc2xpY2UoMCwgLXN1ZmZpeC5sZW5ndGgpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gdXBwZXI7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gZGVkdXBlQ29pbnMoYmFzZXM6IHN0cmluZ1tdKTogc3RyaW5nW10ge1xuICByZXR1cm4gQXJyYXkuZnJvbShuZXcgU2V0KChiYXNlcyA/PyBbXSkubWFwKG5vcm1hbGl6ZUNvaW4pKSkuZmlsdGVyKEJvb2xlYW4pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdXNkdExlZ3NGcm9tQ29pbnMoYmFzZXM6IHN0cmluZ1tdKTogc3RyaW5nW10ge1xuICBjb25zdCB1bmlxID0gZGVkdXBlQ29pbnMoYmFzZXMpLmZpbHRlcigoYykgPT4gYyAmJiBjICE9PSBcIlVTRFRcIik7XG4gIHJldHVybiB1bmlxLm1hcCgoYikgPT4gYCR7Yn1VU0RUYCk7XG59XG5cbi8vIE9yZGVyZWQgcGVybXV0YXRpb25zIEEtPkIgKEEgIT09IEIpLiBObyB2ZXJpZmljYXRpb24gaGVyZS5cbmV4cG9ydCBmdW5jdGlvbiBjcm9zc1BhaXJzRnJvbUNvaW5zKGJhc2VzOiBzdHJpbmdbXSk6IHN0cmluZ1tdIHtcbiAgY29uc3QgY29pbnMgPSBkZWR1cGVDb2lucyhiYXNlcykuZmlsdGVyKChjKSA9PiBjICYmIGMgIT09IFwiVVNEVFwiKTtcbiAgY29uc3Qgb3V0OiBzdHJpbmdbXSA9IFtdO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGNvaW5zLmxlbmd0aDsgaSsrKSB7XG4gICAgZm9yIChsZXQgaiA9IDA7IGogPCBjb2lucy5sZW5ndGg7IGorKykge1xuICAgICAgaWYgKGkgPT09IGopIGNvbnRpbnVlO1xuICAgICAgb3V0LnB1c2goYCR7Y29pbnNbaV19JHtjb2luc1tqXX1gKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG91dDtcbn1cblxuLyoqXG4gKiBBc3luYyBidWlsZGVyIHdpdGggb3B0aW9uYWwgcHJldmlldyB2ZXJpZmljYXRpb24uXG4gKiAtIElmIGB2ZXJpZnlgIGlzIHByb3ZpZGVkLCB3ZSBmaWx0ZXIgVVNEVCArIGNyb3NzIGJ5IGl0LlxuICogLSBJZiBub3QsIHdlIHJldHVybiBvbmx5IFVTRFQgbGVncyAobm8gc3ludGhldGljIGNyb3NzZXMgb24gdGhlIGNsaWVudCkuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwYWlyc0Zyb21TZXR0aW5ncyhcbiAgYmFzZXM6IHN0cmluZ1tdLFxuICBvcHRzPzoge1xuICAgIHZlcmlmeT86IChzeW1ib2xzOiBzdHJpbmdbXSkgPT4gUHJvbWlzZTxTZXQ8c3RyaW5nPj47XG4gICAgcHJlZmVyVmVyaWZpZWRVc2R0PzogYm9vbGVhbjsgLy8gZGVmYXVsdCB0cnVlXG4gIH1cbik6IFByb21pc2U8UGFpckF2YWlsYWJpbGl0eT4ge1xuICBjb25zdCBwcmVmZXJWZXJpZmllZFVzZHQgPSBvcHRzPy5wcmVmZXJWZXJpZmllZFVzZHQgPz8gdHJ1ZTtcblxuICBjb25zdCB1c2R0Q2FuZCA9IHVzZHRMZWdzRnJvbUNvaW5zKGJhc2VzKTtcbiAgY29uc3QgY3Jvc3NDYW5kID0gY3Jvc3NQYWlyc0Zyb21Db2lucyhiYXNlcyk7XG5cbiAgaWYgKCFvcHRzPy52ZXJpZnkpIHtcbiAgICByZXR1cm4geyB1c2R0OiB1c2R0Q2FuZCwgY3Jvc3M6IFtdLCBhbGw6IHVzZHRDYW5kLnNsaWNlKCkgfTtcbiAgfVxuXG4gIGNvbnN0IHZlcmlmaWVkID0gYXdhaXQgb3B0cy52ZXJpZnkoWy4uLnVzZHRDYW5kLCAuLi5jcm9zc0NhbmRdKTtcbiAgY29uc3QgaGFzID0gKHM6IHN0cmluZykgPT4gdmVyaWZpZWQuaGFzKHMudG9VcHBlckNhc2UoKSk7XG5cbiAgY29uc3QgdXNkdCA9XG4gICAgdmVyaWZpZWQuc2l6ZSAmJiBwcmVmZXJWZXJpZmllZFVzZHQgPyB1c2R0Q2FuZC5maWx0ZXIoaGFzKSA6IHVzZHRDYW5kO1xuICBjb25zdCBjcm9zcyA9IGNyb3NzQ2FuZC5maWx0ZXIoaGFzKTtcbiAgY29uc3QgYWxsID0gQXJyYXkuZnJvbShuZXcgU2V0KFsuLi51c2R0LCAuLi5jcm9zc10pKTtcbiAgcmV0dXJuIHsgdXNkdCwgY3Jvc3MsIGFsbCB9O1xufVxuIl0sIm5hbWVzIjpbIlFVT1RFX1NVRkZJWEVTIiwibm9ybWFsaXplQ29pbiIsImMiLCJ1cHBlciIsIlN0cmluZyIsInRvVXBwZXJDYXNlIiwicmVwbGFjZSIsInN1ZmZpeCIsImVuZHNXaXRoIiwibGVuZ3RoIiwic2xpY2UiLCJkZWR1cGVDb2lucyIsImJhc2VzIiwiQXJyYXkiLCJmcm9tIiwiU2V0IiwibWFwIiwiZmlsdGVyIiwiQm9vbGVhbiIsInVzZHRMZWdzRnJvbUNvaW5zIiwidW5pcSIsImIiLCJjcm9zc1BhaXJzRnJvbUNvaW5zIiwiY29pbnMiLCJvdXQiLCJpIiwiaiIsInB1c2giLCJwYWlyc0Zyb21TZXR0aW5ncyIsIm9wdHMiLCJwcmVmZXJWZXJpZmllZFVzZHQiLCJ1c2R0Q2FuZCIsImNyb3NzQ2FuZCIsInZlcmlmeSIsInVzZHQiLCJjcm9zcyIsImFsbCIsInZlcmlmaWVkIiwiaGFzIiwicyIsInNpemUiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/markets/pairs.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/mea/mood.ts":
/*!*****************************!*\
  !*** ./src/lib/mea/mood.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   computeMoodCoeffV1: () => (/* binding */ computeMoodCoeffV1),\n/* harmony export */   moodUUIDFromBuckets: () => (/* binding */ moodUUIDFromBuckets),\n/* harmony export */   normalizeMoodInputs: () => (/* binding */ normalizeMoodInputs)\n/* harmony export */ });\n// mood.ts  formula, buckets, UUID\nconst clamp = (x, lo, hi)=>Math.min(Math.max(x, lo), hi);\n// --- Ranges\nconst V_TEND_ABS_MAX = 1.2;\nconst V_SWAP_ABS_MAX = 0.5;\nconst GFM_MIN = 0.8, GFM_MAX = 1.2;\n// --- Helpers\nfunction eqCuts(maxAbs, bins) {\n    const step = maxAbs / bins;\n    return Array.from({\n        length: bins - 1\n    }, (_, i)=>step * (i + 1)); // absolute cuts\n}\nfunction binSigned(x, absCuts, upBins, downBins) {\n    const a = Math.abs(x);\n    let idx = 0;\n    while(idx < absCuts.length && a > absCuts[idx])idx++;\n    return x >= 0 ? Math.min(idx, upBins - 1) : upBins + Math.min(idx, downBins - 1);\n}\nfunction binAroundOne(gfm) {\n    // map to 8 bins: 0..3 for >=1.0, 4..7 for <1.0\n    const delta = Math.abs((gfm ?? 1) - 1);\n    // cuts every 0.05 up to 0.20\n    const cuts = [\n        0.05,\n        0.10,\n        0.15\n    ];\n    let idx = 0;\n    while(idx < cuts.length && delta > cuts[idx])idx++;\n    if (idx > 3) idx = 3;\n    return (gfm ?? 1) >= 1 ? idx : 4 + idx;\n}\n// --- UUID alphabets\nconst VT_UP = [\n    \"A\",\n    \"B\",\n    \"C\",\n    \"D\",\n    \"E\",\n    \"F\"\n];\nconst VT_DN = [\n    \"G\",\n    \"H\",\n    \"I\",\n    \"J\",\n    \"K\",\n    \"L\"\n];\nconst VS_UP = [\n    \"a\",\n    \"b\",\n    \"c\",\n    \"d\",\n    \"e\",\n    \"f\"\n];\nconst VS_DN = [\n    \"g\",\n    \"h\",\n    \"i\",\n    \"j\",\n    \"k\",\n    \"l\"\n];\n// --- Public API\nfunction computeMoodCoeffV1(inp) {\n    const vT = Math.sign(inp.vTendency ?? 0) * clamp(Math.abs(inp.vTendency ?? 0), 0, V_TEND_ABS_MAX);\n    const vS = Math.sign(inp.vSwap ?? 0) * clamp(Math.abs(inp.vSwap ?? 0), 0, V_SWAP_ABS_MAX);\n    const gf = clamp(inp.GFM ?? 1, GFM_MIN, GFM_MAX);\n    // Your formula\n    let coeff = (vT || 0) / (gf || 1) + (vS || 0);\n    coeff = clamp(coeff, 0.2, 2.0);\n    // Buckets\n    const vtCuts = eqCuts(V_TEND_ABS_MAX, 6);\n    const vsCuts = eqCuts(V_SWAP_ABS_MAX, 6);\n    const vTIdx = binSigned(vT, vtCuts, 6, 6);\n    const vSIdx = binSigned(vS, vsCuts, 6, 6);\n    const gIdx = binAroundOne(gf);\n    return {\n        coeff,\n        buckets: {\n            vTendencyIdx: vTIdx,\n            vSwapIdx: vSIdx,\n            GFMIdx: gIdx\n        }\n    };\n}\nfunction moodUUIDFromBuckets(b) {\n    const vt = b.vTendencyIdx < 6 ? VT_UP[b.vTendencyIdx] : VT_DN[b.vTendencyIdx - 6];\n    const vs = b.vSwapIdx < 6 ? VS_UP[b.vSwapIdx] : VS_DN[b.vSwapIdx - 6];\n    const g = String(b.GFMIdx); // 0..7\n    return `${vt}${vs}${g}`;\n}\n// Convert raw  normalized MoodInputs\nfunction normalizeMoodInputs(raw, ref) {\n    const eps = 1e-9;\n    const Kg = ref.gfmScale ?? 20;\n    const GFM = Math.min(Math.max(1 + Kg * raw.gfmDeltaPct, 0.8), 1.2);\n    const zT = Math.max(-1, Math.min(1, (raw.tendencyRaw - ref.vtMu) / (ref.vtSigma || eps)));\n    const vTendency = 0.8 + 0.4 * zT;\n    const zS = (raw.swapRaw - ref.vsMu) / (ref.vsSigma || eps);\n    const vSwap = 0.5 * Math.tanh((ref.vsAlpha ?? 0.75) * zS);\n    return {\n        vTendency,\n        GFM,\n        vSwap\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LENBQUMsQ0FBQ2IsSUFBSWMsT0FBTyxJQUFJLElBQUcsSUFBS0w7SUFFdEQsT0FBTztRQUFFaEM7UUFBV0k7UUFBS0Y7SUFBTTtBQUNqQyIsInNvdXJjZXMiOlsiSDpcXFVzZXJzXFxHdXNcXHNvdXJjZVxccmVwb1xcZHluYW1pY3NcXGR5bmFtaWNzLWJcXGNyeXB0b3BpLWR5bmFtaWNzXFxzcmNcXGxpYlxcbWVhXFxtb29kLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIG1vb2QudHMg4oCUIGZvcm11bGEsIGJ1Y2tldHMsIFVVSURcclxuXHJcbmV4cG9ydCB0eXBlIE1vb2RJbnB1dHMgPSB7XHJcbiAgdlRlbmRlbmN5OiBudW1iZXIgfCBudWxsOyAvLyBzaWduZWQsIGZvdW5kYXRpb25hbCwgY2xhbXAgYWJzIHRvIDEuMlxyXG4gIEdGTTogbnVtYmVyIHwgbnVsbDsgICAgICAgLy8gZmFjdG9yLCBjbGFtcCB0byBbMC44Li4xLjJdXHJcbiAgdlN3YXA6IG51bWJlciB8IG51bGw7ICAgICAvLyBzaWduZWQsIGNsYW1wIGFicyB0byAwLjVcclxufTtcclxuXHJcbmV4cG9ydCB0eXBlIE1vb2RCdWNrZXRzID0geyB2VGVuZGVuY3lJZHg6IG51bWJlcjsgdlN3YXBJZHg6IG51bWJlcjsgR0ZNSWR4OiBudW1iZXIgfTtcclxuZXhwb3J0IHR5cGUgTW9vZFVVSUQgPSBzdHJpbmc7XHJcblxyXG5jb25zdCBjbGFtcCA9ICh4OiBudW1iZXIsIGxvOiBudW1iZXIsIGhpOiBudW1iZXIpID0+IE1hdGgubWluKE1hdGgubWF4KHgsIGxvKSwgaGkpO1xyXG5cclxuLy8gLS0tIFJhbmdlc1xyXG5jb25zdCBWX1RFTkRfQUJTX01BWCA9IDEuMjtcclxuY29uc3QgVl9TV0FQX0FCU19NQVggPSAwLjU7XHJcbmNvbnN0IEdGTV9NSU4gPSAwLjgsIEdGTV9NQVggPSAxLjI7XHJcblxyXG4vLyAtLS0gSGVscGVyc1xyXG5mdW5jdGlvbiBlcUN1dHMobWF4QWJzOiBudW1iZXIsIGJpbnM6IG51bWJlcik6IG51bWJlcltdIHtcclxuICBjb25zdCBzdGVwID0gbWF4QWJzIC8gYmlucztcclxuICByZXR1cm4gQXJyYXkuZnJvbSh7IGxlbmd0aDogYmlucyAtIDEgfSwgKF8sIGkpID0+IHN0ZXAgKiAoaSArIDEpKTsgLy8gYWJzb2x1dGUgY3V0c1xyXG59XHJcbmZ1bmN0aW9uIGJpblNpZ25lZCh4OiBudW1iZXIsIGFic0N1dHM6IG51bWJlcltdLCB1cEJpbnM6IG51bWJlciwgZG93bkJpbnM6IG51bWJlcik6IG51bWJlciB7XHJcbiAgY29uc3QgYSA9IE1hdGguYWJzKHgpO1xyXG4gIGxldCBpZHggPSAwO1xyXG4gIHdoaWxlIChpZHggPCBhYnNDdXRzLmxlbmd0aCAmJiBhID4gYWJzQ3V0c1tpZHhdKSBpZHgrKztcclxuICByZXR1cm4geCA+PSAwID8gTWF0aC5taW4oaWR4LCB1cEJpbnMgLSAxKSA6IHVwQmlucyArIE1hdGgubWluKGlkeCwgZG93bkJpbnMgLSAxKTtcclxufVxyXG5mdW5jdGlvbiBiaW5Bcm91bmRPbmUoZ2ZtOiBudW1iZXIpOiBudW1iZXIge1xyXG4gIC8vIG1hcCB0byA4IGJpbnM6IDAuLjMgZm9yID49MS4wLCA0Li43IGZvciA8MS4wXHJcbiAgY29uc3QgZGVsdGEgPSBNYXRoLmFicygoZ2ZtID8/IDEpIC0gMSk7XHJcbiAgLy8gY3V0cyBldmVyeSAwLjA1IHVwIHRvIDAuMjBcclxuICBjb25zdCBjdXRzID0gWzAuMDUsIDAuMTAsIDAuMTVdO1xyXG4gIGxldCBpZHggPSAwO1xyXG4gIHdoaWxlIChpZHggPCBjdXRzLmxlbmd0aCAmJiBkZWx0YSA+IGN1dHNbaWR4XSkgaWR4Kys7XHJcbiAgaWYgKGlkeCA+IDMpIGlkeCA9IDM7XHJcbiAgcmV0dXJuIChnZm0gPz8gMSkgPj0gMSA/IGlkeCA6IDQgKyBpZHg7XHJcbn1cclxuXHJcbi8vIC0tLSBVVUlEIGFscGhhYmV0c1xyXG5jb25zdCBWVF9VUCA9IFtcIkFcIixcIkJcIixcIkNcIixcIkRcIixcIkVcIixcIkZcIl07XHJcbmNvbnN0IFZUX0ROID0gW1wiR1wiLFwiSFwiLFwiSVwiLFwiSlwiLFwiS1wiLFwiTFwiXTtcclxuY29uc3QgVlNfVVAgPSBbXCJhXCIsXCJiXCIsXCJjXCIsXCJkXCIsXCJlXCIsXCJmXCJdO1xyXG5jb25zdCBWU19ETiA9IFtcImdcIixcImhcIixcImlcIixcImpcIixcImtcIixcImxcIl07XHJcblxyXG4vLyAtLS0gUHVibGljIEFQSVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNvbXB1dGVNb29kQ29lZmZWMShpbnA6IE1vb2RJbnB1dHMpIHtcclxuICBjb25zdCB2VCA9IE1hdGguc2lnbihpbnAudlRlbmRlbmN5ID8/IDApICogY2xhbXAoTWF0aC5hYnMoaW5wLnZUZW5kZW5jeSA/PyAwKSwgMCwgVl9URU5EX0FCU19NQVgpO1xyXG4gIGNvbnN0IHZTID0gTWF0aC5zaWduKGlucC52U3dhcCA/PyAwKSAgICAgKiBjbGFtcChNYXRoLmFicyhpbnAudlN3YXAgPz8gMCksICAgICAwLCBWX1NXQVBfQUJTX01BWCk7XHJcbiAgY29uc3QgZ2YgID0gY2xhbXAoaW5wLkdGTSA/PyAxLCBHRk1fTUlOLCBHRk1fTUFYKTtcclxuXHJcbiAgLy8gWW91ciBmb3JtdWxhXHJcbiAgbGV0IGNvZWZmID0gKCAodlQgfHwgMCkgLyAoZ2YgfHwgMSkgKSArICh2UyB8fCAwKTtcclxuICBjb2VmZiA9IGNsYW1wKGNvZWZmLCAwLjIsIDIuMCk7XHJcblxyXG4gIC8vIEJ1Y2tldHNcclxuICBjb25zdCB2dEN1dHMgPSBlcUN1dHMoVl9URU5EX0FCU19NQVgsIDYpO1xyXG4gIGNvbnN0IHZzQ3V0cyA9IGVxQ3V0cyhWX1NXQVBfQUJTX01BWCwgNik7XHJcbiAgY29uc3QgdlRJZHggID0gYmluU2lnbmVkKHZULCB2dEN1dHMsIDYsIDYpO1xyXG4gIGNvbnN0IHZTSWR4ICA9IGJpblNpZ25lZCh2UywgdnNDdXRzLCA2LCA2KTtcclxuICBjb25zdCBnSWR4ICAgPSBiaW5Bcm91bmRPbmUoZ2YpO1xyXG5cclxuICByZXR1cm4geyBjb2VmZiwgYnVja2V0czogeyB2VGVuZGVuY3lJZHg6IHZUSWR4LCB2U3dhcElkeDogdlNJZHgsIEdGTUlkeDogZ0lkeCB9IGFzIE1vb2RCdWNrZXRzIH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBtb29kVVVJREZyb21CdWNrZXRzKGI6IE1vb2RCdWNrZXRzKTogTW9vZFVVSUQge1xyXG4gIGNvbnN0IHZ0ID0gYi52VGVuZGVuY3lJZHggPCA2ID8gVlRfVVBbYi52VGVuZGVuY3lJZHhdIDogVlRfRE5bYi52VGVuZGVuY3lJZHggLSA2XTtcclxuICBjb25zdCB2cyA9IGIudlN3YXBJZHggICAgIDwgNiA/IFZTX1VQW2IudlN3YXBJZHhdICAgICA6IFZTX0ROW2IudlN3YXBJZHggLSA2XTtcclxuICBjb25zdCBnICA9IFN0cmluZyhiLkdGTUlkeCk7IC8vIDAuLjdcclxuICByZXR1cm4gYCR7dnR9JHt2c30ke2d9YDtcclxufVxyXG5cclxuLy8gQWRkIG5lYXIgdG9wOlxyXG5leHBvcnQgdHlwZSBNb29kUmVmZXJlbnRpYWxzID0ge1xyXG4gIGdmbVNjYWxlPzogbnVtYmVyOyAvLyBkZWZhdWx0IDIwXHJcbiAgdnRNdTogbnVtYmVyOyB2dFNpZ21hOiBudW1iZXI7IC8vIEZSViBhbmQgZGlzcGVyc2lvbiBmb3IgdHJlbmRcclxuICB2c011OiBudW1iZXI7IHZzU2lnbWE6IG51bWJlcjsgLy8gRlJWIGFuZCBkaXNwZXJzaW9uIGZvciBzd2FwXHJcbiAgdnNBbHBoYT86IG51bWJlcjsgLy8gZGVmYXVsdCAwLjc1XHJcbn07XHJcblxyXG4vLyBDb252ZXJ0IHJhdyDihpIgbm9ybWFsaXplZCBNb29kSW5wdXRzXHJcbmV4cG9ydCBmdW5jdGlvbiBub3JtYWxpemVNb29kSW5wdXRzKHJhdzoge1xyXG4gIGdmbURlbHRhUGN0OiBudW1iZXI7ICAgLy8gZS5nLiwgKzAuMDEgZm9yICsxJVxyXG4gIHRlbmRlbmN5UmF3OiBudW1iZXI7ICAgLy8geW91ciB0cmVuZCBwcm94eVxyXG4gIHN3YXBSYXc6IG51bWJlcjsgICAgICAgLy8geW91ciBzd2FwIHZlbG9jaXR5IHByb3h5XHJcbn0sIHJlZjogTW9vZFJlZmVyZW50aWFscyk6IE1vb2RJbnB1dHMge1xyXG4gIGNvbnN0IGVwcyA9IDFlLTk7XHJcbiAgY29uc3QgS2cgPSByZWYuZ2ZtU2NhbGUgPz8gMjA7XHJcbiAgY29uc3QgR0ZNID0gTWF0aC5taW4oTWF0aC5tYXgoMSArIEtnICogcmF3LmdmbURlbHRhUGN0LCAwLjgpLCAxLjIpO1xyXG5cclxuICBjb25zdCB6VCA9IE1hdGgubWF4KC0xLCBNYXRoLm1pbigxLCAocmF3LnRlbmRlbmN5UmF3IC0gcmVmLnZ0TXUpIC8gKChyZWYudnRTaWdtYSB8fCBlcHMpKSkpO1xyXG4gIGNvbnN0IHZUZW5kZW5jeSA9IDAuOCArIDAuNCAqIHpUO1xyXG5cclxuICBjb25zdCB6UyA9IChyYXcuc3dhcFJhdyAtIHJlZi52c011KSAvICgocmVmLnZzU2lnbWEgfHwgZXBzKSk7XHJcbiAgY29uc3QgdlN3YXAgPSAwLjUgKiBNYXRoLnRhbmgoKHJlZi52c0FscGhhID8/IDAuNzUpICogelMpO1xyXG5cclxuICByZXR1cm4geyB2VGVuZGVuY3ksIEdGTSwgdlN3YXAgfTtcclxufVxyXG4iXSwibmFtZXMiOlsiY2xhbXAiLCJ4IiwibG8iLCJoaSIsIk1hdGgiLCJtaW4iLCJtYXgiLCJWX1RFTkRfQUJTX01BWCIsIlZfU1dBUF9BQlNfTUFYIiwiR0ZNX01JTiIsIkdGTV9NQVgiLCJlcUN1dHMiLCJtYXhBYnMiLCJiaW5zIiwic3RlcCIsIkFycmF5IiwiZnJvbSIsImxlbmd0aCIsIl8iLCJpIiwiYmluU2lnbmVkIiwiYWJzQ3V0cyIsInVwQmlucyIsImRvd25CaW5zIiwiYSIsImFicyIsImlkeCIsImJpbkFyb3VuZE9uZSIsImdmbSIsImRlbHRhIiwiY3V0cyIsIlZUX1VQIiwiVlRfRE4iLCJWU19VUCIsIlZTX0ROIiwiY29tcHV0ZU1vb2RDb2VmZlYxIiwiaW5wIiwidlQiLCJzaWduIiwidlRlbmRlbmN5IiwidlMiLCJ2U3dhcCIsImdmIiwiR0ZNIiwiY29lZmYiLCJ2dEN1dHMiLCJ2c0N1dHMiLCJ2VElkeCIsInZTSWR4IiwiZ0lkeCIsImJ1Y2tldHMiLCJ2VGVuZGVuY3lJZHgiLCJ2U3dhcElkeCIsIkdGTUlkeCIsIm1vb2RVVUlERnJvbUJ1Y2tldHMiLCJiIiwidnQiLCJ2cyIsImciLCJTdHJpbmciLCJub3JtYWxpemVNb29kSW5wdXRzIiwicmF3IiwicmVmIiwiZXBzIiwiS2ciLCJnZm1TY2FsZSIsImdmbURlbHRhUGN0IiwielQiLCJ0ZW5kZW5jeVJhdyIsInZ0TXUiLCJ2dFNpZ21hIiwielMiLCJzd2FwUmF3IiwidnNNdSIsInZzU2lnbWEiLCJ0YW5oIiwidnNBbHBoYSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/mea/mood.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/settings/coin-universe.ts":
/*!*******************************************!*\
  !*** ./src/lib/settings/coin-universe.ts ***!
  \*******************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   fetchCoinUniverseBases: () => (/* binding */ fetchCoinUniverseBases),\n/* harmony export */   fetchCoinUniverseEntries: () => (/* binding */ fetchCoinUniverseEntries),\n/* harmony export */   fetchPairUniverseCoins: () => (/* binding */ fetchPairUniverseCoins),\n/* harmony export */   fetchPairUniversePairs: () => (/* binding */ fetchPairUniversePairs),\n/* harmony export */   normalizeCoinList: () => (/* binding */ normalizeCoinList),\n/* harmony export */   recordSettingsCookieSnapshot: () => (/* binding */ recordSettingsCookieSnapshot),\n/* harmony export */   syncCoinUniverseFromBases: () => (/* binding */ syncCoinUniverseFromBases)\n/* harmony export */ });\n/* harmony import */ var _core_db_pool_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/core/db/pool_server */ \"(rsc)/./src/core/db/pool_server.ts\");\n/* harmony import */ var _lib_markets_pairs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/markets/pairs */ \"(rsc)/./src/lib/markets/pairs.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_core_db_pool_server__WEBPACK_IMPORTED_MODULE_0__]);\n_core_db_pool_server__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\nconst SORT_SENTINEL = 2147483647;\nfunction normalizeCoinList(input) {\n    const arr = Array.isArray(input) ? input : [];\n    const seen = new Set();\n    const out = [];\n    for (const raw of arr){\n        const coin = (0,_lib_markets_pairs__WEBPACK_IMPORTED_MODULE_1__.normalizeCoin)(raw);\n        if (!coin || seen.has(coin)) continue;\n        seen.add(coin);\n        out.push(coin);\n    }\n    if (!seen.has(\"USDT\")) {\n        seen.add(\"USDT\");\n        out.push(\"USDT\");\n    }\n    return out;\n}\nasync function fetchCoinUniverseEntries(options = {}) {\n    try {\n        const { rows } = await (0,_core_db_pool_server__WEBPACK_IMPORTED_MODULE_0__.query)(`\n        select\n          symbol,\n          upper(coalesce(base_asset, (public._split_symbol(symbol)).base)) as base,\n          upper(coalesce(quote_asset, (public._split_symbol(symbol)).quote)) as quote,\n          coalesce(enabled, true) as enabled,\n          sort_order\n        from settings.coin_universe\n        ${options.onlyEnabled ? \"where coalesce(enabled, true) = true\" : \"\"}\n        order by coalesce(sort_order, $1::int), symbol\n      `, [\n            SORT_SENTINEL\n        ]);\n        return rows.filter((row)=>row.base && row.quote).map((row)=>({\n                symbol: row.symbol?.toUpperCase() ?? \"\",\n                base: row.base.toUpperCase(),\n                quote: row.quote.toUpperCase(),\n                enabled: Boolean(row.enabled ?? true),\n                sortOrder: row.sort_order\n            })).filter((entry)=>entry.symbol.length > 0);\n    } catch (err) {\n        console.warn(\"[settings] coin universe query failed:\", err);\n        return [];\n    }\n}\nasync function fetchPairUniversePairs() {\n    try {\n        const { rows } = await (0,_core_db_pool_server__WEBPACK_IMPORTED_MODULE_0__.query)(`\n        select base, quote\n        from matrices.v_pair_universe\n      `);\n        return rows.map((row)=>({\n                base: row.base?.toUpperCase().trim() ?? \"\",\n                quote: row.quote?.toUpperCase().trim() ?? \"\"\n            })).filter((row)=>row.base && row.quote && row.base !== row.quote);\n    } catch (err) {\n        console.warn(\"[settings] pair universe query failed:\", err);\n        return [];\n    }\n}\nasync function fetchPairUniverseCoins() {\n    const pairs = await fetchPairUniversePairs();\n    if (!pairs.length) return [];\n    const set = new Set();\n    for (const { base, quote } of pairs){\n        if (base) set.add(base);\n        if (quote) set.add(quote);\n    }\n    if (!set.has(\"USDT\")) set.add(\"USDT\");\n    return Array.from(set);\n}\nasync function fetchCoinUniverseBases(options = {}) {\n    const entries = await fetchCoinUniverseEntries(options);\n    const bases = entries.filter((entry)=>options.onlyEnabled ? entry.enabled : true).map((entry)=>entry.base);\n    return normalizeCoinList(bases);\n}\nasync function syncCoinUniverseFromBases(bases) {\n    const normalized = normalizeCoinList(bases);\n    if (!normalized.length) return;\n    const symbols = normalized.filter((coin)=>coin !== \"USDT\").map((coin)=>`${coin}USDT`);\n    if (!symbols.length) return;\n    try {\n        await (0,_core_db_pool_server__WEBPACK_IMPORTED_MODULE_0__.query)(`select settings.sp_sync_coin_universe($1::text[])`, [\n            symbols\n        ]);\n    } catch (err) {\n        console.warn(\"[settings] sync coin universe failed:\", err);\n    }\n}\nasync function recordSettingsCookieSnapshot(jsonValue) {\n    if (!jsonValue) return;\n    try {\n        await (0,_core_db_pool_server__WEBPACK_IMPORTED_MODULE_0__.query)(`\n        insert into settings.cookies(name, value, updated_at)\n        values ('appSettings', $1::jsonb, now())\n        on conflict (name) do update\n          set value = excluded.value,\n              updated_at = excluded.updated_at\n      `, [\n            jsonValue\n        ]);\n    } catch (err) {\n        // table might not exist yet; log once for awareness\n        console.warn(\"[settings] cookie snapshot skipped:\", err);\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3NldHRpbmdzL2NvaW4tdW5pdmVyc2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQThDO0FBQ007QUFFcEQsTUFBTUUsZ0JBQWdCO0FBbUJmLFNBQVNDLGtCQUFrQkMsS0FBYztJQUM5QyxNQUFNQyxNQUFNQyxNQUFNQyxPQUFPLENBQUNILFNBQVNBLFFBQVEsRUFBRTtJQUM3QyxNQUFNSSxPQUFPLElBQUlDO0lBQ2pCLE1BQU1DLE1BQWdCLEVBQUU7SUFDeEIsS0FBSyxNQUFNQyxPQUFPTixJQUFLO1FBQ3JCLE1BQU1PLE9BQU9YLGlFQUFhQSxDQUFDVTtRQUMzQixJQUFJLENBQUNDLFFBQVFKLEtBQUtLLEdBQUcsQ0FBQ0QsT0FBTztRQUM3QkosS0FBS00sR0FBRyxDQUFDRjtRQUNURixJQUFJSyxJQUFJLENBQUNIO0lBQ1g7SUFDQSxJQUFJLENBQUNKLEtBQUtLLEdBQUcsQ0FBQyxTQUFTO1FBQ3JCTCxLQUFLTSxHQUFHLENBQUM7UUFDVEosSUFBSUssSUFBSSxDQUFDO0lBQ1g7SUFDQSxPQUFPTDtBQUNUO0FBRU8sZUFBZU0seUJBQXlCQyxVQUF3QixDQUFDLENBQUM7SUFDdkUsSUFBSTtRQUNGLE1BQU0sRUFBRUMsSUFBSSxFQUFFLEdBQUcsTUFBTWxCLDJEQUFLQSxDQU8xQixDQUFDOzs7Ozs7OztRQVFDLEVBQUVpQixRQUFRRSxXQUFXLEdBQUcseUNBQXlDLEdBQUc7O01BRXRFLENBQUMsRUFDRDtZQUFDakI7U0FBYztRQUdqQixPQUFPZ0IsS0FDSkUsTUFBTSxDQUFDLENBQUNDLE1BQVFBLElBQUlDLElBQUksSUFBSUQsSUFBSUUsS0FBSyxFQUNyQ0MsR0FBRyxDQUFDLENBQUNILE1BQVM7Z0JBQ2JJLFFBQVFKLElBQUlJLE1BQU0sRUFBRUMsaUJBQWlCO2dCQUNyQ0osTUFBTUQsSUFBSUMsSUFBSSxDQUFFSSxXQUFXO2dCQUMzQkgsT0FBT0YsSUFBSUUsS0FBSyxDQUFFRyxXQUFXO2dCQUM3QkMsU0FBU0MsUUFBUVAsSUFBSU0sT0FBTyxJQUFJO2dCQUNoQ0UsV0FBV1IsSUFBSVMsVUFBVTtZQUMzQixJQUNDVixNQUFNLENBQUMsQ0FBQ1csUUFBVUEsTUFBTU4sTUFBTSxDQUFDTyxNQUFNLEdBQUc7SUFDN0MsRUFBRSxPQUFPQyxLQUFLO1FBQ1pDLFFBQVFDLElBQUksQ0FBQywwQ0FBMENGO1FBQ3ZELE9BQU8sRUFBRTtJQUNYO0FBQ0Y7QUFFTyxlQUFlRztJQUNwQixJQUFJO1FBQ0YsTUFBTSxFQUFFbEIsSUFBSSxFQUFFLEdBQUcsTUFBTWxCLDJEQUFLQSxDQUMxQixDQUFDOzs7TUFHRCxDQUFDO1FBRUgsT0FBT2tCLEtBQ0pNLEdBQUcsQ0FBQyxDQUFDSCxNQUFTO2dCQUNiQyxNQUFNRCxJQUFJQyxJQUFJLEVBQUVJLGNBQWNXLFVBQVU7Z0JBQ3hDZCxPQUFPRixJQUFJRSxLQUFLLEVBQUVHLGNBQWNXLFVBQVU7WUFDNUMsSUFDQ2pCLE1BQU0sQ0FBQyxDQUFDQyxNQUFRQSxJQUFJQyxJQUFJLElBQUlELElBQUlFLEtBQUssSUFBSUYsSUFBSUMsSUFBSSxLQUFLRCxJQUFJRSxLQUFLO0lBQ3BFLEVBQUUsT0FBT1UsS0FBSztRQUNaQyxRQUFRQyxJQUFJLENBQUMsMENBQTBDRjtRQUN2RCxPQUFPLEVBQUU7SUFDWDtBQUNGO0FBRU8sZUFBZUs7SUFDcEIsTUFBTUMsUUFBUSxNQUFNSDtJQUNwQixJQUFJLENBQUNHLE1BQU1QLE1BQU0sRUFBRSxPQUFPLEVBQUU7SUFFNUIsTUFBTVEsTUFBTSxJQUFJL0I7SUFDaEIsS0FBSyxNQUFNLEVBQUVhLElBQUksRUFBRUMsS0FBSyxFQUFFLElBQUlnQixNQUFPO1FBQ25DLElBQUlqQixNQUFNa0IsSUFBSTFCLEdBQUcsQ0FBQ1E7UUFDbEIsSUFBSUMsT0FBT2lCLElBQUkxQixHQUFHLENBQUNTO0lBQ3JCO0lBQ0EsSUFBSSxDQUFDaUIsSUFBSTNCLEdBQUcsQ0FBQyxTQUFTMkIsSUFBSTFCLEdBQUcsQ0FBQztJQUM5QixPQUFPUixNQUFNbUMsSUFBSSxDQUFDRDtBQUNwQjtBQUVPLGVBQWVFLHVCQUF1QnpCLFVBQXdCLENBQUMsQ0FBQztJQUNyRSxNQUFNMEIsVUFBVSxNQUFNM0IseUJBQXlCQztJQUMvQyxNQUFNMkIsUUFBUUQsUUFDWHZCLE1BQU0sQ0FBQyxDQUFDVyxRQUFXZCxRQUFRRSxXQUFXLEdBQUdZLE1BQU1KLE9BQU8sR0FBRyxNQUN6REgsR0FBRyxDQUFDLENBQUNPLFFBQVVBLE1BQU1ULElBQUk7SUFDNUIsT0FBT25CLGtCQUFrQnlDO0FBQzNCO0FBRU8sZUFBZUMsMEJBQTBCRCxLQUFlO0lBQzdELE1BQU1FLGFBQWEzQyxrQkFBa0J5QztJQUNyQyxJQUFJLENBQUNFLFdBQVdkLE1BQU0sRUFBRTtJQUV4QixNQUFNZSxVQUFVRCxXQUNiMUIsTUFBTSxDQUFDLENBQUNSLE9BQVNBLFNBQVMsUUFDMUJZLEdBQUcsQ0FBQyxDQUFDWixPQUFTLEdBQUdBLEtBQUssSUFBSSxDQUFDO0lBRTlCLElBQUksQ0FBQ21DLFFBQVFmLE1BQU0sRUFBRTtJQUVyQixJQUFJO1FBQ0YsTUFBTWhDLDJEQUFLQSxDQUFDLENBQUMsaURBQWlELENBQUMsRUFBRTtZQUFDK0M7U0FBUTtJQUM1RSxFQUFFLE9BQU9kLEtBQUs7UUFDWkMsUUFBUUMsSUFBSSxDQUFDLHlDQUF5Q0Y7SUFDeEQ7QUFDRjtBQUVPLGVBQWVlLDZCQUE2QkMsU0FBb0M7SUFDckYsSUFBSSxDQUFDQSxXQUFXO0lBQ2hCLElBQUk7UUFDRixNQUFNakQsMkRBQUtBLENBQ1QsQ0FBQzs7Ozs7O01BTUQsQ0FBQyxFQUNEO1lBQUNpRDtTQUFVO0lBRWYsRUFBRSxPQUFPaEIsS0FBSztRQUNaLG9EQUFvRDtRQUNwREMsUUFBUUMsSUFBSSxDQUFDLHVDQUF1Q0Y7SUFDdEQ7QUFDRiIsInNvdXJjZXMiOlsiSDpcXFVzZXJzXFxHdXNcXHNvdXJjZVxccmVwb1xcZHluYW1pY3NcXGR5bmFtaWNzLWJcXGNyeXB0b3BpLWR5bmFtaWNzXFxzcmNcXGxpYlxcc2V0dGluZ3NcXGNvaW4tdW5pdmVyc2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcXVlcnkgfSBmcm9tIFwiQC9jb3JlL2RiL3Bvb2xfc2VydmVyXCI7XG5pbXBvcnQgeyBub3JtYWxpemVDb2luIH0gZnJvbSBcIkAvbGliL21hcmtldHMvcGFpcnNcIjtcblxuY29uc3QgU09SVF9TRU5USU5FTCA9IDJfMTQ3XzQ4M182NDc7XG5cbmV4cG9ydCB0eXBlIENvaW5Vbml2ZXJzZUVudHJ5ID0ge1xuICBzeW1ib2w6IHN0cmluZztcbiAgYmFzZTogc3RyaW5nO1xuICBxdW90ZTogc3RyaW5nO1xuICBlbmFibGVkOiBib29sZWFuO1xuICBzb3J0T3JkZXI6IG51bWJlciB8IG51bGw7XG59O1xuXG5leHBvcnQgdHlwZSBQYWlyVW5pdmVyc2VFbnRyeSA9IHtcbiAgYmFzZTogc3RyaW5nO1xuICBxdW90ZTogc3RyaW5nO1xufTtcblxudHlwZSBGZXRjaE9wdGlvbnMgPSB7XG4gIG9ubHlFbmFibGVkPzogYm9vbGVhbjtcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBub3JtYWxpemVDb2luTGlzdChpbnB1dDogdW5rbm93bik6IHN0cmluZ1tdIHtcbiAgY29uc3QgYXJyID0gQXJyYXkuaXNBcnJheShpbnB1dCkgPyBpbnB1dCA6IFtdO1xuICBjb25zdCBzZWVuID0gbmV3IFNldDxzdHJpbmc+KCk7XG4gIGNvbnN0IG91dDogc3RyaW5nW10gPSBbXTtcbiAgZm9yIChjb25zdCByYXcgb2YgYXJyKSB7XG4gICAgY29uc3QgY29pbiA9IG5vcm1hbGl6ZUNvaW4ocmF3IGFzIHN0cmluZyk7XG4gICAgaWYgKCFjb2luIHx8IHNlZW4uaGFzKGNvaW4pKSBjb250aW51ZTtcbiAgICBzZWVuLmFkZChjb2luKTtcbiAgICBvdXQucHVzaChjb2luKTtcbiAgfVxuICBpZiAoIXNlZW4uaGFzKFwiVVNEVFwiKSkge1xuICAgIHNlZW4uYWRkKFwiVVNEVFwiKTtcbiAgICBvdXQucHVzaChcIlVTRFRcIik7XG4gIH1cbiAgcmV0dXJuIG91dDtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZldGNoQ29pblVuaXZlcnNlRW50cmllcyhvcHRpb25zOiBGZXRjaE9wdGlvbnMgPSB7fSk6IFByb21pc2U8Q29pblVuaXZlcnNlRW50cnlbXT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHsgcm93cyB9ID0gYXdhaXQgcXVlcnk8e1xuICAgICAgc3ltYm9sOiBzdHJpbmc7XG4gICAgICBiYXNlOiBzdHJpbmcgfCBudWxsO1xuICAgICAgcXVvdGU6IHN0cmluZyB8IG51bGw7XG4gICAgICBlbmFibGVkOiBib29sZWFuIHwgbnVsbDtcbiAgICAgIHNvcnRfb3JkZXI6IG51bWJlciB8IG51bGw7XG4gICAgfT4oXG4gICAgICBgXG4gICAgICAgIHNlbGVjdFxuICAgICAgICAgIHN5bWJvbCxcbiAgICAgICAgICB1cHBlcihjb2FsZXNjZShiYXNlX2Fzc2V0LCAocHVibGljLl9zcGxpdF9zeW1ib2woc3ltYm9sKSkuYmFzZSkpIGFzIGJhc2UsXG4gICAgICAgICAgdXBwZXIoY29hbGVzY2UocXVvdGVfYXNzZXQsIChwdWJsaWMuX3NwbGl0X3N5bWJvbChzeW1ib2wpKS5xdW90ZSkpIGFzIHF1b3RlLFxuICAgICAgICAgIGNvYWxlc2NlKGVuYWJsZWQsIHRydWUpIGFzIGVuYWJsZWQsXG4gICAgICAgICAgc29ydF9vcmRlclxuICAgICAgICBmcm9tIHNldHRpbmdzLmNvaW5fdW5pdmVyc2VcbiAgICAgICAgJHtvcHRpb25zLm9ubHlFbmFibGVkID8gXCJ3aGVyZSBjb2FsZXNjZShlbmFibGVkLCB0cnVlKSA9IHRydWVcIiA6IFwiXCJ9XG4gICAgICAgIG9yZGVyIGJ5IGNvYWxlc2NlKHNvcnRfb3JkZXIsICQxOjppbnQpLCBzeW1ib2xcbiAgICAgIGAsXG4gICAgICBbU09SVF9TRU5USU5FTF1cbiAgICApO1xuXG4gICAgcmV0dXJuIHJvd3NcbiAgICAgIC5maWx0ZXIoKHJvdykgPT4gcm93LmJhc2UgJiYgcm93LnF1b3RlKVxuICAgICAgLm1hcCgocm93KSA9PiAoe1xuICAgICAgICBzeW1ib2w6IHJvdy5zeW1ib2w/LnRvVXBwZXJDYXNlKCkgPz8gXCJcIixcbiAgICAgICAgYmFzZTogcm93LmJhc2UhLnRvVXBwZXJDYXNlKCksXG4gICAgICAgIHF1b3RlOiByb3cucXVvdGUhLnRvVXBwZXJDYXNlKCksXG4gICAgICAgIGVuYWJsZWQ6IEJvb2xlYW4ocm93LmVuYWJsZWQgPz8gdHJ1ZSksXG4gICAgICAgIHNvcnRPcmRlcjogcm93LnNvcnRfb3JkZXIsXG4gICAgICB9KSlcbiAgICAgIC5maWx0ZXIoKGVudHJ5KSA9PiBlbnRyeS5zeW1ib2wubGVuZ3RoID4gMCk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGNvbnNvbGUud2FybihcIltzZXR0aW5nc10gY29pbiB1bml2ZXJzZSBxdWVyeSBmYWlsZWQ6XCIsIGVycik7XG4gICAgcmV0dXJuIFtdO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmZXRjaFBhaXJVbml2ZXJzZVBhaXJzKCk6IFByb21pc2U8UGFpclVuaXZlcnNlRW50cnlbXT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHsgcm93cyB9ID0gYXdhaXQgcXVlcnk8eyBiYXNlOiBzdHJpbmcgfCBudWxsOyBxdW90ZTogc3RyaW5nIHwgbnVsbCB9PihcbiAgICAgIGBcbiAgICAgICAgc2VsZWN0IGJhc2UsIHF1b3RlXG4gICAgICAgIGZyb20gbWF0cmljZXMudl9wYWlyX3VuaXZlcnNlXG4gICAgICBgXG4gICAgKTtcbiAgICByZXR1cm4gcm93c1xuICAgICAgLm1hcCgocm93KSA9PiAoe1xuICAgICAgICBiYXNlOiByb3cuYmFzZT8udG9VcHBlckNhc2UoKS50cmltKCkgPz8gXCJcIixcbiAgICAgICAgcXVvdGU6IHJvdy5xdW90ZT8udG9VcHBlckNhc2UoKS50cmltKCkgPz8gXCJcIixcbiAgICAgIH0pKVxuICAgICAgLmZpbHRlcigocm93KSA9PiByb3cuYmFzZSAmJiByb3cucXVvdGUgJiYgcm93LmJhc2UgIT09IHJvdy5xdW90ZSk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGNvbnNvbGUud2FybihcIltzZXR0aW5nc10gcGFpciB1bml2ZXJzZSBxdWVyeSBmYWlsZWQ6XCIsIGVycik7XG4gICAgcmV0dXJuIFtdO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmZXRjaFBhaXJVbml2ZXJzZUNvaW5zKCk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgY29uc3QgcGFpcnMgPSBhd2FpdCBmZXRjaFBhaXJVbml2ZXJzZVBhaXJzKCk7XG4gIGlmICghcGFpcnMubGVuZ3RoKSByZXR1cm4gW107XG5cbiAgY29uc3Qgc2V0ID0gbmV3IFNldDxzdHJpbmc+KCk7XG4gIGZvciAoY29uc3QgeyBiYXNlLCBxdW90ZSB9IG9mIHBhaXJzKSB7XG4gICAgaWYgKGJhc2UpIHNldC5hZGQoYmFzZSk7XG4gICAgaWYgKHF1b3RlKSBzZXQuYWRkKHF1b3RlKTtcbiAgfVxuICBpZiAoIXNldC5oYXMoXCJVU0RUXCIpKSBzZXQuYWRkKFwiVVNEVFwiKTtcbiAgcmV0dXJuIEFycmF5LmZyb20oc2V0KTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZldGNoQ29pblVuaXZlcnNlQmFzZXMob3B0aW9uczogRmV0Y2hPcHRpb25zID0ge30pOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gIGNvbnN0IGVudHJpZXMgPSBhd2FpdCBmZXRjaENvaW5Vbml2ZXJzZUVudHJpZXMob3B0aW9ucyk7XG4gIGNvbnN0IGJhc2VzID0gZW50cmllc1xuICAgIC5maWx0ZXIoKGVudHJ5KSA9PiAob3B0aW9ucy5vbmx5RW5hYmxlZCA/IGVudHJ5LmVuYWJsZWQgOiB0cnVlKSlcbiAgICAubWFwKChlbnRyeSkgPT4gZW50cnkuYmFzZSk7XG4gIHJldHVybiBub3JtYWxpemVDb2luTGlzdChiYXNlcyk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzeW5jQ29pblVuaXZlcnNlRnJvbUJhc2VzKGJhc2VzOiBzdHJpbmdbXSk6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCBub3JtYWxpemVkID0gbm9ybWFsaXplQ29pbkxpc3QoYmFzZXMpO1xuICBpZiAoIW5vcm1hbGl6ZWQubGVuZ3RoKSByZXR1cm47XG5cbiAgY29uc3Qgc3ltYm9scyA9IG5vcm1hbGl6ZWRcbiAgICAuZmlsdGVyKChjb2luKSA9PiBjb2luICE9PSBcIlVTRFRcIilcbiAgICAubWFwKChjb2luKSA9PiBgJHtjb2lufVVTRFRgKTtcblxuICBpZiAoIXN5bWJvbHMubGVuZ3RoKSByZXR1cm47XG5cbiAgdHJ5IHtcbiAgICBhd2FpdCBxdWVyeShgc2VsZWN0IHNldHRpbmdzLnNwX3N5bmNfY29pbl91bml2ZXJzZSgkMTo6dGV4dFtdKWAsIFtzeW1ib2xzXSk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGNvbnNvbGUud2FybihcIltzZXR0aW5nc10gc3luYyBjb2luIHVuaXZlcnNlIGZhaWxlZDpcIiwgZXJyKTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVjb3JkU2V0dGluZ3NDb29raWVTbmFwc2hvdChqc29uVmFsdWU6IHN0cmluZyB8IG51bGwgfCB1bmRlZmluZWQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgaWYgKCFqc29uVmFsdWUpIHJldHVybjtcbiAgdHJ5IHtcbiAgICBhd2FpdCBxdWVyeShcbiAgICAgIGBcbiAgICAgICAgaW5zZXJ0IGludG8gc2V0dGluZ3MuY29va2llcyhuYW1lLCB2YWx1ZSwgdXBkYXRlZF9hdClcbiAgICAgICAgdmFsdWVzICgnYXBwU2V0dGluZ3MnLCAkMTo6anNvbmIsIG5vdygpKVxuICAgICAgICBvbiBjb25mbGljdCAobmFtZSkgZG8gdXBkYXRlXG4gICAgICAgICAgc2V0IHZhbHVlID0gZXhjbHVkZWQudmFsdWUsXG4gICAgICAgICAgICAgIHVwZGF0ZWRfYXQgPSBleGNsdWRlZC51cGRhdGVkX2F0XG4gICAgICBgLFxuICAgICAgW2pzb25WYWx1ZV1cbiAgICApO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICAvLyB0YWJsZSBtaWdodCBub3QgZXhpc3QgeWV0OyBsb2cgb25jZSBmb3IgYXdhcmVuZXNzXG4gICAgY29uc29sZS53YXJuKFwiW3NldHRpbmdzXSBjb29raWUgc25hcHNob3Qgc2tpcHBlZDpcIiwgZXJyKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbInF1ZXJ5Iiwibm9ybWFsaXplQ29pbiIsIlNPUlRfU0VOVElORUwiLCJub3JtYWxpemVDb2luTGlzdCIsImlucHV0IiwiYXJyIiwiQXJyYXkiLCJpc0FycmF5Iiwic2VlbiIsIlNldCIsIm91dCIsInJhdyIsImNvaW4iLCJoYXMiLCJhZGQiLCJwdXNoIiwiZmV0Y2hDb2luVW5pdmVyc2VFbnRyaWVzIiwib3B0aW9ucyIsInJvd3MiLCJvbmx5RW5hYmxlZCIsImZpbHRlciIsInJvdyIsImJhc2UiLCJxdW90ZSIsIm1hcCIsInN5bWJvbCIsInRvVXBwZXJDYXNlIiwiZW5hYmxlZCIsIkJvb2xlYW4iLCJzb3J0T3JkZXIiLCJzb3J0X29yZGVyIiwiZW50cnkiLCJsZW5ndGgiLCJlcnIiLCJjb25zb2xlIiwid2FybiIsImZldGNoUGFpclVuaXZlcnNlUGFpcnMiLCJ0cmltIiwiZmV0Y2hQYWlyVW5pdmVyc2VDb2lucyIsInBhaXJzIiwic2V0IiwiZnJvbSIsImZldGNoQ29pblVuaXZlcnNlQmFzZXMiLCJlbnRyaWVzIiwiYmFzZXMiLCJzeW5jQ29pblVuaXZlcnNlRnJvbUJhc2VzIiwibm9ybWFsaXplZCIsInN5bWJvbHMiLCJyZWNvcmRTZXR0aW5nc0Nvb2tpZVNuYXBzaG90IiwianNvblZhbHVlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/settings/coin-universe.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/settings/schema.ts":
/*!************************************!*\
  !*** ./src/lib/settings/schema.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AppSettings: () => (/* binding */ AppSettings),\n/* harmony export */   DEFAULT_SETTINGS: () => (/* binding */ DEFAULT_SETTINGS),\n/* harmony export */   SETTINGS_VERSION: () => (/* binding */ SETTINGS_VERSION),\n/* harmony export */   isAppSettings: () => (/* binding */ isAppSettings),\n/* harmony export */   mergeAppSettings: () => (/* binding */ mergeAppSettings),\n/* harmony export */   migrateSettings: () => (/* binding */ migrateSettings),\n/* harmony export */   normalizeCoinUniverse: () => (/* binding */ normalizeCoinUniverse)\n/* harmony export */ });\n// src/lib/settings/schema.ts\nconst SETTINGS_VERSION = 1;\nconst DEFAULT_SETTINGS = {\n    version: SETTINGS_VERSION,\n    coinUniverse: [],\n    profile: {\n        nickname: \"\",\n        email: \"\",\n        binanceKeyId: \"\"\n    },\n    stats: {\n        histogramLen: 64,\n        bmDecimals: 4,\n        idPctDecimals: 6\n    },\n    poll: {\n        cycle40: 40,\n        cycle120: 120,\n        refreshUrl: \"/api/system/refresh\"\n    },\n    timing: {\n        autoRefresh: true,\n        autoRefreshMs: 40000,\n        secondaryEnabled: true,\n        secondaryCycles: 3,\n        strCycles: {\n            m30: 45,\n            h1: 90,\n            h3: 270\n        }\n    },\n    clustering: {\n        clusters: [\n            {\n                id: \"cl-1\",\n                name: \"Cluster 1\",\n                coins: []\n            }\n        ]\n    },\n    params: {\n        values: {\n            eta: 0.02,\n            epsilon: 0.2,\n            iota: 0.5\n        }\n    }\n};\n// ---------- internal helpers ----------\nconst toUpperArray = (value)=>{\n    if (!Array.isArray(value)) return [];\n    const seen = new Set();\n    const result = [];\n    for (const entry of value){\n        const upper = String(entry ?? \"\").trim().toUpperCase();\n        if (!upper || seen.has(upper)) continue;\n        seen.add(upper);\n        result.push(upper);\n    }\n    if (!seen.has(\"USDT\")) result.push(\"USDT\");\n    return result;\n};\nconst toNumber = (value, fallback)=>{\n    const parsed = Number(value);\n    return Number.isFinite(parsed) ? parsed : fallback;\n};\nconst clamp = (value, min, max)=>Math.min(max, Math.max(min, value));\nconst toClusterArray = (value)=>{\n    if (!Array.isArray(value)) return DEFAULT_SETTINGS.clustering.clusters;\n    return value.map((entry, index)=>{\n        const obj = entry && typeof entry === \"object\" ? entry : {};\n        return {\n            id: String(obj.id ?? `cl-${index + 1}`),\n            name: String(obj.name ?? `Cluster ${index + 1}`),\n            coins: toUpperArray(obj.coins)\n        };\n    });\n};\nconst toParams = (value)=>{\n    if (!value || typeof value !== \"object\") return {\n        ...DEFAULT_SETTINGS.params.values\n    };\n    const result = {\n        ...DEFAULT_SETTINGS.params.values\n    };\n    for (const [key, raw] of Object.entries(value)){\n        const parsed = Number(raw);\n        if (Number.isFinite(parsed)) result[key] = parsed;\n    }\n    return result;\n};\nconst toPoll = (value)=>{\n    const base = {\n        cycle40: DEFAULT_SETTINGS.poll.cycle40,\n        cycle120: DEFAULT_SETTINGS.poll.cycle120,\n        refreshUrl: DEFAULT_SETTINGS.poll.refreshUrl\n    };\n    if (!value || typeof value !== \"object\") return base;\n    const obj = value;\n    const sanitizeCycle = (raw, fallback)=>{\n        const parsed = Number(raw);\n        if (!Number.isFinite(parsed)) return fallback;\n        const bounded = Math.floor(parsed);\n        return Math.max(5, Math.min(600, bounded));\n    };\n    const resolveUrl = (raw)=>{\n        if (typeof raw !== \"string\") return null;\n        const trimmed = raw.trim();\n        return trimmed.length ? trimmed : null;\n    };\n    return {\n        cycle40: sanitizeCycle(obj.cycle40, base.cycle40),\n        cycle120: sanitizeCycle(obj.cycle120, base.cycle120),\n        refreshUrl: resolveUrl(obj.refreshUrl) ?? resolveUrl(base.refreshUrl) ?? DEFAULT_SETTINGS.poll.refreshUrl\n    };\n};\n// ---------- public migration (existing) ----------\nfunction migrateSettings(input) {\n    const s = input && typeof input === \"object\" ? input : {};\n    const statsSource = s.stats && typeof s.stats === \"object\" ? s.stats : {};\n    const timingSource = s.timing && typeof s.timing === \"object\" ? s.timing : {};\n    const timingCycles = timingSource.strCycles && typeof timingSource.strCycles === \"object\" ? timingSource.strCycles : {};\n    const out = {\n        version: SETTINGS_VERSION,\n        coinUniverse: toUpperArray(s.coinUniverse),\n        profile: {\n            nickname: String(s.profile?.nickname ?? \"\"),\n            email: String(s.profile?.email ?? \"\"),\n            binanceKeyId: String(s.profile?.binanceKeyId ?? \"\")\n        },\n        stats: {\n            histogramLen: Math.max(16, toNumber(statsSource.histogramLen, DEFAULT_SETTINGS.stats.histogramLen)),\n            bmDecimals: clamp(toNumber(statsSource.bmDecimals, DEFAULT_SETTINGS.stats.bmDecimals), 0, 6),\n            idPctDecimals: clamp(toNumber(statsSource.idPctDecimals, DEFAULT_SETTINGS.stats.idPctDecimals), 0, 8)\n        },\n        poll: toPoll(s.poll),\n        timing: {\n            autoRefresh: Boolean(timingSource.autoRefresh ?? DEFAULT_SETTINGS.timing.autoRefresh),\n            autoRefreshMs: Math.max(500, toNumber(timingSource.autoRefreshMs, DEFAULT_SETTINGS.timing.autoRefreshMs)),\n            secondaryEnabled: Boolean(timingSource.secondaryEnabled ?? DEFAULT_SETTINGS.timing.secondaryEnabled),\n            secondaryCycles: clamp(toNumber(timingSource.secondaryCycles, DEFAULT_SETTINGS.timing.secondaryCycles), 1, 10),\n            strCycles: {\n                m30: Math.max(1, toNumber(timingCycles.m30, DEFAULT_SETTINGS.timing.strCycles.m30)),\n                h1: Math.max(1, toNumber(timingCycles.h1, DEFAULT_SETTINGS.timing.strCycles.h1)),\n                h3: Math.max(1, toNumber(timingCycles.h3, DEFAULT_SETTINGS.timing.strCycles.h3))\n            }\n        },\n        clustering: {\n            clusters: toClusterArray(s.clustering?.clusters)\n        },\n        params: {\n            values: toParams(s.params?.values)\n        }\n    };\n    if (out.coinUniverse.length === 0) {\n        out.coinUniverse = [\n            ...DEFAULT_SETTINGS.coinUniverse\n        ];\n    }\n    return out;\n}\n/** Normalize coins from a string (comma/space-separated) or array; ensures USDT present and uppercase+deduped. */ function normalizeCoinUniverse(input) {\n    if (Array.isArray(input)) return toUpperArray(input);\n    if (typeof input === \"string\") {\n        const parts = input.split(/[,\\s]+/).map((s)=>s.trim()).filter(Boolean);\n        return toUpperArray(parts);\n    }\n    return toUpperArray([]);\n}\n/** Type guard to check if an object already looks like an AppSettings after migration. */ function isAppSettings(x) {\n    return !!x && typeof x === \"object\" && \"version\" in x && \"coinUniverse\" in x;\n}\n/**\n * Factory  create a normalized AppSettings object.\n * - If you pass nothing, you get migrated DEFAULT_SETTINGS.\n * - If you pass a deep-partial or any unknown, it is migrated safely.\n */ function AppSettings(input) {\n    return migrateSettings(input ?? DEFAULT_SETTINGS);\n}\n/** Merge a base AppSettings with a deep-partial patch, then normalize. */ function mergeAppSettings(base, patch) {\n    // shallow-merge at top level; nested objects are re-validated by migrateSettings\n    return migrateSettings({\n        ...base,\n        ...patch\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUMsVUFBVTFCLEdBQUcsQ0FBQ2tCLENBQUFBLElBQUtBLEVBQUVqQyxJQUFJLElBQUkwQyxNQUFNLENBQUNKO1FBQzlELE9BQU9oRCxhQUFha0Q7SUFDdEI7SUFDQSxPQUFPbEQsYUFBYSxFQUFFO0FBQ3hCO0FBRUEsd0ZBQXdGLEdBQ2pGLFNBQVNxRCxjQUFjQyxDQUFVO0lBQ3RDLE9BQU8sQ0FBQyxDQUFDQSxLQUFLLE9BQU9BLE1BQU0sWUFBWSxhQUFjQSxLQUFhLGtCQUFtQkE7QUFDdkY7QUFFQTs7OztDQUlDLEdBQ00sU0FBU0MsWUFBWWIsS0FBMEM7SUFDcEUsT0FBT0QsZ0JBQWdCQyxTQUFTNUU7QUFDbEM7QUFFQSx3RUFBd0UsR0FDakUsU0FBUzBGLGlCQUFpQnRCLElBQWlCLEVBQUV1QixLQUErQjtJQUNqRixpRkFBaUY7SUFDakYsT0FBT2hCLGdCQUFnQjtRQUFFLEdBQUdQLElBQUk7UUFBRSxHQUFHdUIsS0FBSztJQUFDO0FBQzdDIiwic291cmNlcyI6WyJIOlxcVXNlcnNcXEd1c1xcc291cmNlXFxyZXBvXFxkeW5hbWljc1xcZHluYW1pY3MtYlxcY3J5cHRvcGktZHluYW1pY3NcXHNyY1xcbGliXFxzZXR0aW5nc1xcc2NoZW1hLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9saWIvc2V0dGluZ3Mvc2NoZW1hLnRzXG5leHBvcnQgdHlwZSBDbHVzdGVyID0geyBpZDogc3RyaW5nOyBuYW1lOiBzdHJpbmc7IGNvaW5zOiBzdHJpbmdbXSB9O1xuXG5leHBvcnQgdHlwZSBBcHBTZXR0aW5ncyA9IHtcbiAgdmVyc2lvbjogbnVtYmVyO1xuICBjb2luVW5pdmVyc2U6IHN0cmluZ1tdO1xuICBwcm9maWxlOiB7IG5pY2tuYW1lOiBzdHJpbmc7IGVtYWlsOiBzdHJpbmc7IGJpbmFuY2VLZXlJZDogc3RyaW5nIH07XG4gIHN0YXRzOiB7IGhpc3RvZ3JhbUxlbjogbnVtYmVyOyBibURlY2ltYWxzOiBudW1iZXI7IGlkUGN0RGVjaW1hbHM6IG51bWJlciB9O1xuICBwb2xsOiB7XG4gICAgY3ljbGU0MDogbnVtYmVyO1xuICAgIGN5Y2xlMTIwOiBudW1iZXI7XG4gICAgcmVmcmVzaFVybDogc3RyaW5nO1xuICB9O1xuICB0aW1pbmc6IHtcbiAgICBhdXRvUmVmcmVzaDogYm9vbGVhbjsgICAgICAgICAgIC8vIDwtLSByZXF1aXJlZCBmbGFnXG4gICAgYXV0b1JlZnJlc2hNczogbnVtYmVyO1xuICAgIHNlY29uZGFyeUVuYWJsZWQ6IGJvb2xlYW47XG4gICAgc2Vjb25kYXJ5Q3ljbGVzOiBudW1iZXI7ICAgICAgICAvLyAxLi4xMFxuICAgIHN0ckN5Y2xlczogeyBtMzA6IG51bWJlcjsgaDE6IG51bWJlcjsgaDM6IG51bWJlciB9O1xuICB9O1xuICBjbHVzdGVyaW5nOiB7XG4gICAgY2x1c3RlcnM6IENsdXN0ZXJbXTtcbiAgfTtcbiAgcGFyYW1zOiB7IHZhbHVlczogUmVjb3JkPHN0cmluZywgbnVtYmVyPiB9O1xufTtcblxuZXhwb3J0IGNvbnN0IFNFVFRJTkdTX1ZFUlNJT04gPSAxO1xuXG5leHBvcnQgY29uc3QgREVGQVVMVF9TRVRUSU5HUzogQXBwU2V0dGluZ3MgPSB7XG4gIHZlcnNpb246IFNFVFRJTkdTX1ZFUlNJT04sXG4gIGNvaW5Vbml2ZXJzZTogW10sXG4gIHByb2ZpbGU6IHsgbmlja25hbWU6IFwiXCIsIGVtYWlsOiBcIlwiLCBiaW5hbmNlS2V5SWQ6IFwiXCIgfSxcbiAgc3RhdHM6IHsgaGlzdG9ncmFtTGVuOiA2NCwgYm1EZWNpbWFsczogNCwgaWRQY3REZWNpbWFsczogNiB9LFxuICBwb2xsOiB7XG4gICAgY3ljbGU0MDogNDAsXG4gICAgY3ljbGUxMjA6IDEyMCxcbiAgICByZWZyZXNoVXJsOiBcIi9hcGkvc3lzdGVtL3JlZnJlc2hcIixcbiAgfSxcbiAgdGltaW5nOiB7XG4gICAgYXV0b1JlZnJlc2g6IHRydWUsXG4gICAgYXV0b1JlZnJlc2hNczogNDBfMDAwLFxuICAgIHNlY29uZGFyeUVuYWJsZWQ6IHRydWUsXG4gICAgc2Vjb25kYXJ5Q3ljbGVzOiAzLFxuICAgIHN0ckN5Y2xlczogeyBtMzA6IDQ1LCBoMTogOTAsIGgzOiAyNzAgfSxcbiAgfSxcbiAgY2x1c3RlcmluZzogeyBjbHVzdGVyczogW3sgaWQ6IFwiY2wtMVwiLCBuYW1lOiBcIkNsdXN0ZXIgMVwiLCBjb2luczogW10gfV0gfSxcbiAgcGFyYW1zOiB7IHZhbHVlczogeyBldGE6IDAuMDIsIGVwc2lsb246IDAuMiwgaW90YTogMC41IH0gfSxcbiAgXG59O1xuXG4vLyAtLS0tLS0tLS0tIGludGVybmFsIGhlbHBlcnMgLS0tLS0tLS0tLVxuY29uc3QgdG9VcHBlckFycmF5ID0gKHZhbHVlOiB1bmtub3duKTogc3RyaW5nW10gPT4ge1xuICBpZiAoIUFycmF5LmlzQXJyYXkodmFsdWUpKSByZXR1cm4gW107XG4gIGNvbnN0IHNlZW4gPSBuZXcgU2V0PHN0cmluZz4oKTtcbiAgY29uc3QgcmVzdWx0OiBzdHJpbmdbXSA9IFtdO1xuICBmb3IgKGNvbnN0IGVudHJ5IG9mIHZhbHVlKSB7XG4gICAgY29uc3QgdXBwZXIgPSBTdHJpbmcoZW50cnkgPz8gXCJcIikudHJpbSgpLnRvVXBwZXJDYXNlKCk7XG4gICAgaWYgKCF1cHBlciB8fCBzZWVuLmhhcyh1cHBlcikpIGNvbnRpbnVlO1xuICAgIHNlZW4uYWRkKHVwcGVyKTtcbiAgICByZXN1bHQucHVzaCh1cHBlcik7XG4gIH1cbiAgaWYgKCFzZWVuLmhhcyhcIlVTRFRcIikpIHJlc3VsdC5wdXNoKFwiVVNEVFwiKTtcbiAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbmNvbnN0IHRvTnVtYmVyID0gKHZhbHVlOiB1bmtub3duLCBmYWxsYmFjazogbnVtYmVyKTogbnVtYmVyID0+IHtcbiAgY29uc3QgcGFyc2VkID0gTnVtYmVyKHZhbHVlKTtcbiAgcmV0dXJuIE51bWJlci5pc0Zpbml0ZShwYXJzZWQpID8gcGFyc2VkIDogZmFsbGJhY2s7XG59O1xuXG5jb25zdCBjbGFtcCA9ICh2YWx1ZTogbnVtYmVyLCBtaW46IG51bWJlciwgbWF4OiBudW1iZXIpOiBudW1iZXIgPT5cbiAgTWF0aC5taW4obWF4LCBNYXRoLm1heChtaW4sIHZhbHVlKSk7XG5cbmNvbnN0IHRvQ2x1c3RlckFycmF5ID0gKHZhbHVlOiB1bmtub3duKTogQ2x1c3RlcltdID0+IHtcbiAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlKSkgcmV0dXJuIERFRkFVTFRfU0VUVElOR1MuY2x1c3RlcmluZy5jbHVzdGVycztcbiAgcmV0dXJuIHZhbHVlLm1hcCgoZW50cnksIGluZGV4KSA9PiB7XG4gICAgY29uc3Qgb2JqID0gKGVudHJ5ICYmIHR5cGVvZiBlbnRyeSA9PT0gXCJvYmplY3RcIikgPyBlbnRyeSBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiA6IHt9O1xuICAgIHJldHVybiB7XG4gICAgICBpZDogU3RyaW5nKG9iai5pZCA/PyBgY2wtJHtpbmRleCArIDF9YCksXG4gICAgICBuYW1lOiBTdHJpbmcob2JqLm5hbWUgPz8gYENsdXN0ZXIgJHtpbmRleCArIDF9YCksXG4gICAgICBjb2luczogdG9VcHBlckFycmF5KG9iai5jb2lucyksXG4gICAgfTtcbiAgfSk7XG59O1xuXG5jb25zdCB0b1BhcmFtcyA9ICh2YWx1ZTogdW5rbm93bik6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPT4ge1xuICBpZiAoIXZhbHVlIHx8IHR5cGVvZiB2YWx1ZSAhPT0gXCJvYmplY3RcIikgcmV0dXJuIHsgLi4uREVGQVVMVF9TRVRUSU5HUy5wYXJhbXMudmFsdWVzIH07XG4gIGNvbnN0IHJlc3VsdDogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHsgLi4uREVGQVVMVF9TRVRUSU5HUy5wYXJhbXMudmFsdWVzIH07XG4gIGZvciAoY29uc3QgW2tleSwgcmF3XSBvZiBPYmplY3QuZW50cmllcyh2YWx1ZSkpIHtcbiAgICBjb25zdCBwYXJzZWQgPSBOdW1iZXIocmF3KTtcbiAgICBpZiAoTnVtYmVyLmlzRmluaXRlKHBhcnNlZCkpIHJlc3VsdFtrZXldID0gcGFyc2VkO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG5jb25zdCB0b1BvbGwgPSAodmFsdWU6IHVua25vd24pID0+IHtcbiAgY29uc3QgYmFzZSA9IHtcbiAgICBjeWNsZTQwOiBERUZBVUxUX1NFVFRJTkdTLnBvbGwuY3ljbGU0MCxcbiAgICBjeWNsZTEyMDogREVGQVVMVF9TRVRUSU5HUy5wb2xsLmN5Y2xlMTIwLFxuICAgIHJlZnJlc2hVcmw6IERFRkFVTFRfU0VUVElOR1MucG9sbC5yZWZyZXNoVXJsLFxuICB9O1xuICBpZiAoIXZhbHVlIHx8IHR5cGVvZiB2YWx1ZSAhPT0gXCJvYmplY3RcIikgcmV0dXJuIGJhc2U7XG4gIGNvbnN0IG9iaiA9IHZhbHVlIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xuICBjb25zdCBzYW5pdGl6ZUN5Y2xlID0gKHJhdzogdW5rbm93biwgZmFsbGJhY2s6IG51bWJlcikgPT4ge1xuICAgIGNvbnN0IHBhcnNlZCA9IE51bWJlcihyYXcpO1xuICAgIGlmICghTnVtYmVyLmlzRmluaXRlKHBhcnNlZCkpIHJldHVybiBmYWxsYmFjaztcbiAgICBjb25zdCBib3VuZGVkID0gTWF0aC5mbG9vcihwYXJzZWQpO1xuICAgIHJldHVybiBNYXRoLm1heCg1LCBNYXRoLm1pbig2MDAsIGJvdW5kZWQpKTtcbiAgfTtcbiAgY29uc3QgcmVzb2x2ZVVybCA9IChyYXc6IHVua25vd24pOiBzdHJpbmcgfCBudWxsID0+IHtcbiAgICBpZiAodHlwZW9mIHJhdyAhPT0gXCJzdHJpbmdcIikgcmV0dXJuIG51bGw7XG4gICAgY29uc3QgdHJpbW1lZCA9IHJhdy50cmltKCk7XG4gICAgcmV0dXJuIHRyaW1tZWQubGVuZ3RoID8gdHJpbW1lZCA6IG51bGw7XG4gIH07XG4gIHJldHVybiB7XG4gICAgY3ljbGU0MDogc2FuaXRpemVDeWNsZShvYmouY3ljbGU0MCwgYmFzZS5jeWNsZTQwKSxcbiAgICBjeWNsZTEyMDogc2FuaXRpemVDeWNsZShvYmouY3ljbGUxMjAsIGJhc2UuY3ljbGUxMjApLFxuICAgIHJlZnJlc2hVcmw6XG4gICAgICByZXNvbHZlVXJsKG9iai5yZWZyZXNoVXJsKSA/P1xuICAgICAgcmVzb2x2ZVVybChiYXNlLnJlZnJlc2hVcmwpID8/XG4gICAgICBERUZBVUxUX1NFVFRJTkdTLnBvbGwucmVmcmVzaFVybCxcbiAgfTtcbn07XG5cbi8vIC0tLS0tLS0tLS0gcHVibGljIG1pZ3JhdGlvbiAoZXhpc3RpbmcpIC0tLS0tLS0tLS1cbmV4cG9ydCBmdW5jdGlvbiBtaWdyYXRlU2V0dGluZ3MoaW5wdXQ6IHVua25vd24pOiBBcHBTZXR0aW5ncyB7XG4gIGNvbnN0IHMgPSAoaW5wdXQgJiYgdHlwZW9mIGlucHV0ID09PSBcIm9iamVjdFwiKSA/IChpbnB1dCBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPikgOiB7fTtcblxuICBjb25zdCBzdGF0c1NvdXJjZSA9IChzLnN0YXRzICYmIHR5cGVvZiBzLnN0YXRzID09PSBcIm9iamVjdFwiKSA/IHMuc3RhdHMgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4gOiB7fTtcbiAgY29uc3QgdGltaW5nU291cmNlID0gKHMudGltaW5nICYmIHR5cGVvZiBzLnRpbWluZyA9PT0gXCJvYmplY3RcIikgPyBzLnRpbWluZyBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiA6IHt9O1xuICBjb25zdCB0aW1pbmdDeWNsZXMgPSAodGltaW5nU291cmNlLnN0ckN5Y2xlcyAmJiB0eXBlb2YgdGltaW5nU291cmNlLnN0ckN5Y2xlcyA9PT0gXCJvYmplY3RcIilcbiAgICA/IHRpbWluZ1NvdXJjZS5zdHJDeWNsZXMgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj5cbiAgICA6IHt9O1xuXG4gIGNvbnN0IG91dDogQXBwU2V0dGluZ3MgPSB7XG4gICAgdmVyc2lvbjogU0VUVElOR1NfVkVSU0lPTixcbiAgICBjb2luVW5pdmVyc2U6IHRvVXBwZXJBcnJheShzLmNvaW5Vbml2ZXJzZSksXG4gICAgcHJvZmlsZToge1xuICAgICAgbmlja25hbWU6IFN0cmluZygocy5wcm9maWxlIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+IHwgdW5kZWZpbmVkKT8ubmlja25hbWUgPz8gXCJcIiksXG4gICAgICBlbWFpbDogU3RyaW5nKChzLnByb2ZpbGUgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4gfCB1bmRlZmluZWQpPy5lbWFpbCA/PyBcIlwiKSxcbiAgICAgIGJpbmFuY2VLZXlJZDogU3RyaW5nKChzLnByb2ZpbGUgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4gfCB1bmRlZmluZWQpPy5iaW5hbmNlS2V5SWQgPz8gXCJcIiksXG4gICAgfSxcbiAgICBzdGF0czoge1xuICAgICAgaGlzdG9ncmFtTGVuOiBNYXRoLm1heCgxNiwgdG9OdW1iZXIoc3RhdHNTb3VyY2UuaGlzdG9ncmFtTGVuLCBERUZBVUxUX1NFVFRJTkdTLnN0YXRzLmhpc3RvZ3JhbUxlbikpLFxuICAgICAgYm1EZWNpbWFsczogY2xhbXAodG9OdW1iZXIoc3RhdHNTb3VyY2UuYm1EZWNpbWFscywgREVGQVVMVF9TRVRUSU5HUy5zdGF0cy5ibURlY2ltYWxzKSwgMCwgNiksXG4gICAgICBpZFBjdERlY2ltYWxzOiBjbGFtcCh0b051bWJlcihzdGF0c1NvdXJjZS5pZFBjdERlY2ltYWxzLCBERUZBVUxUX1NFVFRJTkdTLnN0YXRzLmlkUGN0RGVjaW1hbHMpLCAwLCA4KSxcbiAgICB9LFxuICAgIHBvbGw6IHRvUG9sbChzLnBvbGwpLFxuICAgIHRpbWluZzoge1xuICAgICAgYXV0b1JlZnJlc2g6IEJvb2xlYW4odGltaW5nU291cmNlLmF1dG9SZWZyZXNoID8/IERFRkFVTFRfU0VUVElOR1MudGltaW5nLmF1dG9SZWZyZXNoKSxcbiAgICAgIGF1dG9SZWZyZXNoTXM6IE1hdGgubWF4KDUwMCwgdG9OdW1iZXIodGltaW5nU291cmNlLmF1dG9SZWZyZXNoTXMsIERFRkFVTFRfU0VUVElOR1MudGltaW5nLmF1dG9SZWZyZXNoTXMpKSxcbiAgICAgIHNlY29uZGFyeUVuYWJsZWQ6IEJvb2xlYW4odGltaW5nU291cmNlLnNlY29uZGFyeUVuYWJsZWQgPz8gREVGQVVMVF9TRVRUSU5HUy50aW1pbmcuc2Vjb25kYXJ5RW5hYmxlZCksXG4gICAgICBzZWNvbmRhcnlDeWNsZXM6IGNsYW1wKHRvTnVtYmVyKHRpbWluZ1NvdXJjZS5zZWNvbmRhcnlDeWNsZXMsIERFRkFVTFRfU0VUVElOR1MudGltaW5nLnNlY29uZGFyeUN5Y2xlcyksIDEsIDEwKSxcbiAgICAgIHN0ckN5Y2xlczoge1xuICAgICAgICBtMzA6IE1hdGgubWF4KDEsIHRvTnVtYmVyKHRpbWluZ0N5Y2xlcy5tMzAsIERFRkFVTFRfU0VUVElOR1MudGltaW5nLnN0ckN5Y2xlcy5tMzApKSxcbiAgICAgICAgaDE6IE1hdGgubWF4KDEsIHRvTnVtYmVyKHRpbWluZ0N5Y2xlcy5oMSwgREVGQVVMVF9TRVRUSU5HUy50aW1pbmcuc3RyQ3ljbGVzLmgxKSksXG4gICAgICAgIGgzOiBNYXRoLm1heCgxLCB0b051bWJlcih0aW1pbmdDeWNsZXMuaDMsIERFRkFVTFRfU0VUVElOR1MudGltaW5nLnN0ckN5Y2xlcy5oMykpLFxuICAgICAgfSxcbiAgICB9LFxuICAgIGNsdXN0ZXJpbmc6IHsgY2x1c3RlcnM6IHRvQ2x1c3RlckFycmF5KChzLmNsdXN0ZXJpbmcgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4gfCB1bmRlZmluZWQpPy5jbHVzdGVycykgfSxcbiAgICBwYXJhbXM6IHsgdmFsdWVzOiB0b1BhcmFtcygocy5wYXJhbXMgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4gfCB1bmRlZmluZWQpPy52YWx1ZXMpIH0sXG4gIH07XG5cbiAgaWYgKG91dC5jb2luVW5pdmVyc2UubGVuZ3RoID09PSAwKSB7XG4gICAgb3V0LmNvaW5Vbml2ZXJzZSA9IFsuLi5ERUZBVUxUX1NFVFRJTkdTLmNvaW5Vbml2ZXJzZV07XG4gIH1cblxuICByZXR1cm4gb3V0O1xufVxuXG4vLyAtLS0tLS0tLS0tIE5FVzogcHVibGljLCBlcmdvbm9taWMgaGVscGVycyAtLS0tLS0tLS0tXG4vKiogRGVlcCBwYXJ0aWFsIHR5cGUgZm9yIGVyZ29ub21pYyBwYXRjaGluZy9jcmVhdGlvbi4gKi9cbmV4cG9ydCB0eXBlIERlZXBQYXJ0aWFsPFQ+ID0ge1xuICBbSyBpbiBrZXlvZiBUXT86IFRbS10gZXh0ZW5kcyBvYmplY3QgPyBEZWVwUGFydGlhbDxUW0tdPiA6IFRbS107XG59O1xuXG4vKiogTm9ybWFsaXplIGNvaW5zIGZyb20gYSBzdHJpbmcgKGNvbW1hL3NwYWNlLXNlcGFyYXRlZCkgb3IgYXJyYXk7IGVuc3VyZXMgVVNEVCBwcmVzZW50IGFuZCB1cHBlcmNhc2UrZGVkdXBlZC4gKi9cbmV4cG9ydCBmdW5jdGlvbiBub3JtYWxpemVDb2luVW5pdmVyc2UoaW5wdXQ6IHN0cmluZyB8IHN0cmluZ1tdIHwgdW5rbm93bik6IHN0cmluZ1tdIHtcbiAgaWYgKEFycmF5LmlzQXJyYXkoaW5wdXQpKSByZXR1cm4gdG9VcHBlckFycmF5KGlucHV0KTtcbiAgaWYgKHR5cGVvZiBpbnB1dCA9PT0gXCJzdHJpbmdcIikge1xuICAgIGNvbnN0IHBhcnRzID0gaW5wdXQuc3BsaXQoL1ssXFxzXSsvKS5tYXAocyA9PiBzLnRyaW0oKSkuZmlsdGVyKEJvb2xlYW4pO1xuICAgIHJldHVybiB0b1VwcGVyQXJyYXkocGFydHMpO1xuICB9XG4gIHJldHVybiB0b1VwcGVyQXJyYXkoW10pO1xufVxuXG4vKiogVHlwZSBndWFyZCB0byBjaGVjayBpZiBhbiBvYmplY3QgYWxyZWFkeSBsb29rcyBsaWtlIGFuIEFwcFNldHRpbmdzIGFmdGVyIG1pZ3JhdGlvbi4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0FwcFNldHRpbmdzKHg6IHVua25vd24pOiB4IGlzIEFwcFNldHRpbmdzIHtcbiAgcmV0dXJuICEheCAmJiB0eXBlb2YgeCA9PT0gXCJvYmplY3RcIiAmJiBcInZlcnNpb25cIiBpbiAoeCBhcyBhbnkpICYmIFwiY29pblVuaXZlcnNlXCIgaW4gKHggYXMgYW55KTtcbn1cblxuLyoqXG4gKiBGYWN0b3J5IOKAlCBjcmVhdGUgYSBub3JtYWxpemVkIEFwcFNldHRpbmdzIG9iamVjdC5cbiAqIC0gSWYgeW91IHBhc3Mgbm90aGluZywgeW91IGdldCBtaWdyYXRlZCBERUZBVUxUX1NFVFRJTkdTLlxuICogLSBJZiB5b3UgcGFzcyBhIGRlZXAtcGFydGlhbCBvciBhbnkgdW5rbm93biwgaXQgaXMgbWlncmF0ZWQgc2FmZWx5LlxuICovXG5leHBvcnQgZnVuY3Rpb24gQXBwU2V0dGluZ3MoaW5wdXQ/OiBEZWVwUGFydGlhbDxBcHBTZXR0aW5ncz4gfCB1bmtub3duKTogQXBwU2V0dGluZ3Mge1xuICByZXR1cm4gbWlncmF0ZVNldHRpbmdzKGlucHV0ID8/IERFRkFVTFRfU0VUVElOR1MpO1xufVxuXG4vKiogTWVyZ2UgYSBiYXNlIEFwcFNldHRpbmdzIHdpdGggYSBkZWVwLXBhcnRpYWwgcGF0Y2gsIHRoZW4gbm9ybWFsaXplLiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1lcmdlQXBwU2V0dGluZ3MoYmFzZTogQXBwU2V0dGluZ3MsIHBhdGNoOiBEZWVwUGFydGlhbDxBcHBTZXR0aW5ncz4pOiBBcHBTZXR0aW5ncyB7XG4gIC8vIHNoYWxsb3ctbWVyZ2UgYXQgdG9wIGxldmVsOyBuZXN0ZWQgb2JqZWN0cyBhcmUgcmUtdmFsaWRhdGVkIGJ5IG1pZ3JhdGVTZXR0aW5nc1xuICByZXR1cm4gbWlncmF0ZVNldHRpbmdzKHsgLi4uYmFzZSwgLi4ucGF0Y2ggfSk7XG59XG4iXSwibmFtZXMiOlsiU0VUVElOR1NfVkVSU0lPTiIsIkRFRkFVTFRfU0VUVElOR1MiLCJ2ZXJzaW9uIiwiY29pblVuaXZlcnNlIiwicHJvZmlsZSIsIm5pY2tuYW1lIiwiZW1haWwiLCJiaW5hbmNlS2V5SWQiLCJzdGF0cyIsImhpc3RvZ3JhbUxlbiIsImJtRGVjaW1hbHMiLCJpZFBjdERlY2ltYWxzIiwicG9sbCIsImN5Y2xlNDAiLCJjeWNsZTEyMCIsInJlZnJlc2hVcmwiLCJ0aW1pbmciLCJhdXRvUmVmcmVzaCIsImF1dG9SZWZyZXNoTXMiLCJzZWNvbmRhcnlFbmFibGVkIiwic2Vjb25kYXJ5Q3ljbGVzIiwic3RyQ3ljbGVzIiwibTMwIiwiaDEiLCJoMyIsImNsdXN0ZXJpbmciLCJjbHVzdGVycyIsImlkIiwibmFtZSIsImNvaW5zIiwicGFyYW1zIiwidmFsdWVzIiwiZXRhIiwiZXBzaWxvbiIsImlvdGEiLCJ0b1VwcGVyQXJyYXkiLCJ2YWx1ZSIsIkFycmF5IiwiaXNBcnJheSIsInNlZW4iLCJTZXQiLCJyZXN1bHQiLCJlbnRyeSIsInVwcGVyIiwiU3RyaW5nIiwidHJpbSIsInRvVXBwZXJDYXNlIiwiaGFzIiwiYWRkIiwicHVzaCIsInRvTnVtYmVyIiwiZmFsbGJhY2siLCJwYXJzZWQiLCJOdW1iZXIiLCJpc0Zpbml0ZSIsImNsYW1wIiwibWluIiwibWF4IiwiTWF0aCIsInRvQ2x1c3RlckFycmF5IiwibWFwIiwiaW5kZXgiLCJvYmoiLCJ0b1BhcmFtcyIsImtleSIsInJhdyIsIk9iamVjdCIsImVudHJpZXMiLCJ0b1BvbGwiLCJiYXNlIiwic2FuaXRpemVDeWNsZSIsImJvdW5kZWQiLCJmbG9vciIsInJlc29sdmVVcmwiLCJ0cmltbWVkIiwibGVuZ3RoIiwibWlncmF0ZVNldHRpbmdzIiwiaW5wdXQiLCJzIiwic3RhdHNTb3VyY2UiLCJ0aW1pbmdTb3VyY2UiLCJ0aW1pbmdDeWNsZXMiLCJvdXQiLCJCb29sZWFuIiwibm9ybWFsaXplQ29pblVuaXZlcnNlIiwicGFydHMiLCJzcGxpdCIsImZpbHRlciIsImlzQXBwU2V0dGluZ3MiLCJ4IiwiQXBwU2V0dGluZ3MiLCJtZXJnZUFwcFNldHRpbmdzIiwicGF0Y2giXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/settings/schema.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/settings/server.ts":
/*!************************************!*\
  !*** ./src/lib/settings/server.ts ***!
  \************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getAll: () => (/* binding */ getAll),\n/* harmony export */   resolveCoinsFromSettings: () => (/* binding */ resolveCoinsFromSettings),\n/* harmony export */   serializeSettingsCookie: () => (/* binding */ serializeSettingsCookie),\n/* harmony export */   setAll: () => (/* binding */ setAll)\n/* harmony export */ });\n/* harmony import */ var private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! private-next-rsc-server-reference */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/build/webpack/loaders/next-flight-loader/server-reference.js\");\n/* harmony import */ var private_next_rsc_action_encryption__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! private-next-rsc-action-encryption */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/app-render/encryption.js\");\n/* harmony import */ var private_next_rsc_action_encryption__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(private_next_rsc_action_encryption__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _lib_settings_coin_universe__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/settings/coin-universe */ \"(rsc)/./src/lib/settings/coin-universe.ts\");\n/* harmony import */ var _schema__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./schema */ \"(rsc)/./src/lib/settings/schema.ts\");\n/* harmony import */ var private_next_rsc_action_validate__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! private-next-rsc-action-validate */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-validate.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_lib_settings_coin_universe__WEBPACK_IMPORTED_MODULE_3__]);\n_lib_settings_coin_universe__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n// src/lib/settings/server.ts\n/* __next_internal_action_entry_do_not_use__ {\"00532f31c65bd9d7119874b7c000efa42c3a9e2e3a\":\"getAll\",\"00696b0d07c16ebe05246c326940d3b9133dac036c\":\"resolveCoinsFromSettings\",\"402b519d81502a95cf319ddb5b60bce32907aa6f08\":\"setAll\",\"40f9a1c8f3a3ab5d85ba51065396bf00a061db869e\":\"serializeSettingsCookie\"} */ \n\n\n\n\nconst COOKIE_KEY = \"appSettings\";\nconst LEGACY_COOKIE_KEYS = [\n    \"cp_settings_v1\"\n];\nconst ONE_YEAR = 60 * 60 * 24 * 365;\nfunction safeParseJSON(value) {\n    if (!value) return null;\n    try {\n        return JSON.parse(value);\n    } catch  {\n        return null;\n    }\n}\nasync function getAll() {\n    const jar = await (0,next_headers__WEBPACK_IMPORTED_MODULE_2__.cookies)();\n    const raw = jar.get(COOKIE_KEY)?.value;\n    const parsed = safeParseJSON(raw);\n    const settings = (0,_schema__WEBPACK_IMPORTED_MODULE_4__.migrateSettings)(parsed ?? _schema__WEBPACK_IMPORTED_MODULE_4__.DEFAULT_SETTINGS);\n    const dbCoins = await (0,_lib_settings_coin_universe__WEBPACK_IMPORTED_MODULE_3__.fetchCoinUniverseBases)({\n        onlyEnabled: true\n    });\n    settings.coinUniverse = dbCoins.length ? dbCoins : (0,_lib_settings_coin_universe__WEBPACK_IMPORTED_MODULE_3__.normalizeCoinList)(settings.coinUniverse);\n    return settings;\n}\nasync function serializeSettingsCookie(nextValue) {\n    const current = await getAll();\n    const merged = (0,_schema__WEBPACK_IMPORTED_MODULE_4__.migrateSettings)({\n        ...current,\n        ...nextValue\n    });\n    const normalizedCoins = (0,_lib_settings_coin_universe__WEBPACK_IMPORTED_MODULE_3__.normalizeCoinList)(merged.coinUniverse);\n    await (0,_lib_settings_coin_universe__WEBPACK_IMPORTED_MODULE_3__.syncCoinUniverseFromBases)(normalizedCoins);\n    const normalized = {\n        ...merged,\n        coinUniverse: normalizedCoins\n    };\n    const value = JSON.stringify(normalized);\n    const cookie = {\n        name: COOKIE_KEY,\n        value,\n        options: {\n            httpOnly: false,\n            sameSite: \"lax\",\n            path: \"/\",\n            maxAge: ONE_YEAR\n        }\n    };\n    await (0,_lib_settings_coin_universe__WEBPACK_IMPORTED_MODULE_3__.recordSettingsCookieSnapshot)(value);\n    return {\n        settings: normalized,\n        cookie\n    };\n}\nasync function setAll(nextValue) {\n    const jar = await (0,next_headers__WEBPACK_IMPORTED_MODULE_2__.cookies)();\n    const { settings, cookie } = await serializeSettingsCookie(nextValue);\n    jar.set(cookie.name, cookie.value, cookie.options);\n    const mutable = jar;\n    if (mutable.delete) {\n        for (const legacy of LEGACY_COOKIE_KEYS){\n            if (legacy !== cookie.name) mutable.delete(legacy);\n        }\n    }\n    return settings;\n}\nasync function resolveCoinsFromSettings() {\n    const dbCoins = await (0,_lib_settings_coin_universe__WEBPACK_IMPORTED_MODULE_3__.fetchCoinUniverseBases)({\n        onlyEnabled: true\n    });\n    if (dbCoins.length) return dbCoins;\n    return (0,_lib_settings_coin_universe__WEBPACK_IMPORTED_MODULE_3__.normalizeCoinList)(_schema__WEBPACK_IMPORTED_MODULE_4__.DEFAULT_SETTINGS.coinUniverse);\n}\n\n(0,private_next_rsc_action_validate__WEBPACK_IMPORTED_MODULE_5__.ensureServerEntryExports)([\n    getAll,\n    serializeSettingsCookie,\n    setAll,\n    resolveCoinsFromSettings\n]);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(getAll, \"00532f31c65bd9d7119874b7c000efa42c3a9e2e3a\", null);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(serializeSettingsCookie, \"40f9a1c8f3a3ab5d85ba51065396bf00a061db869e\", null);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(setAll, \"402b519d81502a95cf319ddb5b60bce32907aa6f08\", null);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(resolveCoinsFromSettings, \"00696b0d07c16ebe05246c326940d3b9133dac036c\", null);\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3NldHRpbmdzL3NlcnZlci50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLDZCQUE2Qjs7O0FBR1U7QUFNRDtBQUN5QztBQUUvRSxNQUFNTyxhQUFhO0FBQ25CLE1BQU1DLHFCQUFxQjtJQUFDO0NBQWlCO0FBQzdDLE1BQU1DLFdBQVcsS0FBSyxLQUFLLEtBQUs7QUFFaEMsU0FBU0MsY0FBY0MsS0FBZ0M7SUFDckQsSUFBSSxDQUFDQSxPQUFPLE9BQU87SUFDbkIsSUFBSTtRQUNGLE9BQU9DLEtBQUtDLEtBQUssQ0FBQ0Y7SUFDcEIsRUFBRSxPQUFNO1FBQ04sT0FBTztJQUNUO0FBQ0Y7QUFFTyxlQUFlRztJQUNwQixNQUFNQyxNQUFNLE1BQU1mLHFEQUFPQTtJQUN6QixNQUFNZ0IsTUFBTUQsSUFBSUUsR0FBRyxDQUFDVixhQUFhSTtJQUNqQyxNQUFNTyxTQUFTUixjQUFjTTtJQUM3QixNQUFNRyxXQUFXYix3REFBZUEsQ0FBQ1ksVUFBVWIscURBQWdCQTtJQUMzRCxNQUFNZSxVQUFVLE1BQU1uQixtRkFBc0JBLENBQUM7UUFBRW9CLGFBQWE7SUFBSztJQUNqRUYsU0FBU0csWUFBWSxHQUFHRixRQUFRRyxNQUFNLEdBQUdILFVBQVVsQiw4RUFBaUJBLENBQUNpQixTQUFTRyxZQUFZO0lBQzFGLE9BQU9IO0FBQ1Q7QUFFTyxlQUFlSyx3QkFBd0JDLFNBQWtCO0lBSTlELE1BQU1DLFVBQVUsTUFBTVo7SUFDdEIsTUFBTWEsU0FBU3JCLHdEQUFlQSxDQUFDO1FBQUUsR0FBR29CLE9BQU87UUFBRSxHQUFJRCxTQUFTO0lBQVM7SUFFbkUsTUFBTUcsa0JBQWtCMUIsOEVBQWlCQSxDQUFDeUIsT0FBT0wsWUFBWTtJQUM3RCxNQUFNbEIsc0ZBQXlCQSxDQUFDd0I7SUFFaEMsTUFBTUMsYUFBMEI7UUFDOUIsR0FBR0YsTUFBTTtRQUNUTCxjQUFjTTtJQUNoQjtJQUVBLE1BQU1qQixRQUFRQyxLQUFLa0IsU0FBUyxDQUFDRDtJQUM3QixNQUFNRSxTQUFTO1FBQ2JDLE1BQU16QjtRQUNOSTtRQUNBc0IsU0FBUztZQUNQQyxVQUFVO1lBQ1ZDLFVBQVU7WUFDVkMsTUFBTTtZQUNOQyxRQUFRNUI7UUFDVjtJQUNGO0lBRUEsTUFBTU4seUZBQTRCQSxDQUFDUTtJQUVuQyxPQUFPO1FBQUVRLFVBQVVVO1FBQVlFO0lBQU87QUFDeEM7QUFFTyxlQUFlTyxPQUFPYixTQUFrQjtJQUM3QyxNQUFNVixNQUFNLE1BQU1mLHFEQUFPQTtJQUN6QixNQUFNLEVBQUVtQixRQUFRLEVBQUVZLE1BQU0sRUFBRSxHQUFHLE1BQU1QLHdCQUF3QkM7SUFDM0RWLElBQUl3QixHQUFHLENBQUNSLE9BQU9DLElBQUksRUFBRUQsT0FBT3BCLEtBQUssRUFBRW9CLE9BQU9FLE9BQU87SUFFakQsTUFBTU8sVUFBVXpCO0lBQ2hCLElBQUl5QixRQUFRQyxNQUFNLEVBQUU7UUFDbEIsS0FBSyxNQUFNQyxVQUFVbEMsbUJBQW9CO1lBQ3ZDLElBQUlrQyxXQUFXWCxPQUFPQyxJQUFJLEVBQUVRLFFBQVFDLE1BQU0sQ0FBQ0M7UUFDN0M7SUFDRjtJQUNBLE9BQU92QjtBQUNUO0FBRU8sZUFBZXdCO0lBQ3BCLE1BQU12QixVQUFVLE1BQU1uQixtRkFBc0JBLENBQUM7UUFBRW9CLGFBQWE7SUFBSztJQUNqRSxJQUFJRCxRQUFRRyxNQUFNLEVBQUUsT0FBT0g7SUFDM0IsT0FBT2xCLDhFQUFpQkEsQ0FBQ0cscURBQWdCQSxDQUFDaUIsWUFBWTtBQUN4RDs7O0lBNURzQlI7SUFVQVU7SUFnQ0FjO0lBY0FLOztBQXhEQTdCLDBGQUFBQSxDQUFBQTtBQVVBVSwwRkFBQUEsQ0FBQUE7QUFnQ0FjLDBGQUFBQSxDQUFBQTtBQWNBSywwRkFBQUEsQ0FBQUEiLCJzb3VyY2VzIjpbIkg6XFxVc2Vyc1xcR3VzXFxzb3VyY2VcXHJlcG9cXGR5bmFtaWNzXFxkeW5hbWljcy1iXFxjcnlwdG9waS1keW5hbWljc1xcc3JjXFxsaWJcXHNldHRpbmdzXFxzZXJ2ZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL2xpYi9zZXR0aW5ncy9zZXJ2ZXIudHNcblwidXNlIHNlcnZlclwiO1xuXG5pbXBvcnQgeyBjb29raWVzIH0gZnJvbSBcIm5leHQvaGVhZGVyc1wiO1xuaW1wb3J0IHtcbiAgZmV0Y2hDb2luVW5pdmVyc2VCYXNlcyxcbiAgbm9ybWFsaXplQ29pbkxpc3QsXG4gIHJlY29yZFNldHRpbmdzQ29va2llU25hcHNob3QsXG4gIHN5bmNDb2luVW5pdmVyc2VGcm9tQmFzZXMsXG59IGZyb20gXCJAL2xpYi9zZXR0aW5ncy9jb2luLXVuaXZlcnNlXCI7XG5pbXBvcnQgeyBERUZBVUxUX1NFVFRJTkdTLCBtaWdyYXRlU2V0dGluZ3MsIHR5cGUgQXBwU2V0dGluZ3MgfSBmcm9tIFwiLi9zY2hlbWFcIjtcblxuY29uc3QgQ09PS0lFX0tFWSA9IFwiYXBwU2V0dGluZ3NcIjtcbmNvbnN0IExFR0FDWV9DT09LSUVfS0VZUyA9IFtcImNwX3NldHRpbmdzX3YxXCJdO1xuY29uc3QgT05FX1lFQVIgPSA2MCAqIDYwICogMjQgKiAzNjU7XG5cbmZ1bmN0aW9uIHNhZmVQYXJzZUpTT04odmFsdWU6IHN0cmluZyB8IHVuZGVmaW5lZCB8IG51bGwpOiBhbnkgfCBudWxsIHtcbiAgaWYgKCF2YWx1ZSkgcmV0dXJuIG51bGw7XG4gIHRyeSB7XG4gICAgcmV0dXJuIEpTT04ucGFyc2UodmFsdWUpO1xuICB9IGNhdGNoIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWxsKCk6IFByb21pc2U8QXBwU2V0dGluZ3M+IHtcbiAgY29uc3QgamFyID0gYXdhaXQgY29va2llcygpO1xuICBjb25zdCByYXcgPSBqYXIuZ2V0KENPT0tJRV9LRVkpPy52YWx1ZTtcbiAgY29uc3QgcGFyc2VkID0gc2FmZVBhcnNlSlNPTihyYXcpO1xuICBjb25zdCBzZXR0aW5ncyA9IG1pZ3JhdGVTZXR0aW5ncyhwYXJzZWQgPz8gREVGQVVMVF9TRVRUSU5HUyk7XG4gIGNvbnN0IGRiQ29pbnMgPSBhd2FpdCBmZXRjaENvaW5Vbml2ZXJzZUJhc2VzKHsgb25seUVuYWJsZWQ6IHRydWUgfSk7XG4gIHNldHRpbmdzLmNvaW5Vbml2ZXJzZSA9IGRiQ29pbnMubGVuZ3RoID8gZGJDb2lucyA6IG5vcm1hbGl6ZUNvaW5MaXN0KHNldHRpbmdzLmNvaW5Vbml2ZXJzZSk7XG4gIHJldHVybiBzZXR0aW5ncztcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNlcmlhbGl6ZVNldHRpbmdzQ29va2llKG5leHRWYWx1ZTogdW5rbm93bik6IFByb21pc2U8e1xuICBzZXR0aW5nczogQXBwU2V0dGluZ3M7XG4gIGNvb2tpZTogeyBuYW1lOiBzdHJpbmc7IHZhbHVlOiBzdHJpbmc7IG9wdGlvbnM6IFBhcmFtZXRlcnM8QXdhaXRlZDxSZXR1cm5UeXBlPHR5cGVvZiBjb29raWVzPj5bXCJzZXRcIl0+WzJdIH07XG59PiB7XG4gIGNvbnN0IGN1cnJlbnQgPSBhd2FpdCBnZXRBbGwoKTtcbiAgY29uc3QgbWVyZ2VkID0gbWlncmF0ZVNldHRpbmdzKHsgLi4uY3VycmVudCwgLi4uKG5leHRWYWx1ZSBhcyBhbnkpIH0pO1xuXG4gIGNvbnN0IG5vcm1hbGl6ZWRDb2lucyA9IG5vcm1hbGl6ZUNvaW5MaXN0KG1lcmdlZC5jb2luVW5pdmVyc2UpO1xuICBhd2FpdCBzeW5jQ29pblVuaXZlcnNlRnJvbUJhc2VzKG5vcm1hbGl6ZWRDb2lucyk7XG5cbiAgY29uc3Qgbm9ybWFsaXplZDogQXBwU2V0dGluZ3MgPSB7XG4gICAgLi4ubWVyZ2VkLFxuICAgIGNvaW5Vbml2ZXJzZTogbm9ybWFsaXplZENvaW5zLFxuICB9O1xuXG4gIGNvbnN0IHZhbHVlID0gSlNPTi5zdHJpbmdpZnkobm9ybWFsaXplZCk7XG4gIGNvbnN0IGNvb2tpZSA9IHtcbiAgICBuYW1lOiBDT09LSUVfS0VZLFxuICAgIHZhbHVlLFxuICAgIG9wdGlvbnM6IHtcbiAgICAgIGh0dHBPbmx5OiBmYWxzZSxcbiAgICAgIHNhbWVTaXRlOiBcImxheFwiIGFzIGNvbnN0LFxuICAgICAgcGF0aDogXCIvXCIsXG4gICAgICBtYXhBZ2U6IE9ORV9ZRUFSLFxuICAgIH0sXG4gIH07XG5cbiAgYXdhaXQgcmVjb3JkU2V0dGluZ3NDb29raWVTbmFwc2hvdCh2YWx1ZSk7XG5cbiAgcmV0dXJuIHsgc2V0dGluZ3M6IG5vcm1hbGl6ZWQsIGNvb2tpZSB9O1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2V0QWxsKG5leHRWYWx1ZTogdW5rbm93bik6IFByb21pc2U8QXBwU2V0dGluZ3M+IHtcbiAgY29uc3QgamFyID0gYXdhaXQgY29va2llcygpO1xuICBjb25zdCB7IHNldHRpbmdzLCBjb29raWUgfSA9IGF3YWl0IHNlcmlhbGl6ZVNldHRpbmdzQ29va2llKG5leHRWYWx1ZSk7XG4gIGphci5zZXQoY29va2llLm5hbWUsIGNvb2tpZS52YWx1ZSwgY29va2llLm9wdGlvbnMpO1xuXG4gIGNvbnN0IG11dGFibGUgPSBqYXIgYXMgdW5rbm93biBhcyB7IGRlbGV0ZT86IChuYW1lOiBzdHJpbmcpID0+IHZvaWQgfTtcbiAgaWYgKG11dGFibGUuZGVsZXRlKSB7XG4gICAgZm9yIChjb25zdCBsZWdhY3kgb2YgTEVHQUNZX0NPT0tJRV9LRVlTKSB7XG4gICAgICBpZiAobGVnYWN5ICE9PSBjb29raWUubmFtZSkgbXV0YWJsZS5kZWxldGUobGVnYWN5KTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHNldHRpbmdzO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVzb2x2ZUNvaW5zRnJvbVNldHRpbmdzKCk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgY29uc3QgZGJDb2lucyA9IGF3YWl0IGZldGNoQ29pblVuaXZlcnNlQmFzZXMoeyBvbmx5RW5hYmxlZDogdHJ1ZSB9KTtcbiAgaWYgKGRiQ29pbnMubGVuZ3RoKSByZXR1cm4gZGJDb2lucztcbiAgcmV0dXJuIG5vcm1hbGl6ZUNvaW5MaXN0KERFRkFVTFRfU0VUVElOR1MuY29pblVuaXZlcnNlKTtcbn1cbiJdLCJuYW1lcyI6WyJjb29raWVzIiwiZmV0Y2hDb2luVW5pdmVyc2VCYXNlcyIsIm5vcm1hbGl6ZUNvaW5MaXN0IiwicmVjb3JkU2V0dGluZ3NDb29raWVTbmFwc2hvdCIsInN5bmNDb2luVW5pdmVyc2VGcm9tQmFzZXMiLCJERUZBVUxUX1NFVFRJTkdTIiwibWlncmF0ZVNldHRpbmdzIiwiQ09PS0lFX0tFWSIsIkxFR0FDWV9DT09LSUVfS0VZUyIsIk9ORV9ZRUFSIiwic2FmZVBhcnNlSlNPTiIsInZhbHVlIiwiSlNPTiIsInBhcnNlIiwiZ2V0QWxsIiwiamFyIiwicmF3IiwiZ2V0IiwicGFyc2VkIiwic2V0dGluZ3MiLCJkYkNvaW5zIiwib25seUVuYWJsZWQiLCJjb2luVW5pdmVyc2UiLCJsZW5ndGgiLCJzZXJpYWxpemVTZXR0aW5nc0Nvb2tpZSIsIm5leHRWYWx1ZSIsImN1cnJlbnQiLCJtZXJnZWQiLCJub3JtYWxpemVkQ29pbnMiLCJub3JtYWxpemVkIiwic3RyaW5naWZ5IiwiY29va2llIiwibmFtZSIsIm9wdGlvbnMiLCJodHRwT25seSIsInNhbWVTaXRlIiwicGF0aCIsIm1heEFnZSIsInNldEFsbCIsInNldCIsIm11dGFibGUiLCJkZWxldGUiLCJsZWdhY3kiLCJyZXNvbHZlQ29pbnNGcm9tU2V0dGluZ3MiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/settings/server.ts\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!**************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \**************************************************************************************************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "../app-render/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/server/app-render/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/action-async-storage.external.js");

/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("fs");

/***/ }),

/***/ "module":
/*!*************************!*\
  !*** external "module" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("module");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "next/dist/shared/lib/no-fallback-error.external":
/*!******************************************************************!*\
  !*** external "next/dist/shared/lib/no-fallback-error.external" ***!
  \******************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/no-fallback-error.external");

/***/ }),

/***/ "next/dist/shared/lib/router/utils/app-paths":
/*!**************************************************************!*\
  !*** external "next/dist/shared/lib/router/utils/app-paths" ***!
  \**************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/app-paths");

/***/ }),

/***/ "node:child_process":
/*!*************************************!*\
  !*** external "node:child_process" ***!
  \*************************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:child_process");

/***/ }),

/***/ "node:fs":
/*!**************************!*\
  !*** external "node:fs" ***!
  \**************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:fs");

/***/ }),

/***/ "node:path":
/*!****************************!*\
  !*** external "node:path" ***!
  \****************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:path");

/***/ }),

/***/ "node:url":
/*!***************************!*\
  !*** external "node:url" ***!
  \***************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:url");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("path");

/***/ }),

/***/ "pg":
/*!*********************!*\
  !*** external "pg" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = import("pg");;

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("util");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5"], () => (__webpack_exec__("(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fmoo-aux%2Froute&page=%2Fapi%2Fmoo-aux%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmoo-aux%2Froute.ts&appDir=H%3A%5CUsers%5CGus%5Csource%5Crepo%5Cdynamics%5Cdynamics-b%5Ccryptopi-dynamics%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=H%3A%5CUsers%5CGus%5Csource%5Crepo%5Cdynamics%5Cdynamics-b%5Ccryptopi-dynamics&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!")));
module.exports = __webpack_exports__;

})();