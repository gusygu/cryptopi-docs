/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/settings/wallet/route";
exports.ids = ["app/api/settings/wallet/route"];
exports.modules = {

/***/ "(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fsettings%2Fwallet%2Froute&page=%2Fapi%2Fsettings%2Fwallet%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsettings%2Fwallet%2Froute.ts&appDir=H%3A%5CUsers%5CGus%5Csource%5Crepo%5Cdynamics%5Cdynamics-b%5Ccryptopi-dynamics%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=H%3A%5CUsers%5CGus%5Csource%5Crepo%5Cdynamics%5Cdynamics-b%5Ccryptopi-dynamics&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!":
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fsettings%2Fwallet%2Froute&page=%2Fapi%2Fsettings%2Fwallet%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsettings%2Fwallet%2Froute.ts&appDir=H%3A%5CUsers%5CGus%5Csource%5Crepo%5Cdynamics%5Cdynamics-b%5Ccryptopi-dynamics%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=H%3A%5CUsers%5CGus%5Csource%5Crepo%5Cdynamics%5Cdynamics-b%5Ccryptopi-dynamics&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=! ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   handler: () => (/* binding */ handler),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/dist/server/request-meta */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/request-meta.js\");\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! next/dist/server/lib/trace/tracer */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/lib/trace/tracer.js\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next/dist/shared/lib/router/utils/app-paths */ \"next/dist/shared/lib/router/utils/app-paths\");\n/* harmony import */ var next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! next/dist/server/base-http/node */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/base-http/node.js\");\n/* harmony import */ var next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! next/dist/server/web/spec-extension/adapters/next-request */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/web/spec-extension/adapters/next-request.js\");\n/* harmony import */ var next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! next/dist/server/lib/trace/constants */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/lib/trace/constants.js\");\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! next/dist/server/instrumentation/utils */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/instrumentation/utils.js\");\n/* harmony import */ var next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! next/dist/server/send-response */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/send-response.js\");\n/* harmony import */ var next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! next/dist/server/web/utils */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/web/utils.js\");\n/* harmony import */ var next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__);\n/* harmony import */ var next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! next/dist/server/lib/cache-control */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/lib/cache-control.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! next/dist/lib/constants */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/lib/constants.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13___default = /*#__PURE__*/__webpack_require__.n(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__);\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! next/dist/shared/lib/no-fallback-error.external */ \"next/dist/shared/lib/no-fallback-error.external\");\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__);\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! next/dist/server/response-cache */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/server/response-cache/index.js\");\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__);\n/* harmony import */ var H_Users_Gus_source_repo_dynamics_dynamics_b_cryptopi_dynamics_src_app_api_settings_wallet_route_ts__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./src/app/api/settings/wallet/route.ts */ \"(rsc)/./src/app/api/settings/wallet/route.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([H_Users_Gus_source_repo_dynamics_dynamics_b_cryptopi_dynamics_src_app_api_settings_wallet_route_ts__WEBPACK_IMPORTED_MODULE_16__]);\nH_Users_Gus_source_repo_dynamics_dynamics_b_cryptopi_dynamics_src_app_api_settings_wallet_route_ts__WEBPACK_IMPORTED_MODULE_16__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/settings/wallet/route\",\n        pathname: \"/api/settings/wallet\",\n        filename: \"route\",\n        bundlePath: \"app/api/settings/wallet/route\"\n    },\n    distDir: \".next\" || 0,\n    relativeProjectDir:  false || '',\n    resolvedPagePath: \"H:\\\\Users\\\\Gus\\\\source\\\\repo\\\\dynamics\\\\dynamics-b\\\\cryptopi-dynamics\\\\src\\\\app\\\\api\\\\settings\\\\wallet\\\\route.ts\",\n    nextConfigOutput,\n    userland: H_Users_Gus_source_repo_dynamics_dynamics_b_cryptopi_dynamics_src_app_api_settings_wallet_route_ts__WEBPACK_IMPORTED_MODULE_16__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\nasync function handler(req, res, ctx) {\n    var _nextConfig_experimental;\n    let srcPage = \"/api/settings/wallet/route\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (false) {} else if (srcPage === '/index') {\n        // we always normalize /index specifically\n        srcPage = '/';\n    }\n    const multiZoneDraftMode = false;\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage,\n        multiZoneDraftMode\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return null;\n    }\n    const { buildId, params, nextConfig, isDraftMode, prerenderManifest, routerServerContext, isOnDemandRevalidate, revalidateOnlyGenerated, resolvedPathname } = prepareResult;\n    const normalizedSrcPage = (0,next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__.normalizeAppPath)(srcPage);\n    let isIsr = Boolean(prerenderManifest.dynamicRoutes[normalizedSrcPage] || prerenderManifest.routes[resolvedPathname]);\n    if (isIsr && !isDraftMode) {\n        const isPrerendered = Boolean(prerenderManifest.routes[resolvedPathname]);\n        const prerenderInfo = prerenderManifest.dynamicRoutes[normalizedSrcPage];\n        if (prerenderInfo) {\n            if (prerenderInfo.fallback === false && !isPrerendered) {\n                throw new next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__.NoFallbackError();\n            }\n        }\n    }\n    let cacheKey = null;\n    if (isIsr && !routeModule.isDev && !isDraftMode) {\n        cacheKey = resolvedPathname;\n        // ensure /index and / is normalized to one key\n        cacheKey = cacheKey === '/index' ? '/' : cacheKey;\n    }\n    const supportsDynamicResponse = // If we're in development, we always support dynamic HTML\n    routeModule.isDev === true || // If this is not SSG or does not have static paths, then it supports\n    // dynamic HTML.\n    !isIsr;\n    // This is a revalidation request if the request is for a static\n    // page and it is not being resumed from a postponed render and\n    // it is not a dynamic RSC request then it is a revalidation\n    // request.\n    const isRevalidate = isIsr && !supportsDynamicResponse;\n    const method = req.method || 'GET';\n    const tracer = (0,next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__.getTracer)();\n    const activeSpan = tracer.getActiveScopeSpan();\n    const context = {\n        params,\n        prerenderManifest,\n        renderOpts: {\n            experimental: {\n                cacheComponents: Boolean(nextConfig.experimental.cacheComponents),\n                authInterrupts: Boolean(nextConfig.experimental.authInterrupts)\n            },\n            supportsDynamicResponse,\n            incrementalCache: (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'incrementalCache'),\n            cacheLifeProfiles: (_nextConfig_experimental = nextConfig.experimental) == null ? void 0 : _nextConfig_experimental.cacheLife,\n            isRevalidate,\n            waitUntil: ctx.waitUntil,\n            onClose: (cb)=>{\n                res.on('close', cb);\n            },\n            onAfterTaskError: undefined,\n            onInstrumentationRequestError: (error, _request, errorContext)=>routeModule.onRequestError(req, error, errorContext, routerServerContext)\n        },\n        sharedContext: {\n            buildId\n        }\n    };\n    const nodeNextReq = new next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__.NodeNextRequest(req);\n    const nodeNextRes = new next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__.NodeNextResponse(res);\n    const nextReq = next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__.NextRequestAdapter.fromNodeNextRequest(nodeNextReq, (0,next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__.signalFromNodeResponse)(res));\n    try {\n        const invokeRouteModule = async (span)=>{\n            return routeModule.handle(nextReq, context).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__.BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${req.url}`);\n                }\n            });\n        };\n        const handleResponse = async (currentSpan)=>{\n            var _cacheEntry_value;\n            const responseGenerator = async ({ previousCacheEntry })=>{\n                try {\n                    if (!(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode') && isOnDemandRevalidate && revalidateOnlyGenerated && !previousCacheEntry) {\n                        res.statusCode = 404;\n                        // on-demand revalidate always sets this header\n                        res.setHeader('x-nextjs-cache', 'REVALIDATED');\n                        res.end('This page could not be found');\n                        return null;\n                    }\n                    const response = await invokeRouteModule(currentSpan);\n                    req.fetchMetrics = context.renderOpts.fetchMetrics;\n                    let pendingWaitUntil = context.renderOpts.pendingWaitUntil;\n                    // Attempt using provided waitUntil if available\n                    // if it's not we fallback to sendResponse's handling\n                    if (pendingWaitUntil) {\n                        if (ctx.waitUntil) {\n                            ctx.waitUntil(pendingWaitUntil);\n                            pendingWaitUntil = undefined;\n                        }\n                    }\n                    const cacheTags = context.renderOpts.collectedTags;\n                    // If the request is for a static response, we can cache it so long\n                    // as it's not edge.\n                    if (isIsr) {\n                        const blob = await response.blob();\n                        // Copy the headers from the response.\n                        const headers = (0,next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__.toNodeOutgoingHttpHeaders)(response.headers);\n                        if (cacheTags) {\n                            headers[next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.NEXT_CACHE_TAGS_HEADER] = cacheTags;\n                        }\n                        if (!headers['content-type'] && blob.type) {\n                            headers['content-type'] = blob.type;\n                        }\n                        const revalidate = typeof context.renderOpts.collectedRevalidate === 'undefined' || context.renderOpts.collectedRevalidate >= next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.INFINITE_CACHE ? false : context.renderOpts.collectedRevalidate;\n                        const expire = typeof context.renderOpts.collectedExpire === 'undefined' || context.renderOpts.collectedExpire >= next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.INFINITE_CACHE ? undefined : context.renderOpts.collectedExpire;\n                        // Create the cache entry for the response.\n                        const cacheEntry = {\n                            value: {\n                                kind: next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__.CachedRouteKind.APP_ROUTE,\n                                status: response.status,\n                                body: Buffer.from(await blob.arrayBuffer()),\n                                headers\n                            },\n                            cacheControl: {\n                                revalidate,\n                                expire\n                            }\n                        };\n                        return cacheEntry;\n                    } else {\n                        // send response without caching if not ISR\n                        await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, response, context.renderOpts.pendingWaitUntil);\n                        return null;\n                    }\n                } catch (err) {\n                    // if this is a background revalidate we need to report\n                    // the request error here as it won't be bubbled\n                    if (previousCacheEntry == null ? void 0 : previousCacheEntry.isStale) {\n                        await routeModule.onRequestError(req, err, {\n                            routerKind: 'App Router',\n                            routePath: srcPage,\n                            routeType: 'route',\n                            revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__.getRevalidateReason)({\n                                isRevalidate,\n                                isOnDemandRevalidate\n                            })\n                        }, routerServerContext);\n                    }\n                    throw err;\n                }\n            };\n            const cacheEntry = await routeModule.handleResponse({\n                req,\n                nextConfig,\n                cacheKey,\n                routeKind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n                isFallback: false,\n                prerenderManifest,\n                isRoutePPREnabled: false,\n                isOnDemandRevalidate,\n                revalidateOnlyGenerated,\n                responseGenerator,\n                waitUntil: ctx.waitUntil\n            });\n            // we don't create a cacheEntry for ISR\n            if (!isIsr) {\n                return null;\n            }\n            if ((cacheEntry == null ? void 0 : (_cacheEntry_value = cacheEntry.value) == null ? void 0 : _cacheEntry_value.kind) !== next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__.CachedRouteKind.APP_ROUTE) {\n                var _cacheEntry_value1;\n                throw Object.defineProperty(new Error(`Invariant: app-route received invalid cache entry ${cacheEntry == null ? void 0 : (_cacheEntry_value1 = cacheEntry.value) == null ? void 0 : _cacheEntry_value1.kind}`), \"__NEXT_ERROR_CODE\", {\n                    value: \"E701\",\n                    enumerable: false,\n                    configurable: true\n                });\n            }\n            if (!(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode')) {\n                res.setHeader('x-nextjs-cache', isOnDemandRevalidate ? 'REVALIDATED' : cacheEntry.isMiss ? 'MISS' : cacheEntry.isStale ? 'STALE' : 'HIT');\n            }\n            // Draft mode should never be cached\n            if (isDraftMode) {\n                res.setHeader('Cache-Control', 'private, no-cache, no-store, max-age=0, must-revalidate');\n            }\n            const headers = (0,next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__.fromNodeOutgoingHttpHeaders)(cacheEntry.value.headers);\n            if (!((0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode') && isIsr)) {\n                headers.delete(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.NEXT_CACHE_TAGS_HEADER);\n            }\n            // If cache control is already set on the response we don't\n            // override it to allow users to customize it via next.config\n            if (cacheEntry.cacheControl && !res.getHeader('Cache-Control') && !headers.get('Cache-Control')) {\n                headers.set('Cache-Control', (0,next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_12__.getCacheControlHeader)(cacheEntry.cacheControl));\n            }\n            await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, new Response(cacheEntry.value.body, {\n                headers,\n                status: cacheEntry.value.status || 200\n            }));\n            return null;\n        };\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await handleResponse(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__.BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${req.url}`,\n                    kind: next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__.SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, handleResponse));\n        }\n    } catch (err) {\n        // if we aren't wrapped by base-server handle here\n        if (!activeSpan && !(err instanceof next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__.NoFallbackError)) {\n            await routeModule.onRequestError(req, err, {\n                routerKind: 'App Router',\n                routePath: normalizedSrcPage,\n                routeType: 'route',\n                revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__.getRevalidateReason)({\n                    isRevalidate,\n                    isOnDemandRevalidate\n                })\n            });\n        }\n        // rethrow so that we can handle serving error page\n        // If this is during static generation, throw the error again.\n        if (isIsr) throw err;\n        // Otherwise, send a 500 response.\n        await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, new Response(null, {\n            status: 500\n        }));\n        return null;\n    }\n}\n\n//# sourceMappingURL=app-route.js.map\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbmV4dEAxNS41LjJfQHBsYXl3cmlnaHQrdGVzX2I3ZTZjMjgwZTlhMWI0MzA5MzQ3YzBiZjBhYjQ3NmQ1L25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtYXBwLWxvYWRlci9pbmRleC5qcz9uYW1lPWFwcCUyRmFwaSUyRnNldHRpbmdzJTJGd2FsbGV0JTJGcm91dGUmcGFnZT0lMkZhcGklMkZzZXR0aW5ncyUyRndhbGxldCUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRnNldHRpbmdzJTJGd2FsbGV0JTJGcm91dGUudHMmYXBwRGlyPUglM0ElNUNVc2VycyU1Q0d1cyU1Q3NvdXJjZSU1Q3JlcG8lNUNkeW5hbWljcyU1Q2R5bmFtaWNzLWIlNUNjcnlwdG9waS1keW5hbWljcyU1Q3NyYyU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9SCUzQSU1Q1VzZXJzJTVDR3VzJTVDc291cmNlJTVDcmVwbyU1Q2R5bmFtaWNzJTVDZHluYW1pY3MtYiU1Q2NyeXB0b3BpLWR5bmFtaWNzJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEJmlzR2xvYmFsTm90Rm91bmRFbmFibGVkPSEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBK0Y7QUFDdkM7QUFDcUI7QUFDZDtBQUNTO0FBQ087QUFDSztBQUNtQztBQUNqRDtBQUNPO0FBQ2Y7QUFDc0M7QUFDekI7QUFDTTtBQUNDO0FBQ2hCO0FBQzJFO0FBQzdJO0FB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QWlCLDZFQUFjO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0Qix3RkFBMkI7QUFDdkQsa0JBQWtCLDZFQUFjO0FBQ2hDLCtCQUErQiw0RUFBc0I7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkMsMEZBQXFCO0FBQ2xFO0FBQ0Esa0JBQWtCLDZFQUFZO0FBQzlCO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWLDZFQUE2RSxnRkFBYztBQUMzRixpQ0FBaUMsUUFBUSxFQUFFLFFBQVE7QUFDbkQsMEJBQTBCLHVFQUFRO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsTUFBTTtBQUNOO0FBQ0EsNENBQTRDLDZGQUFlO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLDJGQUFtQjtBQUNyRDtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyw2RUFBWTtBQUMxQjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7O0FBRUEiLCJzb3VyY2VzIjpbIiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgeyBnZXRSZXF1ZXN0TWV0YSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JlcXVlc3QtbWV0YVwiO1xuaW1wb3J0IHsgZ2V0VHJhY2VyLCBTcGFuS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi90cmFjZS90cmFjZXJcIjtcbmltcG9ydCB7IG5vcm1hbGl6ZUFwcFBhdGggfSBmcm9tIFwibmV4dC9kaXN0L3NoYXJlZC9saWIvcm91dGVyL3V0aWxzL2FwcC1wYXRoc1wiO1xuaW1wb3J0IHsgTm9kZU5leHRSZXF1ZXN0LCBOb2RlTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvYmFzZS1odHRwL25vZGVcIjtcbmltcG9ydCB7IE5leHRSZXF1ZXN0QWRhcHRlciwgc2lnbmFsRnJvbU5vZGVSZXNwb25zZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3dlYi9zcGVjLWV4dGVuc2lvbi9hZGFwdGVycy9uZXh0LXJlcXVlc3RcIjtcbmltcG9ydCB7IEJhc2VTZXJ2ZXJTcGFuIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3RyYWNlL2NvbnN0YW50c1wiO1xuaW1wb3J0IHsgZ2V0UmV2YWxpZGF0ZVJlYXNvbiB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2luc3RydW1lbnRhdGlvbi91dGlsc1wiO1xuaW1wb3J0IHsgc2VuZFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvc2VuZC1yZXNwb25zZVwiO1xuaW1wb3J0IHsgZnJvbU5vZGVPdXRnb2luZ0h0dHBIZWFkZXJzLCB0b05vZGVPdXRnb2luZ0h0dHBIZWFkZXJzIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvd2ViL3V0aWxzXCI7XG5pbXBvcnQgeyBnZXRDYWNoZUNvbnRyb2xIZWFkZXIgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvY2FjaGUtY29udHJvbFwiO1xuaW1wb3J0IHsgSU5GSU5JVEVfQ0FDSEUsIE5FWFRfQ0FDSEVfVEFHU19IRUFERVIgfSBmcm9tIFwibmV4dC9kaXN0L2xpYi9jb25zdGFudHNcIjtcbmltcG9ydCB7IE5vRmFsbGJhY2tFcnJvciB9IGZyb20gXCJuZXh0L2Rpc3Qvc2hhcmVkL2xpYi9uby1mYWxsYmFjay1lcnJvci5leHRlcm5hbFwiO1xuaW1wb3J0IHsgQ2FjaGVkUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcmVzcG9uc2UtY2FjaGVcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJIOlxcXFxVc2Vyc1xcXFxHdXNcXFxcc291cmNlXFxcXHJlcG9cXFxcZHluYW1pY3NcXFxcZHluYW1pY3MtYlxcXFxjcnlwdG9waS1keW5hbWljc1xcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFxzZXR0aW5nc1xcXFx3YWxsZXRcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3NldHRpbmdzL3dhbGxldC9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3NldHRpbmdzL3dhbGxldFwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvc2V0dGluZ3Mvd2FsbGV0L3JvdXRlXCJcbiAgICB9LFxuICAgIGRpc3REaXI6IHByb2Nlc3MuZW52Ll9fTkVYVF9SRUxBVElWRV9ESVNUX0RJUiB8fCAnJyxcbiAgICByZWxhdGl2ZVByb2plY3REaXI6IHByb2Nlc3MuZW52Ll9fTkVYVF9SRUxBVElWRV9QUk9KRUNUX0RJUiB8fCAnJyxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkg6XFxcXFVzZXJzXFxcXEd1c1xcXFxzb3VyY2VcXFxccmVwb1xcXFxkeW5hbWljc1xcXFxkeW5hbWljcy1iXFxcXGNyeXB0b3BpLWR5bmFtaWNzXFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXHNldHRpbmdzXFxcXHdhbGxldFxcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHdvcmtBc3luY1N0b3JhZ2UsIHdvcmtVbml0QXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHdvcmtBc3luY1N0b3JhZ2UsXG4gICAgICAgIHdvcmtVbml0QXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgd29ya0FzeW5jU3RvcmFnZSwgd29ya1VuaXRBc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBwYXRjaEZldGNoLCAgfTtcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcSwgcmVzLCBjdHgpIHtcbiAgICB2YXIgX25leHRDb25maWdfZXhwZXJpbWVudGFsO1xuICAgIGxldCBzcmNQYWdlID0gXCIvYXBpL3NldHRpbmdzL3dhbGxldC9yb3V0ZVwiO1xuICAgIC8vIHR1cmJvcGFjayBkb2Vzbid0IG5vcm1hbGl6ZSBgL2luZGV4YCBpbiB0aGUgcGFnZSBuYW1lXG4gICAgLy8gc28gd2UgbmVlZCB0byB0byBwcm9jZXNzIGR5bmFtaWMgcm91dGVzIHByb3Blcmx5XG4gICAgLy8gVE9ETzogZml4IHR1cmJvcGFjayBwcm92aWRpbmcgZGlmZmVyaW5nIHZhbHVlIGZyb20gd2VicGFja1xuICAgIGlmIChwcm9jZXNzLmVudi5UVVJCT1BBQ0spIHtcbiAgICAgICAgc3JjUGFnZSA9IHNyY1BhZ2UucmVwbGFjZSgvXFwvaW5kZXgkLywgJycpIHx8ICcvJztcbiAgICB9IGVsc2UgaWYgKHNyY1BhZ2UgPT09ICcvaW5kZXgnKSB7XG4gICAgICAgIC8vIHdlIGFsd2F5cyBub3JtYWxpemUgL2luZGV4IHNwZWNpZmljYWxseVxuICAgICAgICBzcmNQYWdlID0gJy8nO1xuICAgIH1cbiAgICBjb25zdCBtdWx0aVpvbmVEcmFmdE1vZGUgPSBwcm9jZXNzLmVudi5fX05FWFRfTVVMVElfWk9ORV9EUkFGVF9NT0RFO1xuICAgIGNvbnN0IHByZXBhcmVSZXN1bHQgPSBhd2FpdCByb3V0ZU1vZHVsZS5wcmVwYXJlKHJlcSwgcmVzLCB7XG4gICAgICAgIHNyY1BhZ2UsXG4gICAgICAgIG11bHRpWm9uZURyYWZ0TW9kZVxuICAgIH0pO1xuICAgIGlmICghcHJlcGFyZVJlc3VsdCkge1xuICAgICAgICByZXMuc3RhdHVzQ29kZSA9IDQwMDtcbiAgICAgICAgcmVzLmVuZCgnQmFkIFJlcXVlc3QnKTtcbiAgICAgICAgY3R4LndhaXRVbnRpbCA9PSBudWxsID8gdm9pZCAwIDogY3R4LndhaXRVbnRpbC5jYWxsKGN0eCwgUHJvbWlzZS5yZXNvbHZlKCkpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgY29uc3QgeyBidWlsZElkLCBwYXJhbXMsIG5leHRDb25maWcsIGlzRHJhZnRNb2RlLCBwcmVyZW5kZXJNYW5pZmVzdCwgcm91dGVyU2VydmVyQ29udGV4dCwgaXNPbkRlbWFuZFJldmFsaWRhdGUsIHJldmFsaWRhdGVPbmx5R2VuZXJhdGVkLCByZXNvbHZlZFBhdGhuYW1lIH0gPSBwcmVwYXJlUmVzdWx0O1xuICAgIGNvbnN0IG5vcm1hbGl6ZWRTcmNQYWdlID0gbm9ybWFsaXplQXBwUGF0aChzcmNQYWdlKTtcbiAgICBsZXQgaXNJc3IgPSBCb29sZWFuKHByZXJlbmRlck1hbmlmZXN0LmR5bmFtaWNSb3V0ZXNbbm9ybWFsaXplZFNyY1BhZ2VdIHx8IHByZXJlbmRlck1hbmlmZXN0LnJvdXRlc1tyZXNvbHZlZFBhdGhuYW1lXSk7XG4gICAgaWYgKGlzSXNyICYmICFpc0RyYWZ0TW9kZSkge1xuICAgICAgICBjb25zdCBpc1ByZXJlbmRlcmVkID0gQm9vbGVhbihwcmVyZW5kZXJNYW5pZmVzdC5yb3V0ZXNbcmVzb2x2ZWRQYXRobmFtZV0pO1xuICAgICAgICBjb25zdCBwcmVyZW5kZXJJbmZvID0gcHJlcmVuZGVyTWFuaWZlc3QuZHluYW1pY1JvdXRlc1tub3JtYWxpemVkU3JjUGFnZV07XG4gICAgICAgIGlmIChwcmVyZW5kZXJJbmZvKSB7XG4gICAgICAgICAgICBpZiAocHJlcmVuZGVySW5mby5mYWxsYmFjayA9PT0gZmFsc2UgJiYgIWlzUHJlcmVuZGVyZWQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm9GYWxsYmFja0Vycm9yKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgbGV0IGNhY2hlS2V5ID0gbnVsbDtcbiAgICBpZiAoaXNJc3IgJiYgIXJvdXRlTW9kdWxlLmlzRGV2ICYmICFpc0RyYWZ0TW9kZSkge1xuICAgICAgICBjYWNoZUtleSA9IHJlc29sdmVkUGF0aG5hbWU7XG4gICAgICAgIC8vIGVuc3VyZSAvaW5kZXggYW5kIC8gaXMgbm9ybWFsaXplZCB0byBvbmUga2V5XG4gICAgICAgIGNhY2hlS2V5ID0gY2FjaGVLZXkgPT09ICcvaW5kZXgnID8gJy8nIDogY2FjaGVLZXk7XG4gICAgfVxuICAgIGNvbnN0IHN1cHBvcnRzRHluYW1pY1Jlc3BvbnNlID0gLy8gSWYgd2UncmUgaW4gZGV2ZWxvcG1lbnQsIHdlIGFsd2F5cyBzdXBwb3J0IGR5bmFtaWMgSFRNTFxuICAgIHJvdXRlTW9kdWxlLmlzRGV2ID09PSB0cnVlIHx8IC8vIElmIHRoaXMgaXMgbm90IFNTRyBvciBkb2VzIG5vdCBoYXZlIHN0YXRpYyBwYXRocywgdGhlbiBpdCBzdXBwb3J0c1xuICAgIC8vIGR5bmFtaWMgSFRNTC5cbiAgICAhaXNJc3I7XG4gICAgLy8gVGhpcyBpcyBhIHJldmFsaWRhdGlvbiByZXF1ZXN0IGlmIHRoZSByZXF1ZXN0IGlzIGZvciBhIHN0YXRpY1xuICAgIC8vIHBhZ2UgYW5kIGl0IGlzIG5vdCBiZWluZyByZXN1bWVkIGZyb20gYSBwb3N0cG9uZWQgcmVuZGVyIGFuZFxuICAgIC8vIGl0IGlzIG5vdCBhIGR5bmFtaWMgUlNDIHJlcXVlc3QgdGhlbiBpdCBpcyBhIHJldmFsaWRhdGlvblxuICAgIC8vIHJlcXVlc3QuXG4gICAgY29uc3QgaXNSZXZhbGlkYXRlID0gaXNJc3IgJiYgIXN1cHBvcnRzRHluYW1pY1Jlc3BvbnNlO1xuICAgIGNvbnN0IG1ldGhvZCA9IHJlcS5tZXRob2QgfHwgJ0dFVCc7XG4gICAgY29uc3QgdHJhY2VyID0gZ2V0VHJhY2VyKCk7XG4gICAgY29uc3QgYWN0aXZlU3BhbiA9IHRyYWNlci5nZXRBY3RpdmVTY29wZVNwYW4oKTtcbiAgICBjb25zdCBjb250ZXh0ID0ge1xuICAgICAgICBwYXJhbXMsXG4gICAgICAgIHByZXJlbmRlck1hbmlmZXN0LFxuICAgICAgICByZW5kZXJPcHRzOiB7XG4gICAgICAgICAgICBleHBlcmltZW50YWw6IHtcbiAgICAgICAgICAgICAgICBjYWNoZUNvbXBvbmVudHM6IEJvb2xlYW4obmV4dENvbmZpZy5leHBlcmltZW50YWwuY2FjaGVDb21wb25lbnRzKSxcbiAgICAgICAgICAgICAgICBhdXRoSW50ZXJydXB0czogQm9vbGVhbihuZXh0Q29uZmlnLmV4cGVyaW1lbnRhbC5hdXRoSW50ZXJydXB0cylcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzdXBwb3J0c0R5bmFtaWNSZXNwb25zZSxcbiAgICAgICAgICAgIGluY3JlbWVudGFsQ2FjaGU6IGdldFJlcXVlc3RNZXRhKHJlcSwgJ2luY3JlbWVudGFsQ2FjaGUnKSxcbiAgICAgICAgICAgIGNhY2hlTGlmZVByb2ZpbGVzOiAoX25leHRDb25maWdfZXhwZXJpbWVudGFsID0gbmV4dENvbmZpZy5leHBlcmltZW50YWwpID09IG51bGwgPyB2b2lkIDAgOiBfbmV4dENvbmZpZ19leHBlcmltZW50YWwuY2FjaGVMaWZlLFxuICAgICAgICAgICAgaXNSZXZhbGlkYXRlLFxuICAgICAgICAgICAgd2FpdFVudGlsOiBjdHgud2FpdFVudGlsLFxuICAgICAgICAgICAgb25DbG9zZTogKGNiKT0+e1xuICAgICAgICAgICAgICAgIHJlcy5vbignY2xvc2UnLCBjYik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgb25BZnRlclRhc2tFcnJvcjogdW5kZWZpbmVkLFxuICAgICAgICAgICAgb25JbnN0cnVtZW50YXRpb25SZXF1ZXN0RXJyb3I6IChlcnJvciwgX3JlcXVlc3QsIGVycm9yQ29udGV4dCk9PnJvdXRlTW9kdWxlLm9uUmVxdWVzdEVycm9yKHJlcSwgZXJyb3IsIGVycm9yQ29udGV4dCwgcm91dGVyU2VydmVyQ29udGV4dClcbiAgICAgICAgfSxcbiAgICAgICAgc2hhcmVkQ29udGV4dDoge1xuICAgICAgICAgICAgYnVpbGRJZFxuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBub2RlTmV4dFJlcSA9IG5ldyBOb2RlTmV4dFJlcXVlc3QocmVxKTtcbiAgICBjb25zdCBub2RlTmV4dFJlcyA9IG5ldyBOb2RlTmV4dFJlc3BvbnNlKHJlcyk7XG4gICAgY29uc3QgbmV4dFJlcSA9IE5leHRSZXF1ZXN0QWRhcHRlci5mcm9tTm9kZU5leHRSZXF1ZXN0KG5vZGVOZXh0UmVxLCBzaWduYWxGcm9tTm9kZVJlc3BvbnNlKHJlcykpO1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGludm9rZVJvdXRlTW9kdWxlID0gYXN5bmMgKHNwYW4pPT57XG4gICAgICAgICAgICByZXR1cm4gcm91dGVNb2R1bGUuaGFuZGxlKG5leHRSZXEsIGNvbnRleHQpLmZpbmFsbHkoKCk9PntcbiAgICAgICAgICAgICAgICBpZiAoIXNwYW4pIHJldHVybjtcbiAgICAgICAgICAgICAgICBzcGFuLnNldEF0dHJpYnV0ZXMoe1xuICAgICAgICAgICAgICAgICAgICAnaHR0cC5zdGF0dXNfY29kZSc6IHJlcy5zdGF0dXNDb2RlLFxuICAgICAgICAgICAgICAgICAgICAnbmV4dC5yc2MnOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJvb3RTcGFuQXR0cmlidXRlcyA9IHRyYWNlci5nZXRSb290U3BhbkF0dHJpYnV0ZXMoKTtcbiAgICAgICAgICAgICAgICAvLyBXZSB3ZXJlIHVuYWJsZSB0byBnZXQgYXR0cmlidXRlcywgcHJvYmFibHkgT1RFTCBpcyBub3QgZW5hYmxlZFxuICAgICAgICAgICAgICAgIGlmICghcm9vdFNwYW5BdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQuc3Bhbl90eXBlJykgIT09IEJhc2VTZXJ2ZXJTcGFuLmhhbmRsZVJlcXVlc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBVbmV4cGVjdGVkIHJvb3Qgc3BhbiB0eXBlICcke3Jvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQuc3Bhbl90eXBlJyl9Jy4gUGxlYXNlIHJlcG9ydCB0aGlzIE5leHQuanMgaXNzdWUgaHR0cHM6Ly9naXRodWIuY29tL3ZlcmNlbC9uZXh0LmpzYCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3Qgcm91dGUgPSByb290U3BhbkF0dHJpYnV0ZXMuZ2V0KCduZXh0LnJvdXRlJyk7XG4gICAgICAgICAgICAgICAgaWYgKHJvdXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBgJHttZXRob2R9ICR7cm91dGV9YDtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi5zZXRBdHRyaWJ1dGVzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICduZXh0LnJvdXRlJzogcm91dGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAnaHR0cC5yb3V0ZSc6IHJvdXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ25leHQuc3Bhbl9uYW1lJzogbmFtZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi51cGRhdGVOYW1lKG5hbWUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNwYW4udXBkYXRlTmFtZShgJHttZXRob2R9ICR7cmVxLnVybH1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgaGFuZGxlUmVzcG9uc2UgPSBhc3luYyAoY3VycmVudFNwYW4pPT57XG4gICAgICAgICAgICB2YXIgX2NhY2hlRW50cnlfdmFsdWU7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZUdlbmVyYXRvciA9IGFzeW5jICh7IHByZXZpb3VzQ2FjaGVFbnRyeSB9KT0+e1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghZ2V0UmVxdWVzdE1ldGEocmVxLCAnbWluaW1hbE1vZGUnKSAmJiBpc09uRGVtYW5kUmV2YWxpZGF0ZSAmJiByZXZhbGlkYXRlT25seUdlbmVyYXRlZCAmJiAhcHJldmlvdXNDYWNoZUVudHJ5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMuc3RhdHVzQ29kZSA9IDQwNDtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9uLWRlbWFuZCByZXZhbGlkYXRlIGFsd2F5cyBzZXRzIHRoaXMgaGVhZGVyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXMuc2V0SGVhZGVyKCd4LW5leHRqcy1jYWNoZScsICdSRVZBTElEQVRFRCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzLmVuZCgnVGhpcyBwYWdlIGNvdWxkIG5vdCBiZSBmb3VuZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBpbnZva2VSb3V0ZU1vZHVsZShjdXJyZW50U3Bhbik7XG4gICAgICAgICAgICAgICAgICAgIHJlcS5mZXRjaE1ldHJpY3MgPSBjb250ZXh0LnJlbmRlck9wdHMuZmV0Y2hNZXRyaWNzO1xuICAgICAgICAgICAgICAgICAgICBsZXQgcGVuZGluZ1dhaXRVbnRpbCA9IGNvbnRleHQucmVuZGVyT3B0cy5wZW5kaW5nV2FpdFVudGlsO1xuICAgICAgICAgICAgICAgICAgICAvLyBBdHRlbXB0IHVzaW5nIHByb3ZpZGVkIHdhaXRVbnRpbCBpZiBhdmFpbGFibGVcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgaXQncyBub3Qgd2UgZmFsbGJhY2sgdG8gc2VuZFJlc3BvbnNlJ3MgaGFuZGxpbmdcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBlbmRpbmdXYWl0VW50aWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdHgud2FpdFVudGlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LndhaXRVbnRpbChwZW5kaW5nV2FpdFVudGlsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZW5kaW5nV2FpdFVudGlsID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhY2hlVGFncyA9IGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRUYWdzO1xuICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgcmVxdWVzdCBpcyBmb3IgYSBzdGF0aWMgcmVzcG9uc2UsIHdlIGNhbiBjYWNoZSBpdCBzbyBsb25nXG4gICAgICAgICAgICAgICAgICAgIC8vIGFzIGl0J3Mgbm90IGVkZ2UuXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc0lzcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYmxvYiA9IGF3YWl0IHJlc3BvbnNlLmJsb2IoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENvcHkgdGhlIGhlYWRlcnMgZnJvbSB0aGUgcmVzcG9uc2UuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBoZWFkZXJzID0gdG9Ob2RlT3V0Z29pbmdIdHRwSGVhZGVycyhyZXNwb25zZS5oZWFkZXJzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYWNoZVRhZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzW05FWFRfQ0FDSEVfVEFHU19IRUFERVJdID0gY2FjaGVUYWdzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFoZWFkZXJzWydjb250ZW50LXR5cGUnXSAmJiBibG9iLnR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzWydjb250ZW50LXR5cGUnXSA9IGJsb2IudHlwZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJldmFsaWRhdGUgPSB0eXBlb2YgY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZFJldmFsaWRhdGUgPT09ICd1bmRlZmluZWQnIHx8IGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRSZXZhbGlkYXRlID49IElORklOSVRFX0NBQ0hFID8gZmFsc2UgOiBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkUmV2YWxpZGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4cGlyZSA9IHR5cGVvZiBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkRXhwaXJlID09PSAndW5kZWZpbmVkJyB8fCBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkRXhwaXJlID49IElORklOSVRFX0NBQ0hFID8gdW5kZWZpbmVkIDogY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZEV4cGlyZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENyZWF0ZSB0aGUgY2FjaGUgZW50cnkgZm9yIHRoZSByZXNwb25zZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhY2hlRW50cnkgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2luZDogQ2FjaGVkUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiByZXNwb25zZS5zdGF0dXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvZHk6IEJ1ZmZlci5mcm9tKGF3YWl0IGJsb2IuYXJyYXlCdWZmZXIoKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlQ29udHJvbDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXZhbGlkYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBpcmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhY2hlRW50cnk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZW5kIHJlc3BvbnNlIHdpdGhvdXQgY2FjaGluZyBpZiBub3QgSVNSXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBzZW5kUmVzcG9uc2Uobm9kZU5leHRSZXEsIG5vZGVOZXh0UmVzLCByZXNwb25zZSwgY29udGV4dC5yZW5kZXJPcHRzLnBlbmRpbmdXYWl0VW50aWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhpcyBpcyBhIGJhY2tncm91bmQgcmV2YWxpZGF0ZSB3ZSBuZWVkIHRvIHJlcG9ydFxuICAgICAgICAgICAgICAgICAgICAvLyB0aGUgcmVxdWVzdCBlcnJvciBoZXJlIGFzIGl0IHdvbid0IGJlIGJ1YmJsZWRcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByZXZpb3VzQ2FjaGVFbnRyeSA9PSBudWxsID8gdm9pZCAwIDogcHJldmlvdXNDYWNoZUVudHJ5LmlzU3RhbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHJvdXRlTW9kdWxlLm9uUmVxdWVzdEVycm9yKHJlcSwgZXJyLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm91dGVyS2luZDogJ0FwcCBSb3V0ZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdXRlUGF0aDogc3JjUGFnZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3V0ZVR5cGU6ICdyb3V0ZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV2YWxpZGF0ZVJlYXNvbjogZ2V0UmV2YWxpZGF0ZVJlYXNvbih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzUmV2YWxpZGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNPbkRlbWFuZFJldmFsaWRhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgcm91dGVyU2VydmVyQ29udGV4dCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjb25zdCBjYWNoZUVudHJ5ID0gYXdhaXQgcm91dGVNb2R1bGUuaGFuZGxlUmVzcG9uc2Uoe1xuICAgICAgICAgICAgICAgIHJlcSxcbiAgICAgICAgICAgICAgICBuZXh0Q29uZmlnLFxuICAgICAgICAgICAgICAgIGNhY2hlS2V5LFxuICAgICAgICAgICAgICAgIHJvdXRlS2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgICAgICAgICBpc0ZhbGxiYWNrOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBwcmVyZW5kZXJNYW5pZmVzdCxcbiAgICAgICAgICAgICAgICBpc1JvdXRlUFBSRW5hYmxlZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgaXNPbkRlbWFuZFJldmFsaWRhdGUsXG4gICAgICAgICAgICAgICAgcmV2YWxpZGF0ZU9ubHlHZW5lcmF0ZWQsXG4gICAgICAgICAgICAgICAgcmVzcG9uc2VHZW5lcmF0b3IsXG4gICAgICAgICAgICAgICAgd2FpdFVudGlsOiBjdHgud2FpdFVudGlsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vIHdlIGRvbid0IGNyZWF0ZSBhIGNhY2hlRW50cnkgZm9yIElTUlxuICAgICAgICAgICAgaWYgKCFpc0lzcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKChjYWNoZUVudHJ5ID09IG51bGwgPyB2b2lkIDAgOiAoX2NhY2hlRW50cnlfdmFsdWUgPSBjYWNoZUVudHJ5LnZhbHVlKSA9PSBudWxsID8gdm9pZCAwIDogX2NhY2hlRW50cnlfdmFsdWUua2luZCkgIT09IENhY2hlZFJvdXRlS2luZC5BUFBfUk9VVEUpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2NhY2hlRW50cnlfdmFsdWUxO1xuICAgICAgICAgICAgICAgIHRocm93IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXcgRXJyb3IoYEludmFyaWFudDogYXBwLXJvdXRlIHJlY2VpdmVkIGludmFsaWQgY2FjaGUgZW50cnkgJHtjYWNoZUVudHJ5ID09IG51bGwgPyB2b2lkIDAgOiAoX2NhY2hlRW50cnlfdmFsdWUxID0gY2FjaGVFbnRyeS52YWx1ZSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9jYWNoZUVudHJ5X3ZhbHVlMS5raW5kfWApLCBcIl9fTkVYVF9FUlJPUl9DT0RFXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFwiRTcwMVwiLFxuICAgICAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWdldFJlcXVlc3RNZXRhKHJlcSwgJ21pbmltYWxNb2RlJykpIHtcbiAgICAgICAgICAgICAgICByZXMuc2V0SGVhZGVyKCd4LW5leHRqcy1jYWNoZScsIGlzT25EZW1hbmRSZXZhbGlkYXRlID8gJ1JFVkFMSURBVEVEJyA6IGNhY2hlRW50cnkuaXNNaXNzID8gJ01JU1MnIDogY2FjaGVFbnRyeS5pc1N0YWxlID8gJ1NUQUxFJyA6ICdISVQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIERyYWZ0IG1vZGUgc2hvdWxkIG5ldmVyIGJlIGNhY2hlZFxuICAgICAgICAgICAgaWYgKGlzRHJhZnRNb2RlKSB7XG4gICAgICAgICAgICAgICAgcmVzLnNldEhlYWRlcignQ2FjaGUtQ29udHJvbCcsICdwcml2YXRlLCBuby1jYWNoZSwgbm8tc3RvcmUsIG1heC1hZ2U9MCwgbXVzdC1yZXZhbGlkYXRlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBoZWFkZXJzID0gZnJvbU5vZGVPdXRnb2luZ0h0dHBIZWFkZXJzKGNhY2hlRW50cnkudmFsdWUuaGVhZGVycyk7XG4gICAgICAgICAgICBpZiAoIShnZXRSZXF1ZXN0TWV0YShyZXEsICdtaW5pbWFsTW9kZScpICYmIGlzSXNyKSkge1xuICAgICAgICAgICAgICAgIGhlYWRlcnMuZGVsZXRlKE5FWFRfQ0FDSEVfVEFHU19IRUFERVIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gSWYgY2FjaGUgY29udHJvbCBpcyBhbHJlYWR5IHNldCBvbiB0aGUgcmVzcG9uc2Ugd2UgZG9uJ3RcbiAgICAgICAgICAgIC8vIG92ZXJyaWRlIGl0IHRvIGFsbG93IHVzZXJzIHRvIGN1c3RvbWl6ZSBpdCB2aWEgbmV4dC5jb25maWdcbiAgICAgICAgICAgIGlmIChjYWNoZUVudHJ5LmNhY2hlQ29udHJvbCAmJiAhcmVzLmdldEhlYWRlcignQ2FjaGUtQ29udHJvbCcpICYmICFoZWFkZXJzLmdldCgnQ2FjaGUtQ29udHJvbCcpKSB7XG4gICAgICAgICAgICAgICAgaGVhZGVycy5zZXQoJ0NhY2hlLUNvbnRyb2wnLCBnZXRDYWNoZUNvbnRyb2xIZWFkZXIoY2FjaGVFbnRyeS5jYWNoZUNvbnRyb2wpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGF3YWl0IHNlbmRSZXNwb25zZShub2RlTmV4dFJlcSwgbm9kZU5leHRSZXMsIG5ldyBSZXNwb25zZShjYWNoZUVudHJ5LnZhbHVlLmJvZHksIHtcbiAgICAgICAgICAgICAgICBoZWFkZXJzLFxuICAgICAgICAgICAgICAgIHN0YXR1czogY2FjaGVFbnRyeS52YWx1ZS5zdGF0dXMgfHwgMjAwXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfTtcbiAgICAgICAgLy8gVE9ETzogYWN0aXZlU3BhbiBjb2RlIHBhdGggaXMgZm9yIHdoZW4gd3JhcHBlZCBieVxuICAgICAgICAvLyBuZXh0LXNlcnZlciBjYW4gYmUgcmVtb3ZlZCB3aGVuIHRoaXMgaXMgbm8gbG9uZ2VyIHVzZWRcbiAgICAgICAgaWYgKGFjdGl2ZVNwYW4pIHtcbiAgICAgICAgICAgIGF3YWl0IGhhbmRsZVJlc3BvbnNlKGFjdGl2ZVNwYW4pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYXdhaXQgdHJhY2VyLndpdGhQcm9wYWdhdGVkQ29udGV4dChyZXEuaGVhZGVycywgKCk9PnRyYWNlci50cmFjZShCYXNlU2VydmVyU3Bhbi5oYW5kbGVSZXF1ZXN0LCB7XG4gICAgICAgICAgICAgICAgICAgIHNwYW5OYW1lOiBgJHttZXRob2R9ICR7cmVxLnVybH1gLFxuICAgICAgICAgICAgICAgICAgICBraW5kOiBTcGFuS2luZC5TRVJWRVIsXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLm1ldGhvZCc6IG1ldGhvZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLnRhcmdldCc6IHJlcS51cmxcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIGhhbmRsZVJlc3BvbnNlKSk7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgLy8gaWYgd2UgYXJlbid0IHdyYXBwZWQgYnkgYmFzZS1zZXJ2ZXIgaGFuZGxlIGhlcmVcbiAgICAgICAgaWYgKCFhY3RpdmVTcGFuICYmICEoZXJyIGluc3RhbmNlb2YgTm9GYWxsYmFja0Vycm9yKSkge1xuICAgICAgICAgICAgYXdhaXQgcm91dGVNb2R1bGUub25SZXF1ZXN0RXJyb3IocmVxLCBlcnIsIHtcbiAgICAgICAgICAgICAgICByb3V0ZXJLaW5kOiAnQXBwIFJvdXRlcicsXG4gICAgICAgICAgICAgICAgcm91dGVQYXRoOiBub3JtYWxpemVkU3JjUGFnZSxcbiAgICAgICAgICAgICAgICByb3V0ZVR5cGU6ICdyb3V0ZScsXG4gICAgICAgICAgICAgICAgcmV2YWxpZGF0ZVJlYXNvbjogZ2V0UmV2YWxpZGF0ZVJlYXNvbih7XG4gICAgICAgICAgICAgICAgICAgIGlzUmV2YWxpZGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgaXNPbkRlbWFuZFJldmFsaWRhdGVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gcmV0aHJvdyBzbyB0aGF0IHdlIGNhbiBoYW5kbGUgc2VydmluZyBlcnJvciBwYWdlXG4gICAgICAgIC8vIElmIHRoaXMgaXMgZHVyaW5nIHN0YXRpYyBnZW5lcmF0aW9uLCB0aHJvdyB0aGUgZXJyb3IgYWdhaW4uXG4gICAgICAgIGlmIChpc0lzcikgdGhyb3cgZXJyO1xuICAgICAgICAvLyBPdGhlcndpc2UsIHNlbmQgYSA1MDAgcmVzcG9uc2UuXG4gICAgICAgIGF3YWl0IHNlbmRSZXNwb25zZShub2RlTmV4dFJlcSwgbm9kZU5leHRSZXMsIG5ldyBSZXNwb25zZShudWxsLCB7XG4gICAgICAgICAgICBzdGF0dXM6IDUwMFxuICAgICAgICB9KSk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fsettings%2Fwallet%2Froute&page=%2Fapi%2Fsettings%2Fwallet%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsettings%2Fwallet%2Froute.ts&appDir=H%3A%5CUsers%5CGus%5Csource%5Crepo%5Cdynamics%5Cdynamics-b%5Ccryptopi-dynamics%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=H%3A%5CUsers%5CGus%5Csource%5Crepo%5Cdynamics%5Cdynamics-b%5Ccryptopi-dynamics&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!\n");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!**************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \**************************************************************************************************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./src/app/api/market/providers/binance/account/test/verify.ts":
/*!*********************************************************************!*\
  !*** ./src/app/api/market/providers/binance/account/test/verify.ts ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   verifyBinanceAccount: () => (/* binding */ verifyBinanceAccount)\n/* harmony export */ });\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_0__);\n\nasync function fetchServerTime() {\n    const res = await fetch(\"https://api.binance.com/api/v3/time\", {\n        cache: \"no-store\"\n    });\n    if (!res.ok) {\n        throw new Error(`Failed to fetch Binance server time (HTTP ${res.status})`);\n    }\n    const data = await res.json();\n    return Number(data?.serverTime ?? Date.now());\n}\nasync function requestAccount(apiKey, apiSecret, skewMs = 0) {\n    const timestamp = Date.now() + skewMs;\n    const query = new URLSearchParams({\n        timestamp: String(timestamp)\n    }).toString();\n    const signature = crypto__WEBPACK_IMPORTED_MODULE_0___default().createHmac(\"sha256\", apiSecret).update(query).digest(\"hex\");\n    const url = `https://api.binance.com/api/v3/account?${query}&signature=${signature}`;\n    const res = await fetch(url, {\n        headers: {\n            \"X-MBX-APIKEY\": apiKey\n        },\n        cache: \"no-store\"\n    });\n    const text = await res.text();\n    let json;\n    try {\n        json = text ? JSON.parse(text) : undefined;\n    } catch  {\n        json = undefined;\n    }\n    if (!res.ok) {\n        const message = (json && typeof json === \"object\" ? json.msg : undefined) || text || `HTTP ${res.status}`;\n        return {\n            ok: false,\n            status: res.status,\n            error: message,\n            code: typeof json?.code === \"number\" ? json.code : undefined\n        };\n    }\n    return {\n        ok: true,\n        body: (json && typeof json === \"object\" ? json : {}) ?? {}\n    };\n}\nasync function verifyBinanceAccount(apiKey, apiSecret) {\n    try {\n        let attempt = await requestAccount(apiKey, apiSecret);\n        if (!attempt.ok && (attempt.code === -1021 || /timestamp/i.test(attempt.error))) {\n            const serverTime = await fetchServerTime();\n            const skew = serverTime - Date.now();\n            attempt = await requestAccount(apiKey, apiSecret, skew);\n        }\n        if (!attempt.ok) {\n            return {\n                ok: false,\n                status: attempt.status,\n                error: attempt.error\n            };\n        }\n        const body = attempt.body;\n        const balances = Array.isArray(body.balances) ? body.balances.length : 0;\n        return {\n            ok: true,\n            accountType: typeof body.accountType === \"string\" ? body.accountType : null,\n            canTrade: Boolean(body.canTrade),\n            balancesCount: balances,\n            updateTime: typeof body.updateTime === \"number\" ? body.updateTime : null\n        };\n    } catch (error) {\n        const message = error instanceof Error ? error.message : String(error ?? \"Unexpected error\");\n        return {\n            ok: false,\n            error: message\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9tYXJrZXQvcHJvdmlkZXJzL2JpbmFuY2UvYWNjb3VudC90ZXN0L3ZlcmlmeS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBNEI7QUFjNUIsZUFBZUM7SUFDYixNQUFNQyxNQUFNLE1BQU1DLE1BQU0sdUNBQXVDO1FBQzdEQyxPQUFPO0lBQ1Q7SUFDQSxJQUFJLENBQUNGLElBQUlHLEVBQUUsRUFBRTtRQUNYLE1BQU0sSUFBSUMsTUFBTSxDQUFDLDBDQUEwQyxFQUFFSixJQUFJSyxNQUFNLENBQUMsQ0FBQyxDQUFDO0lBQzVFO0lBQ0EsTUFBTUMsT0FBUSxNQUFNTixJQUFJTyxJQUFJO0lBQzVCLE9BQU9DLE9BQU9GLE1BQU1HLGNBQWNDLEtBQUtDLEdBQUc7QUFDNUM7QUFNQSxlQUFlQyxlQUNiQyxNQUFjLEVBQ2RDLFNBQWlCLEVBQ2pCQyxTQUFTLENBQUM7SUFFVixNQUFNQyxZQUFZTixLQUFLQyxHQUFHLEtBQUtJO0lBQy9CLE1BQU1FLFFBQVEsSUFBSUMsZ0JBQWdCO1FBQUVGLFdBQVdHLE9BQU9IO0lBQVcsR0FBR0ksUUFBUTtJQUM1RSxNQUFNQyxZQUFZdkIsd0RBQWlCLENBQUMsVUFBVWdCLFdBQVdTLE1BQU0sQ0FBQ04sT0FBT08sTUFBTSxDQUFDO0lBRTlFLE1BQU1DLE1BQU0sQ0FBQyx1Q0FBdUMsRUFBRVIsTUFBTSxXQUFXLEVBQUVJLFdBQVc7SUFDcEYsTUFBTXJCLE1BQU0sTUFBTUMsTUFBTXdCLEtBQUs7UUFDM0JDLFNBQVM7WUFBRSxnQkFBZ0JiO1FBQU87UUFDbENYLE9BQU87SUFDVDtJQUVBLE1BQU15QixPQUFPLE1BQU0zQixJQUFJMkIsSUFBSTtJQUMzQixJQUFJcEI7SUFDSixJQUFJO1FBQ0ZBLE9BQU9vQixPQUFPQyxLQUFLQyxLQUFLLENBQUNGLFFBQVFHO0lBQ25DLEVBQUUsT0FBTTtRQUNOdkIsT0FBT3VCO0lBQ1Q7SUFFQSxJQUFJLENBQUM5QixJQUFJRyxFQUFFLEVBQUU7UUFDWCxNQUFNNEIsVUFDSixDQUFDeEIsUUFBUSxPQUFPQSxTQUFTLFdBQVdBLEtBQUt5QixHQUFHLEdBQUdGLFNBQVEsS0FDdkRILFFBQ0EsQ0FBQyxLQUFLLEVBQUUzQixJQUFJSyxNQUFNLEVBQUU7UUFDdEIsT0FBTztZQUNMRixJQUFJO1lBQ0pFLFFBQVFMLElBQUlLLE1BQU07WUFDbEI0QixPQUFPRjtZQUNQRyxNQUFNLE9BQU8zQixNQUFNMkIsU0FBUyxXQUFXM0IsS0FBSzJCLElBQUksR0FBR0o7UUFDckQ7SUFDRjtJQUVBLE9BQU87UUFDTDNCLElBQUk7UUFDSmdDLE1BQU0sQ0FBQzVCLFFBQVEsT0FBT0EsU0FBUyxXQUFZQSxPQUFzQixDQUFDLE1BQU0sQ0FBQztJQUMzRTtBQUNGO0FBRU8sZUFBZTZCLHFCQUNwQnZCLE1BQWMsRUFDZEMsU0FBaUI7SUFFakIsSUFBSTtRQUNGLElBQUl1QixVQUFVLE1BQU16QixlQUFlQyxRQUFRQztRQUUzQyxJQUFJLENBQUN1QixRQUFRbEMsRUFBRSxJQUFLa0MsQ0FBQUEsUUFBUUgsSUFBSSxLQUFLLENBQUMsUUFBUSxhQUFhSSxJQUFJLENBQUNELFFBQVFKLEtBQUssSUFBSTtZQUMvRSxNQUFNeEIsYUFBYSxNQUFNVjtZQUN6QixNQUFNd0MsT0FBTzlCLGFBQWFDLEtBQUtDLEdBQUc7WUFDbEMwQixVQUFVLE1BQU16QixlQUFlQyxRQUFRQyxXQUFXeUI7UUFDcEQ7UUFFQSxJQUFJLENBQUNGLFFBQVFsQyxFQUFFLEVBQUU7WUFDZixPQUFPO2dCQUNMQSxJQUFJO2dCQUNKRSxRQUFRZ0MsUUFBUWhDLE1BQU07Z0JBQ3RCNEIsT0FBT0ksUUFBUUosS0FBSztZQUN0QjtRQUNGO1FBRUEsTUFBTUUsT0FBT0UsUUFBUUYsSUFBSTtRQUN6QixNQUFNSyxXQUFXQyxNQUFNQyxPQUFPLENBQUNQLEtBQUtLLFFBQVEsSUFBSUwsS0FBS0ssUUFBUSxDQUFDRyxNQUFNLEdBQUc7UUFFdkUsT0FBTztZQUNMeEMsSUFBSTtZQUNKeUMsYUFBYSxPQUFPVCxLQUFLUyxXQUFXLEtBQUssV0FBV1QsS0FBS1MsV0FBVyxHQUFHO1lBQ3ZFQyxVQUFVQyxRQUFRWCxLQUFLVSxRQUFRO1lBQy9CRSxlQUFlUDtZQUNmUSxZQUFZLE9BQU9iLEtBQUthLFVBQVUsS0FBSyxXQUFXYixLQUFLYSxVQUFVLEdBQUc7UUFDdEU7SUFDRixFQUFFLE9BQU9mLE9BQU87UUFDZCxNQUFNRixVQUFVRSxpQkFBaUI3QixRQUFRNkIsTUFBTUYsT0FBTyxHQUFHWixPQUFPYyxTQUFTO1FBQ3pFLE9BQU87WUFBRTlCLElBQUk7WUFBTzhCLE9BQU9GO1FBQVE7SUFDckM7QUFDRiIsInNvdXJjZXMiOlsiSDpcXFVzZXJzXFxHdXNcXHNvdXJjZVxccmVwb1xcZHluYW1pY3NcXGR5bmFtaWNzLWJcXGNyeXB0b3BpLWR5bmFtaWNzXFxzcmNcXGFwcFxcYXBpXFxtYXJrZXRcXHByb3ZpZGVyc1xcYmluYW5jZVxcYWNjb3VudFxcdGVzdFxcdmVyaWZ5LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjcnlwdG8gZnJvbSBcImNyeXB0b1wiO1xuXG5leHBvcnQgdHlwZSBWZXJpZnlSZXNwb25zZSA9IHtcbiAgb2s6IGJvb2xlYW47XG4gIGFjY291bnRUeXBlPzogc3RyaW5nIHwgbnVsbDtcbiAgY2FuVHJhZGU/OiBib29sZWFuO1xuICBiYWxhbmNlc0NvdW50PzogbnVtYmVyO1xuICB1cGRhdGVUaW1lPzogbnVtYmVyIHwgbnVsbDtcbiAgc3RhdHVzPzogbnVtYmVyO1xuICBlcnJvcj86IHN0cmluZztcbn07XG5cbnR5cGUgUmF3QWNjb3VudCA9IFJlY29yZDxzdHJpbmcsIHVua25vd24+ICYgeyBiYWxhbmNlcz86IHVua25vd25bXSB9O1xuXG5hc3luYyBmdW5jdGlvbiBmZXRjaFNlcnZlclRpbWUoKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goXCJodHRwczovL2FwaS5iaW5hbmNlLmNvbS9hcGkvdjMvdGltZVwiLCB7XG4gICAgY2FjaGU6IFwibm8tc3RvcmVcIixcbiAgfSk7XG4gIGlmICghcmVzLm9rKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZmV0Y2ggQmluYW5jZSBzZXJ2ZXIgdGltZSAoSFRUUCAke3Jlcy5zdGF0dXN9KWApO1xuICB9XG4gIGNvbnN0IGRhdGEgPSAoYXdhaXQgcmVzLmpzb24oKSkgYXMgeyBzZXJ2ZXJUaW1lPzogbnVtYmVyIH07XG4gIHJldHVybiBOdW1iZXIoZGF0YT8uc2VydmVyVGltZSA/PyBEYXRlLm5vdygpKTtcbn1cblxudHlwZSBSZXF1ZXN0UmVzdWx0ID1cbiAgfCB7IG9rOiB0cnVlOyBib2R5OiBSYXdBY2NvdW50IH1cbiAgfCB7IG9rOiBmYWxzZTsgc3RhdHVzOiBudW1iZXI7IGVycm9yOiBzdHJpbmc7IGNvZGU/OiBudW1iZXIgfTtcblxuYXN5bmMgZnVuY3Rpb24gcmVxdWVzdEFjY291bnQoXG4gIGFwaUtleTogc3RyaW5nLFxuICBhcGlTZWNyZXQ6IHN0cmluZyxcbiAgc2tld01zID0gMCxcbik6IFByb21pc2U8UmVxdWVzdFJlc3VsdD4ge1xuICBjb25zdCB0aW1lc3RhbXAgPSBEYXRlLm5vdygpICsgc2tld01zO1xuICBjb25zdCBxdWVyeSA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoeyB0aW1lc3RhbXA6IFN0cmluZyh0aW1lc3RhbXApIH0pLnRvU3RyaW5nKCk7XG4gIGNvbnN0IHNpZ25hdHVyZSA9IGNyeXB0by5jcmVhdGVIbWFjKFwic2hhMjU2XCIsIGFwaVNlY3JldCkudXBkYXRlKHF1ZXJ5KS5kaWdlc3QoXCJoZXhcIik7XG5cbiAgY29uc3QgdXJsID0gYGh0dHBzOi8vYXBpLmJpbmFuY2UuY29tL2FwaS92My9hY2NvdW50PyR7cXVlcnl9JnNpZ25hdHVyZT0ke3NpZ25hdHVyZX1gO1xuICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaCh1cmwsIHtcbiAgICBoZWFkZXJzOiB7IFwiWC1NQlgtQVBJS0VZXCI6IGFwaUtleSB9LFxuICAgIGNhY2hlOiBcIm5vLXN0b3JlXCIsXG4gIH0pO1xuXG4gIGNvbnN0IHRleHQgPSBhd2FpdCByZXMudGV4dCgpO1xuICBsZXQganNvbjogYW55O1xuICB0cnkge1xuICAgIGpzb24gPSB0ZXh0ID8gSlNPTi5wYXJzZSh0ZXh0KSA6IHVuZGVmaW5lZDtcbiAgfSBjYXRjaCB7XG4gICAganNvbiA9IHVuZGVmaW5lZDtcbiAgfVxuXG4gIGlmICghcmVzLm9rKSB7XG4gICAgY29uc3QgbWVzc2FnZSA9XG4gICAgICAoanNvbiAmJiB0eXBlb2YganNvbiA9PT0gXCJvYmplY3RcIiA/IGpzb24ubXNnIDogdW5kZWZpbmVkKSB8fFxuICAgICAgdGV4dCB8fFxuICAgICAgYEhUVFAgJHtyZXMuc3RhdHVzfWA7XG4gICAgcmV0dXJuIHtcbiAgICAgIG9rOiBmYWxzZSxcbiAgICAgIHN0YXR1czogcmVzLnN0YXR1cyxcbiAgICAgIGVycm9yOiBtZXNzYWdlLFxuICAgICAgY29kZTogdHlwZW9mIGpzb24/LmNvZGUgPT09IFwibnVtYmVyXCIgPyBqc29uLmNvZGUgOiB1bmRlZmluZWQsXG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgb2s6IHRydWUsXG4gICAgYm9keTogKGpzb24gJiYgdHlwZW9mIGpzb24gPT09IFwib2JqZWN0XCIgPyAoanNvbiBhcyBSYXdBY2NvdW50KSA6IHt9KSA/PyB7fSxcbiAgfTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHZlcmlmeUJpbmFuY2VBY2NvdW50KFxuICBhcGlLZXk6IHN0cmluZyxcbiAgYXBpU2VjcmV0OiBzdHJpbmcsXG4pOiBQcm9taXNlPFZlcmlmeVJlc3BvbnNlPiB7XG4gIHRyeSB7XG4gICAgbGV0IGF0dGVtcHQgPSBhd2FpdCByZXF1ZXN0QWNjb3VudChhcGlLZXksIGFwaVNlY3JldCk7XG5cbiAgICBpZiAoIWF0dGVtcHQub2sgJiYgKGF0dGVtcHQuY29kZSA9PT0gLTEwMjEgfHwgL3RpbWVzdGFtcC9pLnRlc3QoYXR0ZW1wdC5lcnJvcikpKSB7XG4gICAgICBjb25zdCBzZXJ2ZXJUaW1lID0gYXdhaXQgZmV0Y2hTZXJ2ZXJUaW1lKCk7XG4gICAgICBjb25zdCBza2V3ID0gc2VydmVyVGltZSAtIERhdGUubm93KCk7XG4gICAgICBhdHRlbXB0ID0gYXdhaXQgcmVxdWVzdEFjY291bnQoYXBpS2V5LCBhcGlTZWNyZXQsIHNrZXcpO1xuICAgIH1cblxuICAgIGlmICghYXR0ZW1wdC5vaykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgb2s6IGZhbHNlLFxuICAgICAgICBzdGF0dXM6IGF0dGVtcHQuc3RhdHVzLFxuICAgICAgICBlcnJvcjogYXR0ZW1wdC5lcnJvcixcbiAgICAgIH07XG4gICAgfVxuXG4gICAgY29uc3QgYm9keSA9IGF0dGVtcHQuYm9keTtcbiAgICBjb25zdCBiYWxhbmNlcyA9IEFycmF5LmlzQXJyYXkoYm9keS5iYWxhbmNlcykgPyBib2R5LmJhbGFuY2VzLmxlbmd0aCA6IDA7XG5cbiAgICByZXR1cm4ge1xuICAgICAgb2s6IHRydWUsXG4gICAgICBhY2NvdW50VHlwZTogdHlwZW9mIGJvZHkuYWNjb3VudFR5cGUgPT09IFwic3RyaW5nXCIgPyBib2R5LmFjY291bnRUeXBlIDogbnVsbCxcbiAgICAgIGNhblRyYWRlOiBCb29sZWFuKGJvZHkuY2FuVHJhZGUpLFxuICAgICAgYmFsYW5jZXNDb3VudDogYmFsYW5jZXMsXG4gICAgICB1cGRhdGVUaW1lOiB0eXBlb2YgYm9keS51cGRhdGVUaW1lID09PSBcIm51bWJlclwiID8gYm9keS51cGRhdGVUaW1lIDogbnVsbCxcbiAgICB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvciA/PyBcIlVuZXhwZWN0ZWQgZXJyb3JcIik7XG4gICAgcmV0dXJuIHsgb2s6IGZhbHNlLCBlcnJvcjogbWVzc2FnZSB9O1xuICB9XG59XG5cclxuIl0sIm5hbWVzIjpbImNyeXB0byIsImZldGNoU2VydmVyVGltZSIsInJlcyIsImZldGNoIiwiY2FjaGUiLCJvayIsIkVycm9yIiwic3RhdHVzIiwiZGF0YSIsImpzb24iLCJOdW1iZXIiLCJzZXJ2ZXJUaW1lIiwiRGF0ZSIsIm5vdyIsInJlcXVlc3RBY2NvdW50IiwiYXBpS2V5IiwiYXBpU2VjcmV0Iiwic2tld01zIiwidGltZXN0YW1wIiwicXVlcnkiLCJVUkxTZWFyY2hQYXJhbXMiLCJTdHJpbmciLCJ0b1N0cmluZyIsInNpZ25hdHVyZSIsImNyZWF0ZUhtYWMiLCJ1cGRhdGUiLCJkaWdlc3QiLCJ1cmwiLCJoZWFkZXJzIiwidGV4dCIsIkpTT04iLCJwYXJzZSIsInVuZGVmaW5lZCIsIm1lc3NhZ2UiLCJtc2ciLCJlcnJvciIsImNvZGUiLCJib2R5IiwidmVyaWZ5QmluYW5jZUFjY291bnQiLCJhdHRlbXB0IiwidGVzdCIsInNrZXciLCJiYWxhbmNlcyIsIkFycmF5IiwiaXNBcnJheSIsImxlbmd0aCIsImFjY291bnRUeXBlIiwiY2FuVHJhZGUiLCJCb29sZWFuIiwiYmFsYW5jZXNDb3VudCIsInVwZGF0ZVRpbWUiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/market/providers/binance/account/test/verify.ts\n");

/***/ }),

/***/ "(rsc)/./src/app/api/settings/wallet/route.ts":
/*!**********************************************!*\
  !*** ./src/app/api/settings/wallet/route.ts ***!
  \**********************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DELETE: () => (/* binding */ DELETE),\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   dynamic: () => (/* binding */ dynamic),\n/* harmony export */   revalidate: () => (/* binding */ revalidate)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/api/server.js\");\n/* harmony import */ var _app_api_market_providers_binance_account_test_verify__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/app/api/market/providers/binance/account/test/verify */ \"(rsc)/./src/app/api/market/providers/binance/account/test/verify.ts\");\n/* harmony import */ var _core_sources_binanceAccount__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/core/sources/binanceAccount */ \"(rsc)/./src/core/sources/binanceAccount.ts\");\n/* harmony import */ var _lib_wallet_registry__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/wallet/registry */ \"(rsc)/./src/lib/wallet/registry.ts\");\n/* harmony import */ var _lib_auth_server__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/auth/server */ \"(rsc)/./src/lib/auth/server.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_lib_auth_server__WEBPACK_IMPORTED_MODULE_4__]);\n_lib_auth_server__WEBPACK_IMPORTED_MODULE_4__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\nconst dynamic = \"force-dynamic\";\nconst revalidate = 0;\nasync function readSessionEmail() {\n    const user = await (0,_lib_auth_server__WEBPACK_IMPORTED_MODULE_4__.getCurrentUser)();\n    return user?.email?.toLowerCase() ?? null;\n}\nasync function GET() {\n    const email = await readSessionEmail();\n    if (!email) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            ok: false,\n            error: \"Not signed in\"\n        }, {\n            status: 401\n        });\n    }\n    const wallet = (0,_lib_wallet_registry__WEBPACK_IMPORTED_MODULE_3__.getWallet)(email);\n    if (!wallet) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            ok: true,\n            email,\n            linked: false\n        }, {\n            headers: {\n                \"Cache-Control\": \"no-store\"\n            }\n        });\n    }\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        ok: true,\n        email,\n        linked: true,\n        keyId: wallet.apiKey,\n        keyHint: (0,_lib_wallet_registry__WEBPACK_IMPORTED_MODULE_3__.maskKey)(wallet.apiKey),\n        linkedAt: new Date(wallet.linkedAt).toISOString()\n    }, {\n        headers: {\n            \"Cache-Control\": \"no-store\"\n        }\n    });\n}\nasync function POST(req) {\n    const email = await readSessionEmail();\n    if (!email) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            ok: false,\n            error: \"Not signed in\"\n        }, {\n            status: 401\n        });\n    }\n    const { apiKey, apiSecret } = await req.json();\n    if (!apiKey || !apiSecret) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            ok: false,\n            error: \"Missing apiKey or apiSecret\"\n        }, {\n            status: 400\n        });\n    }\n    const result = await (0,_app_api_market_providers_binance_account_test_verify__WEBPACK_IMPORTED_MODULE_1__.verifyBinanceAccount)(apiKey, apiSecret);\n    if (!result.ok) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            ok: false,\n            error: result.error ?? \"Verification failed\",\n            status: result.status ?? 0\n        }, {\n            status: 200\n        });\n    }\n    const record = (0,_lib_wallet_registry__WEBPACK_IMPORTED_MODULE_3__.setWallet)(email, {\n        apiKey,\n        apiSecret,\n        linkedAt: Date.now()\n    });\n    (0,_core_sources_binanceAccount__WEBPACK_IMPORTED_MODULE_2__.clearWalletCache)(email);\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        ok: true,\n        email,\n        linked: true,\n        keyId: record.apiKey,\n        keyHint: (0,_lib_wallet_registry__WEBPACK_IMPORTED_MODULE_3__.maskKey)(record.apiKey),\n        linkedAt: new Date(record.linkedAt).toISOString(),\n        account: {\n            accountType: result.accountType ?? null,\n            canTrade: result.canTrade ?? false,\n            balancesCount: result.balancesCount ?? 0,\n            updateTime: result.updateTime ?? null\n        }\n    }, {\n        headers: {\n            \"Cache-Control\": \"no-store\"\n        }\n    });\n}\nasync function DELETE() {\n    const email = await readSessionEmail();\n    if (!email) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            ok: false,\n            error: \"Not signed in\"\n        }, {\n            status: 401\n        });\n    }\n    (0,_lib_wallet_registry__WEBPACK_IMPORTED_MODULE_3__.deleteWallet)(email);\n    (0,_core_sources_binanceAccount__WEBPACK_IMPORTED_MODULE_2__.clearWalletCache)(email);\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        ok: true,\n        email,\n        linked: false\n    }, {\n        headers: {\n            \"Cache-Control\": \"no-store\"\n        }\n    });\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9zZXR0aW5ncy93YWxsZXQvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7OztBQUEyQztBQUNtRDtBQUM3QjtBQUNtQjtBQUNqQztBQUU1QyxNQUFNUSxVQUFVLGdCQUFnQjtBQUNoQyxNQUFNQyxhQUFhLEVBQUU7QUFFNUIsZUFBZUM7SUFDYixNQUFNQyxPQUFPLE1BQU1KLGdFQUFjQTtJQUNqQyxPQUFPSSxNQUFNQyxPQUFPQyxpQkFBaUI7QUFDdkM7QUFFTyxlQUFlQztJQUNwQixNQUFNRixRQUFRLE1BQU1GO0lBQ3BCLElBQUksQ0FBQ0UsT0FBTztRQUNWLE9BQU9aLHFEQUFZQSxDQUFDZSxJQUFJLENBQUM7WUFBRUMsSUFBSTtZQUFPQyxPQUFPO1FBQWdCLEdBQUc7WUFBRUMsUUFBUTtRQUFJO0lBQ2hGO0lBRUEsTUFBTUMsU0FBU2YsK0RBQVNBLENBQUNRO0lBQ3pCLElBQUksQ0FBQ08sUUFBUTtRQUNYLE9BQU9uQixxREFBWUEsQ0FBQ2UsSUFBSSxDQUFDO1lBQUVDLElBQUk7WUFBTUo7WUFBT1EsUUFBUTtRQUFNLEdBQUc7WUFBRUMsU0FBUztnQkFBRSxpQkFBaUI7WUFBVztRQUFFO0lBQzFHO0lBRUEsT0FBT3JCLHFEQUFZQSxDQUFDZSxJQUFJLENBQ3RCO1FBQ0VDLElBQUk7UUFDSko7UUFDQVEsUUFBUTtRQUNSRSxPQUFPSCxPQUFPSSxNQUFNO1FBQ3BCQyxTQUFTbkIsNkRBQU9BLENBQUNjLE9BQU9JLE1BQU07UUFDOUJFLFVBQVUsSUFBSUMsS0FBS1AsT0FBT00sUUFBUSxFQUFFRSxXQUFXO0lBQ2pELEdBQ0E7UUFBRU4sU0FBUztZQUFFLGlCQUFpQjtRQUFXO0lBQUU7QUFFL0M7QUFJTyxlQUFlTyxLQUFLQyxHQUFZO0lBQ3JDLE1BQU1qQixRQUFRLE1BQU1GO0lBQ3BCLElBQUksQ0FBQ0UsT0FBTztRQUNWLE9BQU9aLHFEQUFZQSxDQUFDZSxJQUFJLENBQUM7WUFBRUMsSUFBSTtZQUFPQyxPQUFPO1FBQWdCLEdBQUc7WUFBRUMsUUFBUTtRQUFJO0lBQ2hGO0lBRUEsTUFBTSxFQUFFSyxNQUFNLEVBQUVPLFNBQVMsRUFBRSxHQUFJLE1BQU1ELElBQUlkLElBQUk7SUFDN0MsSUFBSSxDQUFDUSxVQUFVLENBQUNPLFdBQVc7UUFDekIsT0FBTzlCLHFEQUFZQSxDQUFDZSxJQUFJLENBQUM7WUFBRUMsSUFBSTtZQUFPQyxPQUFPO1FBQThCLEdBQUc7WUFBRUMsUUFBUTtRQUFJO0lBQzlGO0lBRUEsTUFBTWEsU0FBUyxNQUFNOUIsMkdBQW9CQSxDQUFDc0IsUUFBUU87SUFDbEQsSUFBSSxDQUFDQyxPQUFPZixFQUFFLEVBQUU7UUFDZCxPQUFPaEIscURBQVlBLENBQUNlLElBQUksQ0FDdEI7WUFBRUMsSUFBSTtZQUFPQyxPQUFPYyxPQUFPZCxLQUFLLElBQUk7WUFBdUJDLFFBQVFhLE9BQU9iLE1BQU0sSUFBSTtRQUFFLEdBQ3RGO1lBQUVBLFFBQVE7UUFBSTtJQUVsQjtJQUVBLE1BQU1jLFNBQVMxQiwrREFBU0EsQ0FBQ00sT0FBTztRQUFFVztRQUFRTztRQUFXTCxVQUFVQyxLQUFLTyxHQUFHO0lBQUc7SUFDMUUvQiw4RUFBZ0JBLENBQUNVO0lBRWpCLE9BQU9aLHFEQUFZQSxDQUFDZSxJQUFJLENBQ3RCO1FBQ0VDLElBQUk7UUFDSko7UUFDQVEsUUFBUTtRQUNSRSxPQUFPVSxPQUFPVCxNQUFNO1FBQ3BCQyxTQUFTbkIsNkRBQU9BLENBQUMyQixPQUFPVCxNQUFNO1FBQzlCRSxVQUFVLElBQUlDLEtBQUtNLE9BQU9QLFFBQVEsRUFBRUUsV0FBVztRQUMvQ08sU0FBUztZQUNQQyxhQUFhSixPQUFPSSxXQUFXLElBQUk7WUFDbkNDLFVBQVVMLE9BQU9LLFFBQVEsSUFBSTtZQUM3QkMsZUFBZU4sT0FBT00sYUFBYSxJQUFJO1lBQ3ZDQyxZQUFZUCxPQUFPTyxVQUFVLElBQUk7UUFDbkM7SUFDRixHQUNBO1FBQUVqQixTQUFTO1lBQUUsaUJBQWlCO1FBQVc7SUFBRTtBQUUvQztBQUVPLGVBQWVrQjtJQUNwQixNQUFNM0IsUUFBUSxNQUFNRjtJQUNwQixJQUFJLENBQUNFLE9BQU87UUFDVixPQUFPWixxREFBWUEsQ0FBQ2UsSUFBSSxDQUFDO1lBQUVDLElBQUk7WUFBT0MsT0FBTztRQUFnQixHQUFHO1lBQUVDLFFBQVE7UUFBSTtJQUNoRjtJQUVBZixrRUFBWUEsQ0FBQ1M7SUFDYlYsOEVBQWdCQSxDQUFDVTtJQUVqQixPQUFPWixxREFBWUEsQ0FBQ2UsSUFBSSxDQUFDO1FBQUVDLElBQUk7UUFBTUo7UUFBT1EsUUFBUTtJQUFNLEdBQUc7UUFBRUMsU0FBUztZQUFFLGlCQUFpQjtRQUFXO0lBQUU7QUFDMUciLCJzb3VyY2VzIjpbIkg6XFxVc2Vyc1xcR3VzXFxzb3VyY2VcXHJlcG9cXGR5bmFtaWNzXFxkeW5hbWljcy1iXFxjcnlwdG9waS1keW5hbWljc1xcc3JjXFxhcHBcXGFwaVxcc2V0dGluZ3NcXHdhbGxldFxccm91dGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvc2VydmVyXCI7XHJcbmltcG9ydCB7IHZlcmlmeUJpbmFuY2VBY2NvdW50IH0gZnJvbSBcIkAvYXBwL2FwaS9tYXJrZXQvcHJvdmlkZXJzL2JpbmFuY2UvYWNjb3VudC90ZXN0L3ZlcmlmeVwiO1xuaW1wb3J0IHsgY2xlYXJXYWxsZXRDYWNoZSB9IGZyb20gXCJAL2NvcmUvc291cmNlcy9iaW5hbmNlQWNjb3VudFwiO1xuaW1wb3J0IHsgZGVsZXRlV2FsbGV0LCBnZXRXYWxsZXQsIG1hc2tLZXksIHNldFdhbGxldCB9IGZyb20gXCJAL2xpYi93YWxsZXQvcmVnaXN0cnlcIjtcbmltcG9ydCB7IGdldEN1cnJlbnRVc2VyIH0gZnJvbSBcIkAvbGliL2F1dGgvc2VydmVyXCI7XG5cclxuZXhwb3J0IGNvbnN0IGR5bmFtaWMgPSBcImZvcmNlLWR5bmFtaWNcIjtcclxuZXhwb3J0IGNvbnN0IHJldmFsaWRhdGUgPSAwO1xyXG5cclxuYXN5bmMgZnVuY3Rpb24gcmVhZFNlc3Npb25FbWFpbCgpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgY29uc3QgdXNlciA9IGF3YWl0IGdldEN1cnJlbnRVc2VyKCk7XG4gIHJldHVybiB1c2VyPy5lbWFpbD8udG9Mb3dlckNhc2UoKSA/PyBudWxsO1xufVxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQoKSB7XHJcbiAgY29uc3QgZW1haWwgPSBhd2FpdCByZWFkU2Vzc2lvbkVtYWlsKCk7XHJcbiAgaWYgKCFlbWFpbCkge1xyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgb2s6IGZhbHNlLCBlcnJvcjogXCJOb3Qgc2lnbmVkIGluXCIgfSwgeyBzdGF0dXM6IDQwMSB9KTtcclxuICB9XHJcblxyXG4gIGNvbnN0IHdhbGxldCA9IGdldFdhbGxldChlbWFpbCk7XHJcbiAgaWYgKCF3YWxsZXQpIHtcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IG9rOiB0cnVlLCBlbWFpbCwgbGlua2VkOiBmYWxzZSB9LCB7IGhlYWRlcnM6IHsgXCJDYWNoZS1Db250cm9sXCI6IFwibm8tc3RvcmVcIiB9IH0pO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAge1xyXG4gICAgICBvazogdHJ1ZSxcclxuICAgICAgZW1haWwsXHJcbiAgICAgIGxpbmtlZDogdHJ1ZSxcclxuICAgICAga2V5SWQ6IHdhbGxldC5hcGlLZXksXHJcbiAgICAgIGtleUhpbnQ6IG1hc2tLZXkod2FsbGV0LmFwaUtleSksXHJcbiAgICAgIGxpbmtlZEF0OiBuZXcgRGF0ZSh3YWxsZXQubGlua2VkQXQpLnRvSVNPU3RyaW5nKCksXHJcbiAgICB9LFxyXG4gICAgeyBoZWFkZXJzOiB7IFwiQ2FjaGUtQ29udHJvbFwiOiBcIm5vLXN0b3JlXCIgfSB9XHJcbiAgKTtcclxufVxyXG5cclxudHlwZSBXYWxsZXRQYXlsb2FkID0geyBhcGlLZXk/OiBzdHJpbmc7IGFwaVNlY3JldD86IHN0cmluZyB9O1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxOiBSZXF1ZXN0KSB7XHJcbiAgY29uc3QgZW1haWwgPSBhd2FpdCByZWFkU2Vzc2lvbkVtYWlsKCk7XHJcbiAgaWYgKCFlbWFpbCkge1xyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgb2s6IGZhbHNlLCBlcnJvcjogXCJOb3Qgc2lnbmVkIGluXCIgfSwgeyBzdGF0dXM6IDQwMSB9KTtcclxuICB9XHJcblxyXG4gIGNvbnN0IHsgYXBpS2V5LCBhcGlTZWNyZXQgfSA9IChhd2FpdCByZXEuanNvbigpKSBhcyBXYWxsZXRQYXlsb2FkO1xyXG4gIGlmICghYXBpS2V5IHx8ICFhcGlTZWNyZXQpIHtcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IG9rOiBmYWxzZSwgZXJyb3I6IFwiTWlzc2luZyBhcGlLZXkgb3IgYXBpU2VjcmV0XCIgfSwgeyBzdGF0dXM6IDQwMCB9KTtcclxuICB9XHJcblxyXG4gIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHZlcmlmeUJpbmFuY2VBY2NvdW50KGFwaUtleSwgYXBpU2VjcmV0KTtcclxuICBpZiAoIXJlc3VsdC5vaykge1xyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICB7IG9rOiBmYWxzZSwgZXJyb3I6IHJlc3VsdC5lcnJvciA/PyBcIlZlcmlmaWNhdGlvbiBmYWlsZWRcIiwgc3RhdHVzOiByZXN1bHQuc3RhdHVzID8/IDAgfSxcclxuICAgICAgeyBzdGF0dXM6IDIwMCB9XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgcmVjb3JkID0gc2V0V2FsbGV0KGVtYWlsLCB7IGFwaUtleSwgYXBpU2VjcmV0LCBsaW5rZWRBdDogRGF0ZS5ub3coKSB9KTtcclxuICBjbGVhcldhbGxldENhY2hlKGVtYWlsKTtcclxuXHJcbiAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAge1xyXG4gICAgICBvazogdHJ1ZSxcclxuICAgICAgZW1haWwsXHJcbiAgICAgIGxpbmtlZDogdHJ1ZSxcclxuICAgICAga2V5SWQ6IHJlY29yZC5hcGlLZXksXHJcbiAgICAgIGtleUhpbnQ6IG1hc2tLZXkocmVjb3JkLmFwaUtleSksXHJcbiAgICAgIGxpbmtlZEF0OiBuZXcgRGF0ZShyZWNvcmQubGlua2VkQXQpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgIGFjY291bnQ6IHtcclxuICAgICAgICBhY2NvdW50VHlwZTogcmVzdWx0LmFjY291bnRUeXBlID8/IG51bGwsXHJcbiAgICAgICAgY2FuVHJhZGU6IHJlc3VsdC5jYW5UcmFkZSA/PyBmYWxzZSxcclxuICAgICAgICBiYWxhbmNlc0NvdW50OiByZXN1bHQuYmFsYW5jZXNDb3VudCA/PyAwLFxyXG4gICAgICAgIHVwZGF0ZVRpbWU6IHJlc3VsdC51cGRhdGVUaW1lID8/IG51bGwsXHJcbiAgICAgIH0sXHJcbiAgICB9LFxyXG4gICAgeyBoZWFkZXJzOiB7IFwiQ2FjaGUtQ29udHJvbFwiOiBcIm5vLXN0b3JlXCIgfSB9XHJcbiAgKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIERFTEVURSgpIHtcclxuICBjb25zdCBlbWFpbCA9IGF3YWl0IHJlYWRTZXNzaW9uRW1haWwoKTtcclxuICBpZiAoIWVtYWlsKSB7XHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBvazogZmFsc2UsIGVycm9yOiBcIk5vdCBzaWduZWQgaW5cIiB9LCB7IHN0YXR1czogNDAxIH0pO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlV2FsbGV0KGVtYWlsKTtcclxuICBjbGVhcldhbGxldENhY2hlKGVtYWlsKTtcclxuXHJcbiAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgb2s6IHRydWUsIGVtYWlsLCBsaW5rZWQ6IGZhbHNlIH0sIHsgaGVhZGVyczogeyBcIkNhY2hlLUNvbnRyb2xcIjogXCJuby1zdG9yZVwiIH0gfSk7XHJcbn1cclxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsInZlcmlmeUJpbmFuY2VBY2NvdW50IiwiY2xlYXJXYWxsZXRDYWNoZSIsImRlbGV0ZVdhbGxldCIsImdldFdhbGxldCIsIm1hc2tLZXkiLCJzZXRXYWxsZXQiLCJnZXRDdXJyZW50VXNlciIsImR5bmFtaWMiLCJyZXZhbGlkYXRlIiwicmVhZFNlc3Npb25FbWFpbCIsInVzZXIiLCJlbWFpbCIsInRvTG93ZXJDYXNlIiwiR0VUIiwianNvbiIsIm9rIiwiZXJyb3IiLCJzdGF0dXMiLCJ3YWxsZXQiLCJsaW5rZWQiLCJoZWFkZXJzIiwia2V5SWQiLCJhcGlLZXkiLCJrZXlIaW50IiwibGlua2VkQXQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJQT1NUIiwicmVxIiwiYXBpU2VjcmV0IiwicmVzdWx0IiwicmVjb3JkIiwibm93IiwiYWNjb3VudCIsImFjY291bnRUeXBlIiwiY2FuVHJhZGUiLCJiYWxhbmNlc0NvdW50IiwidXBkYXRlVGltZSIsIkRFTEVURSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/settings/wallet/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/core/db/index.ts":
/*!******************************!*\
  !*** ./src/core/db/index.ts ***!
  \******************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   appendAppLedger: () => (/* binding */ appendAppLedger),\n/* harmony export */   createAppSession: () => (/* binding */ createAppSession),\n/* harmony export */   currentAppSession: () => (/* binding */ currentAppSession),\n/* harmony export */   db: () => (/* binding */ db),\n/* harmony export */   getOpening: () => (/* binding */ getOpening),\n/* harmony export */   getPool: () => (/* binding */ getPool),\n/* harmony export */   query: () => (/* binding */ query),\n/* harmony export */   sessionKV: () => (/* binding */ sessionKV),\n/* harmony export */   useAppSession: () => (/* binding */ useAppSession),\n/* harmony export */   withClient: () => (/* binding */ withClient)\n/* harmony export */ });\n/* harmony import */ var pg__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pg */ \"pg\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_3__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([pg__WEBPACK_IMPORTED_MODULE_0__]);\npg__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n// Unified Postgres access layer (connection + helpers + ledgers + openings + sessions)\n\n\n\n\n/*  Pool setup  */ function asBool(v, def = false) {\n    if (v == null) return def;\n    const s = String(v).trim().toLowerCase();\n    return s === \"1\" || s === \"true\" || s === \"yes\" || s === \"on\";\n}\nconst useUrl = !!process.env.DATABASE_URL;\nconst base = useUrl ? {\n    connectionString: String(process.env.DATABASE_URL)\n} : {\n    host: String(process.env.PGHOST ?? \"localhost\"),\n    port: Number(process.env.PGPORT ?? 5432),\n    user: String(process.env.PGUSER ?? \"\"),\n    password: String(process.env.PGPASSWORD ?? \"\"),\n    database: String(process.env.PGDATABASE ?? \"\")\n};\nconst poolConfig = {\n    ...base,\n    max: Number(process.env.DB_POOL_MAX ?? 10),\n    idleTimeoutMillis: Number(process.env.DB_IDLE_MS ?? 45000),\n    connectionTimeoutMillis: Number(process.env.DB_CONN_TIMEOUT_MS ?? 5000),\n    ssl: asBool(process.env.DB_SSL) ? {\n        rejectUnauthorized: false\n    } : undefined\n};\nfunction getPool() {\n    if (!global.__core_pg_pool__) {\n        global.__core_pg_pool__ = new pg__WEBPACK_IMPORTED_MODULE_0__.Pool(poolConfig);\n    }\n    return global.__core_pg_pool__;\n}\nconst db = getPool();\n/** Convenience wrappers */ async function withClient(fn) {\n    const c = await db.connect();\n    try {\n        return await fn(c);\n    } finally{\n        c.release();\n    }\n}\nasync function query(text, params) {\n    return db.query(text, params);\n}\nasync function appendAppLedger(e) {\n    await db.query(`INSERT INTO app_ledger (topic,event,payload,session_id,idempotency_key,ts_epoch_ms)\n     VALUES ($1,$2,$3,$4,$5,$6)\n     ON CONFLICT (idempotency_key) DO NOTHING`, [\n        e.topic,\n        e.event,\n        e.payload ?? null,\n        e.session_id ?? null,\n        e.idempotency_key ?? null,\n        e.ts_epoch_ms\n    ]);\n}\n/*  Opening helpers  */ const openingCache = new Map();\nconst keyStr = (b, q, w, sid)=>`${b}:${q}:${w}:${sid}`;\nasync function getOpening(base, quote = \"USDT\", window = \"1h\", appSessionId = \"global\") {\n    const ck = keyStr(base, quote, window, appSessionId);\n    const hit = openingCache.get(ck);\n    if (hit) return hit;\n    const q = `\n    SELECT opening_ts AS ts, opening_price AS price\n      FROM strategy_aux.str_aux_session\n     WHERE pair_base=$1 AND pair_quote=$2 AND window_key=$3\n       AND ($4::text IS NULL OR app_session_id=$4)\n       AND opening_stamp=TRUE\n  ORDER BY opening_ts DESC LIMIT 1\n  `;\n    const { rows } = await db.query(q, [\n        base,\n        quote,\n        window,\n        appSessionId\n    ]);\n    if (rows.length) {\n        const val = {\n            price: Number(rows[0].price),\n            ts: Number(rows[0].ts)\n        };\n        openingCache.set(ck, val);\n        return val;\n    }\n    return null;\n}\n/*  Sessions  */ const SESSION_FILE = (0,path__WEBPACK_IMPORTED_MODULE_3__.resolve)(process.cwd(), \"var\", \"current-session.json\");\nfunction ensureDir() {\n    (0,fs__WEBPACK_IMPORTED_MODULE_2__.mkdirSync)((0,path__WEBPACK_IMPORTED_MODULE_3__.dirname)(SESSION_FILE), {\n        recursive: true\n    });\n}\nfunction newSessionId() {\n    return `sess_${Date.now()}_${(0,crypto__WEBPACK_IMPORTED_MODULE_1__.randomBytes)(4).toString(\"hex\")}`;\n}\nasync function createAppSession(id) {\n    const sid = id ?? newSessionId();\n    await db.query(`INSERT INTO app_sessions (app_session_id) VALUES ($1)\n     ON CONFLICT (app_session_id) DO NOTHING`, [\n        sid\n    ]);\n    return sid;\n}\nfunction useAppSession(id) {\n    ensureDir();\n    (0,fs__WEBPACK_IMPORTED_MODULE_2__.writeFileSync)(SESSION_FILE, JSON.stringify({\n        id\n    }, null, 2), \"utf8\");\n}\nfunction currentAppSession() {\n    if (process.env.APP_SESSION_ID) return String(process.env.APP_SESSION_ID);\n    if (!(0,fs__WEBPACK_IMPORTED_MODULE_2__.existsSync)(SESSION_FILE)) return null;\n    try {\n        const j = JSON.parse((0,fs__WEBPACK_IMPORTED_MODULE_2__.readFileSync)(SESSION_FILE, \"utf8\"));\n        return typeof j?.id === \"string\" ? j.id : null;\n    } catch  {\n        return null;\n    }\n}\n/*  Ephemeral Session KV  */ class SessionKV {\n    set(ns, key, v, ttlMs) {\n        const k = `${ns}:${key}`;\n        this.s.set(k, {\n            v,\n            exp: ttlMs ? Date.now() + ttlMs : undefined\n        });\n    }\n    get(ns, key) {\n        const k = `${ns}:${key}`;\n        const e = this.s.get(k);\n        if (!e) return;\n        if (e.exp && Date.now() > e.exp) {\n            this.s.delete(k);\n            return;\n        }\n        return e.v;\n    }\n    delete(ns, key) {\n        this.s.delete(`${ns}:${key}`);\n    }\n    clear(ns) {\n        if (!ns) return this.s.clear();\n        const p = `${ns}:`;\n        for (const k of Array.from(this.s.keys()))if (k.startsWith(p)) this.s.delete(k);\n    }\n    constructor(){\n        this.s = new Map();\n    }\n}\nconst sessionKV = new SessionKV();\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFDMUYsQ0FBQyxDQUFDZ0csS0FBSztRQUM1QixNQUFNQyxJQUFJLEdBQUdQLEdBQUcsQ0FBQyxDQUFDO1FBQ2xCLEtBQUssTUFBTUcsS0FBS0ssTUFBTUMsSUFBSSxDQUFDLElBQUksQ0FBQ25HLENBQUMsQ0FBQ29HLElBQUksSUFBSyxJQUFJUCxFQUFFUSxVQUFVLENBQUNKLElBQUksSUFBSSxDQUFDakcsQ0FBQyxDQUFDK0YsTUFBTSxDQUFDRjtJQUNoRjs7YUFmUTdGLElBQUksSUFBSXFEOztBQWdCbEI7QUFFTyxNQUFNaUQsWUFBWSxJQUFJYixZQUFpQiIsInNvdXJjZXMiOlsiSDpcXFVzZXJzXFxHdXNcXHNvdXJjZVxccmVwb1xcZHluYW1pY3NcXGR5bmFtaWNzLWJcXGNyeXB0b3BpLWR5bmFtaWNzXFxzcmNcXGNvcmVcXGRiXFxpbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBVbmlmaWVkIFBvc3RncmVzIGFjY2VzcyBsYXllciAoY29ubmVjdGlvbiArIGhlbHBlcnMgKyBsZWRnZXJzICsgb3BlbmluZ3MgKyBzZXNzaW9ucylcblxuaW1wb3J0IHsgUG9vbCwgdHlwZSBQb29sQ2xpZW50LCB0eXBlIFF1ZXJ5UmVzdWx0IH0gZnJvbSBcInBnXCI7XG5pbXBvcnQgeyByYW5kb21CeXRlcyB9IGZyb20gXCJjcnlwdG9cIjtcbmltcG9ydCB7IG1rZGlyU3luYywgZXhpc3RzU3luYywgcmVhZEZpbGVTeW5jLCB3cml0ZUZpbGVTeW5jIH0gZnJvbSBcImZzXCI7XG5pbXBvcnQgeyByZXNvbHZlLCBkaXJuYW1lIH0gZnJvbSBcInBhdGhcIjtcblxuLyog4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAIFBvb2wgc2V0dXAg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAICovXG5cbmZ1bmN0aW9uIGFzQm9vbCh2OiBhbnksIGRlZiA9IGZhbHNlKSB7XG4gIGlmICh2ID09IG51bGwpIHJldHVybiBkZWY7XG4gIGNvbnN0IHMgPSBTdHJpbmcodikudHJpbSgpLnRvTG93ZXJDYXNlKCk7XG4gIHJldHVybiBzID09PSBcIjFcIiB8fCBzID09PSBcInRydWVcIiB8fCBzID09PSBcInllc1wiIHx8IHMgPT09IFwib25cIjtcbn1cblxuY29uc3QgdXNlVXJsID0gISFwcm9jZXNzLmVudi5EQVRBQkFTRV9VUkw7XG5jb25zdCBiYXNlID0gdXNlVXJsXG4gID8geyBjb25uZWN0aW9uU3RyaW5nOiBTdHJpbmcocHJvY2Vzcy5lbnYuREFUQUJBU0VfVVJMKSB9XG4gIDoge1xuICAgICAgaG9zdDogU3RyaW5nKHByb2Nlc3MuZW52LlBHSE9TVCA/PyBcImxvY2FsaG9zdFwiKSxcbiAgICAgIHBvcnQ6IE51bWJlcihwcm9jZXNzLmVudi5QR1BPUlQgPz8gNTQzMiksXG4gICAgICB1c2VyOiBTdHJpbmcocHJvY2Vzcy5lbnYuUEdVU0VSID8/IFwiXCIpLFxuICAgICAgcGFzc3dvcmQ6IFN0cmluZyhwcm9jZXNzLmVudi5QR1BBU1NXT1JEID8/IFwiXCIpLFxuICAgICAgZGF0YWJhc2U6IFN0cmluZyhwcm9jZXNzLmVudi5QR0RBVEFCQVNFID8/IFwiXCIpLFxuICAgIH07XG5cbmNvbnN0IHBvb2xDb25maWcgPSB7XG4gIC4uLmJhc2UsXG4gIG1heDogTnVtYmVyKHByb2Nlc3MuZW52LkRCX1BPT0xfTUFYID8/IDEwKSxcbiAgaWRsZVRpbWVvdXRNaWxsaXM6IE51bWJlcihwcm9jZXNzLmVudi5EQl9JRExFX01TID8/IDQ1XzAwMCksXG4gIGNvbm5lY3Rpb25UaW1lb3V0TWlsbGlzOiBOdW1iZXIocHJvY2Vzcy5lbnYuREJfQ09OTl9USU1FT1VUX01TID8/IDVfMDAwKSxcbiAgc3NsOiBhc0Jvb2wocHJvY2Vzcy5lbnYuREJfU1NMKSA/IHsgcmVqZWN0VW5hdXRob3JpemVkOiBmYWxzZSBhcyBjb25zdCB9IDogdW5kZWZpbmVkLFxufTtcblxuZGVjbGFyZSBnbG9iYWwge1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdmFyXG4gIHZhciBfX2NvcmVfcGdfcG9vbF9fOiBQb29sIHwgdW5kZWZpbmVkO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0UG9vbCgpOiBQb29sIHtcbiAgaWYgKCFnbG9iYWwuX19jb3JlX3BnX3Bvb2xfXykge1xuICAgIGdsb2JhbC5fX2NvcmVfcGdfcG9vbF9fID0gbmV3IFBvb2wocG9vbENvbmZpZyBhcyBhbnkpO1xuICB9XG4gIHJldHVybiBnbG9iYWwuX19jb3JlX3BnX3Bvb2xfXyE7XG59XG5cbmV4cG9ydCBjb25zdCBkYiA9IGdldFBvb2woKTtcblxuLyoqIENvbnZlbmllbmNlIHdyYXBwZXJzICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gd2l0aENsaWVudDxUPihmbjogKGM6IFBvb2xDbGllbnQpID0+IFByb21pc2U8VD4pIHtcbiAgY29uc3QgYyA9IGF3YWl0IGRiLmNvbm5lY3QoKTtcbiAgdHJ5IHsgcmV0dXJuIGF3YWl0IGZuKGMpOyB9IGZpbmFsbHkgeyBjLnJlbGVhc2UoKTsgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcXVlcnk8VCA9IGFueT4odGV4dDogc3RyaW5nLCBwYXJhbXM/OiBhbnlbXSk6IFByb21pc2U8UXVlcnlSZXN1bHQ8VD4+IHtcbiAgcmV0dXJuIGRiLnF1ZXJ5PFQ+KHRleHQsIHBhcmFtcyk7XG59XG5cbi8qIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCBBcHAgTGVkZ2VyIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCAqL1xuZXhwb3J0IHR5cGUgQXBwTGVkZ2VyRXZlbnQgPSB7XG4gIHRvcGljOiBzdHJpbmc7XG4gIGV2ZW50OiBzdHJpbmc7XG4gIHBheWxvYWQ/OiB1bmtub3duO1xuICBzZXNzaW9uX2lkPzogc3RyaW5nO1xuICBpZGVtcG90ZW5jeV9rZXk/OiBzdHJpbmc7XG4gIHRzX2Vwb2NoX21zOiBudW1iZXI7XG59O1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXBwZW5kQXBwTGVkZ2VyKGU6IEFwcExlZGdlckV2ZW50KSB7XG4gIGF3YWl0IGRiLnF1ZXJ5KFxuICAgIGBJTlNFUlQgSU5UTyBhcHBfbGVkZ2VyICh0b3BpYyxldmVudCxwYXlsb2FkLHNlc3Npb25faWQsaWRlbXBvdGVuY3lfa2V5LHRzX2Vwb2NoX21zKVxuICAgICBWQUxVRVMgKCQxLCQyLCQzLCQ0LCQ1LCQ2KVxuICAgICBPTiBDT05GTElDVCAoaWRlbXBvdGVuY3lfa2V5KSBETyBOT1RISU5HYCxcbiAgICBbZS50b3BpYywgZS5ldmVudCwgZS5wYXlsb2FkID8/IG51bGwsIGUuc2Vzc2lvbl9pZCA/PyBudWxsLCBlLmlkZW1wb3RlbmN5X2tleSA/PyBudWxsLCBlLnRzX2Vwb2NoX21zXVxuICApO1xufVxuXG4vKiDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAgT3BlbmluZyBoZWxwZXJzIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCAqL1xuXG5jb25zdCBvcGVuaW5nQ2FjaGUgPSBuZXcgTWFwPHN0cmluZywgeyBwcmljZTogbnVtYmVyOyB0czogbnVtYmVyIH0+KCk7XG5jb25zdCBrZXlTdHIgPSAoYjogc3RyaW5nLCBxOiBzdHJpbmcsIHc6IHN0cmluZywgc2lkOiBzdHJpbmcpID0+IGAke2J9OiR7cX06JHt3fToke3NpZH1gO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0T3BlbmluZyhiYXNlOiBzdHJpbmcsIHF1b3RlID0gXCJVU0RUXCIsIHdpbmRvdyA9IFwiMWhcIiwgYXBwU2Vzc2lvbklkID0gXCJnbG9iYWxcIikge1xuICBjb25zdCBjayA9IGtleVN0cihiYXNlLCBxdW90ZSwgd2luZG93LCBhcHBTZXNzaW9uSWQpO1xuICBjb25zdCBoaXQgPSBvcGVuaW5nQ2FjaGUuZ2V0KGNrKTtcbiAgaWYgKGhpdCkgcmV0dXJuIGhpdDtcblxuICBjb25zdCBxID0gYFxuICAgIFNFTEVDVCBvcGVuaW5nX3RzIEFTIHRzLCBvcGVuaW5nX3ByaWNlIEFTIHByaWNlXG4gICAgICBGUk9NIHN0cmF0ZWd5X2F1eC5zdHJfYXV4X3Nlc3Npb25cbiAgICAgV0hFUkUgcGFpcl9iYXNlPSQxIEFORCBwYWlyX3F1b3RlPSQyIEFORCB3aW5kb3dfa2V5PSQzXG4gICAgICAgQU5EICgkNDo6dGV4dCBJUyBOVUxMIE9SIGFwcF9zZXNzaW9uX2lkPSQ0KVxuICAgICAgIEFORCBvcGVuaW5nX3N0YW1wPVRSVUVcbiAgT1JERVIgQlkgb3BlbmluZ190cyBERVNDIExJTUlUIDFcbiAgYDtcbiAgY29uc3QgeyByb3dzIH0gPSBhd2FpdCBkYi5xdWVyeShxLCBbYmFzZSwgcXVvdGUsIHdpbmRvdywgYXBwU2Vzc2lvbklkXSk7XG4gIGlmIChyb3dzLmxlbmd0aCkge1xuICAgIGNvbnN0IHZhbCA9IHsgcHJpY2U6IE51bWJlcihyb3dzWzBdLnByaWNlKSwgdHM6IE51bWJlcihyb3dzWzBdLnRzKSB9O1xuICAgIG9wZW5pbmdDYWNoZS5zZXQoY2ssIHZhbCk7XG4gICAgcmV0dXJuIHZhbDtcbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuLyog4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAIFNlc3Npb25zIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCAqL1xuXG5jb25zdCBTRVNTSU9OX0ZJTEUgPSByZXNvbHZlKHByb2Nlc3MuY3dkKCksIFwidmFyXCIsIFwiY3VycmVudC1zZXNzaW9uLmpzb25cIik7XG5mdW5jdGlvbiBlbnN1cmVEaXIoKSB7IG1rZGlyU3luYyhkaXJuYW1lKFNFU1NJT05fRklMRSksIHsgcmVjdXJzaXZlOiB0cnVlIH0pOyB9XG5mdW5jdGlvbiBuZXdTZXNzaW9uSWQoKSB7IHJldHVybiBgc2Vzc18ke0RhdGUubm93KCl9XyR7cmFuZG9tQnl0ZXMoNCkudG9TdHJpbmcoXCJoZXhcIil9YDsgfVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlQXBwU2Vzc2lvbihpZD86IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gIGNvbnN0IHNpZCA9IGlkID8/IG5ld1Nlc3Npb25JZCgpO1xuICBhd2FpdCBkYi5xdWVyeShcbiAgICBgSU5TRVJUIElOVE8gYXBwX3Nlc3Npb25zIChhcHBfc2Vzc2lvbl9pZCkgVkFMVUVTICgkMSlcbiAgICAgT04gQ09ORkxJQ1QgKGFwcF9zZXNzaW9uX2lkKSBETyBOT1RISU5HYCxcbiAgICBbc2lkXVxuICApO1xuICByZXR1cm4gc2lkO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdXNlQXBwU2Vzc2lvbihpZDogc3RyaW5nKSB7XG4gIGVuc3VyZURpcigpO1xuICB3cml0ZUZpbGVTeW5jKFNFU1NJT05fRklMRSwgSlNPTi5zdHJpbmdpZnkoeyBpZCB9LCBudWxsLCAyKSwgXCJ1dGY4XCIpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3VycmVudEFwcFNlc3Npb24oKTogc3RyaW5nIHwgbnVsbCB7XG4gIGlmIChwcm9jZXNzLmVudi5BUFBfU0VTU0lPTl9JRCkgcmV0dXJuIFN0cmluZyhwcm9jZXNzLmVudi5BUFBfU0VTU0lPTl9JRCk7XG4gIGlmICghZXhpc3RzU3luYyhTRVNTSU9OX0ZJTEUpKSByZXR1cm4gbnVsbDtcbiAgdHJ5IHtcbiAgICBjb25zdCBqID0gSlNPTi5wYXJzZShyZWFkRmlsZVN5bmMoU0VTU0lPTl9GSUxFLCBcInV0ZjhcIikpO1xuICAgIHJldHVybiB0eXBlb2Ygaj8uaWQgPT09IFwic3RyaW5nXCIgPyBqLmlkIDogbnVsbDtcbiAgfSBjYXRjaCB7IHJldHVybiBudWxsOyB9XG59XG5cbi8qIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCBFcGhlbWVyYWwgU2Vzc2lvbiBLViDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAgKi9cbmNsYXNzIFNlc3Npb25LVjxWID0gdW5rbm93bj4ge1xuICBwcml2YXRlIHMgPSBuZXcgTWFwPHN0cmluZywgeyB2OiBWOyBleHA/OiBudW1iZXIgfT4oKTtcbiAgc2V0KG5zOiBzdHJpbmcsIGtleTogc3RyaW5nLCB2OiBWLCB0dGxNcz86IG51bWJlcikge1xuICAgIGNvbnN0IGsgPSBgJHtuc306JHtrZXl9YDsgdGhpcy5zLnNldChrLCB7IHYsIGV4cDogdHRsTXMgPyBEYXRlLm5vdygpK3R0bE1zIDogdW5kZWZpbmVkIH0pO1xuICB9XG4gIGdldChuczogc3RyaW5nLCBrZXk6IHN0cmluZyk6IFYgfCB1bmRlZmluZWQge1xuICAgIGNvbnN0IGsgPSBgJHtuc306JHtrZXl9YDsgY29uc3QgZSA9IHRoaXMucy5nZXQoayk7XG4gICAgaWYgKCFlKSByZXR1cm47XG4gICAgaWYgKGUuZXhwICYmIERhdGUubm93KCkgPiBlLmV4cCkgeyB0aGlzLnMuZGVsZXRlKGspOyByZXR1cm47IH1cbiAgICByZXR1cm4gZS52O1xuICB9XG4gIGRlbGV0ZShuczogc3RyaW5nLCBrZXk6IHN0cmluZykgeyB0aGlzLnMuZGVsZXRlKGAke25zfToke2tleX1gKTsgfVxuICBjbGVhcihucz86IHN0cmluZykge1xuICAgIGlmICghbnMpIHJldHVybiB0aGlzLnMuY2xlYXIoKTtcbiAgICBjb25zdCBwID0gYCR7bnN9OmA7XG4gICAgZm9yIChjb25zdCBrIG9mIEFycmF5LmZyb20odGhpcy5zLmtleXMoKSkpIGlmIChrLnN0YXJ0c1dpdGgocCkpIHRoaXMucy5kZWxldGUoayk7XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IHNlc3Npb25LViA9IG5ldyBTZXNzaW9uS1Y8YW55PigpO1xuIl0sIm5hbWVzIjpbIlBvb2wiLCJyYW5kb21CeXRlcyIsIm1rZGlyU3luYyIsImV4aXN0c1N5bmMiLCJyZWFkRmlsZVN5bmMiLCJ3cml0ZUZpbGVTeW5jIiwicmVzb2x2ZSIsImRpcm5hbWUiLCJhc0Jvb2wiLCJ2IiwiZGVmIiwicyIsIlN0cmluZyIsInRyaW0iLCJ0b0xvd2VyQ2FzZSIsInVzZVVybCIsInByb2Nlc3MiLCJlbnYiLCJEQVRBQkFTRV9VUkwiLCJiYXNlIiwiY29ubmVjdGlvblN0cmluZyIsImhvc3QiLCJQR0hPU1QiLCJwb3J0IiwiTnVtYmVyIiwiUEdQT1JUIiwidXNlciIsIlBHVVNFUiIsInBhc3N3b3JkIiwiUEdQQVNTV09SRCIsImRhdGFiYXNlIiwiUEdEQVRBQkFTRSIsInBvb2xDb25maWciLCJtYXgiLCJEQl9QT09MX01BWCIsImlkbGVUaW1lb3V0TWlsbGlzIiwiREJfSURMRV9NUyIsImNvbm5lY3Rpb25UaW1lb3V0TWlsbGlzIiwiREJfQ09OTl9USU1FT1VUX01TIiwic3NsIiwiREJfU1NMIiwicmVqZWN0VW5hdXRob3JpemVkIiwidW5kZWZpbmVkIiwiZ2V0UG9vbCIsImdsb2JhbCIsIl9fY29yZV9wZ19wb29sX18iLCJkYiIsIndpdGhDbGllbnQiLCJmbiIsImMiLCJjb25uZWN0IiwicmVsZWFzZSIsInF1ZXJ5IiwidGV4dCIsInBhcmFtcyIsImFwcGVuZEFwcExlZGdlciIsImUiLCJ0b3BpYyIsImV2ZW50IiwicGF5bG9hZCIsInNlc3Npb25faWQiLCJpZGVtcG90ZW5jeV9rZXkiLCJ0c19lcG9jaF9tcyIsIm9wZW5pbmdDYWNoZSIsIk1hcCIsImtleVN0ciIsImIiLCJxIiwidyIsInNpZCIsImdldE9wZW5pbmciLCJxdW90ZSIsIndpbmRvdyIsImFwcFNlc3Npb25JZCIsImNrIiwiaGl0IiwiZ2V0Iiwicm93cyIsImxlbmd0aCIsInZhbCIsInByaWNlIiwidHMiLCJzZXQiLCJTRVNTSU9OX0ZJTEUiLCJjd2QiLCJlbnN1cmVEaXIiLCJyZWN1cnNpdmUiLCJuZXdTZXNzaW9uSWQiLCJEYXRlIiwibm93IiwidG9TdHJpbmciLCJjcmVhdGVBcHBTZXNzaW9uIiwiaWQiLCJ1c2VBcHBTZXNzaW9uIiwiSlNPTiIsInN0cmluZ2lmeSIsImN1cnJlbnRBcHBTZXNzaW9uIiwiQVBQX1NFU1NJT05fSUQiLCJqIiwicGFyc2UiLCJTZXNzaW9uS1YiLCJucyIsImtleSIsInR0bE1zIiwiayIsImV4cCIsImRlbGV0ZSIsImNsZWFyIiwicCIsIkFycmF5IiwiZnJvbSIsImtleXMiLCJzdGFydHNXaXRoIiwic2Vzc2lvbktWIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/core/db/index.ts\n");

/***/ }),

/***/ "(rsc)/./src/core/sources/binanceAccount.ts":
/*!********************************************!*\
  !*** ./src/core/sources/binanceAccount.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   _internal: () => (/* binding */ _internal),\n/* harmony export */   clearWalletCache: () => (/* binding */ clearWalletCache),\n/* harmony export */   fetchMyTradesForSymbol: () => (/* binding */ fetchMyTradesForSymbol),\n/* harmony export */   getAccountBalances: () => (/* binding */ getAccountBalances),\n/* harmony export */   getMyTradesForSymbol: () => (/* binding */ getMyTradesForSymbol)\n/* harmony export */ });\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _lib_wallet_registry__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/wallet/registry */ \"(rsc)/./src/lib/wallet/registry.ts\");\n/**\n * Signed-account adapter (no separate binanceClient.ts needed).\n * - GET /api/v3/account (SIGNED)\n * - Response hardening\n * - 40s result cache to align with project cycles\n */ \n\n/**\n * Fetch private trades for a single symbol.\n * - Uses env or wallet-linked credentials.\n * - Returns [] on missing creds or error (soft fail).\n */ async function getMyTradesForSymbol(symbol, options = {}) {\n    const email = options.email?.toLowerCase() ?? null;\n    const creds = resolveCredentials(email);\n    if (!creds) {\n        const scope = email ? `for ${email}` : \"(env)\";\n        console.warn(`getMyTradesForSymbol: missing credentials ${scope}`);\n        return [];\n    }\n    const query = {\n        symbol,\n        fromId: options.fromId,\n        startTime: options.startTime,\n        endTime: options.endTime,\n        limit: options.limit ?? 500\n    };\n    try {\n        return await signedGET(\"/api/v3/myTrades\", query, creds);\n    } catch (error) {\n        const message = error instanceof Error ? error.message : String(error ?? \"myTrades fetch failed\");\n        console.warn(`getMyTradesForSymbol(${symbol}): ${message}`);\n        return [];\n    }\n}\nconst BASE = process.env.BINANCE_BASE ?? \"https://api.binance.com\";\nconst ENV_API_KEY = process.env.BINANCE_API_KEY ?? process.env.BINANCE_KEY ?? \"\";\nconst ENV_API_SECRET = process.env.BINANCE_API_SECRET ?? process.env.BINANCE_SECRET ?? \"\";\nconst envCredentials = ENV_API_KEY && ENV_API_SECRET ? {\n    apiKey: ENV_API_KEY,\n    apiSecret: ENV_API_SECRET\n} : null;\n// ---- signed client (inlined) ------------------------------------------------\nlet timeSkewMs = 0; // serverTime - localTime; maintained automatically\nfunction qs(params) {\n    const entries = Object.entries(params).filter(([, v])=>v !== undefined && v !== null).map(([k, v])=>[\n            k,\n            typeof v === \"string\" ? v : String(v)\n        ]);\n    entries.sort(([a], [b])=>a < b ? -1 : a > b ? 1 : 0);\n    return entries.map(([k, v])=>`${encodeURIComponent(k)}=${encodeURIComponent(v)}`).join(\"&\");\n}\nfunction sign(payload, secret) {\n    return crypto__WEBPACK_IMPORTED_MODULE_0___default().createHmac(\"sha256\", secret).update(payload).digest(\"hex\");\n}\nasync function getJson(url, init) {\n    const res = await fetch(url, init);\n    const text = await res.text();\n    const body = text ? (()=>{\n        try {\n            return JSON.parse(text);\n        } catch  {\n            return text;\n        }\n    })() : null;\n    if (!res.ok) {\n        const { msg, code } = typeof body === \"object\" && body !== null ? body : {};\n        const message = msg ?? (typeof body === \"string\" ? body : res.statusText);\n        const err = new Error(`HTTP ${res.status}${code != null ? ` (${code})` : \"\"}: ${message}`);\n        if (code != null) err.code = code;\n        throw err;\n    }\n    return body;\n}\nasync function fetchServerTime() {\n    const url = new URL(\"/api/v3/time\", BASE).toString();\n    const j = await getJson(url, {\n        cache: \"no-store\"\n    });\n    return Number(j?.serverTime ?? Date.now());\n}\nfunction resolveCredentials(email) {\n    if (email) {\n        const wallet = (0,_lib_wallet_registry__WEBPACK_IMPORTED_MODULE_1__.getWallet)(email);\n        if (wallet) return {\n            apiKey: wallet.apiKey,\n            apiSecret: wallet.apiSecret\n        };\n    }\n    return envCredentials;\n}\n/**\n * Signed GET with automatic time-skew recovery (-1021).\n * Throws if API credentials are missing.\n */ async function signedGET(path, query = {}, creds) {\n    const recvWindow = Number(query.recvWindow ?? 5000);\n    const timestamp = Date.now() + timeSkewMs;\n    const baseParams = {\n        ...query,\n        recvWindow,\n        timestamp\n    };\n    const payload = qs(baseParams);\n    const sig = sign(payload, creds.apiSecret);\n    const url = new URL(path, BASE);\n    url.search = `${payload}&signature=${sig}`;\n    const headers = {\n        \"X-MBX-APIKEY\": creds.apiKey\n    };\n    try {\n        return await getJson(url.toString(), {\n            headers,\n            cache: \"no-store\"\n        });\n    } catch (error) {\n        const err = error;\n        if (err.code === -1021 || /-1021/.test(String(err.message))) {\n            try {\n                const serverTime = await fetchServerTime();\n                timeSkewMs = serverTime - Date.now();\n            } catch  {\n            // ignore skew update errors; will rethrow original\n            }\n            const ts2 = Date.now() + timeSkewMs;\n            const payload2 = qs({\n                ...query,\n                recvWindow,\n                timestamp: ts2\n            });\n            const sig2 = sign(payload2, creds.apiSecret);\n            const url2 = new URL(path, BASE);\n            url2.search = `${payload2}&signature=${sig2}`;\n            return await getJson(url2.toString(), {\n                headers,\n                cache: \"no-store\"\n            });\n        }\n        throw err;\n    }\n}\n// ---- wallet facade (per-email cache) ---------------------------------------\nconst WALLET_TTL_MS = 40000;\nconst cache = new Map();\nfunction cacheKey(email) {\n    return email?.toLowerCase() ?? \"__env__\";\n}\n/** Clear wallet cache (optional: for tests/manual refresh) */ function clearWalletCache(email) {\n    if (email) {\n        cache.delete(cacheKey(email));\n        return;\n    }\n    cache.clear();\n}\n/**\n * Returns a map: { ASSET -> free balance }, e.g. { BTC: 0.01, USDT: 123.45 }\n * Soft-fails to {} when credentials are missing or request fails.\n */ async function getAccountBalances(options = {}) {\n    const email = options.email?.toLowerCase() ?? null;\n    const key = cacheKey(email);\n    const now = Date.now();\n    const cached = cache.get(key);\n    if (cached && now - cached.at < WALLET_TTL_MS) {\n        return cached.data;\n    }\n    const creds = resolveCredentials(email);\n    if (!creds) {\n        const scope = email ? `for ${email}` : \"(env)\";\n        console.warn(`getAccountBalances: missing credentials ${scope}`);\n        const empty = {};\n        cache.set(key, {\n            at: now,\n            data: empty\n        });\n        return empty;\n    }\n    try {\n        const data = await signedGET(\"/api/v3/account\", {}, creds);\n        const out = {};\n        const arr = Array.isArray(data?.balances) ? data.balances : [];\n        for (const balance of arr){\n            const asset = String(balance.asset ?? \"\").trim();\n            if (!asset) continue;\n            const free = Number(balance.free);\n            if (Number.isFinite(free)) out[asset] = free;\n        }\n        cache.set(key, {\n            at: now,\n            data: out\n        });\n        return out;\n    } catch (error) {\n        const message = error instanceof Error ? error.message : String(error ?? \"wallet fetch failed\");\n        console.warn(`getAccountBalances: ${message}`);\n        const empty = {};\n        cache.set(key, {\n            at: now,\n            data: empty\n        });\n        return empty;\n    }\n}\n// Optional: export the signed helper if other modules need it in the future.\nconst _internal = {\n    signedGET,\n    fetchServerTime,\n    resolveCredentials\n};\n// src/core/features/cin-aux/binanceTrades.ts\nconst BINANCE_API_KEY = process.env.BINANCE_API_KEY;\nconst BINANCE_API_SECRET = process.env.BINANCE_API_SECRET;\nconst BINANCE_BASE_URL = \"https://api.binance.com\";\nfunction signQuery(query) {\n    return crypto__WEBPACK_IMPORTED_MODULE_0___default().createHmac(\"sha256\", BINANCE_API_SECRET).update(query).digest(\"hex\");\n}\nasync function fetchMyTradesForSymbol(args) {\n    if (!BINANCE_API_KEY || !BINANCE_API_SECRET) {\n        throw new Error(\"Binance API credentials not configured\");\n    }\n    const params = {\n        symbol: args.symbol.toUpperCase(),\n        timestamp: Date.now()\n    };\n    if (args.startTime) params.startTime = args.startTime;\n    if (args.endTime) params.endTime = args.endTime;\n    if (args.limit) params.limit = args.limit;\n    const query = new URLSearchParams(Object.entries(params).map(([k, v])=>[\n            k,\n            String(v)\n        ])).toString();\n    const signature = signQuery(query);\n    const url = `${BINANCE_BASE_URL}/api/v3/myTrades?${query}&signature=${signature}`;\n    const res = await fetch(url, {\n        method: \"GET\",\n        headers: {\n            \"X-MBX-APIKEY\": BINANCE_API_KEY\n        }\n    });\n    if (!res.ok) {\n        throw new Error(`Binance myTrades HTTP ${res.status}`);\n    }\n    const json = await res.json();\n    return json;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvY29yZS9zb3VyY2VzL2JpbmFuY2VBY2NvdW50LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQUE7Ozs7O0NBS0MsR0FFMkI7QUFDc0I7QUFvQ2xEOzs7O0NBSUMsR0FDTSxlQUFlRSxxQkFDcEJDLE1BQWMsRUFDZEMsVUFBMkIsQ0FBQyxDQUFDO0lBRTdCLE1BQU1DLFFBQVFELFFBQVFDLEtBQUssRUFBRUMsaUJBQWlCO0lBQzlDLE1BQU1DLFFBQVFDLG1CQUFtQkg7SUFDakMsSUFBSSxDQUFDRSxPQUFPO1FBQ1YsTUFBTUUsUUFBUUosUUFBUSxDQUFDLElBQUksRUFBRUEsT0FBTyxHQUFHO1FBQ3ZDSyxRQUFRQyxJQUFJLENBQUMsQ0FBQywwQ0FBMEMsRUFBRUYsT0FBTztRQUNqRSxPQUFPLEVBQUU7SUFDWDtJQUVBLE1BQU1HLFFBQXFCO1FBQ3pCVDtRQUNBVSxRQUFRVCxRQUFRUyxNQUFNO1FBQ3RCQyxXQUFXVixRQUFRVSxTQUFTO1FBQzVCQyxTQUFTWCxRQUFRVyxPQUFPO1FBQ3hCQyxPQUFPWixRQUFRWSxLQUFLLElBQUk7SUFDMUI7SUFFQSxJQUFJO1FBQ0YsT0FBTyxNQUFNQyxVQUEwQixvQkFBb0JMLE9BQU9MO0lBQ3BFLEVBQUUsT0FBT1csT0FBTztRQUNkLE1BQU1DLFVBQVVELGlCQUFpQkUsUUFBUUYsTUFBTUMsT0FBTyxHQUFHRSxPQUFPSCxTQUFTO1FBQ3pFUixRQUFRQyxJQUFJLENBQUMsQ0FBQyxxQkFBcUIsRUFBRVIsT0FBTyxHQUFHLEVBQUVnQixTQUFTO1FBQzFELE9BQU8sRUFBRTtJQUNYO0FBQ0Y7QUFFQSxNQUFNRyxPQUFPQyxRQUFRQyxHQUFHLENBQUNDLFlBQVksSUFBSTtBQUN6QyxNQUFNQyxjQUNKSCxRQUFRQyxHQUFHLENBQUNHLGVBQWUsSUFDM0JKLFFBQVFDLEdBQUcsQ0FBQ0ksV0FBVyxJQUN2QjtBQUNGLE1BQU1DLGlCQUNKTixRQUFRQyxHQUFHLENBQUNNLGtCQUFrQixJQUM5QlAsUUFBUUMs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M0csU0FBUyxFQUFFdUIsT0FBT3ZCLFNBQVMsR0FBRzJHLEtBQUszRyxTQUFTO0lBQ3JELElBQUkyRyxLQUFLMUcsT0FBTyxFQUFFc0IsT0FBT3RCLE9BQU8sR0FBRzBHLEtBQUsxRyxPQUFPO0lBQy9DLElBQUkwRyxLQUFLekcsS0FBSyxFQUFFcUIsT0FBT3JCLEtBQUssR0FBR3lHLEtBQUt6RyxLQUFLO0lBRXpDLE1BQU1KLFFBQVEsSUFBSStHLGdCQUNoQnBGLE9BQU9ELE9BQU8sQ0FBQ0QsUUFBUU0sR0FBRyxDQUFDLENBQUMsQ0FBQ0MsR0FBR0gsRUFBRSxHQUFLO1lBQUNHO1lBQUd2QixPQUFPb0I7U0FBRyxHQUNyRGdDLFFBQVE7SUFFVixNQUFNbUQsWUFBWUwsVUFBVTNHO0lBQzVCLE1BQU02QyxNQUFNLEdBQUc2RCxpQkFBaUIsaUJBQWlCLEVBQUUxRyxNQUFNLFdBQVcsRUFBRWdILFdBQVc7SUFFakYsTUFBTWpFLE1BQU0sTUFBTUMsTUFBTUgsS0FBSztRQUMzQm9FLFFBQVE7UUFDUnRDLFNBQVM7WUFDUCxnQkFBZ0I1RDtRQUNsQjtJQUNGO0lBRUEsSUFBSSxDQUFDZ0MsSUFBSU0sRUFBRSxFQUFFO1FBQ1gsTUFBTSxJQUFJN0MsTUFBTSxDQUFDLHNCQUFzQixFQUFFdUMsSUFBSVcsTUFBTSxFQUFFO0lBQ3ZEO0lBRUEsTUFBTXdELE9BQVEsTUFBTW5FLElBQUltRSxJQUFJO0lBQzVCLE9BQU9BO0FBQ1QiLCJzb3VyY2VzIjpbIkg6XFxVc2Vyc1xcR3VzXFxzb3VyY2VcXHJlcG9cXGR5bmFtaWNzXFxkeW5hbWljcy1iXFxjcnlwdG9waS1keW5hbWljc1xcc3JjXFxjb3JlXFxzb3VyY2VzXFxiaW5hbmNlQWNjb3VudC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFNpZ25lZC1hY2NvdW50IGFkYXB0ZXIgKG5vIHNlcGFyYXRlIGJpbmFuY2VDbGllbnQudHMgbmVlZGVkKS5cbiAqIC0gR0VUIC9hcGkvdjMvYWNjb3VudCAoU0lHTkVEKVxuICogLSBSZXNwb25zZSBoYXJkZW5pbmdcbiAqIC0gNDBzIHJlc3VsdCBjYWNoZSB0byBhbGlnbiB3aXRoIHByb2plY3QgY3ljbGVzXG4gKi9cblxuaW1wb3J0IGNyeXB0byBmcm9tIFwiY3J5cHRvXCI7XG5pbXBvcnQgeyBnZXRXYWxsZXQgfSBmcm9tIFwiQC9saWIvd2FsbGV0L3JlZ2lzdHJ5XCI7XG5cbmV4cG9ydCB0eXBlIEJhbGFuY2VzTWFwID0gUmVjb3JkPHN0cmluZywgbnVtYmVyPjtcblxudHlwZSBRdWVyeVJlY29yZCA9IFJlY29yZDxzdHJpbmcsIHN0cmluZyB8IG51bWJlciB8IHVuZGVmaW5lZD47XG5cbnR5cGUgQmluYW5jZUVycm9yID0geyBjb2RlPzogbnVtYmVyOyBtc2c/OiBzdHJpbmcgfTtcblxudHlwZSBDcmVkZW50aWFscyA9IHsgYXBpS2V5OiBzdHJpbmc7IGFwaVNlY3JldDogc3RyaW5nIH07XG5cbmV4cG9ydCB0eXBlIEFjY291bnRPcHRpb25zID0ge1xuICBlbWFpbD86IHN0cmluZztcbn07XG4vLyAtLS0tIC9hcGkvdjMvbXlUcmFkZXMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5leHBvcnQgdHlwZSBBY2NvdW50VHJhZGUgPSB7XG4gIGlkOiBudW1iZXI7XG4gIG9yZGVySWQ6IG51bWJlcjtcbiAgcHJpY2U6IHN0cmluZztcbiAgcXR5OiBzdHJpbmc7XG4gIHF1b3RlUXR5OiBzdHJpbmc7XG4gIGNvbW1pc3Npb246IHN0cmluZztcbiAgY29tbWlzc2lvbkFzc2V0OiBzdHJpbmc7XG4gIHRpbWU6IG51bWJlcjsgICAgICAgIC8vIG1zIHNpbmNlIGVwb2NoXG4gIGlzQnV5ZXI6IGJvb2xlYW47XG4gIGlzTWFrZXI6IGJvb2xlYW47XG4gIGlzQmVzdE1hdGNoOiBib29sZWFuO1xufTtcblxuZXhwb3J0IHR5cGUgTXlUcmFkZXNPcHRpb25zID0gQWNjb3VudE9wdGlvbnMgJiB7XG4gIGZyb21JZD86IG51bWJlcjtcbiAgc3RhcnRUaW1lPzogbnVtYmVyOyAgLy8gZXBvY2ggbXNcbiAgZW5kVGltZT86IG51bWJlcjsgICAgLy8gZXBvY2ggbXNcbiAgbGltaXQ/OiBudW1iZXI7XG59O1xuXG4vKipcbiAqIEZldGNoIHByaXZhdGUgdHJhZGVzIGZvciBhIHNpbmdsZSBzeW1ib2wuXG4gKiAtIFVzZXMgZW52IG9yIHdhbGxldC1saW5rZWQgY3JlZGVudGlhbHMuXG4gKiAtIFJldHVybnMgW10gb24gbWlzc2luZyBjcmVkcyBvciBlcnJvciAoc29mdCBmYWlsKS5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldE15VHJhZGVzRm9yU3ltYm9sKFxuICBzeW1ib2w6IHN0cmluZyxcbiAgb3B0aW9uczogTXlUcmFkZXNPcHRpb25zID0ge30sXG4pOiBQcm9taXNlPEFjY291bnRUcmFkZVtdPiB7XG4gIGNvbnN0IGVtYWlsID0gb3B0aW9ucy5lbWFpbD8udG9Mb3dlckNhc2UoKSA/PyBudWxsO1xuICBjb25zdCBjcmVkcyA9IHJlc29sdmVDcmVkZW50aWFscyhlbWFpbCk7XG4gIGlmICghY3JlZHMpIHtcbiAgICBjb25zdCBzY29wZSA9IGVtYWlsID8gYGZvciAke2VtYWlsfWAgOiBcIihlbnYpXCI7XG4gICAgY29uc29sZS53YXJuKGBnZXRNeVRyYWRlc0ZvclN5bWJvbDogbWlzc2luZyBjcmVkZW50aWFscyAke3Njb3BlfWApO1xuICAgIHJldHVybiBbXTtcbiAgfVxuXG4gIGNvbnN0IHF1ZXJ5OiBRdWVyeVJlY29yZCA9IHtcbiAgICBzeW1ib2wsXG4gICAgZnJvbUlkOiBvcHRpb25zLmZyb21JZCxcbiAgICBzdGFydFRpbWU6IG9wdGlvbnMuc3RhcnRUaW1lLFxuICAgIGVuZFRpbWU6IG9wdGlvbnMuZW5kVGltZSxcbiAgICBsaW1pdDogb3B0aW9ucy5saW1pdCA/PyA1MDAsXG4gIH07XG5cbiAgdHJ5IHtcbiAgICByZXR1cm4gYXdhaXQgc2lnbmVkR0VUPEFjY291bnRUcmFkZVtdPihcIi9hcGkvdjMvbXlUcmFkZXNcIiwgcXVlcnksIGNyZWRzKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zdCBtZXNzYWdlID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IgPz8gXCJteVRyYWRlcyBmZXRjaCBmYWlsZWRcIik7XG4gICAgY29uc29sZS53YXJuKGBnZXRNeVRyYWRlc0ZvclN5bWJvbCgke3N5bWJvbH0pOiAke21lc3NhZ2V9YCk7XG4gICAgcmV0dXJuIFtdO1xuICB9XG59XG5cbmNvbnN0IEJBU0UgPSBwcm9jZXNzLmVudi5CSU5BTkNFX0JBU0UgPz8gXCJodHRwczovL2FwaS5iaW5hbmNlLmNvbVwiO1xuY29uc3QgRU5WX0FQSV9LRVkgPVxuICBwcm9jZXNzLmVudi5CSU5BTkNFX0FQSV9LRVkgPz9cbiAgcHJvY2Vzcy5lbnYuQklOQU5DRV9LRVkgPz9cbiAgXCJcIjtcbmNvbnN0IEVOVl9BUElfU0VDUkVUID1cbiAgcHJvY2Vzcy5lbnYuQklOQU5DRV9BUElfU0VDUkVUID8/XG4gIHByb2Nlc3MuZW52LkJJTkFOQ0VfU0VDUkVUID8/XG4gIFwiXCI7XG5cbmNvbnN0IGVudkNyZWRlbnRpYWxzOiBDcmVkZW50aWFscyB8IG51bGwgPVxuICBFTlZfQVBJX0tFWSAmJiBFTlZfQVBJX1NFQ1JFVCA/IHsgYXBpS2V5OiBFTlZfQVBJX0tFWSwgYXBpU2VjcmV0OiBFTlZfQVBJX1NFQ1JFVCB9IDogbnVsbDtcblxuLy8gLS0tLSBzaWduZWQgY2xpZW50IChpbmxpbmVkKSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxubGV0IHRpbWVTa2V3TXMgPSAwOyAvLyBzZXJ2ZXJUaW1lIC0gbG9jYWxUaW1lOyBtYWludGFpbmVkIGF1dG9tYXRpY2FsbHlcblxuZnVuY3Rpb24gcXMocGFyYW1zOiBRdWVyeVJlY29yZCk6IHN0cmluZyB7XG4gIGNvbnN0IGVudHJpZXMgPSBPYmplY3QuZW50cmllcyhwYXJhbXMpXG4gICAgLmZpbHRlcigoWywgdl0pID0+IHYgIT09IHVuZGVmaW5lZCAmJiB2ICE9PSBudWxsKVxuICAgIC5tYXAoKFtrLCB2XSkgPT4gW2ssIHR5cGVvZiB2ID09PSBcInN0cmluZ1wiID8gdiA6IFN0cmluZyh2KV0gYXMgW3N0cmluZywgc3RyaW5nXSk7XG4gIGVudHJpZXMuc29ydCgoW2FdLCBbYl0pID0+IChhIDwgYiA/IC0xIDogYSA+IGIgPyAxIDogMCkpO1xuICByZXR1cm4gZW50cmllcy5tYXAoKFtrLCB2XSkgPT4gYCR7ZW5jb2RlVVJJQ29tcG9uZW50KGspfT0ke2VuY29kZVVSSUNvbXBvbmVudCh2KX1gKS5qb2luKFwiJlwiKTtcbn1cblxuZnVuY3Rpb24gc2lnbihwYXlsb2FkOiBzdHJpbmcsIHNlY3JldDogc3RyaW5nKSB7XG4gIHJldHVybiBjcnlwdG8uY3JlYXRlSG1hYyhcInNoYTI1NlwiLCBzZWNyZXQpLnVwZGF0ZShwYXlsb2FkKS5kaWdlc3QoXCJoZXhcIik7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGdldEpzb248VD4odXJsOiBzdHJpbmcsIGluaXQ/OiBSZXF1ZXN0SW5pdCk6IFByb21pc2U8VD4ge1xuICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaCh1cmwsIGluaXQpO1xuICBjb25zdCB0ZXh0ID0gYXdhaXQgcmVzLnRleHQoKTtcbiAgY29uc3QgYm9keTogdW5rbm93biA9IHRleHQgPyAoKCkgPT4geyB0cnkgeyByZXR1cm4gSlNPTi5wYXJzZSh0ZXh0KTsgfSBjYXRjaCB7IHJldHVybiB0ZXh0OyB9IH0pKCkgOiBudWxsO1xuICBpZiAoIXJlcy5vaykge1xuICAgIGNvbnN0IHsgbXNnLCBjb2RlIH0gPSAodHlwZW9mIGJvZHkgPT09IFwib2JqZWN0XCIgJiYgYm9keSAhPT0gbnVsbCA/IChib2R5IGFzIEJpbmFuY2VFcnJvcikgOiB7fSk7XG4gICAgY29uc3QgbWVzc2FnZSA9IG1zZyA/PyAodHlwZW9mIGJvZHkgPT09IFwic3RyaW5nXCIgPyBib2R5IDogcmVzLnN0YXR1c1RleHQpO1xuICAgIGNvbnN0IGVyciA9IG5ldyBFcnJvcihgSFRUUCAke3Jlcy5zdGF0dXN9JHtjb2RlICE9IG51bGwgPyBgICgke2NvZGV9KWAgOiBcIlwifTogJHttZXNzYWdlfWApO1xuICAgIGlmIChjb2RlICE9IG51bGwpIChlcnIgYXMgRXJyb3IgJiB7IGNvZGU/OiBudW1iZXIgfSkuY29kZSA9IGNvZGU7XG4gICAgdGhyb3cgZXJyO1xuICB9XG4gIHJldHVybiBib2R5IGFzIFQ7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGZldGNoU2VydmVyVGltZSgpOiBQcm9taXNlPG51bWJlcj4ge1xuICBjb25zdCB1cmwgPSBuZXcgVVJMKFwiL2FwaS92My90aW1lXCIsIEJBU0UpLnRvU3RyaW5nKCk7XG4gIGNvbnN0IGogPSBhd2FpdCBnZXRKc29uPHsgc2VydmVyVGltZTogbnVtYmVyIH0+KHVybCwgeyBjYWNoZTogXCJuby1zdG9yZVwiIH0pO1xuICByZXR1cm4gTnVtYmVyKGo/LnNlcnZlclRpbWUgPz8gRGF0ZS5ub3coKSk7XG59XG5cbmZ1bmN0aW9uIHJlc29sdmVDcmVkZW50aWFscyhlbWFpbD86IHN0cmluZyB8IG51bGwpOiBDcmVkZW50aWFscyB8IG51bGwge1xuICBpZiAoZW1haWwpIHtcbiAgICBjb25zdCB3YWxsZXQgPSBnZXRXYWxsZXQoZW1haWwpO1xuICAgIGlmICh3YWxsZXQpIHJldHVybiB7IGFwaUtleTogd2FsbGV0LmFwaUtleSwgYXBpU2VjcmV0OiB3YWxsZXQuYXBpU2VjcmV0IH07XG4gIH1cbiAgcmV0dXJuIGVudkNyZWRlbnRpYWxzO1xufVxuXG4vKipcbiAqIFNpZ25lZCBHRVQgd2l0aCBhdXRvbWF0aWMgdGltZS1za2V3IHJlY292ZXJ5ICgtMTAyMSkuXG4gKiBUaHJvd3MgaWYgQVBJIGNyZWRlbnRpYWxzIGFyZSBtaXNzaW5nLlxuICovXG5hc3luYyBmdW5jdGlvbiBzaWduZWRHRVQ8VD4ocGF0aDogc3RyaW5nLCBxdWVyeTogUXVlcnlSZWNvcmQgPSB7fSwgY3JlZHM6IENyZWRlbnRpYWxzKTogUHJvbWlzZTxUPiB7XG4gIGNvbnN0IHJlY3ZXaW5kb3cgPSBOdW1iZXIocXVlcnkucmVjdldpbmRvdyA/PyA1MDAwKTtcbiAgY29uc3QgdGltZXN0YW1wID0gRGF0ZS5ub3coKSArIHRpbWVTa2V3TXM7XG5cbiAgY29uc3QgYmFzZVBhcmFtcyA9IHsgLi4ucXVlcnksIHJlY3ZXaW5kb3csIHRpbWVzdGFtcCB9O1xuICBjb25zdCBwYXlsb2FkID0gcXMoYmFzZVBhcmFtcyk7XG4gIGNvbnN0IHNpZyA9IHNpZ24ocGF5bG9hZCwgY3JlZHMuYXBpU2VjcmV0KTtcblxuICBjb25zdCB1cmwgPSBuZXcgVVJMKHBhdGgsIEJBU0UpO1xuICB1cmwuc2VhcmNoID0gYCR7cGF5bG9hZH0mc2lnbmF0dXJlPSR7c2lnfWA7XG5cbiAgY29uc3QgaGVhZGVycyA9IHsgXCJYLU1CWC1BUElLRVlcIjogY3JlZHMuYXBpS2V5IH07XG5cbiAgdHJ5IHtcbiAgICByZXR1cm4gYXdhaXQgZ2V0SnNvbjxUPih1cmwudG9TdHJpbmcoKSwgeyBoZWFkZXJzLCBjYWNoZTogXCJuby1zdG9yZVwiIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnN0IGVyciA9IGVycm9yIGFzIEVycm9yICYgeyBjb2RlPzogbnVtYmVyIH07XG4gICAgaWYgKGVyci5jb2RlID09PSAtMTAyMSB8fCAvLTEwMjEvLnRlc3QoU3RyaW5nKGVyci5tZXNzYWdlKSkpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHNlcnZlclRpbWUgPSBhd2FpdCBmZXRjaFNlcnZlclRpbWUoKTtcbiAgICAgICAgdGltZVNrZXdNcyA9IHNlcnZlclRpbWUgLSBEYXRlLm5vdygpO1xuICAgICAgfSBjYXRjaCB7XG4gICAgICAgIC8vIGlnbm9yZSBza2V3IHVwZGF0ZSBlcnJvcnM7IHdpbGwgcmV0aHJvdyBvcmlnaW5hbFxuICAgICAgfVxuICAgICAgY29uc3QgdHMyID0gRGF0ZS5ub3coKSArIHRpbWVTa2V3TXM7XG4gICAgICBjb25zdCBwYXlsb2FkMiA9IHFzKHsgLi4ucXVlcnksIHJlY3ZXaW5kb3csIHRpbWVzdGFtcDogdHMyIH0pO1xuICAgICAgY29uc3Qgc2lnMiA9IHNpZ24ocGF5bG9hZDIsIGNyZWRzLmFwaVNlY3JldCk7XG4gICAgICBjb25zdCB1cmwyID0gbmV3IFVSTChwYXRoLCBCQVNFKTtcbiAgICAgIHVybDIuc2VhcmNoID0gYCR7cGF5bG9hZDJ9JnNpZ25hdHVyZT0ke3NpZzJ9YDtcbiAgICAgIHJldHVybiBhd2FpdCBnZXRKc29uPFQ+KHVybDIudG9TdHJpbmcoKSwgeyBoZWFkZXJzLCBjYWNoZTogXCJuby1zdG9yZVwiIH0pO1xuICAgIH1cbiAgICB0aHJvdyBlcnI7XG4gIH1cbn1cblxuLy8gLS0tLSB3YWxsZXQgZmFjYWRlIChwZXItZW1haWwgY2FjaGUpIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5jb25zdCBXQUxMRVRfVFRMX01TID0gNDBfMDAwO1xuY29uc3QgY2FjaGUgPSBuZXcgTWFwPHN0cmluZywgeyBhdDogbnVtYmVyOyBkYXRhOiBCYWxhbmNlc01hcCB9PigpO1xuXG5mdW5jdGlvbiBjYWNoZUtleShlbWFpbD86IHN0cmluZyB8IG51bGwpIHtcbiAgcmV0dXJuIGVtYWlsPy50b0xvd2VyQ2FzZSgpID8/IFwiX19lbnZfX1wiO1xufVxuXG4vKiogQ2xlYXIgd2FsbGV0IGNhY2hlIChvcHRpb25hbDogZm9yIHRlc3RzL21hbnVhbCByZWZyZXNoKSAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyV2FsbGV0Q2FjaGUoZW1haWw/OiBzdHJpbmcpIHtcbiAgaWYgKGVtYWlsKSB7XG4gICAgY2FjaGUuZGVsZXRlKGNhY2hlS2V5KGVtYWlsKSk7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNhY2hlLmNsZWFyKCk7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIG1hcDogeyBBU1NFVCAtPiBmcmVlIGJhbGFuY2UgfSwgZS5nLiB7IEJUQzogMC4wMSwgVVNEVDogMTIzLjQ1IH1cbiAqIFNvZnQtZmFpbHMgdG8ge30gd2hlbiBjcmVkZW50aWFscyBhcmUgbWlzc2luZyBvciByZXF1ZXN0IGZhaWxzLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWNjb3VudEJhbGFuY2VzKG9wdGlvbnM6IEFjY291bnRPcHRpb25zID0ge30pOiBQcm9taXNlPEJhbGFuY2VzTWFwPiB7XG4gIGNvbnN0IGVtYWlsID0gb3B0aW9ucy5lbWFpbD8udG9Mb3dlckNhc2UoKSA/PyBudWxsO1xuICBjb25zdCBrZXkgPSBjYWNoZUtleShlbWFpbCk7XG4gIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gIGNvbnN0IGNhY2hlZCA9IGNhY2hlLmdldChrZXkpO1xuICBpZiAoY2FjaGVkICYmIG5vdyAtIGNhY2hlZC5hdCA8IFdBTExFVF9UVExfTVMpIHtcbiAgICByZXR1cm4gY2FjaGVkLmRhdGE7XG4gIH1cblxuICB0eXBlIEFjY291bnRSZXNwID0ge1xuICAgIGJhbGFuY2VzPzogQXJyYXk8eyBhc3NldD86IHN0cmluZzsgZnJlZT86IHN0cmluZzsgbG9ja2VkPzogc3RyaW5nIH0+O1xuICB9O1xuXG4gIGNvbnN0IGNyZWRzID0gcmVzb2x2ZUNyZWRlbnRpYWxzKGVtYWlsKTtcbiAgaWYgKCFjcmVkcykge1xuICAgIGNvbnN0IHNjb3BlID0gZW1haWwgPyBgZm9yICR7ZW1haWx9YCA6IFwiKGVudilcIjtcbiAgICBjb25zb2xlLndhcm4oYGdldEFjY291bnRCYWxhbmNlczogbWlzc2luZyBjcmVkZW50aWFscyAke3Njb3BlfWApO1xuICAgIGNvbnN0IGVtcHR5OiBCYWxhbmNlc01hcCA9IHt9O1xuICAgIGNhY2hlLnNldChrZXksIHsgYXQ6IG5vdywgZGF0YTogZW1wdHkgfSk7XG4gICAgcmV0dXJuIGVtcHR5O1xuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgc2lnbmVkR0VUPEFjY291bnRSZXNwPihcIi9hcGkvdjMvYWNjb3VudFwiLCB7fSwgY3JlZHMpO1xuICAgIGNvbnN0IG91dDogQmFsYW5jZXNNYXAgPSB7fTtcbiAgICBjb25zdCBhcnIgPSBBcnJheS5pc0FycmF5KGRhdGE/LmJhbGFuY2VzKSA/IGRhdGEuYmFsYW5jZXMgOiBbXTtcbiAgICBmb3IgKGNvbnN0IGJhbGFuY2Ugb2YgYXJyKSB7XG4gICAgICBjb25zdCBhc3NldCA9IFN0cmluZyhiYWxhbmNlLmFzc2V0ID8/IFwiXCIpLnRyaW0oKTtcbiAgICAgIGlmICghYXNzZXQpIGNvbnRpbnVlO1xuICAgICAgY29uc3QgZnJlZSA9IE51bWJlcihiYWxhbmNlLmZyZWUpO1xuICAgICAgaWYgKE51bWJlci5pc0Zpbml0ZShmcmVlKSkgb3V0W2Fzc2V0XSA9IGZyZWU7XG4gICAgfVxuICAgIGNhY2hlLnNldChrZXksIHsgYXQ6IG5vdywgZGF0YTogb3V0IH0pO1xuICAgIHJldHVybiBvdXQ7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc3QgbWVzc2FnZSA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yID8/IFwid2FsbGV0IGZldGNoIGZhaWxlZFwiKTtcbiAgICBjb25zb2xlLndhcm4oYGdldEFjY291bnRCYWxhbmNlczogJHttZXNzYWdlfWApO1xuICAgIGNvbnN0IGVtcHR5OiBCYWxhbmNlc01hcCA9IHt9O1xuICAgIGNhY2hlLnNldChrZXksIHsgYXQ6IG5vdywgZGF0YTogZW1wdHkgfSk7XG4gICAgcmV0dXJuIGVtcHR5O1xuICB9XG59XG5cbi8vIE9wdGlvbmFsOiBleHBvcnQgdGhlIHNpZ25lZCBoZWxwZXIgaWYgb3RoZXIgbW9kdWxlcyBuZWVkIGl0IGluIHRoZSBmdXR1cmUuXG5leHBvcnQgY29uc3QgX2ludGVybmFsID0geyBzaWduZWRHRVQsIGZldGNoU2VydmVyVGltZSwgcmVzb2x2ZUNyZWRlbnRpYWxzIH07XG5cbi8vIHNyYy9jb3JlL2ZlYXR1cmVzL2Npbi1hdXgvYmluYW5jZVRyYWRlcy50c1xuXG5jb25zdCBCSU5BTkNFX0FQSV9LRVkgPSBwcm9jZXNzLmVudi5CSU5BTkNFX0FQSV9LRVkhO1xuY29uc3QgQklOQU5DRV9BUElfU0VDUkVUID0gcHJvY2Vzcy5lbnYuQklOQU5DRV9BUElfU0VDUkVUITtcbmNvbnN0IEJJTkFOQ0VfQkFTRV9VUkwgPSBcImh0dHBzOi8vYXBpLmJpbmFuY2UuY29tXCI7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQmluYW5jZVRyYWRlIHtcbiAgc3ltYm9sOiBzdHJpbmc7XG4gIGlkOiBudW1iZXI7XG4gIG9yZGVySWQ6IG51bWJlcjtcbiAgcHJpY2U6IHN0cmluZztcbiAgcXR5OiBzdHJpbmc7XG4gIHF1b3RlUXR5OiBzdHJpbmc7XG4gIGNvbW1pc3Npb246IHN0cmluZztcbiAgY29tbWlzc2lvbkFzc2V0OiBzdHJpbmc7XG4gIHRpbWU6IG51bWJlcjsgLy8gbXMgc2luY2UgZXBvY2hcbiAgaXNCdXllcjogYm9vbGVhbjtcbiAgaXNNYWtlcjogYm9vbGVhbjtcbiAgaXNCZXN0TWF0Y2g6IGJvb2xlYW47XG59XG5cbmZ1bmN0aW9uIHNpZ25RdWVyeShxdWVyeTogc3RyaW5nKTogc3RyaW5nIHtcbiAgcmV0dXJuIGNyeXB0b1xuICAgIC5jcmVhdGVIbWFjKFwic2hhMjU2XCIsIEJJTkFOQ0VfQVBJX1NFQ1JFVClcbiAgICAudXBkYXRlKHF1ZXJ5KVxuICAgIC5kaWdlc3QoXCJoZXhcIik7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmZXRjaE15VHJhZGVzRm9yU3ltYm9sKGFyZ3M6IHtcbiAgc3ltYm9sOiBzdHJpbmc7XG4gIHN0YXJ0VGltZTogbnVtYmVyO1xuICBlbmRUaW1lOiBudW1iZXI7XG4gIGxpbWl0PzogbnVtYmVyO1xufSk6IFByb21pc2U8QmluYW5jZVRyYWRlW10+IHtcbiAgaWYgKCFCSU5BTkNFX0FQSV9LRVkgfHwgIUJJTkFOQ0VfQVBJX1NFQ1JFVCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIkJpbmFuY2UgQVBJIGNyZWRlbnRpYWxzIG5vdCBjb25maWd1cmVkXCIpO1xuICB9XG5cblxuICBcbiAgY29uc3QgcGFyYW1zOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmcgfCBudW1iZXI+ID0ge1xuICAgIHN5bWJvbDogYXJncy5zeW1ib2wudG9VcHBlckNhc2UoKSxcbiAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gIH07XG4gIGlmIChhcmdzLnN0YXJ0VGltZSkgcGFyYW1zLnN0YXJ0VGltZSA9IGFyZ3Muc3RhcnRUaW1lO1xuICBpZiAoYXJncy5lbmRUaW1lKSBwYXJhbXMuZW5kVGltZSA9IGFyZ3MuZW5kVGltZTtcbiAgaWYgKGFyZ3MubGltaXQpIHBhcmFtcy5saW1pdCA9IGFyZ3MubGltaXQ7XG5cbiAgY29uc3QgcXVlcnkgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKFxuICAgIE9iamVjdC5lbnRyaWVzKHBhcmFtcykubWFwKChbaywgdl0pID0+IFtrLCBTdHJpbmcodildKVxuICApLnRvU3RyaW5nKCk7XG5cbiAgY29uc3Qgc2lnbmF0dXJlID0gc2lnblF1ZXJ5KHF1ZXJ5KTtcbiAgY29uc3QgdXJsID0gYCR7QklOQU5DRV9CQVNFX1VSTH0vYXBpL3YzL215VHJhZGVzPyR7cXVlcnl9JnNpZ25hdHVyZT0ke3NpZ25hdHVyZX1gO1xuXG4gIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKHVybCwge1xuICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICBoZWFkZXJzOiB7XG4gICAgICBcIlgtTUJYLUFQSUtFWVwiOiBCSU5BTkNFX0FQSV9LRVksXG4gICAgfSxcbiAgfSk7XG5cbiAgaWYgKCFyZXMub2spIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEJpbmFuY2UgbXlUcmFkZXMgSFRUUCAke3Jlcy5zdGF0dXN9YCk7XG4gIH1cblxuICBjb25zdCBqc29uID0gKGF3YWl0IHJlcy5qc29uKCkpIGFzIEJpbmFuY2VUcmFkZVtdO1xuICByZXR1cm4ganNvbjtcbn1cblxuIl0sIm5hbWVzIjpbImNyeXB0byIsImdldFdhbGxldCIsImdldE15VHJhZGVzRm9yU3ltYm9sIiwic3ltYm9sIiwib3B0aW9ucyIsImVtYWlsIiwidG9Mb3dlckNhc2UiLCJjcmVkcyIsInJlc29sdmVDcmVkZW50aWFscyIsInNjb3BlIiwiY29uc29sZSIsIndhcm4iLCJxdWVyeSIsImZyb21JZCIsInN0YXJ0VGltZSIsImVuZFRpbWUiLCJsaW1pdCIsInNpZ25lZEdFVCIsImVycm9yIiwibWVzc2FnZSIsIkVycm9yIiwiU3RyaW5nIiwiQkFTRSIsInByb2Nlc3MiLCJlbnYiLCJCSU5BTkNFX0JBU0UiLCJFTlZfQVBJX0tFWSIsIkJJTkFOQ0VfQVBJX0tFWSIsIkJJTkFOQ0VfS0VZIiwiRU5WX0FQSV9TRUNSRVQiLCJCSU5BTkNFX0FQSV9TRUNSRVQiLCJCSU5BTkNFX1NFQ1JFVCIsImVudkNyZWRlbnRpYWxzIiwiYXBpS2V5IiwiYXBpU2VjcmV0IiwidGltZVNrZXdNcyIsInFzIiwicGFyYW1zIiwiZW50cmllcyIsIk9iamVjdCIsImZpbHRlciIsInYiLCJ1bmRlZmluZWQiLCJtYXAiLCJrIiwic29ydCIsImEiLCJiIiwiZW5jb2RlVVJJQ29tcG9uZW50Iiwiam9pbiIsInNpZ24iLCJwYXlsb2FkIiwic2VjcmV0IiwiY3JlYXRlSG1hYyIsInVwZGF0ZSIsImRpZ2VzdCIsImdldEpzb24iLCJ1cmwiLCJpbml0IiwicmVzIiwiZmV0Y2giLCJ0ZXh0IiwiYm9keSIsIkpTT04iLCJwYXJzZSIsIm9rIiwibXNnIiwiY29kZSIsInN0YXR1c1RleHQiLCJlcnIiLCJzdGF0dXMiLCJmZXRjaFNlcnZlclRpbWUiLCJVUkwiLCJ0b1N0cmluZyIsImoiLCJjYWNoZSIsIk51bWJlciIsInNlcnZlclRpbWUiLCJEYXRlIiwibm93Iiwid2FsbGV0IiwicGF0aCIsInJlY3ZXaW5kb3ciLCJ0aW1lc3RhbXAiLCJiYXNlUGFyYW1zIiwic2lnIiwic2VhcmNoIiwiaGVhZGVycyIsInRlc3QiLCJ0czIiLCJwYXlsb2FkMiIsInNpZzIiLCJ1cmwyIiwiV0FMTEVUX1RUTF9NUyIsIk1hcCIsImNhY2hlS2V5IiwiY2xlYXJXYWxsZXRDYWNoZSIsImRlbGV0ZSIsImNsZWFyIiwiZ2V0QWNjb3VudEJhbGFuY2VzIiwia2V5IiwiY2FjaGVkIiwiZ2V0IiwiYXQiLCJkYXRhIiwiZW1wdHkiLCJzZXQiLCJvdXQiLCJhcnIiLCJBcnJheSIsImlzQXJyYXkiLCJiYWxhbmNlcyIsImJhbGFuY2UiLCJhc3NldCIsInRyaW0iLCJmcmVlIiwiaXNGaW5pdGUiLCJfaW50ZXJuYWwiLCJCSU5BTkNFX0JBU0VfVVJMIiwic2lnblF1ZXJ5IiwiZmV0Y2hNeVRyYWRlc0ZvclN5bWJvbCIsImFyZ3MiLCJ0b1VwcGVyQ2FzZSIsIlVSTFNlYXJjaFBhcmFtcyIsInNpZ25hdHVyZSIsIm1ldGhvZCIsImpzb24iXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/core/sources/binanceAccount.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/auth/server.ts":
/*!********************************!*\
  !*** ./src/lib/auth/server.ts ***!
  \********************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   clearSessionCookieAndRevoke: () => (/* binding */ clearSessionCookieAndRevoke),\n/* harmony export */   createSession: () => (/* binding */ createSession),\n/* harmony export */   createUserFromInvite: () => (/* binding */ createUserFromInvite),\n/* harmony export */   findUserByEmail: () => (/* binding */ findUserByEmail),\n/* harmony export */   getCurrentUser: () => (/* binding */ getCurrentUser),\n/* harmony export */   hashPassword: () => (/* binding */ hashPassword),\n/* harmony export */   requireAdmin: () => (/* binding */ requireAdmin),\n/* harmony export */   verifyPassword: () => (/* binding */ verifyPassword)\n/* harmony export */ });\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _core_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/core/db */ \"(rsc)/./src/core/db/index.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_core_db__WEBPACK_IMPORTED_MODULE_2__]);\n_core_db__WEBPACK_IMPORTED_MODULE_2__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n// src/lib/auth/server.ts\n\n\n\nconst SESSION_COOKIE = \"session\"; // reuse your existing cookie name\nconst SESSION_TTL_MS = 1000 * 60 * 60 * 24 * 7; // 7 days\n//  basic helpers \nfunction randomToken() {\n    return crypto__WEBPACK_IMPORTED_MODULE_0___default().randomBytes(32).toString(\"hex\");\n}\nfunction hashToken(raw) {\n    return crypto__WEBPACK_IMPORTED_MODULE_0___default().createHash(\"sha256\").update(raw).digest(\"hex\");\n}\nasync function hashPassword(raw) {\n    // scrypt with salt (simple variant; you can swap to argon2/bcrypt later)\n    const salt = crypto__WEBPACK_IMPORTED_MODULE_0___default().randomBytes(16);\n    const derivedKey = await new Promise((resolve, reject)=>{\n        crypto__WEBPACK_IMPORTED_MODULE_0___default().scrypt(raw, salt, 64, (err, key)=>err ? reject(err) : resolve(key));\n    });\n    return `${salt.toString(\"hex\")}:${derivedKey.toString(\"hex\")}`;\n}\nasync function verifyPassword(raw, stored) {\n    const [saltHex, hashHex] = stored.split(\":\");\n    if (!saltHex || !hashHex) return false;\n    const salt = Buffer.from(saltHex, \"hex\");\n    const expected = Buffer.from(hashHex, \"hex\");\n    const derived = await new Promise((resolve, reject)=>{\n        crypto__WEBPACK_IMPORTED_MODULE_0___default().scrypt(raw, salt, expected.length, (err, key)=>err ? reject(err) : resolve(key));\n    });\n    return crypto__WEBPACK_IMPORTED_MODULE_0___default().timingSafeEqual(expected, derived);\n}\nasync function findUserByEmail(email) {\n    const { rows } = await (0,_core_db__WEBPACK_IMPORTED_MODULE_2__.query)(`select user_id, email, nickname, is_admin, status\n       from auth.\"user\"\n      where email = $1`, [\n        email.toLowerCase()\n    ]);\n    return rows[0] ?? null;\n}\n// Create/activate user from invite token + password.\n// Handles: invite validity, email binding, status, audit.\nasync function createUserFromInvite(params) {\n    const { email, nickname, password, inviteToken } = params;\n    const tokenHash = hashToken(inviteToken);\n    return await (0,_core_db__WEBPACK_IMPORTED_MODULE_2__.withClient)(async (client)=>{\n        await client.query(\"BEGIN\");\n        try {\n            const { rows: invRows } = await client.query(`select invite_id, email, status, expires_at, used_at\n           from auth.invite\n          where token_hash = $1\n          for update`, [\n                tokenHash\n            ]);\n            const inv = invRows[0];\n            if (!inv) throw new Error(\"Invalid invite\");\n            if (inv.status !== \"active\") throw new Error(\"Invite not active\");\n            if (inv.expires_at && new Date(inv.expires_at) < new Date()) {\n                throw new Error(\"Invite expired\");\n            }\n            if (inv.email && inv.email.toLowerCase() !== email.toLowerCase()) {\n                throw new Error(\"Invite bound to a different email\");\n            }\n            const pwdHash = await hashPassword(password);\n            const { rows: userRows } = await client.query(`insert into auth.\"user\" (email, nickname, password_hash, status)\n         values ($1, $2, $3, 'active')\n         on conflict (email) do update\n           set nickname = excluded.nickname,\n               password_hash = excluded.password_hash,\n               status = 'active'\n         returning user_id, email, nickname, is_admin, status`, [\n                email.toLowerCase(),\n                nickname || null,\n                pwdHash\n            ]);\n            const user = userRows[0];\n            await client.query(`update auth.invite\n            set status = 'used',\n                used_at = now(),\n                used_by = $2\n          where invite_id = $1`, [\n                inv.invite_id,\n                user.user_id\n            ]);\n            await client.query(`insert into auth.audit_log (user_id, event, details)\n         values ($1, 'invite.accepted', jsonb_build_object('invite_id', $2))`, [\n                user.user_id,\n                inv.invite_id\n            ]);\n            await client.query(\"COMMIT\");\n            return user;\n        } catch (e) {\n            await client.query(\"ROLLBACK\");\n            throw e;\n        }\n    });\n}\n//  sessions \nasync function createSession(userId, req) {\n    const rawToken = randomToken();\n    const tokenHash = hashToken(rawToken);\n    const now = Date.now();\n    const expiresAt = new Date(now + SESSION_TTL_MS);\n    const ip = req?.headers.get(\"x-forwarded-for\")?.split(\",\")[0]?.trim() ?? null;\n    const ua = req?.headers.get(\"user-agent\") ?? null;\n    await (0,_core_db__WEBPACK_IMPORTED_MODULE_2__.query)(`insert into auth.session (user_id, token_hash, expires_at, ip, user_agent)\n     values ($1, $2, $3, $4, $5)`, [\n        userId,\n        tokenHash,\n        expiresAt,\n        ip,\n        ua\n    ]);\n    const jar = await (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n    jar.set(SESSION_COOKIE, rawToken, {\n        httpOnly: true,\n        sameSite: \"lax\",\n        path: \"/\",\n        expires: expiresAt\n    });\n    await (0,_core_db__WEBPACK_IMPORTED_MODULE_2__.query)(`update auth.\"user\" set last_login_at = now() where user_id = $1`, [\n        userId\n    ]);\n    await (0,_core_db__WEBPACK_IMPORTED_MODULE_2__.query)(`insert into auth.audit_log (user_id, event, details)\n     values ($1, 'login.success', '{}'::jsonb)`, [\n        userId\n    ]);\n}\nasync function clearSessionCookieAndRevoke() {\n    const jar = await (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n    const raw = jar.get(SESSION_COOKIE)?.value ?? null;\n    if (raw) {\n        const tokenHash = hashToken(raw);\n        await (0,_core_db__WEBPACK_IMPORTED_MODULE_2__.query)(`update auth.session\n          set revoked_at = now()\n        where token_hash = $1\n          and revoked_at is null`, [\n            tokenHash\n        ]);\n    }\n    jar.delete(SESSION_COOKIE);\n}\nasync function getCurrentUser(opts) {\n    const jar = await (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n    const raw = jar.get(SESSION_COOKIE)?.value ?? null;\n    if (!raw) return null;\n    const tokenHash = hashToken(raw);\n    const { rows } = await (0,_core_db__WEBPACK_IMPORTED_MODULE_2__.query)(`select u.user_id, u.email, u.nickname, u.is_admin, u.status,\n            s.expires_at, s.revoked_at\n       from auth.session s\n       join auth.\"user\" u on u.user_id = s.user_id\n      where s.token_hash = $1\n      order by s.created_at desc\n      limit 1`, [\n        tokenHash\n    ]);\n    const row = rows[0];\n    if (!row) return null;\n    if (row.revoked_at) return null;\n    if (new Date(row.expires_at) < new Date()) return null;\n    if (row.status !== \"active\" && !opts?.includeInactive) return null;\n    return {\n        user_id: row.user_id,\n        email: row.email,\n        nickname: row.nickname,\n        is_admin: row.is_admin,\n        status: row.status\n    };\n}\nasync function requireAdmin() {\n    const user = await getCurrentUser();\n    if (!user || !user.is_admin) {\n        throw new Error(\"Forbidden\");\n    }\n    return user;\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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T0FBTztJQUU5RCxPQUFPO1FBQ0wxQixTQUFTd0IsSUFBSXhCLE9BQU87UUFDcEJwQixPQUFPNEMsSUFBSTVDLEtBQUs7UUFDaEJLLFVBQVV1QyxJQUFJdkMsUUFBUTtRQUN0QjBDLFVBQVVILElBQUlHLFFBQVE7UUFDdEJsQyxRQUFRK0IsSUFBSS9CLE1BQU07SUFDcEI7QUFDRjtBQUVPLGVBQWVtQztJQUNwQixNQUFNOUIsT0FBTyxNQUFNd0I7SUFDbkIsSUFBSSxDQUFDeEIsUUFBUSxDQUFDQSxLQUFLNkIsUUFBUSxFQUFFO1FBQzNCLE1BQU0sSUFBSW5DLE1BQU07SUFDbEI7SUFDQSxPQUFPTTtBQUNUIiwic291cmNlcyI6WyJIOlxcVXNlcnNcXEd1c1xcc291cmNlXFxyZXBvXFxkeW5hbWljc1xcZHluYW1pY3MtYlxcY3J5cHRvcGktZHluYW1pY3NcXHNyY1xcbGliXFxhdXRoXFxzZXJ2ZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL2xpYi9hdXRoL3NlcnZlci50c1xyXG5pbXBvcnQgY3J5cHRvIGZyb20gXCJjcnlwdG9cIjtcclxuaW1wb3J0IHsgY29va2llcyB9IGZyb20gXCJuZXh0L2hlYWRlcnNcIjtcclxuaW1wb3J0IHR5cGUgeyBOZXh0UmVxdWVzdCB9IGZyb20gXCJuZXh0L3NlcnZlclwiO1xyXG5pbXBvcnQgeyBxdWVyeSwgd2l0aENsaWVudCB9IGZyb20gXCJAL2NvcmUvZGJcIjtcclxuXHJcbmNvbnN0IFNFU1NJT05fQ09PS0lFID0gXCJzZXNzaW9uXCI7ICAgICAgICAgICAgLy8gcmV1c2UgeW91ciBleGlzdGluZyBjb29raWUgbmFtZVxyXG5jb25zdCBTRVNTSU9OX1RUTF9NUyA9IDEwMDAgKiA2MCAqIDYwICogMjQgKiA3OyAvLyA3IGRheXNcclxuXHJcbi8vIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCBiYXNpYyBoZWxwZXJzIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgFxyXG5cclxuZnVuY3Rpb24gcmFuZG9tVG9rZW4oKTogc3RyaW5nIHtcclxuICByZXR1cm4gY3J5cHRvLnJhbmRvbUJ5dGVzKDMyKS50b1N0cmluZyhcImhleFwiKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFzaFRva2VuKHJhdzogc3RyaW5nKTogc3RyaW5nIHtcclxuICByZXR1cm4gY3J5cHRvLmNyZWF0ZUhhc2goXCJzaGEyNTZcIikudXBkYXRlKHJhdykuZGlnZXN0KFwiaGV4XCIpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFzaFBhc3N3b3JkKHJhdzogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICAvLyBzY3J5cHQgd2l0aCBzYWx0IChzaW1wbGUgdmFyaWFudDsgeW91IGNhbiBzd2FwIHRvIGFyZ29uMi9iY3J5cHQgbGF0ZXIpXHJcbiAgY29uc3Qgc2FsdCA9IGNyeXB0by5yYW5kb21CeXRlcygxNik7XHJcbiAgY29uc3QgZGVyaXZlZEtleSA9IGF3YWl0IG5ldyBQcm9taXNlPEJ1ZmZlcj4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgY3J5cHRvLnNjcnlwdChyYXcsIHNhbHQsIDY0LCAoZXJyLCBrZXkpID0+IChlcnIgPyByZWplY3QoZXJyKSA6IHJlc29sdmUoa2V5IGFzIEJ1ZmZlcikpKTtcclxuICB9KTtcclxuICByZXR1cm4gYCR7c2FsdC50b1N0cmluZyhcImhleFwiKX06JHtkZXJpdmVkS2V5LnRvU3RyaW5nKFwiaGV4XCIpfWA7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB2ZXJpZnlQYXNzd29yZChyYXc6IHN0cmluZywgc3RvcmVkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcclxuICBjb25zdCBbc2FsdEhleCwgaGFzaEhleF0gPSBzdG9yZWQuc3BsaXQoXCI6XCIpO1xyXG4gIGlmICghc2FsdEhleCB8fCAhaGFzaEhleCkgcmV0dXJuIGZhbHNlO1xyXG4gIGNvbnN0IHNhbHQgPSBCdWZmZXIuZnJvbShzYWx0SGV4LCBcImhleFwiKTtcclxuICBjb25zdCBleHBlY3RlZCA9IEJ1ZmZlci5mcm9tKGhhc2hIZXgsIFwiaGV4XCIpO1xyXG4gIGNvbnN0IGRlcml2ZWQgPSBhd2FpdCBuZXcgUHJvbWlzZTxCdWZmZXI+KChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgIGNyeXB0by5zY3J5cHQocmF3LCBzYWx0LCBleHBlY3RlZC5sZW5ndGgsIChlcnIsIGtleSkgPT5cclxuICAgICAgZXJyID8gcmVqZWN0KGVycikgOiByZXNvbHZlKGtleSBhcyBCdWZmZXIpLFxyXG4gICAgKTtcclxuICB9KTtcclxuICByZXR1cm4gY3J5cHRvLnRpbWluZ1NhZmVFcXVhbChleHBlY3RlZCwgZGVyaXZlZCk7XHJcbn1cclxuXHJcbi8vIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgCB1c2VycyDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIBcclxuXHJcbmV4cG9ydCB0eXBlIERiVXNlciA9IHtcclxuICB1c2VyX2lkOiBzdHJpbmc7XHJcbiAgZW1haWw6IHN0cmluZztcclxuICBuaWNrbmFtZTogc3RyaW5nIHwgbnVsbDtcclxuICBpc19hZG1pbjogYm9vbGVhbjtcclxuICBzdGF0dXM6IHN0cmluZztcclxufTtcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmaW5kVXNlckJ5RW1haWwoZW1haWw6IHN0cmluZyk6IFByb21pc2U8RGJVc2VyIHwgbnVsbD4ge1xyXG4gIGNvbnN0IHsgcm93cyB9ID0gYXdhaXQgcXVlcnk8RGJVc2VyPihcclxuICAgIGBzZWxlY3QgdXNlcl9pZCwgZW1haWwsIG5pY2tuYW1lLCBpc19hZG1pbiwgc3RhdHVzXHJcbiAgICAgICBmcm9tIGF1dGguXCJ1c2VyXCJcclxuICAgICAgd2hlcmUgZW1haWwgPSAkMWAsXHJcbiAgICBbZW1haWwudG9Mb3dlckNhc2UoKV0sXHJcbiAgKTtcclxuICByZXR1cm4gcm93c1swXSA/PyBudWxsO1xyXG59XHJcblxyXG4vLyBDcmVhdGUvYWN0aXZhdGUgdXNlciBmcm9tIGludml0ZSB0b2tlbiArIHBhc3N3b3JkLlxyXG4vLyBIYW5kbGVzOiBpbnZpdGUgdmFsaWRpdHksIGVtYWlsIGJpbmRpbmcsIHN0YXR1cywgYXVkaXQuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVVc2VyRnJvbUludml0ZShwYXJhbXM6IHtcclxuICBlbWFpbDogc3RyaW5nO1xyXG4gIG5pY2tuYW1lPzogc3RyaW5nO1xyXG4gIHBhc3N3b3JkOiBzdHJpbmc7XHJcbiAgaW52aXRlVG9rZW46IHN0cmluZztcclxufSk6IFByb21pc2U8RGJVc2VyPiB7XHJcbiAgY29uc3QgeyBlbWFpbCwgbmlja25hbWUsIHBhc3N3b3JkLCBpbnZpdGVUb2tlbiB9ID0gcGFyYW1zO1xyXG4gIGNvbnN0IHRva2VuSGFzaCA9IGhhc2hUb2tlbihpbnZpdGVUb2tlbik7XHJcblxyXG4gIHJldHVybiBhd2FpdCB3aXRoQ2xpZW50PERiVXNlcj4oYXN5bmMgKGNsaWVudCkgPT4ge1xyXG4gICAgYXdhaXQgY2xpZW50LnF1ZXJ5KFwiQkVHSU5cIik7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCB7IHJvd3M6IGludlJvd3MgfSA9IGF3YWl0IGNsaWVudC5xdWVyeShcclxuICAgICAgICBgc2VsZWN0IGludml0ZV9pZCwgZW1haWwsIHN0YXR1cywgZXhwaXJlc19hdCwgdXNlZF9hdFxyXG4gICAgICAgICAgIGZyb20gYXV0aC5pbnZpdGVcclxuICAgICAgICAgIHdoZXJlIHRva2VuX2hhc2ggPSAkMVxyXG4gICAgICAgICAgZm9yIHVwZGF0ZWAsXHJcbiAgICAgICAgW3Rva2VuSGFzaF0sXHJcbiAgICAgICk7XHJcbiAgICAgIGNvbnN0IGludiA9IGludlJvd3NbMF07XHJcbiAgICAgIGlmICghaW52KSB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGludml0ZVwiKTtcclxuICAgICAgaWYgKGludi5zdGF0dXMgIT09IFwiYWN0aXZlXCIpIHRocm93IG5ldyBFcnJvcihcIkludml0ZSBub3QgYWN0aXZlXCIpO1xyXG4gICAgICBpZiAoaW52LmV4cGlyZXNfYXQgJiYgbmV3IERhdGUoaW52LmV4cGlyZXNfYXQpIDwgbmV3IERhdGUoKSkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludml0ZSBleHBpcmVkXCIpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChpbnYuZW1haWwgJiYgaW52LmVtYWlsLnRvTG93ZXJDYXNlKCkgIT09IGVtYWlsLnRvTG93ZXJDYXNlKCkpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZpdGUgYm91bmQgdG8gYSBkaWZmZXJlbnQgZW1haWxcIik7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IHB3ZEhhc2ggPSBhd2FpdCBoYXNoUGFzc3dvcmQocGFzc3dvcmQpO1xyXG5cclxuICAgICAgY29uc3QgeyByb3dzOiB1c2VyUm93cyB9ID0gYXdhaXQgY2xpZW50LnF1ZXJ5PERiVXNlcj4oXHJcbiAgICAgICAgYGluc2VydCBpbnRvIGF1dGguXCJ1c2VyXCIgKGVtYWlsLCBuaWNrbmFtZSwgcGFzc3dvcmRfaGFzaCwgc3RhdHVzKVxyXG4gICAgICAgICB2YWx1ZXMgKCQxLCAkMiwgJDMsICdhY3RpdmUnKVxyXG4gICAgICAgICBvbiBjb25mbGljdCAoZW1haWwpIGRvIHVwZGF0ZVxyXG4gICAgICAgICAgIHNldCBuaWNrbmFtZSA9IGV4Y2x1ZGVkLm5pY2tuYW1lLFxyXG4gICAgICAgICAgICAgICBwYXNzd29yZF9oYXNoID0gZXhjbHVkZWQucGFzc3dvcmRfaGFzaCxcclxuICAgICAgICAgICAgICAgc3RhdHVzID0gJ2FjdGl2ZSdcclxuICAgICAgICAgcmV0dXJuaW5nIHVzZXJfaWQsIGVtYWlsLCBuaWNrbmFtZSwgaXNfYWRtaW4sIHN0YXR1c2AsXHJcbiAgICAgICAgW2VtYWlsLnRvTG93ZXJDYXNlKCksIG5pY2tuYW1lIHx8IG51bGwsIHB3ZEhhc2hdLFxyXG4gICAgICApO1xyXG4gICAgICBjb25zdCB1c2VyID0gdXNlclJvd3NbMF07XHJcblxyXG4gICAgICBhd2FpdCBjbGllbnQucXVlcnkoXHJcbiAgICAgICAgYHVwZGF0ZSBhdXRoLmludml0ZVxyXG4gICAgICAgICAgICBzZXQgc3RhdHVzID0gJ3VzZWQnLFxyXG4gICAgICAgICAgICAgICAgdXNlZF9hdCA9IG5vdygpLFxyXG4gICAgICAgICAgICAgICAgdXNlZF9ieSA9ICQyXHJcbiAgICAgICAgICB3aGVyZSBpbnZpdGVfaWQgPSAkMWAsXHJcbiAgICAgICAgW2ludi5pbnZpdGVfaWQsIHVzZXIudXNlcl9pZF0sXHJcbiAgICAgICk7XHJcblxyXG4gICAgICBhd2FpdCBjbGllbnQucXVlcnkoXHJcbiAgICAgICAgYGluc2VydCBpbnRvIGF1dGguYXVkaXRfbG9nICh1c2VyX2lkLCBldmVudCwgZGV0YWlscylcclxuICAgICAgICAgdmFsdWVzICgkMSwgJ2ludml0ZS5hY2NlcHRlZCcsIGpzb25iX2J1aWxkX29iamVjdCgnaW52aXRlX2lkJywgJDIpKWAsXHJcbiAgICAgICAgW3VzZXIudXNlcl9pZCwgaW52Lmludml0ZV9pZF0sXHJcbiAgICAgICk7XHJcblxyXG4gICAgICBhd2FpdCBjbGllbnQucXVlcnkoXCJDT01NSVRcIik7XHJcbiAgICAgIHJldHVybiB1c2VyO1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICBhd2FpdCBjbGllbnQucXVlcnkoXCJST0xMQkFDS1wiKTtcclxuICAgICAgdGhyb3cgZTtcclxuICAgIH1cclxuICB9KTtcclxufVxyXG5cclxuLy8g4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAIHNlc3Npb25zIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgFxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVNlc3Npb24odXNlcklkOiBzdHJpbmcsIHJlcT86IE5leHRSZXF1ZXN0KTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgY29uc3QgcmF3VG9rZW4gPSByYW5kb21Ub2tlbigpO1xyXG4gIGNvbnN0IHRva2VuSGFzaCA9IGhhc2hUb2tlbihyYXdUb2tlbik7XHJcbiAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcclxuICBjb25zdCBleHBpcmVzQXQgPSBuZXcgRGF0ZShub3cgKyBTRVNTSU9OX1RUTF9NUyk7XHJcblxyXG4gIGNvbnN0IGlwID0gcmVxPy5oZWFkZXJzLmdldChcIngtZm9yd2FyZGVkLWZvclwiKT8uc3BsaXQoXCIsXCIpWzBdPy50cmltKCkgPz8gbnVsbDtcclxuICBjb25zdCB1YSA9IHJlcT8uaGVhZGVycy5nZXQoXCJ1c2VyLWFnZW50XCIpID8/IG51bGw7XHJcblxyXG4gIGF3YWl0IHF1ZXJ5KFxyXG4gICAgYGluc2VydCBpbnRvIGF1dGguc2Vzc2lvbiAodXNlcl9pZCwgdG9rZW5faGFzaCwgZXhwaXJlc19hdCwgaXAsIHVzZXJfYWdlbnQpXHJcbiAgICAgdmFsdWVzICgkMSwgJDIsICQzLCAkNCwgJDUpYCxcclxuICAgIFt1c2VySWQsIHRva2VuSGFzaCwgZXhwaXJlc0F0LCBpcCwgdWFdLFxyXG4gICk7XHJcblxyXG4gIGNvbnN0IGphciA9IGF3YWl0IGNvb2tpZXMoKTtcclxuICBqYXIuc2V0KFNFU1NJT05fQ09PS0lFLCByYXdUb2tlbiwge1xyXG4gICAgaHR0cE9ubHk6IHRydWUsXHJcbiAgICBzYW1lU2l0ZTogXCJsYXhcIixcclxuICAgIHBhdGg6IFwiL1wiLFxyXG4gICAgZXhwaXJlczogZXhwaXJlc0F0LFxyXG4gIH0pO1xyXG5cclxuICBhd2FpdCBxdWVyeShgdXBkYXRlIGF1dGguXCJ1c2VyXCIgc2V0IGxhc3RfbG9naW5fYXQgPSBub3coKSB3aGVyZSB1c2VyX2lkID0gJDFgLCBbdXNlcklkXSk7XHJcblxyXG4gIGF3YWl0IHF1ZXJ5KFxyXG4gICAgYGluc2VydCBpbnRvIGF1dGguYXVkaXRfbG9nICh1c2VyX2lkLCBldmVudCwgZGV0YWlscylcclxuICAgICB2YWx1ZXMgKCQxLCAnbG9naW4uc3VjY2VzcycsICd7fSc6Ompzb25iKWAsXHJcbiAgICBbdXNlcklkXSxcclxuICApO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2xlYXJTZXNzaW9uQ29va2llQW5kUmV2b2tlKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gIGNvbnN0IGphciA9IGF3YWl0IGNvb2tpZXMoKTtcclxuICBjb25zdCByYXcgPSBqYXIuZ2V0KFNFU1NJT05fQ09PS0lFKT8udmFsdWUgPz8gbnVsbDtcclxuICBpZiAocmF3KSB7XHJcbiAgICBjb25zdCB0b2tlbkhhc2ggPSBoYXNoVG9rZW4ocmF3KTtcclxuICAgIGF3YWl0IHF1ZXJ5KFxyXG4gICAgICBgdXBkYXRlIGF1dGguc2Vzc2lvblxyXG4gICAgICAgICAgc2V0IHJldm9rZWRfYXQgPSBub3coKVxyXG4gICAgICAgIHdoZXJlIHRva2VuX2hhc2ggPSAkMVxyXG4gICAgICAgICAgYW5kIHJldm9rZWRfYXQgaXMgbnVsbGAsXHJcbiAgICAgIFt0b2tlbkhhc2hdLFxyXG4gICAgKTtcclxuICB9XHJcbiAgamFyLmRlbGV0ZShTRVNTSU9OX0NPT0tJRSk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDdXJyZW50VXNlcihvcHRzPzogeyBpbmNsdWRlSW5hY3RpdmU/OiBib29sZWFuIH0pOiBQcm9taXNlPERiVXNlciB8IG51bGw+IHtcbiAgY29uc3QgamFyID0gYXdhaXQgY29va2llcygpO1xuICBjb25zdCByYXcgPSBqYXIuZ2V0KFNFU1NJT05fQ09PS0lFKT8udmFsdWUgPz8gbnVsbDtcbiAgaWYgKCFyYXcpIHJldHVybiBudWxsO1xuXG4gIGNvbnN0IHRva2VuSGFzaCA9IGhhc2hUb2tlbihyYXcpO1xuICBjb25zdCB7IHJvd3MgfSA9IGF3YWl0IHF1ZXJ5PFxyXG4gICAgRGJVc2VyICYgeyBleHBpcmVzX2F0OiBzdHJpbmc7IHJldm9rZWRfYXQ6IHN0cmluZyB8IG51bGwgfVxyXG4gID4oXHJcbiAgICBgc2VsZWN0IHUudXNlcl9pZCwgdS5lbWFpbCwgdS5uaWNrbmFtZSwgdS5pc19hZG1pbiwgdS5zdGF0dXMsXHJcbiAgICAgICAgICAgIHMuZXhwaXJlc19hdCwgcy5yZXZva2VkX2F0XHJcbiAgICAgICBmcm9tIGF1dGguc2Vzc2lvbiBzXHJcbiAgICAgICBqb2luIGF1dGguXCJ1c2VyXCIgdSBvbiB1LnVzZXJfaWQgPSBzLnVzZXJfaWRcclxuICAgICAgd2hlcmUgcy50b2tlbl9oYXNoID0gJDFcclxuICAgICAgb3JkZXIgYnkgcy5jcmVhdGVkX2F0IGRlc2NcclxuICAgICAgbGltaXQgMWAsXHJcbiAgICBbdG9rZW5IYXNoXSxcclxuICApO1xyXG5cclxuICBjb25zdCByb3cgPSByb3dzWzBdO1xyXG4gIGlmICghcm93KSByZXR1cm4gbnVsbDtcclxuICBpZiAocm93LnJldm9rZWRfYXQpIHJldHVybiBudWxsO1xuICBpZiAobmV3IERhdGUocm93LmV4cGlyZXNfYXQpIDwgbmV3IERhdGUoKSkgcmV0dXJuIG51bGw7XG4gIGlmIChyb3cuc3RhdHVzICE9PSBcImFjdGl2ZVwiICYmICFvcHRzPy5pbmNsdWRlSW5hY3RpdmUpIHJldHVybiBudWxsO1xuXHJcbiAgcmV0dXJuIHtcclxuICAgIHVzZXJfaWQ6IHJvdy51c2VyX2lkLFxyXG4gICAgZW1haWw6IHJvdy5lbWFpbCxcclxuICAgIG5pY2tuYW1lOiByb3cubmlja25hbWUsXHJcbiAgICBpc19hZG1pbjogcm93LmlzX2FkbWluLFxyXG4gICAgc3RhdHVzOiByb3cuc3RhdHVzLFxyXG4gIH07XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXF1aXJlQWRtaW4oKTogUHJvbWlzZTxEYlVzZXI+IHtcclxuICBjb25zdCB1c2VyID0gYXdhaXQgZ2V0Q3VycmVudFVzZXIoKTtcclxuICBpZiAoIXVzZXIgfHwgIXVzZXIuaXNfYWRtaW4pIHtcclxuICAgIHRocm93IG5ldyBFcnJvcihcIkZvcmJpZGRlblwiKTtcclxuICB9XHJcbiAgcmV0dXJuIHVzZXI7XHJcbn1cclxuIl0sIm5hbWVzIjpbImNyeXB0byIsImNvb2tpZXMiLCJxdWVyeSIsIndpdGhDbGllbnQiLCJTRVNTSU9OX0NPT0tJRSIsIlNFU1NJT05fVFRMX01TIiwicmFuZG9tVG9rZW4iLCJyYW5kb21CeXRlcyIsInRvU3RyaW5nIiwiaGFzaFRva2VuIiwicmF3IiwiY3JlYXRlSGFzaCIsInVwZGF0ZSIsImRpZ2VzdCIsImhhc2hQYXNzd29yZCIsInNhbHQiLCJkZXJpdmVkS2V5IiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJzY3J5cHQiLCJlcnIiLCJrZXkiLCJ2ZXJpZnlQYXNzd29yZCIsInN0b3JlZCIsInNhbHRIZXgiLCJoYXNoSGV4Iiwic3BsaXQiLCJCdWZmZXIiLCJmcm9tIiwiZXhwZWN0ZWQiLCJkZXJpdmVkIiwibGVuZ3RoIiwidGltaW5nU2FmZUVxdWFsIiwiZmluZFVzZXJCeUVtYWlsIiwiZW1haWwiLCJyb3dzIiwidG9Mb3dlckNhc2UiLCJjcmVhdGVVc2VyRnJvbUludml0ZSIsInBhcmFtcyIsIm5pY2tuYW1lIiwicGFzc3dvcmQiLCJpbnZpdGVUb2tlbiIsInRva2VuSGFzaCIsImNsaWVudCIsImludlJvd3MiLCJpbnYiLCJFcnJvciIsInN0YXR1cyIsImV4cGlyZXNfYXQiLCJEYXRlIiwicHdkSGFzaCIsInVzZXJSb3dzIiwidXNlciIsImludml0ZV9pZCIsInVzZXJfaWQiLCJlIiwiY3JlYXRlU2Vzc2lvbiIsInVzZXJJZCIsInJlcSIsInJhd1Rva2VuIiwibm93IiwiZXhwaXJlc0F0IiwiaXAiLCJoZWFkZXJzIiwiZ2V0IiwidHJpbSIsInVhIiwiamFyIiwic2V0IiwiaHR0cE9ubHkiLCJzYW1lU2l0ZSIsInBhdGgiLCJleHBpcmVzIiwiY2xlYXJTZXNzaW9uQ29va2llQW5kUmV2b2tlIiwidmFsdWUiLCJkZWxldGUiLCJnZXRDdXJyZW50VXNlciIsIm9wdHMiLCJyb3ciLCJyZXZva2VkX2F0IiwiaW5jbHVkZUluYWN0aXZlIiwiaXNfYWRtaW4iLCJyZXF1aXJlQWRtaW4iXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/auth/server.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/wallet/registry.ts":
/*!************************************!*\
  !*** ./src/lib/wallet/registry.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   deleteWallet: () => (/* binding */ deleteWallet),\n/* harmony export */   getWallet: () => (/* binding */ getWallet),\n/* harmony export */   listWallets: () => (/* binding */ listWallets),\n/* harmony export */   maskKey: () => (/* binding */ maskKey),\n/* harmony export */   setWallet: () => (/* binding */ setWallet)\n/* harmony export */ });\n// src/lib/wallet/registry.ts\n// In-memory registry that maps user emails to Binance API credentials.\nconst GLOBAL_KEY = \"__cryptopi_wallet_registry__\";\nconst globalObject = globalThis;\nif (!globalObject[GLOBAL_KEY]) {\n    globalObject[GLOBAL_KEY] = new Map();\n}\nconst registry = globalObject[GLOBAL_KEY];\nfunction normalizeEmail(email) {\n    return email.trim().toLowerCase();\n}\nfunction getWallet(email) {\n    return registry.get(normalizeEmail(email)) ?? null;\n}\nfunction setWallet(email, record) {\n    const normalized = normalizeEmail(email);\n    const entry = {\n        email: normalized,\n        apiKey: record.apiKey,\n        apiSecret: record.apiSecret,\n        linkedAt: record.linkedAt ?? Date.now()\n    };\n    registry.set(normalized, entry);\n    return entry;\n}\nfunction deleteWallet(email) {\n    registry.delete(normalizeEmail(email));\n}\nfunction maskKey(apiKey) {\n    if (apiKey.length <= 8) return apiKey;\n    return `${apiKey.slice(0, 4)}${apiKey.slice(-4)}`;\n}\nfunction listWallets() {\n    return Array.from(registry.values());\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3dhbGxldC9yZWdpc3RyeS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBLDZCQUE2QjtBQUM3Qix1RUFBdUU7QUFXdkUsTUFBTUEsYUFBYTtBQUNuQixNQUFNQyxlQUFlQztBQUVyQixJQUFJLENBQUNELFlBQVksQ0FBQ0QsV0FBVyxFQUFFO0lBQzdCQyxZQUFZLENBQUNELFdBQVcsR0FBRyxJQUFJRztBQUNqQztBQUVBLE1BQU1DLFdBQVdILFlBQVksQ0FBQ0QsV0FBVztBQUV6QyxTQUFTSyxlQUFlQyxLQUFhO0lBQ25DLE9BQU9BLE1BQU1DLElBQUksR0FBR0MsV0FBVztBQUNqQztBQUVPLFNBQVNDLFVBQVVILEtBQWE7SUFDckMsT0FBT0YsU0FBU00sR0FBRyxDQUFDTCxlQUFlQyxXQUFXO0FBQ2hEO0FBRU8sU0FBU0ssVUFBVUwsS0FBYSxFQUFFTSxNQUFtQztJQUMxRSxNQUFNQyxhQUFhUixlQUFlQztJQUNsQyxNQUFNUSxRQUFzQjtRQUMxQlIsT0FBT087UUFDUEUsUUFBUUgsT0FBT0csTUFBTTtRQUNyQkMsV0FBV0osT0FBT0ksU0FBUztRQUMzQkMsVUFBVUwsT0FBT0ssUUFBUSxJQUFJQyxLQUFLQyxHQUFHO0lBQ3ZDO0lBQ0FmLFNBQVNnQixHQUFHLENBQUNQLFlBQVlDO0lBQ3pCLE9BQU9BO0FBQ1Q7QUFFTyxTQUFTTyxhQUFhZixLQUFhO0lBQ3hDRixTQUFTa0IsTUFBTSxDQUFDakIsZUFBZUM7QUFDakM7QUFFTyxTQUFTaUIsUUFBUVIsTUFBYztJQUNwQyxJQUFJQSxPQUFPUyxNQUFNLElBQUksR0FBRyxPQUFPVDtJQUMvQixPQUFPLEdBQUdBLE9BQU9VLEtBQUssQ0FBQyxHQUFHLEdBQUcsQ0FBQyxFQUFFVixPQUFPVSxLQUFLLENBQUMsQ0FBQyxJQUFJO0FBQ3BEO0FBRU8sU0FBU0M7SUFDZCxPQUFPQyxNQUFNQyxJQUFJLENBQUN4QixTQUFTeUIsTUFBTTtBQUNuQyIsInNvdXJjZXMiOlsiSDpcXFVzZXJzXFxHdXNcXHNvdXJjZVxccmVwb1xcZHluYW1pY3NcXGR5bmFtaWNzLWJcXGNyeXB0b3BpLWR5bmFtaWNzXFxzcmNcXGxpYlxcd2FsbGV0XFxyZWdpc3RyeS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvbGliL3dhbGxldC9yZWdpc3RyeS50c1xyXG4vLyBJbi1tZW1vcnkgcmVnaXN0cnkgdGhhdCBtYXBzIHVzZXIgZW1haWxzIHRvIEJpbmFuY2UgQVBJIGNyZWRlbnRpYWxzLlxyXG5cclxuZXhwb3J0IHR5cGUgV2FsbGV0UmVjb3JkID0ge1xyXG4gIGVtYWlsOiBzdHJpbmc7XHJcbiAgYXBpS2V5OiBzdHJpbmc7XHJcbiAgYXBpU2VjcmV0OiBzdHJpbmc7XHJcbiAgbGlua2VkQXQ6IG51bWJlcjtcclxufTtcclxuXHJcbnR5cGUgV2FsbGV0TWFwID0gTWFwPHN0cmluZywgV2FsbGV0UmVjb3JkPjtcclxuXHJcbmNvbnN0IEdMT0JBTF9LRVkgPSBcIl9fY3J5cHRvcGlfd2FsbGV0X3JlZ2lzdHJ5X19cIjtcclxuY29uc3QgZ2xvYmFsT2JqZWN0ID0gZ2xvYmFsVGhpcyBhcyB1bmtub3duIGFzIHsgW0dMT0JBTF9LRVldPzogV2FsbGV0TWFwIH07XHJcblxyXG5pZiAoIWdsb2JhbE9iamVjdFtHTE9CQUxfS0VZXSkge1xyXG4gIGdsb2JhbE9iamVjdFtHTE9CQUxfS0VZXSA9IG5ldyBNYXAoKTtcclxufVxyXG5cclxuY29uc3QgcmVnaXN0cnkgPSBnbG9iYWxPYmplY3RbR0xPQkFMX0tFWV0hO1xyXG5cclxuZnVuY3Rpb24gbm9ybWFsaXplRW1haWwoZW1haWw6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgcmV0dXJuIGVtYWlsLnRyaW0oKS50b0xvd2VyQ2FzZSgpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0V2FsbGV0KGVtYWlsOiBzdHJpbmcpOiBXYWxsZXRSZWNvcmQgfCBudWxsIHtcclxuICByZXR1cm4gcmVnaXN0cnkuZ2V0KG5vcm1hbGl6ZUVtYWlsKGVtYWlsKSkgPz8gbnVsbDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNldFdhbGxldChlbWFpbDogc3RyaW5nLCByZWNvcmQ6IE9taXQ8V2FsbGV0UmVjb3JkLCBcImVtYWlsXCI+KTogV2FsbGV0UmVjb3JkIHtcclxuICBjb25zdCBub3JtYWxpemVkID0gbm9ybWFsaXplRW1haWwoZW1haWwpO1xyXG4gIGNvbnN0IGVudHJ5OiBXYWxsZXRSZWNvcmQgPSB7XHJcbiAgICBlbWFpbDogbm9ybWFsaXplZCxcclxuICAgIGFwaUtleTogcmVjb3JkLmFwaUtleSxcclxuICAgIGFwaVNlY3JldDogcmVjb3JkLmFwaVNlY3JldCxcclxuICAgIGxpbmtlZEF0OiByZWNvcmQubGlua2VkQXQgPz8gRGF0ZS5ub3coKSxcclxuICB9O1xyXG4gIHJlZ2lzdHJ5LnNldChub3JtYWxpemVkLCBlbnRyeSk7XHJcbiAgcmV0dXJuIGVudHJ5O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZGVsZXRlV2FsbGV0KGVtYWlsOiBzdHJpbmcpIHtcclxuICByZWdpc3RyeS5kZWxldGUobm9ybWFsaXplRW1haWwoZW1haWwpKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG1hc2tLZXkoYXBpS2V5OiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gIGlmIChhcGlLZXkubGVuZ3RoIDw9IDgpIHJldHVybiBhcGlLZXk7XHJcbiAgcmV0dXJuIGAke2FwaUtleS5zbGljZSgwLCA0KX3igKYke2FwaUtleS5zbGljZSgtNCl9YDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGxpc3RXYWxsZXRzKCk6IFdhbGxldFJlY29yZFtdIHtcclxuICByZXR1cm4gQXJyYXkuZnJvbShyZWdpc3RyeS52YWx1ZXMoKSk7XHJcbn1cclxuXHJcbiJdLCJuYW1lcyI6WyJHTE9CQUxfS0VZIiwiZ2xvYmFsT2JqZWN0IiwiZ2xvYmFsVGhpcyIsIk1hcCIsInJlZ2lzdHJ5Iiwibm9ybWFsaXplRW1haWwiLCJlbWFpbCIsInRyaW0iLCJ0b0xvd2VyQ2FzZSIsImdldFdhbGxldCIsImdldCIsInNldFdhbGxldCIsInJlY29yZCIsIm5vcm1hbGl6ZWQiLCJlbnRyeSIsImFwaUtleSIsImFwaVNlY3JldCIsImxpbmtlZEF0IiwiRGF0ZSIsIm5vdyIsInNldCIsImRlbGV0ZVdhbGxldCIsImRlbGV0ZSIsIm1hc2tLZXkiLCJsZW5ndGgiLCJzbGljZSIsImxpc3RXYWxsZXRzIiwiQXJyYXkiLCJmcm9tIiwidmFsdWVzIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/wallet/registry.ts\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!**************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \**************************************************************************************************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "../app-render/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/server/app-render/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/action-async-storage.external.js");

/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "./work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("fs");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "next/dist/shared/lib/no-fallback-error.external":
/*!******************************************************************!*\
  !*** external "next/dist/shared/lib/no-fallback-error.external" ***!
  \******************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/no-fallback-error.external");

/***/ }),

/***/ "next/dist/shared/lib/router/utils/app-paths":
/*!**************************************************************!*\
  !*** external "next/dist/shared/lib/router/utils/app-paths" ***!
  \**************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/app-paths");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("path");

/***/ }),

/***/ "pg":
/*!*********************!*\
  !*** external "pg" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = import("pg");;

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5"], () => (__webpack_exec__("(rsc)/./node_modules/.pnpm/next@15.5.2_@playwright+tes_b7e6c280e9a1b4309347c0bf0ab476d5/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fsettings%2Fwallet%2Froute&page=%2Fapi%2Fsettings%2Fwallet%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsettings%2Fwallet%2Froute.ts&appDir=H%3A%5CUsers%5CGus%5Csource%5Crepo%5Cdynamics%5Cdynamics-b%5Ccryptopi-dynamics%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=H%3A%5CUsers%5CGus%5Csource%5Crepo%5Cdynamics%5Cdynamics-b%5Ccryptopi-dynamics&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!")));
module.exports = __webpack_exports__;

})();